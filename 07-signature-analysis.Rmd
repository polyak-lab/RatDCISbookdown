# ER/Pgr Subtyping

In this section, we will look at whether there are differences in rat subtype using the following approaches:

* Creating our own subtyping approach using specific markers of interest (e.g. using PAM clustering)
    * Using known gene list 
    * Using random genes (top 50, 100, 200 etc variable genes)
* PAM50 subtyping using the methods published by [Parker et al](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2667820/). This method uses rsem scores to classify samples.

As the DN samples do have keratin expression, we will also try to determine the subtypes in these samples too.

In the below analyses, we will conduct this subtyping as follows:

* progression specific epithelial cohort
* characterisation specific epithelial cohort
* dn specific cohort (progression)

## In-house classifier

The selected gene list includes three lists: A. is a mroe comprehensive list containing epithelial, mesenchymal markers and proliferation markers, B. has a more narrow list of subtype specific markers 

a. 'Ar', 'Cd24', 'Cdh1', 'Foxa1', 'Gata3', 'Krt8', 'Krt18', 'Krt5', 'Vim', 'Erbb2', 'Esr1', 'Pgr', 'Mki67', 'Pcna'
b. 'Ar', 'Foxa1', 'Gata3', 'Erbb2', 'Esr1', 'Pgr'

We will be using variance stabilised counts in this section.

Firstly, we will look at the progression cohort. Note that the overlap between the two gene-sets are similar, and the heatmap is row-scaled. 

```{r}
Markers=c('Ar', 'Cd24', 'Cdh1', 'Foxa1', 'Gata3', 'Krt8', 'Krt18', 'Krt5', 'Vim', 'Erbb2', 'Esr1', 'Pgr', 'Mki67', 'Pcna')
Markers2=c('Ar', 'Foxa1', 'Gata3', 'Erbb2', 'Esr1', 'Pgr')

#pdf(sprintf("rslt/signatureAnalysis/new_classifer_PAM_%s.pdf", Sys.Date()), height=6, width=7)
# Progression cohort
Ax1=assay(vstEp)[ match(Markers, rownames(assay(vstEp))),]
Pam1=pam(t(Ax1), 2)
plot(Pam1, main="extended list")
ColA=Pam1$clustering
ColA=ifelse(ColA==1, "Basal", "Lum")

Ax2=assay(vstEp)[ match(Markers2, rownames(assay(vstEp))),]
Pam2=pam(t(Ax2), 2)
plot(Pam2, main="narrow list")
ColB=Pam2$clustering
ColB=ifelse(ColB==1, "Basal", "Lum")

table(ColA, ColB)

CTable=cbind(ColA, ColB)
CTable=gsub("Basal", "red", CTable)
CTable=gsub("Lum", "blue", CTable)

heatmap.plus(Ax1, col=brewer.pal(11, "RdBu")[11:1], ColSideColors =CTable,scale="row", main="Progression cohort vsd marker list1", trace="none")
```

We can perform a similar analysis to the characterisation cohort:

```{r}
c2=infoTableFinal$SampleID[which(infoTableFinal$Fraction=="Ep" & infoTableFinal$Cohort=="Characterisation")]
Ax1=assay(vsd)[ match(Markers, rownames(assay(vsd))), match(c2, colnames(vsd))]
Pam3=pam(t(Ax1), 2)
#plot(Pam3, "extended list")
ColC=Pam3$clustering
ColC=ifelse(ColC==1, "Basal", "Lum")


Ax2=assay(vsd)[ match(Markers2, rownames(assay(vsd))), match(c2, colnames(vsd))]
Pam4=pam(t(Ax1), 2)
#plot(Pam4, "narrow list")
ColD=Pam4$clustering
ColD=ifelse(ColD==1, "Basal", "Lum")

table(ColC, ColD)

CTable=cbind(ColC, ColD)
CTable=gsub("Basal", "red", CTable)
CTable=gsub("Lum", "blue", CTable)

heatmap.plus(Ax1, col=brewer.pal(11, "RdBu")[11:1], ColSideColors =CTable,scale="row", main="Char cohort vsd marker list1", trace="none")
```

DN samples:

```{r}
Ax1=assay(vstDN)[ match(Markers, rownames(assay(vstDN))),]
Pam5=pam(t(Ax1), 2)
plot(Pam5, main="extended list DN")
ColE=Pam5$clustering
ColE=ifelse(ColE==1, "Basal", "Lum")

Ax2=assay(vstDN)[ match(Markers2, rownames(assay(vstDN))),]
Pam6=pam(t(Ax2), 2)
plot(Pam6, main="narrow list")
ColF=Pam6$clustering
ColF=ifelse(ColF==1, "Basal", "Lum")

table(ColE, ColF)

CTable=cbind(ColE, ColF)
CTable=gsub("Basal", "red", CTable)
CTable=gsub("Lum", "blue", CTable)

heatmap.plus(Ax1, col=brewer.pal(11, "RdBu")[11:1], ColSideColors =CTable,scale="row", main="DN samples vsd marker list1", trace="none")

```

We can collate these different scores and assess whether there are similarities with PgR and ER staining:

```{r}
## match to infoTable here
infoTableFinal$Subtype_extendedList=NA
infoTableFinal$Subtype_compressedList=NA

id=match(names(ColA), infoTableFinal$Sample)
infoTableFinal$Subtype_extendedList[id]=ColA
infoTableFinal$Subtype_compressedList[id]=ColB

id2=match(names(ColE), infoTableFinal$Sample)
infoTableFinal$Subtype_extendedList[id2]=ColE
infoTableFinal$Subtype_compressedList[id2]=ColF

id3=match(names(ColC), infoTableFinal$Sample)
infoTableFinal$Subtype_extendedList[id3]=ColC
infoTableFinal$Subtype_compressedList[id3]=ColD


# Contingency Tables
par(mfrow=c(2,2))
a1=table(infoTableFinal$Subtype_compressedList, Cdata$PgR..IF.[match(infoTableFinal$TumorID, Cdata$TumorID)])
ContTable(a1[ ,-2], "Pgr Expr", T, "Pgr IF", "compressed subtype")
a1=table(infoTableFinal$Subtype_extendedList, Cdata$PgR..IF.[match(infoTableFinal$TumorID, Cdata$TumorID)])
ContTable(a1[ ,-2], "Pgr Expr", T, "Pgr IF", "Extended subtype")

# remove all the DN samples
x1=which(infoTableFinal$Fraction=="Ep")
a1=table(infoTableFinal$Subtype_compressedList[x1], Cdata$PgR..IF.[match(infoTableFinal$TumorID[x1], Cdata$TumorID)])
ContTable(a1[ ,-2], "Pgr Expr", T, "Pgr IF", "compressed subtype")
a1=table(infoTableFinal$Subtype_extendedList[x1], Cdata$PgR..IF.[match(infoTableFinal$TumorID[x1], Cdata$TumorID)])
ContTable(a1[ ,-2], "Pgr Expr", T, "Pgr IF", "Extended subtype")

# Contingency Tables
par(mfrow=c(2,2))
a1=table(infoTableFinal$Subtype_compressedList, Cdata$ER..IF.[match(infoTableFinal$TumorID, Cdata$TumorID)])
ContTable(a1[ ,-2], "ER Expr", T, "ER IF", "compressed subtype")
a1=table(infoTableFinal$Subtype_extendedList, Cdata$ER..IF.[match(infoTableFinal$TumorID, Cdata$TumorID)])
ContTable(a1[ ,-2], "ER Expr", T, "ER IF", "Extended subtype")

# remove all the DN samples
x1=which(infoTableFinal$Fraction=="Ep")
a1=table(infoTableFinal$Subtype_compressedList[x1], Cdata$ER..IF.[match(infoTableFinal$TumorID[x1], Cdata$TumorID)])
ContTable(a1[ ,-2], "ER Expr", T, "ER IF", "compressed subtype no DN")
a1=table(infoTableFinal$Subtype_extendedList[x1], Cdata$ER..IF.[match(infoTableFinal$TumorID[x1], Cdata$TumorID)])
ContTable(a1[ ,-2], "ER Expr", T, "ER IF", "Extended subtype no DN")

```


Finally, look at whether any of the above samples have similar DN and Ep calls: it appears that this call is random, and the subtype does not dictate growth rate

```{r}
idx1=substr(names(ColA), 1, nchar(names(ColA))-3)
idx2=substr(names(ColE), 1, nchar(names(ColE))-3)

a1=data.frame(nid=idx1, ep=ColA)
a2=data.frame(nid=idx2, dn=ColE)
a3=merge(a1, a2, by.x="nid", by.y="nid", all.x=T, all.y=T)
a3$growth=infoTableFinal$Growth[match(a3$nid, infoTableFinal$TumorID)]
print('extended list')
table(a3$ep, a3$dn, a3$growth)

a1=data.frame(nid=idx1, ep=ColB)
a2=data.frame(nid=idx2, dn=ColF)
a3=merge(a1, a2, by.x="nid", by.y="nid", all.x=T, all.y=T)
a3$growth=infoTableFinal$Growth[match(a3$nid, infoTableFinal$TumorID)]
print('narrow list')
table(a3$ep, a3$dn, a3$growth)
```

## PAM50 (Parker) scoring

Here, we have used rsem counts in PAM50 subtyping.

```{r}

ExpressedaprilChar=read.delim("../output4external/RSEM_for_PAM50_allExpressedgenes_noCD45_characterisationOnlyapril_2020-11-03_pam50scores.txt")
ExpressedaprilProg=read.delim("../output4external/RSEM_for_PAM50_allExpressedgenes_noCD45_progressionapril_2020-11-03_pam50scores.txt")
ExpressedaprilProg2=read.delim("../output4external/RSEM_for_PAM50_allExpressedgenes_epOnly_progressionapril_2020-11-03_pam50scores.txt")

Pall=rbind(ExpressedaprilChar, ExpressedaprilProg)
Pall$Call[match(ExpressedaprilProg2$X, Pall$X)]=ExpressedaprilProg2$Call

# add to pamcalls

Pall$PamCallLong=infoTableFinal$Subtype_extendedList[match(Pall$X, infoTableFinal$SampleID)]
Pall$PamCallshort=infoTableFinal$Subtype_compressedList[match(Pall$X, infoTableFinal$SampleID)]


```

Plot all samples together and compare the confidence and scores in different subtypes:
There is overlap between the LumB and Her2 scores, similarly Normal and LumA scores are similar

```{r}
t2=data.matrix(Pall[ ,2:6])
rownames(t2)=Pall$X
heatmap.2(t2, col=RdBu[11:1], trace="none")
```

We can pull out the main markers of interest: ER, PGR, Erbb2 and Ki67 (or PCNA). 
We also compare these expression distribution of these markers to CD45, DN and Ep overall:

Notes:

* Pgr highest in luminal samples
* Esr1 dynamic range is lower
* Ar is higher in basal samples
* Pcna is higher in Basal

```{r}
midx=match(ExpressedaprilChar$X, colnames(allTPMFinal))
midx3=match(Pall$X[grep("DN",Pall$X)], colnames(allTPMFinal))
midx2=match(ExpressedaprilProg2$X, colnames(allTPMFinal))

summ1=table(ExpressedaprilChar$Call)
summ2=table(ExpressedaprilProg2$Call)
summ3=table(Pall$Call[grep("DN",Pall$X)])

gList=c("Esr1", "Pgr", "Erbb2", "Ar", "Pcna", "Mki67")

par(mfrow=c(2,3))

for (i in gList){
boxplot(allTPMFinal[i, midx ]~ExpressedaprilChar$Call, main="Char",  names=paste(names(summ1)," N=",summ1, sep=""), las=2, ylab=i, xlab="")
boxplot(allTPMFinal[i, midx2 ]~ExpressedaprilProg2$Call, main="Prog", names=paste(names(summ2)," N=",summ2, sep=""), las=2,ylab=i, xlab="")
boxplot(allTPMFinal[i, midx3 ]~Pall$Call[grep("DN",Pall$X)], main="DN",  names=paste(names(summ3)," N=",summ3, sep=""), ylab=i, las=2, xlab="")
}

summ4=table(infoTableFinal$Fraction)

for (i in gList){
boxplot(allTPMFinal[i, ]~infoTableFinal$Fraction, main=i,  names=paste(names(summ4)," N=",summ4, sep=""), las=2, ylab=i, xlab="")
}

```

heatmap based on the previous markers:

```{r}
Ax1=assay(vsd)[ match(Markers, rownames(assay(vsd))),na.omit(midx)]
Ax1b=allRSEMnorm2log[na.omit(match(toupper(Markers), rownames(allRSEMnorm2log))), na.omit(midx)]

Ax2=assay(vsd)[ match(Markers, rownames(assay(vsd))),na.omit(midx2)]
Ax2b=allRSEMnorm2log[na.omit(match(toupper(Markers), rownames(allRSEMnorm2log))), na.omit(midx2)]

Ax3=assay(vsd)[match(Markers, rownames(assay(vsd))),na.omit(midx3)]
Ax3b=allRSEMnorm2log[na.omit(match(toupper(Markers), rownames(allRSEMnorm2log))), na.omit(midx3)]

BLcall=as.character(Pall$Call)
BLcall[grep("Lum", BLcall)]="blue"
BLcall[grep("Her2", BLcall)]="magenta"
BLcall[grep("Normal", BLcall)]="green"
BLcall[grep("Basal", BLcall)]="red"

heatmap.2(Ax1, col=brewer.pal(11, "RdBu")[11:1], ColSideColors = BLcall[which(Pall$X%in%colnames(Ax1)) ],scale="row", main="vsd marker list1", trace="none")
heatmap.2(Ax1b, col=brewer.pal(11, "RdBu")[11:1], ColSideColors = BLcall[which(Pall$X%in%colnames(Ax1)) ], trace="none", scale="row", main="RSEM marker1")

heatmap.2(Ax2, col=brewer.pal(11, "RdBu")[11:1], ColSideColors =BLcall[which(Pall$X%in%colnames(Ax2))], scale="row", main="vsd marker list2", trace="none")
heatmap.2(Ax2b, col=brewer.pal(11, "RdBu")[11:1], ColSideColors = BLcall[which(Pall$X%in%colnames(Ax2))], trace="none", scale="row", main="RSEM marker2")

heatmap.2(Ax3, col=brewer.pal(11, "RdBu")[11:1], ColSideColors = BLcall[which(Pall$X%in%colnames(Ax3))], scale="row", main="vsd marker list3", trace="none")
heatmap.2(Ax3b, col=brewer.pal(11, "RdBu")[11:1], ColSideColors = BLcall[which(Pall$X%in%colnames(Ax3))], trace="none", scale="row", main="RSEM marker3")

```

Based on the above calls, we can condense the calls:

* Her2, LumB are sumilar and can be combined with LumA
* Normal and Basal are most likely most similar

```{r}
Pall$Call2=Pall$Call
Pall$Call2[which(Pall$Call2=="Her2")]="LumB"

Pall$Call3="Basal"
Pall$Call3[grep("Lum", Pall$Call2)]="Lum"

BLcall=ifelse(Pall$Call3=="Basal", "blue", "red")

midx4=match(Pall$X, colnames(allTPMFinal))
Ax4=assay(vsd)[match(Markers, rownames(assay(vsd))),na.omit(midx4)]
Ax4b=allRSEMnorm2log[na.omit(match(toupper(Markers), rownames(allRSEMnorm2log))), na.omit(midx4)]

heatmap.2(Ax4, col=brewer.pal(11, "RdBu")[11:1], ColSideColors = BLcall, scale="row", main="vsd marker list3", trace="none")
heatmap.2(Ax4b, col=brewer.pal(11, "RdBu")[11:1], ColSideColors = BLcall, trace="none", scale="row", main="RSEM marker3")

```


## Clustering based on random genes

In this section we randomly select the most variable 50, 100, 200, 500 genes: we use both the standard deviation and coefficient of variation (sd normalised by the mean) to select these most variable genes.

Below is a correlation plot which visualises the concordance between the different methods.

```{r}
ProgCoh=assay(vsd)[ ,which(infoTableFinal$Fraction=="Ep" & infoTableFinal$Cohort=="Progression")]
CharCoh=assay(vsd)[ ,which(infoTableFinal$Fraction=="Ep" & infoTableFinal$Cohort=="Characterisation")]

GeneVar1=sapply(1:nrow(ProgCoh), function(x) sd(ProgCoh[x, ]))
GeneVar2=sapply(1:nrow(ProgCoh), function(x) sd(ProgCoh[x, ])/mean(ProgCoh[x, ]))
names(GeneVar2)=rownames(ProgCoh)
names(GeneVar1)=rownames(ProgCoh)
OrdGene1=sort(GeneVar1, decreasing = T)
OrdGene2=sort(GeneVar2, decreasing = T)

xsearch=c(50, 100, 200, 500)

CallsTableProg=matrix(NA, ncol=ncol(ProgCoh), nrow=11)
colnames(CallsTableProg)=colnames(ProgCoh)
CallsTableProg[1, ]=Pall$Call3[match(colnames(CallsTableProg), Pall$X)]
#CallsTableProg[2, ]=Pall$Call2[match(colnames(CallsTableProg), Pall$X)]
CallsTableProg[2, ]=Pall$PamCallLong[match(colnames(CallsTableProg), Pall$X)]
CallsTableProg[3, ]=Pall$PamCallshort[match(colnames(CallsTableProg), Pall$X)]

count=4

par(mfrow=c(2,2))

for (i in xsearch){
 # Int1=venn(list(SD=names(OrdGene1)[1:i], CoV=names(OrdGene2)[1:i]))
  ax1=pam(t(ProgCoh[names(OrdGene1)[1:i],  ]), 2)
  bx1=pam(t(ProgCoh[names(OrdGene2)[1:i],  ]), 2)
  CallsTableProg[count, ]=ax1$clustering
  CallsTableProg[count+1, ]=bx1$clustering
  count=count+2
}

ConcordanceMat=matrix(NA, nrow=nrow(CallsTableProg), ncol=nrow(CallsTableProg))
for (i in 1:nrow(CallsTableProg)){
  for (j in 1:nrow(CallsTableProg)){
    a1=table(CallsTableProg[i, ], CallsTableProg[j, ])
    ConcordanceMat[i, j]=sum(diag(a1))/sum(a1)
  }
}

colnames(ConcordanceMat)=c("P50", "PamLong","PamShort", paste(rep(c("sd", "cov"), 4), rep(xsearch, each=2), sep="."))
rownames(ConcordanceMat)=colnames(ConcordanceMat)
ConcordanceMat2=ConcordanceMat
ConcordanceMat2[which(ConcordanceMat2<0.5, arr.ind=T)]=1-ConcordanceMat2[which(ConcordanceMat2<0.5, arr.ind=T)]

# Example heatmap
Ax1=assay(vstEp)[ match(Markers, rownames(assay(vstEp))),]

TabOutput=cbind(ifelse(CallsTableProg[4, ]==1, "blue", "red"),ifelse(CallsTableProg[5, ]==1, "blue", "red"))
x1=match(colnames(Ax1), colnames(CallsTableProg))

heatmap.plus(Ax1, col=brewer.pal(11, "RdBu")[11:1], ColSideColors =(TabOutput[ x1,]),scale="row", main="Progression cohort vsd marker list1", trace="none")

```

## Consolidating the different results

Below is a concordance map of the similarity between the different metrics calculated as

$$ \frac{N_{b,b}+N_{l,l}}{N_{total}} $$

where $N_{b,b}$ is the number of cases which are basal in two comparisons and $N_{l,l}$ the number of cases which are luminal in both comparisons.

Note that the values extend from 0.5 to 1, which indicates that any two methods overlap more than just by chance. 

There is good overlap between the in-house specific list characterisation, and some overlap between pam50 calling and in-house short list. 

```{r}
heatmap.2(ConcordanceMat2, col=RdBu[11:1], trace="none",scale="none")

heatmap.2(ConcordanceMat2[1:7, 1:7], col=RdBu[11:1], trace="none",scale="none")
```

Below is a summary of the average expression values of the classes defined by the different methods:

* The targeted lists show differences in esr1, pgr, erbb2, pcna
* Ar has differing directions for the pam classifications
* Random genes selected show differences in pgr, erbb2, Ar and perhaps Mki67

```{r}
par(mfrow=c(2,3))

compv=c("PAM50", "pamlong", "pamshort", "top50cov", "top50sd")

for (j in gList){
for (i in 1:5){
  boxplot(ProgCoh[j, ]~CallsTableProg[i, ], main=compv[i], ylab=j, xlab="")
}}
mtext("ESR1", side=2, outer=T, line=-2)

```

We can summarise the outputs for each sample below

```{r}
CallsTableProg2=CallsTableProg[1:5, ]
rownames(CallsTableProg2)=c("PAM50", "pamlong", "pamshort", "top50cov", "top50sd")

scroll_box(kable(t(CallsTableProg2), format="html"),
         height="300px", width="100%")


```

# Signature analysis

In this section, we use a combination of gene-set enrichment analysis, heatmap visualisation and XX to investigate differences in 

- PAM50 expression
- Major signalling pathways
- MHC expression signatures

## MHC signature analysis

Look if there is an association between MHC class I and class II and checkpoint proteins with growth in the different fractions. The summary appears:

* class I: association with stable in ep samples
* class II: low expression in DN stable sampels
* MHC presentation: higher in stable samples Ep (and also the characterisation cohort in general), may also be the case in DN samples

### MHC-I

```{r}
classI <- c("RT1-A1", "RT1-A2", "RT1-A3", "RT1-Cl", "RT1-M2", "RT1-M3-1", "RT1-M4", "RT1-M5", "RT1-N1", "RT1-N2", "RT1-N3", "RT1-O1", "RT1-S2", "RT1-S3")
classII <- c("RT1-Ba", "RT1-Bb", "RT1-Da", "RT1-Db1", "RT1-Db2", "RT1-DMa", "RT1-DMb", "RT1-DOa", "RT1-DOb", "RT1-Ha")

#pdf(sprintf("rslt/signatureAnalysis/MHC_presentation_%s.pdf", Sys.Date()), height=6, width=7)

MHCclassSumm2=assay(vsd)[na.omit(match(classI, rownames(assay(vsd)))), ]

heatmap.2(MHCclassSumm2[ ,which(infoTableFinal$Fraction=="CD45")], col=RdBu[11:1], trace="none", ColSideColors = palette()[factor(infoTableFinal$Growth[which(infoTableFinal$Fraction=="CD45")])], scale="row", main="CD: MHC class I")

heatmap.2(MHCclassSumm2[ ,which(infoTableFinal$Fraction=="Ep")], col=RdBu[11:1], trace="none", ColSideColors = palette()[factor(infoTableFinal$Growth[which(infoTableFinal$Fraction=="Ep")])], scale="row", main="Ep: MHC class I")

heatmap.2(MHCclassSumm2[ ,which(infoTableFinal$Fraction=="DN")], col=RdBu[11:1], trace="none", ColSideColors = palette()[factor(infoTableFinal$Growth[which(infoTableFinal$Fraction=="DN")])], scale="row", main="DN: MHC class I")
```

### MHC-II

```{r}
MHCclassSumm2=assay(vsd)[na.omit(match(classII, rownames(assay(vsd)))), ]

heatmap.2(MHCclassSumm2[ ,which(infoTableFinal$Fraction=="CD45")], col=RdBu[11:1], trace="none", ColSideColors = palette()[factor(infoTableFinal$Growth[which(infoTableFinal$Fraction=="CD45")])], scale="row", main="CD: MHC class II")

heatmap.2(MHCclassSumm2[ ,which(infoTableFinal$Fraction=="Ep")], col=RdBu[11:1], trace="none", ColSideColors = palette()[factor(infoTableFinal$Growth[which(infoTableFinal$Fraction=="Ep")])], scale="row", main="Ep: MHC class II")

heatmap.2(MHCclassSumm2[ ,which(infoTableFinal$Fraction=="DN")], col=RdBu[11:1], trace="none", ColSideColors = palette()[factor(infoTableFinal$Growth[which(infoTableFinal$Fraction=="DN")])], scale="row", main="DN: MHC class II")
```

### MHC presentation proteins

```{r}
MHCclassSumm2=assay(vsd)[na.omit(match(MHCPres2Rat[-1], rownames(assay(vsd2)))), ]

heatmap.2(MHCclassSumm2[ ,which(infoTableFinal$Fraction=="CD45")], col=RdBu[11:1], trace="none", ColSideColors = palette()[factor(infoTableFinal$Growth[which(infoTableFinal$Fraction=="CD45")])], scale="row", main="CD45: MHC presentation")

heatmap.2(MHCclassSumm2[ ,which(infoTableFinal$Fraction=="Ep")], col=RdBu[11:1], trace="none", ColSideColors = palette()[factor(infoTableFinal$Growth[which(infoTableFinal$Fraction=="Ep")])], scale="row", main="Ep: MHC presentation")

heatmap.2(MHCclassSumm2[ ,which(infoTableFinal$Fraction=="DN")], col=RdBu[11:1], trace="none", ColSideColors = palette()[factor(infoTableFinal$Growth[which(infoTableFinal$Fraction=="DN")])], scale="row", main="DN: MHC presentation")

#dev.off()
```

