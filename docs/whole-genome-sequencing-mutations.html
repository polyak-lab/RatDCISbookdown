<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 21 Whole Genome Sequencing Mutations | NMU-induced rat tumor models for I/O</title>
  <meta name="description" content="This is a summary of the code required in the study: ‘NMU-induced rat tumor models for I/O’" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 21 Whole Genome Sequencing Mutations | NMU-induced rat tumor models for I/O" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://polyak-lab.github.io/RatDCISbookdown/" />
  
  <meta property="og:description" content="This is a summary of the code required in the study: ‘NMU-induced rat tumor models for I/O’" />
  <meta name="github-repo" content="polyak-lab/RatDCISbookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 21 Whole Genome Sequencing Mutations | NMU-induced rat tumor models for I/O" />
  
  <meta name="twitter:description" content="This is a summary of the code required in the study: ‘NMU-induced rat tumor models for I/O’" />
  

<meta name="author" content="Anne Trinh" />


<meta name="date" content="2021-06-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bcr-clonotype-analysis.html"/>
<link rel="next" href="mutations-in-rna.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.17/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<script src="libs/jszip-1.10.20/jszip.min.js"></script>
<link href="libs/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/forceGraph-0.1.0.9/common.css" rel="stylesheet" />
<script src="libs/forceGraph-0.1.0.9/common.js"></script>
<script src="libs/forceGraph-0.1.0.9/jquery.min.js"></script>
<script src="libs/forceGraph-0.1.0.9/settings.js"></script>
<script src="libs/forceGraph-0.1.0.9/sigma.min.js"></script>
<script src="libs/forceGraph-0.1.0.9/plugins.min.js"></script>
<script src="libs/forceGraph-binding-0.99.19/forceGraph.js"></script>
<script type="text/javascript">
  
  // toggle visibility of R source blocks in R Markdown output
function toggle_R() {
  var x = document.getElementsByClassName('r');
  if (x.length == 0) return;
  function toggle_vis(o) {
    var d = o.style.display;
    o.style.display = (d == 'block' || d == '') ? 'none':'block';
  }
  
  for (i = 0; i < x.length; i++) {
    var y = x[i];
    if (y.tagName.toLowerCase() === 'pre') toggle_vis(y);
  }
  
  var elem = document.getElementById("myButton1");
  if (elem.value === "Hide Global") elem.value = "Show Global";
  else elem.value = "Hide Global";
}

document.write('<input onclick="toggle_R();" type="button" value="Hide Global" id="myButton1" style="position: absolute; top: 10%; right: 2%; z-index: 200"></input>')

</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Rat prevention study</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a><ul>
<li class="chapter" data-level="1.1" data-path="prerequisites.html"><a href="prerequisites.html#packages-and-software"><i class="fa fa-check"></i><b>1.1</b> Packages and Software</a></li>
<li class="chapter" data-level="1.2" data-path="prerequisites.html"><a href="prerequisites.html#external-software"><i class="fa fa-check"></i><b>1.2</b> External software</a></li>
<li class="chapter" data-level="1.3" data-path="prerequisites.html"><a href="prerequisites.html#annotations"><i class="fa fa-check"></i><b>1.3</b> Annotations</a><ul>
<li class="chapter" data-level="1.3.1" data-path="prerequisites.html"><a href="prerequisites.html#genomic-properties"><i class="fa fa-check"></i><b>1.3.1</b> Genomic properties</a></li>
<li class="chapter" data-level="1.3.2" data-path="prerequisites.html"><a href="prerequisites.html#gene-name-homologs-between-organisms"><i class="fa fa-check"></i><b>1.3.2</b> Gene name homologs between organisms</a></li>
<li class="chapter" data-level="1.3.3" data-path="prerequisites.html"><a href="prerequisites.html#gene-signatures-and-data-bases"><i class="fa fa-check"></i><b>1.3.3</b> Gene signatures and data-bases</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cohort-characteristics.html"><a href="cohort-characteristics.html"><i class="fa fa-check"></i><b>2</b> Cohort characteristics</a><ul>
<li class="chapter" data-level="2.1" data-path="cohort-characteristics.html"><a href="cohort-characteristics.html#size-information"><i class="fa fa-check"></i><b>2.1</b> Size information</a></li>
<li class="chapter" data-level="2.2" data-path="cohort-characteristics.html"><a href="cohort-characteristics.html#calculating-growth-rates"><i class="fa fa-check"></i><b>2.2</b> Calculating growth rates</a></li>
<li class="chapter" data-level="2.3" data-path="cohort-characteristics.html"><a href="cohort-characteristics.html#km-curves-for-survival"><i class="fa fa-check"></i><b>2.3</b> KM curves for survival</a></li>
<li class="chapter" data-level="2.4" data-path="cohort-characteristics.html"><a href="cohort-characteristics.html#facs-data-dncd45epcam"><i class="fa fa-check"></i><b>2.4</b> FACS data (DN/CD45/EpCAM)</a></li>
<li class="chapter" data-level="2.5" data-path="cohort-characteristics.html"><a href="cohort-characteristics.html#facs-data"><i class="fa fa-check"></i><b>2.5</b> FACS data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cohort-summary-table.html"><a href="cohort-summary-table.html"><i class="fa fa-check"></i><b>3</b> Cohort Summary Table</a><ul>
<li class="chapter" data-level="3.1" data-path="cohort-summary-table.html"><a href="cohort-summary-table.html#total-number-of-samples"><i class="fa fa-check"></i><b>3.1</b> Total number of samples</a></li>
<li class="chapter" data-level="3.2" data-path="cohort-summary-table.html"><a href="cohort-summary-table.html#compare-the-characterisation-vs-progression-cohort"><i class="fa fa-check"></i><b>3.2</b> Compare the characterisation vs progression cohort</a></li>
<li class="chapter" data-level="3.3" data-path="cohort-summary-table.html"><a href="cohort-summary-table.html#summary-of-the-rna-data"><i class="fa fa-check"></i><b>3.3</b> Summary of the RNA data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="whole-slide-imaging.html"><a href="whole-slide-imaging.html"><i class="fa fa-check"></i><b>4</b> Whole-slide imaging</a><ul>
<li class="chapter" data-level="4.1" data-path="whole-slide-imaging.html"><a href="whole-slide-imaging.html#associate-the-frequencies-with-other-data-types"><i class="fa fa-check"></i><b>4.1</b> Associate the frequencies with other data types</a></li>
<li class="chapter" data-level="4.2" data-path="whole-slide-imaging.html"><a href="whole-slide-imaging.html#cellular-composition"><i class="fa fa-check"></i><b>4.2</b> Cellular composition</a></li>
<li class="chapter" data-level="4.3" data-path="whole-slide-imaging.html"><a href="whole-slide-imaging.html#associate-composition-with-other-covariates"><i class="fa fa-check"></i><b>4.3</b> Associate composition with other covariates</a></li>
<li class="chapter" data-level="4.4" data-path="whole-slide-imaging.html"><a href="whole-slide-imaging.html#estimate-tumor-size"><i class="fa fa-check"></i><b>4.4</b> Estimate tumor size</a></li>
<li class="chapter" data-level="4.5" data-path="whole-slide-imaging.html"><a href="whole-slide-imaging.html#correlations-between-different-subpopulations"><i class="fa fa-check"></i><b>4.5</b> Correlations between different subpopulations</a></li>
<li class="chapter" data-level="4.6" data-path="whole-slide-imaging.html"><a href="whole-slide-imaging.html#associations-between-cd8-counts-with-other-clinical-variables"><i class="fa fa-check"></i><b>4.6</b> Associations between CD8 counts with other clinical variables</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spatial-statistics.html"><a href="spatial-statistics.html"><i class="fa fa-check"></i><b>5</b> Spatial statistics</a><ul>
<li class="chapter" data-level="5.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#knn-distances"><i class="fa fa-check"></i><b>5.1</b> knn-Distances:</a><ul>
<li class="chapter" data-level="5.1.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#comparison-to-manual-classification"><i class="fa fa-check"></i><b>5.1.1</b> Comparison to manual classification</a></li>
<li class="chapter" data-level="5.1.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#associations-with-outcome-to-treatment"><i class="fa fa-check"></i><b>5.1.2</b> Associations with outcome to treatment</a></li>
<li class="chapter" data-level="5.1.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#growth"><i class="fa fa-check"></i><b>5.1.3</b> Growth</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#the-interacting-fraction"><i class="fa fa-check"></i><b>5.2</b> The interacting fraction</a><ul>
<li class="chapter" data-level="5.2.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#comparison-to-manual-select-optimal-r"><i class="fa fa-check"></i><b>5.2.1</b> Comparison to manual &amp; select optimal r</a></li>
<li class="chapter" data-level="5.2.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#growth-1"><i class="fa fa-check"></i><b>5.2.2</b> Growth</a></li>
<li class="chapter" data-level="5.2.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#treatment"><i class="fa fa-check"></i><b>5.2.3</b> Treatment</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#m-h-distances"><i class="fa fa-check"></i><b>5.3</b> M-H distances</a><ul>
<li class="chapter" data-level="5.3.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#comparison-to-manual-scoring"><i class="fa fa-check"></i><b>5.3.1</b> Comparison to Manual Scoring</a></li>
<li class="chapter" data-level="5.3.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#growth-2"><i class="fa fa-check"></i><b>5.3.2</b> Growth</a></li>
<li class="chapter" data-level="5.3.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#treatment-1"><i class="fa fa-check"></i><b>5.3.3</b> Treatment</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="spatial-statistics.html"><a href="spatial-statistics.html#comparison-between-metrics"><i class="fa fa-check"></i><b>5.4</b> Comparison between metrics</a></li>
<li class="chapter" data-level="5.5" data-path="spatial-statistics.html"><a href="spatial-statistics.html#distances-to-unclassified-cells"><i class="fa fa-check"></i><b>5.5</b> Distances to “unclassified cells”</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="expression-data.html"><a href="expression-data.html"><i class="fa fa-check"></i><b>6</b> Expression data</a><ul>
<li class="chapter" data-level="6.1" data-path="expression-data.html"><a href="expression-data.html#running-alignment"><i class="fa fa-check"></i><b>6.1</b> Running alignment</a></li>
<li class="chapter" data-level="6.2" data-path="expression-data.html"><a href="expression-data.html#rna-initial-qc"><i class="fa fa-check"></i><b>6.2</b> RNA Initial QC</a></li>
<li class="chapter" data-level="6.3" data-path="expression-data.html"><a href="expression-data.html#normalisation"><i class="fa fa-check"></i><b>6.3</b> Normalisation</a><ul>
<li class="chapter" data-level="6.3.1" data-path="expression-data.html"><a href="expression-data.html#preliminary-visualisation-to-remove-outliers"><i class="fa fa-check"></i><b>6.3.1</b> preliminary visualisation (to remove outliers)</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="expression-data.html"><a href="expression-data.html#processing-files-for-external-software"><i class="fa fa-check"></i><b>6.4</b> Processing files for external software</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rna-data-preliminary-plots.html"><a href="rna-data-preliminary-plots.html"><i class="fa fa-check"></i><b>7</b> RNA data: preliminary plots</a><ul>
<li class="chapter" data-level="7.1" data-path="rna-data-preliminary-plots.html"><a href="rna-data-preliminary-plots.html#pca-plots"><i class="fa fa-check"></i><b>7.1</b> PCA plots</a></li>
<li class="chapter" data-level="7.2" data-path="rna-data-preliminary-plots.html"><a href="rna-data-preliminary-plots.html#expression-patterns-by-cell-type"><i class="fa fa-check"></i><b>7.2</b> Expression patterns by cell type</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="deseq-analysis-progressionimmunotherapy-cohort.html"><a href="deseq-analysis-progressionimmunotherapy-cohort.html"><i class="fa fa-check"></i><b>8</b> DESeq analysis: Progression/Immunotherapy cohort</a><ul>
<li class="chapter" data-level="8.1" data-path="deseq-analysis-progressionimmunotherapy-cohort.html"><a href="deseq-analysis-progressionimmunotherapy-cohort.html#dn-vs-ep"><i class="fa fa-check"></i><b>8.1</b> DN vs Ep</a></li>
<li class="chapter" data-level="8.2" data-path="deseq-analysis-progressionimmunotherapy-cohort.html"><a href="deseq-analysis-progressionimmunotherapy-cohort.html#no.-samples-in-comparisons"><i class="fa fa-check"></i><b>8.2</b> No. samples in comparisons</a></li>
<li class="chapter" data-level="8.3" data-path="deseq-analysis-progressionimmunotherapy-cohort.html"><a href="deseq-analysis-progressionimmunotherapy-cohort.html#set-up-cell-type-specific-the-comparisons"><i class="fa fa-check"></i><b>8.3</b> Set-up cell-type specific the comparisons</a></li>
<li class="chapter" data-level="8.4" data-path="deseq-analysis-progressionimmunotherapy-cohort.html"><a href="deseq-analysis-progressionimmunotherapy-cohort.html#pca-plots-1"><i class="fa fa-check"></i><b>8.4</b> PCA plots</a><ul>
<li class="chapter" data-level="8.4.1" data-path="deseq-analysis-progressionimmunotherapy-cohort.html"><a href="deseq-analysis-progressionimmunotherapy-cohort.html#epcam"><i class="fa fa-check"></i><b>8.4.1</b> EpCAM</a></li>
<li class="chapter" data-level="8.4.2" data-path="deseq-analysis-progressionimmunotherapy-cohort.html"><a href="deseq-analysis-progressionimmunotherapy-cohort.html#cd45"><i class="fa fa-check"></i><b>8.4.2</b> CD45</a></li>
<li class="chapter" data-level="8.4.3" data-path="deseq-analysis-progressionimmunotherapy-cohort.html"><a href="deseq-analysis-progressionimmunotherapy-cohort.html#dn"><i class="fa fa-check"></i><b>8.4.3</b> DN</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="deseq-analysis-progressionimmunotherapy-cohort.html"><a href="deseq-analysis-progressionimmunotherapy-cohort.html#pearson-correlation-plots-of-samples"><i class="fa fa-check"></i><b>8.5</b> Pearson correlation plots of samples</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="collating-results-and-running-gsea.html"><a href="collating-results-and-running-gsea.html"><i class="fa fa-check"></i><b>9</b> Collating results and running GSEA</a></li>
<li class="chapter" data-level="10" data-path="erpgr-subtyping.html"><a href="erpgr-subtyping.html"><i class="fa fa-check"></i><b>10</b> ER/Pgr Subtyping</a><ul>
<li class="chapter" data-level="10.1" data-path="erpgr-subtyping.html"><a href="erpgr-subtyping.html#gene-list"><i class="fa fa-check"></i><b>10.1</b> Gene List</a></li>
<li class="chapter" data-level="10.2" data-path="erpgr-subtyping.html"><a href="erpgr-subtyping.html#progression-cohort"><i class="fa fa-check"></i><b>10.2</b> Progression cohort</a></li>
<li class="chapter" data-level="10.3" data-path="erpgr-subtyping.html"><a href="erpgr-subtyping.html#charcterisation-cohort"><i class="fa fa-check"></i><b>10.3</b> Charcterisation cohort</a></li>
<li class="chapter" data-level="10.4" data-path="erpgr-subtyping.html"><a href="erpgr-subtyping.html#dn-samples"><i class="fa fa-check"></i><b>10.4</b> DN samples</a></li>
<li class="chapter" data-level="10.5" data-path="erpgr-subtyping.html"><a href="erpgr-subtyping.html#comparison-with-staining"><i class="fa fa-check"></i><b>10.5</b> Comparison with staining</a></li>
<li class="chapter" data-level="10.6" data-path="erpgr-subtyping.html"><a href="erpgr-subtyping.html#summary-of-expression-markers-for-each-subtypecell-fraction"><i class="fa fa-check"></i><b>10.6</b> Summary of expression markers for each subtype/cell fraction</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="expression-in-specific-pathways.html"><a href="expression-in-specific-pathways.html"><i class="fa fa-check"></i><b>11</b> Expression in Specific pathways</a></li>
<li class="chapter" data-level="12" data-path="deseq-analysis-immunotherapygrowth-comparisons.html"><a href="deseq-analysis-immunotherapygrowth-comparisons.html"><i class="fa fa-check"></i><b>12</b> DESeq analysis: Immunotherapy/Growth comparisons</a><ul>
<li class="chapter" data-level="12.1" data-path="deseq-analysis-immunotherapygrowth-comparisons.html"><a href="deseq-analysis-immunotherapygrowth-comparisons.html#summary-of-comparisons"><i class="fa fa-check"></i><b>12.1</b> Summary of comparisons</a></li>
<li class="chapter" data-level="12.2" data-path="deseq-analysis-immunotherapygrowth-comparisons.html"><a href="deseq-analysis-immunotherapygrowth-comparisons.html#deseq-immunotherapy"><i class="fa fa-check"></i><b>12.2</b> DESeq: immunotherapy</a></li>
<li class="chapter" data-level="12.3" data-path="deseq-analysis-immunotherapygrowth-comparisons.html"><a href="deseq-analysis-immunotherapygrowth-comparisons.html#growing-vs-stable-emphasis"><i class="fa fa-check"></i><b>12.3</b> Growing vs stable emphasis</a><ul>
<li class="chapter" data-level="12.3.1" data-path="deseq-analysis-immunotherapygrowth-comparisons.html"><a href="deseq-analysis-immunotherapygrowth-comparisons.html#dn-fraction"><i class="fa fa-check"></i><b>12.3.1</b> DN fraction</a></li>
<li class="chapter" data-level="12.3.2" data-path="deseq-analysis-immunotherapygrowth-comparisons.html"><a href="deseq-analysis-immunotherapygrowth-comparisons.html#cd-fraction"><i class="fa fa-check"></i><b>12.3.2</b> CD fraction</a></li>
<li class="chapter" data-level="12.3.3" data-path="deseq-analysis-immunotherapygrowth-comparisons.html"><a href="deseq-analysis-immunotherapygrowth-comparisons.html#ep-fraction"><i class="fa fa-check"></i><b>12.3.3</b> Ep Fraction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="summary-of-gsea-runs.html"><a href="summary-of-gsea-runs.html"><i class="fa fa-check"></i><b>13</b> Summary of GSEA runs</a><ul>
<li class="chapter" data-level="13.1" data-path="summary-of-gsea-runs.html"><a href="summary-of-gsea-runs.html#stable-vs-growing-all-samples"><i class="fa fa-check"></i><b>13.1</b> Stable vs growing: all samples</a><ul>
<li class="chapter" data-level="13.1.1" data-path="summary-of-gsea-runs.html"><a href="summary-of-gsea-runs.html#barplots-of-enriched-pathways"><i class="fa fa-check"></i><b>13.1.1</b> barplots of enriched pathways</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="summary-of-gsea-runs.html"><a href="summary-of-gsea-runs.html#comparisons-based-on-treatment"><i class="fa fa-check"></i><b>13.2</b> Comparisons based on treatment</a></li>
<li class="chapter" data-level="13.3" data-path="summary-of-gsea-runs.html"><a href="summary-of-gsea-runs.html#pathways-of-interest-2"><i class="fa fa-check"></i><b>13.3</b> Pathways of Interest 2</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="epcam-inflammatory-vs-non-inflammatory-samples.html"><a href="epcam-inflammatory-vs-non-inflammatory-samples.html"><i class="fa fa-check"></i><b>14</b> Epcam+ Inflammatory vs non-inflammatory samples</a><ul>
<li class="chapter" data-level="14.1" data-path="epcam-inflammatory-vs-non-inflammatory-samples.html"><a href="epcam-inflammatory-vs-non-inflammatory-samples.html#identification-of-inflammatory-samples"><i class="fa fa-check"></i><b>14.1</b> Identification of inflammatory samples</a></li>
<li class="chapter" data-level="14.2" data-path="epcam-inflammatory-vs-non-inflammatory-samples.html"><a href="epcam-inflammatory-vs-non-inflammatory-samples.html#deg-inflammatory-vs-non-inflammatory"><i class="fa fa-check"></i><b>14.2</b> DEG: inflammatory vs non-inflammatory</a></li>
<li class="chapter" data-level="14.3" data-path="epcam-inflammatory-vs-non-inflammatory-samples.html"><a href="epcam-inflammatory-vs-non-inflammatory-samples.html#finding-3-signatures-for-3-branches"><i class="fa fa-check"></i><b>14.3</b> Finding 3 signatures for 3 branches</a></li>
<li class="chapter" data-level="14.4" data-path="epcam-inflammatory-vs-non-inflammatory-samples.html"><a href="epcam-inflammatory-vs-non-inflammatory-samples.html#analyse-the-non-inflammatory-samples"><i class="fa fa-check"></i><b>14.4</b> Analyse the non-inflammatory samples</a><ul>
<li class="chapter" data-level="14.4.1" data-path="epcam-inflammatory-vs-non-inflammatory-samples.html"><a href="epcam-inflammatory-vs-non-inflammatory-samples.html#gsea"><i class="fa fa-check"></i><b>14.4.1</b> GSEA</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="epcam-inflammatory-vs-non-inflammatory-samples.html"><a href="epcam-inflammatory-vs-non-inflammatory-samples.html#luminal-only-non-inflammtory-samples-samples"><i class="fa fa-check"></i><b>14.5</b> Luminal-only non-inflammtory samples samples</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html"><i class="fa fa-check"></i><b>15</b> TCGA: Associate Epcam+ inflammatory with survival</a><ul>
<li class="chapter" data-level="15.1" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#associating-cd74-with-phenotype-and-outcome"><i class="fa fa-check"></i><b>15.1</b> Associating CD74 with phenotype and outcome</a></li>
<li class="chapter" data-level="15.2" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#associating-admats10-with-phenotype-and-outcome"><i class="fa fa-check"></i><b>15.2</b> Associating ADMATS10 with phenotype and outcome</a><ul>
<li class="chapter" data-level="15.2.1" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#all-samples"><i class="fa fa-check"></i><b>15.2.1</b> All samples</a></li>
<li class="chapter" data-level="15.2.2" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#redone-using-only-er-cases"><i class="fa fa-check"></i><b>15.2.2</b> Redone using only ER cases</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#signature-lum-cases-non-inflammatory-growing-vs-stable"><i class="fa fa-check"></i><b>15.3</b> Signature: Lum cases non-inflammatory: growing vs stable</a></li>
<li class="chapter" data-level="15.4" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#comparison-to-oncotype-and-mammaprint"><i class="fa fa-check"></i><b>15.4</b> Comparison to oncotype and mammaprint</a><ul>
<li class="chapter" data-level="15.4.1" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#overall-survival"><i class="fa fa-check"></i><b>15.4.1</b> Overall survival</a></li>
<li class="chapter" data-level="15.4.2" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#dfs-survival"><i class="fa fa-check"></i><b>15.4.2</b> DFS survival</a></li>
<li class="chapter" data-level="15.4.3" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#tcga-luma-high-vs-low-signatures"><i class="fa fa-check"></i><b>15.4.3</b> TCGA: LumA high vs low signatures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="read-in-er-io-data.html"><a href="read-in-er-io-data.html"><i class="fa fa-check"></i><b>16</b> Read in ER i/o data</a><ul>
<li class="chapter" data-level="16.1" data-path="read-in-er-io-data.html"><a href="read-in-er-io-data.html#signature-lum-cases-non-inflammatory-growing-vs-stable-1"><i class="fa fa-check"></i><b>16.1</b> Signature: Lum cases non-inflammatory: growing vs stable</a></li>
<li class="chapter" data-level="16.2" data-path="read-in-er-io-data.html"><a href="read-in-er-io-data.html#do-associative-study-with-other-features"><i class="fa fa-check"></i><b>16.2</b> Do associative study with other features?</a></li>
<li class="chapter" data-level="16.3" data-path="read-in-er-io-data.html"><a href="read-in-er-io-data.html#use-raw-counts-and-perform-a-batch-correction-if-necessary"><i class="fa fa-check"></i><b>16.3</b> Use raw counts and perform a batch correction if necessary</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="deseq-analysis-characterisation-cohort-big-vs-small.html"><a href="deseq-analysis-characterisation-cohort-big-vs-small.html"><i class="fa fa-check"></i><b>17</b> DESeq analysis: Characterisation cohort (big vs small)</a><ul>
<li class="chapter" data-level="17.1" data-path="deseq-analysis-characterisation-cohort-big-vs-small.html"><a href="deseq-analysis-characterisation-cohort-big-vs-small.html#cd45-samples-1"><i class="fa fa-check"></i><b>17.1</b> CD45 samples</a><ul>
<li class="chapter" data-level="17.1.1" data-path="deseq-analysis-characterisation-cohort-big-vs-small.html"><a href="deseq-analysis-characterisation-cohort-big-vs-small.html#pca-plot"><i class="fa fa-check"></i><b>17.1.1</b> PCA plot</a></li>
<li class="chapter" data-level="17.1.2" data-path="deseq-analysis-characterisation-cohort-big-vs-small.html"><a href="deseq-analysis-characterisation-cohort-big-vs-small.html#differential-gene-expression"><i class="fa fa-check"></i><b>17.1.2</b> Differential Gene Expression</a></li>
<li class="chapter" data-level="17.1.3" data-path="deseq-analysis-characterisation-cohort-big-vs-small.html"><a href="deseq-analysis-characterisation-cohort-big-vs-small.html#gsea-1"><i class="fa fa-check"></i><b>17.1.3</b> GSEA</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="deseq-analysis-characterisation-cohort-big-vs-small.html"><a href="deseq-analysis-characterisation-cohort-big-vs-small.html#epithelial-samples-1"><i class="fa fa-check"></i><b>17.2</b> Epithelial samples</a><ul>
<li class="chapter" data-level="17.2.1" data-path="deseq-analysis-characterisation-cohort-big-vs-small.html"><a href="deseq-analysis-characterisation-cohort-big-vs-small.html#pca-plot-1"><i class="fa fa-check"></i><b>17.2.1</b> PCA plot</a></li>
<li class="chapter" data-level="17.2.2" data-path="deseq-analysis-characterisation-cohort-big-vs-small.html"><a href="deseq-analysis-characterisation-cohort-big-vs-small.html#gsea-2"><i class="fa fa-check"></i><b>17.2.2</b> GSEA</a></li>
<li class="chapter" data-level="17.2.3" data-path="deseq-analysis-characterisation-cohort-big-vs-small.html"><a href="deseq-analysis-characterisation-cohort-big-vs-small.html#check-expression-of-checkpoint-proteins"><i class="fa fa-check"></i><b>17.2.3</b> Check expression of checkpoint proteins</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="signature-analysis.html"><a href="signature-analysis.html"><i class="fa fa-check"></i><b>18</b> Signature analysis</a><ul>
<li class="chapter" data-level="18.1" data-path="signature-analysis.html"><a href="signature-analysis.html#mhc-signature-analysis"><i class="fa fa-check"></i><b>18.1</b> MHC signature analysis</a><ul>
<li class="chapter" data-level="18.1.1" data-path="signature-analysis.html"><a href="signature-analysis.html#mhc-i"><i class="fa fa-check"></i><b>18.1.1</b> MHC-I</a></li>
<li class="chapter" data-level="18.1.2" data-path="signature-analysis.html"><a href="signature-analysis.html#mhc-ii"><i class="fa fa-check"></i><b>18.1.2</b> MHC-II</a></li>
<li class="chapter" data-level="18.1.3" data-path="signature-analysis.html"><a href="signature-analysis.html#mhc-presentation-proteins"><i class="fa fa-check"></i><b>18.1.3</b> MHC presentation proteins</a></li>
<li class="chapter" data-level="18.1.4" data-path="signature-analysis.html"><a href="signature-analysis.html#inflammation-related-genes-il6-jak-stat-and-tnfnfkb"><i class="fa fa-check"></i><b>18.1.4</b> inflammation related genes: IL6-JAK-STAT and TNF/NFKB</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="immune-estimation.html"><a href="immune-estimation.html"><i class="fa fa-check"></i><b>19</b> Immune estimation</a><ul>
<li class="chapter" data-level="19.1" data-path="immune-estimation.html"><a href="immune-estimation.html#overview-of-the-cell-types"><i class="fa fa-check"></i><b>19.1</b> Overview of the cell types</a></li>
<li class="chapter" data-level="19.2" data-path="immune-estimation.html"><a href="immune-estimation.html#characterisation-cohort-assoc-with-size"><i class="fa fa-check"></i><b>19.2</b> characterisation cohort: assoc with size</a></li>
<li class="chapter" data-level="19.3" data-path="immune-estimation.html"><a href="immune-estimation.html#comparison-with-facs-data"><i class="fa fa-check"></i><b>19.3</b> Comparison with FACS data</a></li>
<li class="chapter" data-level="19.4" data-path="immune-estimation.html"><a href="immune-estimation.html#progression-cohort-1"><i class="fa fa-check"></i><b>19.4</b> Progression cohort</a></li>
<li class="chapter" data-level="19.5" data-path="immune-estimation.html"><a href="immune-estimation.html#clinical-associations"><i class="fa fa-check"></i><b>19.5</b> Clinical associations</a><ul>
<li class="chapter" data-level="19.5.1" data-path="immune-estimation.html"><a href="immune-estimation.html#associate-with-treatment"><i class="fa fa-check"></i><b>19.5.1</b> Associate with Treatment</a></li>
<li class="chapter" data-level="19.5.2" data-path="immune-estimation.html"><a href="immune-estimation.html#association-with-growth"><i class="fa fa-check"></i><b>19.5.2</b> Association with Growth</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="immune-estimation.html"><a href="immune-estimation.html#summary-of-the-outcome"><i class="fa fa-check"></i><b>19.6</b> Summary of the outcome</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="bcr-clonotype-analysis.html"><a href="bcr-clonotype-analysis.html"><i class="fa fa-check"></i><b>20</b> BCR clonotype analysis</a><ul>
<li class="chapter" data-level="20.1" data-path="bcr-clonotype-analysis.html"><a href="bcr-clonotype-analysis.html#processing-summary"><i class="fa fa-check"></i><b>20.1</b> Processing summary</a></li>
<li class="chapter" data-level="20.2" data-path="bcr-clonotype-analysis.html"><a href="bcr-clonotype-analysis.html#summary-stats"><i class="fa fa-check"></i><b>20.2</b> Summary Stats</a></li>
<li class="chapter" data-level="20.3" data-path="bcr-clonotype-analysis.html"><a href="bcr-clonotype-analysis.html#diversity-metrics"><i class="fa fa-check"></i><b>20.3</b> Diversity metrics</a></li>
<li class="chapter" data-level="20.4" data-path="bcr-clonotype-analysis.html"><a href="bcr-clonotype-analysis.html#compare-the-characterisation-cohort"><i class="fa fa-check"></i><b>20.4</b> Compare the characterisation cohort</a></li>
<li class="chapter" data-level="20.5" data-path="bcr-clonotype-analysis.html"><a href="bcr-clonotype-analysis.html#associate-with-clinicopathological-data-progression"><i class="fa fa-check"></i><b>20.5</b> Associate with clinicopathological data (progression)</a></li>
<li class="chapter" data-level="20.6" data-path="bcr-clonotype-analysis.html"><a href="bcr-clonotype-analysis.html#associate-with-signature-scores"><i class="fa fa-check"></i><b>20.6</b> Associate with signature scores</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html"><i class="fa fa-check"></i><b>21</b> Whole Genome Sequencing Mutations</a><ul>
<li class="chapter" data-level="21.1" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#data"><i class="fa fa-check"></i><b>21.1</b> Data</a><ul>
<li class="chapter" data-level="21.1.1" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#extract-mutation-signatures"><i class="fa fa-check"></i><b>21.1.1</b> Extract mutation signatures</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#annotate-the-data-with-human-common-variants"><i class="fa fa-check"></i><b>21.2</b> Annotate the data with human common variants</a></li>
<li class="chapter" data-level="21.3" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#plots"><i class="fa fa-check"></i><b>21.3</b> Plots</a><ul>
<li class="chapter" data-level="21.3.1" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#quick-overview"><i class="fa fa-check"></i><b>21.3.1</b> Quick overview</a></li>
<li class="chapter" data-level="21.3.2" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#coding-variants-tmb"><i class="fa fa-check"></i><b>21.3.2</b> Coding variants &amp; TMB</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#comparison-with-rat-mutational-datasets"><i class="fa fa-check"></i><b>21.4</b> Comparison with rat mutational datasets</a><ul>
<li class="chapter" data-level="21.4.1" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#sites-which-are-commonly-mutated"><i class="fa fa-check"></i><b>21.4.1</b> Sites which are commonly mutated?</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#overview-of-the-mutations"><i class="fa fa-check"></i><b>21.5</b> Overview of the mutations</a><ul>
<li class="chapter" data-level="21.5.1" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#all-mutations"><i class="fa fa-check"></i><b>21.5.1</b> All mutations</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#metacore-analysis-of-commonly-mutated-pathways"><i class="fa fa-check"></i><b>21.6</b> Metacore analysis of commonly mutated pathways</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="mutations-in-rna.html"><a href="mutations-in-rna.html"><i class="fa fa-check"></i><b>22</b> Mutations in RNA</a><ul>
<li class="chapter" data-level="22.1" data-path="mutations-in-rna.html"><a href="mutations-in-rna.html#haplotype-caller"><i class="fa fa-check"></i><b>22.1</b> Haplotype caller</a></li>
<li class="chapter" data-level="22.2" data-path="mutations-in-rna.html"><a href="mutations-in-rna.html#load-files"><i class="fa fa-check"></i><b>22.2</b> Load files</a></li>
<li class="chapter" data-level="22.3" data-path="mutations-in-rna.html"><a href="mutations-in-rna.html#identifying-polymorphisms-compare-frequencies-in-cd45-and-ep-data"><i class="fa fa-check"></i><b>22.3</b> Identifying polymorphisms: compare frequencies in CD45 and Ep data</a></li>
<li class="chapter" data-level="22.4" data-path="mutations-in-rna.html"><a href="mutations-in-rna.html#find-coding-mutations-which-are-specific-to-ep-cells"><i class="fa fa-check"></i><b>22.4</b> Find coding mutations which are specific to ep cells</a></li>
<li class="chapter" data-level="22.5" data-path="mutations-in-rna.html"><a href="mutations-in-rna.html#filtering-wgs-data-based-on-cd45-data"><i class="fa fa-check"></i><b>22.5</b> Filtering WGS data based on CD45 data</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="mutations-in-progression-cohort.html"><a href="mutations-in-progression-cohort.html"><i class="fa fa-check"></i><b>23</b> Mutations in progression cohort</a><ul>
<li class="chapter" data-level="23.1" data-path="mutations-in-progression-cohort.html"><a href="mutations-in-progression-cohort.html#summary-of-common-mutations"><i class="fa fa-check"></i><b>23.1</b> Summary of common mutations:</a></li>
<li class="chapter" data-level="23.2" data-path="mutations-in-progression-cohort.html"><a href="mutations-in-progression-cohort.html#look-at-the-common-mutations-cosmic-ones"><i class="fa fa-check"></i><b>23.2</b> Look at the common mutations (cosmic ones)</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="trichrome-staining.html"><a href="trichrome-staining.html"><i class="fa fa-check"></i><b>24</b> Trichrome staining</a><ul>
<li class="chapter" data-level="24.1" data-path="trichrome-staining.html"><a href="trichrome-staining.html#associations-with-cellular-fraction-wsi"><i class="fa fa-check"></i><b>24.1</b> Associations with cellular fraction (wsi)</a></li>
<li class="chapter" data-level="24.2" data-path="trichrome-staining.html"><a href="trichrome-staining.html#associations-with-cd8-content"><i class="fa fa-check"></i><b>24.2</b> Associations with CD8 content</a></li>
<li class="chapter" data-level="24.3" data-path="trichrome-staining.html"><a href="trichrome-staining.html#associations-with-growth-and-treatment"><i class="fa fa-check"></i><b>24.3</b> Associations with growth and treatment</a></li>
<li class="chapter" data-level="24.4" data-path="trichrome-staining.html"><a href="trichrome-staining.html#association-with-hyperinflammatory-status"><i class="fa fa-check"></i><b>24.4</b> Association with hyperinflammatory status</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="cnv-calling.html"><a href="cnv-calling.html"><i class="fa fa-check"></i><b>25</b> CNV calling</a><ul>
<li class="chapter" data-level="25.1" data-path="cnv-calling.html"><a href="cnv-calling.html#sample-data"><i class="fa fa-check"></i><b>25.1</b> Sample data</a></li>
<li class="chapter" data-level="25.2" data-path="cnv-calling.html"><a href="cnv-calling.html#data-summary"><i class="fa fa-check"></i><b>25.2</b> Data Summary</a><ul>
<li class="chapter" data-level="25.2.1" data-path="cnv-calling.html"><a href="cnv-calling.html#frequency-of-gains-and-losses-across-the-genome"><i class="fa fa-check"></i><b>25.2.1</b> Frequency of gains and losses across the genome</a></li>
<li class="chapter" data-level="25.2.2" data-path="cnv-calling.html"><a href="cnv-calling.html#loci-which-have-a-hit-in-at-least-30-of-samples"><i class="fa fa-check"></i><b>25.2.2</b> Loci which have a hit in at least 30% of samples</a></li>
<li class="chapter" data-level="25.2.3" data-path="cnv-calling.html"><a href="cnv-calling.html#annotated-plot-of-genome-and-locations-of-genes"><i class="fa fa-check"></i><b>25.2.3</b> Annotated plot of genome and locations of genes</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="cnv-calling.html"><a href="cnv-calling.html#samples-with-cnvs-in-breast-related-genes"><i class="fa fa-check"></i><b>25.3</b> Samples with CNVs in breast-related genes</a></li>
<li class="chapter" data-level="25.4" data-path="cnv-calling.html"><a href="cnv-calling.html#summary-of-the-sequencing-depth"><i class="fa fa-check"></i><b>25.4</b> Summary of the sequencing depth</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="writing-files-to-file.html"><a href="writing-files-to-file.html"><i class="fa fa-check"></i><b>26</b> Writing files to file</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="list-of-figures.html"><a href="list-of-figures.html"><i class="fa fa-check"></i><b>A</b> List of Figures</a><ul>
<li class="chapter" data-level="" data-path="list-of-figures.html"><a href="list-of-figures.html#main-figures"><i class="fa fa-check"></i>Main Figures</a></li>
<li class="chapter" data-level="" data-path="list-of-figures.html"><a href="list-of-figures.html#figure-1-nmu-induced-mammary-tumors"><i class="fa fa-check"></i>Figure 1: NMU-induced mammary tumors</a></li>
<li class="chapter" data-level="" data-path="list-of-figures.html"><a href="list-of-figures.html#figure-2-immune-system-of-nmu-rat"><i class="fa fa-check"></i>Figure 2: Immune system of NMU-rat</a></li>
<li class="chapter" data-level="" data-path="list-of-figures.html"><a href="list-of-figures.html#figure-3-immunotherapy-applied-to-nmu-rats"><i class="fa fa-check"></i>Figure 3: Immunotherapy applied to NMU rats</a></li>
<li class="chapter" data-level="" data-path="list-of-figures.html"><a href="list-of-figures.html#figure-4-characterizing-cd45-cells-in-tumors"><i class="fa fa-check"></i>Figure 4: Characterizing CD45 cells in tumors</a></li>
<li class="chapter" data-level="" data-path="list-of-figures.html"><a href="list-of-figures.html#figure-5-epithelial-cells-in-growing-vs-stable-rats"><i class="fa fa-check"></i>Figure 5 : Epithelial cells in growing vs stable rats</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="extended-figures.html"><a href="extended-figures.html"><i class="fa fa-check"></i>Extended Figures</a><ul>
<li class="chapter" data-level="" data-path="extended-figures.html"><a href="extended-figures.html#extended-data-1"><i class="fa fa-check"></i>Extended data 1</a></li>
<li class="chapter" data-level="" data-path="extended-figures.html"><a href="extended-figures.html#extended-data-2"><i class="fa fa-check"></i>Extended data 2</a></li>
<li class="chapter" data-level="" data-path="extended-figures.html"><a href="extended-figures.html#extended-data-3"><i class="fa fa-check"></i>Extended data 3</a></li>
<li class="chapter" data-level="" data-path="extended-figures.html"><a href="extended-figures.html#extended-data-4"><i class="fa fa-check"></i>Extended data 4</a></li>
<li class="chapter" data-level="" data-path="extended-figures.html"><a href="extended-figures.html#extended-data-5"><i class="fa fa-check"></i>Extended data 5</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NMU-induced rat tumor models for I/O</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="whole-genome-sequencing-mutations" class="section level1">
<h1><span class="header-section-number">Chapter 21</span> Whole Genome Sequencing Mutations</h1>
<p>Whole genome sequencing was performed on XX samples by the new york genome centre.
The pipeline involves:</p>
<p><span style="color:red"> Insert information on the NYGC pipeline here </span></p>
<div id="data" class="section level2">
<h2><span class="header-section-number">21.1</span> Data</h2>
<p>In this section, we load the maf output files and create lists which</p>
<ul>
<li>filter out coding mutations</li>
<li>Determine mutational signatures by:
<ul>
<li>Creating bed files with genomic locations of the SNP +- 1 base location</li>
<li>Extracting the nucleotide sequence using bedtools</li>
<li>Convert all mutations to C &gt; N and T &gt; N to obtain 96 mutational signatures</li>
<li>run with single sample SigProfiler to obtain the signature scores</li>
</ul></li>
<li>Annotate data with common human variants</li>
</ul>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="whole-genome-sequencing-mutations.html#cb474-1"></a><span class="co"># Load and save for the first time here</span></span>
<span id="cb474-2"><a href="whole-genome-sequencing-mutations.html#cb474-2"></a><span class="co"># redo</span></span>
<span id="cb474-3"><a href="whole-genome-sequencing-mutations.html#cb474-3"></a></span>
<span id="cb474-4"><a href="whole-genome-sequencing-mutations.html#cb474-4"></a>mafdir=<span class="st">&#39;../data/wholegenome_mutations/maf/&#39;</span></span>
<span id="cb474-5"><a href="whole-genome-sequencing-mutations.html#cb474-5"></a>x1=<span class="kw">dir</span>(mafdir, <span class="st">&#39;annotated.maf&#39;</span>)</span>
<span id="cb474-6"><a href="whole-genome-sequencing-mutations.html#cb474-6"></a><span class="co">#names2=sapply(strsplit( x1,&quot;--&quot;), function(x) x[1])</span></span>
<span id="cb474-7"><a href="whole-genome-sequencing-mutations.html#cb474-7"></a>AllMutWGS=<span class="kw">lapply</span>(x1, <span class="cf">function</span>(x) <span class="kw">read.delim</span>(<span class="kw">paste</span>(mafdir, x, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">skip =</span> <span class="dv">1</span>))</span>
<span id="cb474-8"><a href="whole-genome-sequencing-mutations.html#cb474-8"></a><span class="kw">names</span>(AllMutWGS)=<span class="kw">sapply</span>(<span class="kw">strsplit</span>( x1,<span class="st">&quot;--&quot;</span>), <span class="cf">function</span>(x) x[<span class="dv">1</span>])</span>
<span id="cb474-9"><a href="whole-genome-sequencing-mutations.html#cb474-9"></a><span class="co"># # ## summary of the number of mutations?</span></span>
<span id="cb474-10"><a href="whole-genome-sequencing-mutations.html#cb474-10"></a><span class="kw">print</span>(<span class="st">&#39;no of mutations&#39;</span>)</span>
<span id="cb474-11"><a href="whole-genome-sequencing-mutations.html#cb474-11"></a><span class="co">## [1] &quot;no of mutations&quot;</span></span>
<span id="cb474-12"><a href="whole-genome-sequencing-mutations.html#cb474-12"></a>TotCount=<span class="kw">lapply</span>(AllMutWGS, nrow)</span>
<span id="cb474-13"><a href="whole-genome-sequencing-mutations.html#cb474-13"></a></span>
<span id="cb474-14"><a href="whole-genome-sequencing-mutations.html#cb474-14"></a>SearchVars=<span class="kw">c</span>(<span class="st">&quot;Splice_Site&quot;</span>, <span class="st">&quot;Nonstop_Mutation&quot;</span>, <span class="st">&quot;Nonsense_Mutation&quot;</span>, <span class="st">&quot;Missense_Mutation&quot;</span>, <span class="st">&quot;Frame_Shift_Ins&quot;</span>, <span class="st">&quot;Frame_Shift_Del&quot;</span>)</span>
<span id="cb474-15"><a href="whole-genome-sequencing-mutations.html#cb474-15"></a></span>
<span id="cb474-16"><a href="whole-genome-sequencing-mutations.html#cb474-16"></a>AllMutWGS=<span class="kw">lapply</span>(AllMutWGS, <span class="cf">function</span>(x) {x<span class="op">$</span>VAF&lt;-x<span class="op">$</span>t_alt_count<span class="op">/</span>(x<span class="op">$</span>t_alt_count<span class="op">+</span>x<span class="op">$</span>t_ref_count); x})</span>
<span id="cb474-17"><a href="whole-genome-sequencing-mutations.html#cb474-17"></a></span>
<span id="cb474-18"><a href="whole-genome-sequencing-mutations.html#cb474-18"></a>AllMutWGScoding=<span class="kw">lapply</span>(AllMutWGS, <span class="cf">function</span>(x) x[ x<span class="op">$</span>Variant_Classification<span class="op">%in%</span>SearchVars, ])</span>
<span id="cb474-19"><a href="whole-genome-sequencing-mutations.html#cb474-19"></a>A2=<span class="kw">sapply</span>(AllMutWGScoding, nrow)</span>
<span id="cb474-20"><a href="whole-genome-sequencing-mutations.html#cb474-20"></a></span>
<span id="cb474-21"><a href="whole-genome-sequencing-mutations.html#cb474-21"></a><span class="co"># Save the combined mutation lists</span></span>
<span id="cb474-22"><a href="whole-genome-sequencing-mutations.html#cb474-22"></a><span class="kw">save</span>(AllMutWGS, AllMutWGScoding, <span class="dt">file=</span><span class="kw">sprintf</span>(<span class="st">&quot;outputs/WGS_mutations_coding_%s.RData&quot;</span>, <span class="kw">Sys.Date</span>()))</span>
<span id="cb474-23"><a href="whole-genome-sequencing-mutations.html#cb474-23"></a></span>
<span id="cb474-24"><a href="whole-genome-sequencing-mutations.html#cb474-24"></a><span class="co">## filters on VAF and depth?</span></span>
<span id="cb474-25"><a href="whole-genome-sequencing-mutations.html#cb474-25"></a>AllMutWGScoding=<span class="kw">lapply</span>(AllMutWGScoding, <span class="cf">function</span>(x) {x&lt;-x[<span class="kw">which</span>(x<span class="op">$</span>VAF<span class="op">&gt;=</span><span class="fl">0.1</span> <span class="op">&amp;</span><span class="st"> </span>x<span class="op">$</span>n_ref_count<span class="op">&gt;</span><span class="dv">8</span> <span class="op">&amp;</span></span>
<span id="cb474-26"><a href="whole-genome-sequencing-mutations.html#cb474-26"></a><span class="st">                                                                    </span>(x<span class="op">$</span>t_alt_count<span class="op">+</span>x<span class="op">$</span>t_ref_count)<span class="op">&gt;</span><span class="dv">14</span>), ]; x})</span>
<span id="cb474-27"><a href="whole-genome-sequencing-mutations.html#cb474-27"></a></span>
<span id="cb474-28"><a href="whole-genome-sequencing-mutations.html#cb474-28"></a><span class="co">#load(&#39;data/wholegenome_mutations/WGS_mutations_coding_2020-10-14.RData&#39;)</span></span>
<span id="cb474-29"><a href="whole-genome-sequencing-mutations.html#cb474-29"></a>MeltWGSCoding=<span class="kw">melt</span>(AllMutWGScoding, <span class="dt">measure.vars=</span><span class="kw">c</span>(<span class="st">&quot;Tumor_Sample_Barcode&quot;</span>))</span>
<span id="cb474-30"><a href="whole-genome-sequencing-mutations.html#cb474-30"></a>MeltWGSCoding<span class="op">$</span>Hum_Gene=SymHum2Rat<span class="op">$</span>HGNC.symbol[<span class="kw">match</span>(MeltWGSCoding<span class="op">$</span>Gene_Symbol, SymHum2Rat<span class="op">$</span>RGD.symbol)]</span>
<span id="cb474-31"><a href="whole-genome-sequencing-mutations.html#cb474-31"></a>MeltWGSCoding<span class="op">$</span>Hum_Gene[<span class="kw">which</span>(<span class="kw">is.na</span>(MeltWGSCoding<span class="op">$</span>Hum_Gene))]=<span class="kw">toupper</span>(MeltWGSCoding<span class="op">$</span>Gene_Symbol[<span class="kw">which</span>(<span class="kw">is.na</span>(MeltWGSCoding<span class="op">$</span>Hum_Gene))])</span>
<span id="cb474-32"><a href="whole-genome-sequencing-mutations.html#cb474-32"></a>MutAllCosmic=<span class="kw">lapply</span>(AllMutWGScoding, <span class="cf">function</span>(x) x[<span class="kw">which</span>(x<span class="op">$</span>Gene_Symbol<span class="op">%in%</span>RatCosmic), ])</span>
<span id="cb474-33"><a href="whole-genome-sequencing-mutations.html#cb474-33"></a>MeltCosmic=<span class="kw">melt</span>(MutAllCosmic, <span class="dt">measure.vars=</span><span class="kw">c</span>(<span class="st">&quot;Tumor_Sample_Barcode&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="whole-genome-sequencing-mutations.html#cb475-1"></a><span class="co"># Find complete numbers here, so we don&#39;t have to go back </span></span>
<span id="cb475-2"><a href="whole-genome-sequencing-mutations.html#cb475-2"></a>TotCount=<span class="kw">sapply</span>(AllMutWGS, nrow)</span>
<span id="cb475-3"><a href="whole-genome-sequencing-mutations.html#cb475-3"></a>SearchVars=<span class="kw">c</span>(<span class="st">&quot;Splice_Site&quot;</span>, <span class="st">&quot;Nonstop_Mutation&quot;</span>, <span class="st">&quot;Nonsense_Mutation&quot;</span>, <span class="st">&quot;Missense_Mutation&quot;</span>, <span class="st">&quot;Frame_Shift_Ins&quot;</span>, <span class="st">&quot;Frame_Shift_Del&quot;</span>)</span>
<span id="cb475-4"><a href="whole-genome-sequencing-mutations.html#cb475-4"></a></span>
<span id="cb475-5"><a href="whole-genome-sequencing-mutations.html#cb475-5"></a><span class="kw">head</span>(TotCount)</span>
<span id="cb475-6"><a href="whole-genome-sequencing-mutations.html#cb475-6"></a><span class="co">##  C1R-tumor  C2N-tumor C2R1-tumor C2R2-tumor C2R3-tumor  C4P-tumor </span></span>
<span id="cb475-7"><a href="whole-genome-sequencing-mutations.html#cb475-7"></a><span class="co">##     240153     262425     235677     222717     238324     258677</span></span></code></pre></div>
<div id="extract-mutation-signatures" class="section level3">
<h3><span class="header-section-number">21.1.1</span> Extract mutation signatures</h3>
<p>Annotate the files so that the nucleotide codon can be extracted based on the genome file.
For this, use all mutations (not just coding ones)
See the bash file extract-trinucleotide-forSigProfiler.sh to see the output of this.
The output table $fout3 should have 6 columns with the genomic location, the reference and alt allele and codon context.</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="whole-genome-sequencing-mutations.html#cb476-1"></a>TBed=<span class="kw">lapply</span>(AllMutWGScoding, <span class="cf">function</span>(x) <span class="kw">cbind</span>(<span class="kw">as.character</span>(x<span class="op">$</span>Chromosome), x<span class="op">$</span>Start_Position<span class="dv">-2</span>, x<span class="op">$</span>End_Position<span class="op">+</span><span class="dv">1</span>, <span class="kw">as.character</span>(x<span class="op">$</span>Reference_Allele), <span class="kw">as.character</span>(x<span class="op">$</span>Tumor_Seq_Allele2)))</span>
<span id="cb476-2"><a href="whole-genome-sequencing-mutations.html#cb476-2"></a>TBed=<span class="kw">lapply</span>(TBed, <span class="cf">function</span>(x) x[<span class="kw">which</span>(<span class="kw">nchar</span>(x[ ,<span class="dv">4</span>])<span class="op">==</span><span class="dv">1</span>), ])</span>
<span id="cb476-3"><a href="whole-genome-sequencing-mutations.html#cb476-3"></a><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(TBed), <span class="cf">function</span>(x) <span class="kw">write.table</span>(TBed[[x]], <span class="dt">file=</span><span class="kw">paste</span>(<span class="kw">names</span>(TBed)[x], <span class="st">&quot;coding_tricodon.bed&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>),<span class="dt">col.names=</span>F, <span class="dt">row.names =</span> F, <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">quote =</span> F))</span>
<span id="cb476-4"><a href="whole-genome-sequencing-mutations.html#cb476-4"></a></span>
<span id="cb476-5"><a href="whole-genome-sequencing-mutations.html#cb476-5"></a><span class="co">## bedtools command</span></span>
<span id="cb476-6"><a href="whole-genome-sequencing-mutations.html#cb476-6"></a>bedtools getfasta <span class="op">-</span>fi ..<span class="op">/</span>Genomic_Files<span class="op">/</span>rn6.fa <span class="op">-</span>bed <span class="op">$</span>f <span class="op">-</span>tab <span class="op">-</span>fo <span class="op">$</span>fout</span>
<span id="cb476-7"><a href="whole-genome-sequencing-mutations.html#cb476-7"></a><span class="kw">f3</span>() { awk <span class="st">&#39;{print $1, $2, $3, $4 ,$5}&#39;</span> <span class="st">&quot;$1&quot;</span>; }; paste <span class="op">&lt;</span>(f3 <span class="op">$</span>f) <span class="op">&lt;</span>(f3 <span class="op">$</span>fout) <span class="op">&gt;</span><span class="st"> </span><span class="er">$</span>fout2</span>
<span id="cb476-8"><a href="whole-genome-sequencing-mutations.html#cb476-8"></a>awk <span class="st">&#39;{if (length($7)==3) print $1, $2, $3, $4, $5, toupper($7)}&#39;</span> <span class="op">$</span>fout2 <span class="op">&gt;</span><span class="st"> </span><span class="er">$</span>fout3</span>
<span id="cb476-9"><a href="whole-genome-sequencing-mutations.html#cb476-9"></a><span class="co">## see the bash file extract-trinucleotide-forSigProfiler.sh to see the output of this.</span></span></code></pre></div>
<p>Following running the above bash script, we can run the following extract the tri-nucleotide sequence</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="whole-genome-sequencing-mutations.html#cb477-1"></a>FFiles=<span class="kw">dir</span>(<span class="st">&quot;../data/tricodon_mut_sigs/extract_context/&quot;</span>, <span class="st">&quot;*.txt&quot;</span>,<span class="dt">full.names=</span>T)</span>
<span id="cb477-2"><a href="whole-genome-sequencing-mutations.html#cb477-2"></a>OutputList=<span class="kw">sapply</span>(FFiles, <span class="cf">function</span>(x) <span class="kw">FindTriNucleotideContext</span>(x))</span>
<span id="cb477-3"><a href="whole-genome-sequencing-mutations.html#cb477-3"></a>TableOut=<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(OutputList), <span class="cf">function</span>(x) <span class="kw">unlist</span>(OutputList[<span class="dv">3</span>, x]))</span>
<span id="cb477-4"><a href="whole-genome-sequencing-mutations.html#cb477-4"></a><span class="co">## make a plot here</span></span>
<span id="cb477-5"><a href="whole-genome-sequencing-mutations.html#cb477-5"></a><span class="co"># condense the type of mutations here</span></span>
<span id="cb477-6"><a href="whole-genome-sequencing-mutations.html#cb477-6"></a>a1=<span class="kw">basename</span>(FFiles)</span>
<span id="cb477-7"><a href="whole-genome-sequencing-mutations.html#cb477-7"></a>a2=<span class="kw">sapply</span>(<span class="kw">strsplit</span>(a1, <span class="st">&quot;_&quot;</span>), <span class="cf">function</span>(x) x[<span class="dv">1</span>])</span>
<span id="cb477-8"><a href="whole-genome-sequencing-mutations.html#cb477-8"></a>xall=<span class="kw">as.character</span>(<span class="kw">unlist</span>(OutputList[<span class="dv">1</span>, <span class="dv">1</span>]))</span>
<span id="cb477-9"><a href="whole-genome-sequencing-mutations.html#cb477-9"></a>TestAll=<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(TableOut), <span class="cf">function</span>(x) <span class="kw">unlist</span>(<span class="kw">by</span>(TableOut[ ,x], xall, sum)))</span>
<span id="cb477-10"><a href="whole-genome-sequencing-mutations.html#cb477-10"></a>TestAll2=<span class="kw">t</span>(TestAll)<span class="op">/</span><span class="kw">colSums</span>(TestAll)</span>
<span id="cb477-11"><a href="whole-genome-sequencing-mutations.html#cb477-11"></a><span class="kw">rownames</span>(TestAll2)=<span class="kw">sapply</span>(a2, <span class="cf">function</span>(x) Cdata<span class="op">$</span>NewID[<span class="kw">grep</span>(x,  Cdata<span class="op">$</span>WGS)])</span>
<span id="cb477-12"><a href="whole-genome-sequencing-mutations.html#cb477-12"></a>TestAll2melt=<span class="kw">melt</span>(TestAll2)</span>
<span id="cb477-13"><a href="whole-genome-sequencing-mutations.html#cb477-13"></a></span>
<span id="cb477-14"><a href="whole-genome-sequencing-mutations.html#cb477-14"></a><span class="co">#pdf(&quot;~/Desktop/Frequency_mutations_6types.pdf&quot;, height=5, width=6)</span></span>
<span id="cb477-15"><a href="whole-genome-sequencing-mutations.html#cb477-15"></a><span class="kw">ggplot</span>(TestAll2melt, <span class="kw">aes</span>(<span class="dt">x=</span>Var1, <span class="dt">y=</span>value, <span class="dt">fill=</span>Var2))<span class="op">+</span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="op">+</span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>))<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Frequency of Mutation&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:1j"></span>
<img src="RatDCIS-bookdown_files/figure-html/1j-1.png" alt="Frequency of different mutational codons" width="672" />
<p class="caption">
Figure 21.1: Frequency of different mutational codons
</p>
</div>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="whole-genome-sequencing-mutations.html#cb478-1"></a><span class="co">#dev.off()</span></span>
<span id="cb478-2"><a href="whole-genome-sequencing-mutations.html#cb478-2"></a></span>
<span id="cb478-3"><a href="whole-genome-sequencing-mutations.html#cb478-3"></a></span>
<span id="cb478-4"><a href="whole-genome-sequencing-mutations.html#cb478-4"></a><span class="kw">write.csv</span>(TestAll2melt, <span class="dt">file=</span><span class="st">&quot;nature-tables/1j.csv&quot;</span>)</span>
<span id="cb478-5"><a href="whole-genome-sequencing-mutations.html#cb478-5"></a></span>
<span id="cb478-6"><a href="whole-genome-sequencing-mutations.html#cb478-6"></a>TableOut=<span class="kw">cbind</span>(<span class="kw">as.character</span>(<span class="kw">unlist</span>(OutputList[<span class="dv">1</span>, <span class="dv">1</span>])), <span class="kw">as.character</span>(<span class="kw">unlist</span>(OutputList[<span class="dv">2</span>, <span class="dv">1</span>])), TableOut)</span>
<span id="cb478-7"><a href="whole-genome-sequencing-mutations.html#cb478-7"></a><span class="kw">colnames</span>(TableOut)=<span class="kw">c</span>(<span class="st">&quot;MutationType&quot;</span>,<span class="st">&quot;Nutrinucleotide&quot;</span>, <span class="kw">paste</span>(<span class="st">&quot;BRCA&quot;</span>, a2, <span class="dt">sep=</span><span class="st">&quot;::&quot;</span>))</span>
<span id="cb478-8"><a href="whole-genome-sequencing-mutations.html#cb478-8"></a><span class="co">#write.csv(TableOut, file=&quot;../data/tricodon_mut_sigs/output4SigProfiler-jan2021.csv&quot;, sep = &quot;,&quot;, row.names = F)</span></span></code></pre></div>
<p>This is then run in python (sigprofiler) with the following code:</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="whole-genome-sequencing-mutations.html#cb479-1"></a>module load gcc</span>
<span id="cb479-2"><a href="whole-genome-sequencing-mutations.html#cb479-2"></a>module load python<span class="op">/</span><span class="dv">3</span>.<span class="fl">7.4</span></span>
<span id="cb479-3"><a href="whole-genome-sequencing-mutations.html#cb479-3"></a>python3</span>
<span id="cb479-4"><a href="whole-genome-sequencing-mutations.html#cb479-4"></a>import SigProfilerExtractor</span>
<span id="cb479-5"><a href="whole-genome-sequencing-mutations.html#cb479-5"></a>from sigproSS import spss_pcwag <span class="co">## (spss uses only vcf files)</span></span>
<span id="cb479-6"><a href="whole-genome-sequencing-mutations.html#cb479-6"></a><span class="kw">spss_pcwag.single_sample_pcwag</span>(<span class="st">&quot;output4SigProfiler-jan2021.csv&quot;</span>, <span class="dt">output=</span><span class="st">&quot;output-jan2021&quot;</span>)</span></code></pre></div>
<p>The results from this analysis are shown below</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="whole-genome-sequencing-mutations.html#cb480-1"></a>SBSprof=<span class="kw">read.delim</span>(<span class="st">&quot;../data/tricodon_mut_sigs/output-jan2021-allsamples/sig_activities.txt&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</span>
<span id="cb480-2"><a href="whole-genome-sequencing-mutations.html#cb480-2"></a>SBSprofb=SBSprof[ ,<span class="op">-</span><span class="dv">1</span>]<span class="op">/</span><span class="kw">rowSums</span>(SBSprof[ ,<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb480-3"><a href="whole-genome-sequencing-mutations.html#cb480-3"></a>SBSprofb=SBSprofb[ ,<span class="op">-</span><span class="kw">which</span>(<span class="kw">colSums</span>(SBSprofb)<span class="op">==</span><span class="dv">0</span>)]</span>
<span id="cb480-4"><a href="whole-genome-sequencing-mutations.html#cb480-4"></a><span class="kw">rownames</span>(SBSprofb)=SBSprof[ ,<span class="dv">1</span>]</span>
<span id="cb480-5"><a href="whole-genome-sequencing-mutations.html#cb480-5"></a></span>
<span id="cb480-6"><a href="whole-genome-sequencing-mutations.html#cb480-6"></a>SBSmelt=<span class="kw">melt</span>(<span class="kw">cbind</span>(SBSprofb[ , <span class="dv">-1</span>], <span class="dt">id=</span><span class="kw">rownames</span>(SBSprofb)))</span>
<span id="cb480-7"><a href="whole-genome-sequencing-mutations.html#cb480-7"></a>SBSsummary &lt;-<span class="st"> </span><span class="kw">aggregate</span>(. <span class="op">~</span><span class="st"> </span>variable, mean, <span class="dt">data=</span>SBSmelt)</span>
<span id="cb480-8"><a href="whole-genome-sequencing-mutations.html#cb480-8"></a></span>
<span id="cb480-9"><a href="whole-genome-sequencing-mutations.html#cb480-9"></a><span class="kw">ggplot</span>(SBSmelt, <span class="kw">aes</span>(<span class="dt">x=</span>variable, <span class="dt">y=</span>value, <span class="dt">col=</span>variable))<span class="op">+</span><span class="kw">geom_jitter</span>()<span class="op">+</span><span class="kw">geom_crossbar</span>(<span class="dt">data=</span>SBSsummary , <span class="kw">aes</span>(<span class="dt">ymin =</span> value, <span class="dt">ymax =</span> value),<span class="dt">size=</span><span class="fl">0.5</span>,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">width =</span> <span class="fl">.7</span>)<span class="op">+</span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Percentage of mutations&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:Ext1j"></span>
<img src="RatDCIS-bookdown_files/figure-html/Ext1j-1.png" alt="Alexandrov mutational signatures" width="672" />
<p class="caption">
Figure 21.2: Alexandrov mutational signatures
</p>
</div>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="whole-genome-sequencing-mutations.html#cb481-1"></a></span>
<span id="cb481-2"><a href="whole-genome-sequencing-mutations.html#cb481-2"></a><span class="kw">write.csv</span>(SBSmelt, <span class="dt">file=</span><span class="st">&quot;nature-tables/Ext1j.csv&quot;</span>)</span></code></pre></div>
<p>We can see whether any of these associate with tumor size for example:</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="whole-genome-sequencing-mutations.html#cb482-1"></a><span class="co">## Assign with growth data or tumor size?</span></span>
<span id="cb482-2"><a href="whole-genome-sequencing-mutations.html#cb482-2"></a>tname=<span class="kw">substr</span>(SBSprof<span class="op">$</span>Cancer.Types, <span class="dv">7</span>, <span class="dv">20</span>)</span>
<span id="cb482-3"><a href="whole-genome-sequencing-mutations.html#cb482-3"></a>idx=<span class="kw">sapply</span>(tname, <span class="cf">function</span>(x) <span class="kw">grep</span>(x, Cdata<span class="op">$</span>WGS))</span>
<span id="cb482-4"><a href="whole-genome-sequencing-mutations.html#cb482-4"></a>sizeInfo=Cdata<span class="op">$</span>Tumor.diameter.sac.mm[idx]</span>
<span id="cb482-5"><a href="whole-genome-sequencing-mutations.html#cb482-5"></a></span>
<span id="cb482-6"><a href="whole-genome-sequencing-mutations.html#cb482-6"></a><span class="co">#par(mfrow=c(2,1))</span></span>
<span id="cb482-7"><a href="whole-genome-sequencing-mutations.html#cb482-7"></a>cor1=<span class="kw">cor.test</span>(SBSprofb<span class="op">$</span>SBS32<span class="op">+</span>SBSprofb<span class="op">$</span>SBS11, sizeInfo, <span class="dt">use=</span><span class="st">&quot;complete&quot;</span>)</span>
<span id="cb482-8"><a href="whole-genome-sequencing-mutations.html#cb482-8"></a>cor2=<span class="kw">cor.test</span>(SBSprofb<span class="op">$</span>SBS32[<span class="kw">which</span>(SBSprofb<span class="op">$</span>SBS32<span class="op">&gt;</span><span class="dv">0</span>)], sizeInfo[<span class="kw">which</span>(SBSprofb<span class="op">$</span>SBS32<span class="op">&gt;</span><span class="dv">0</span>)], <span class="dt">use=</span><span class="st">&quot;complete&quot;</span>)</span>
<span id="cb482-9"><a href="whole-genome-sequencing-mutations.html#cb482-9"></a>cor3=<span class="kw">cor.test</span>(SBSprofb<span class="op">$</span>SBS11[<span class="kw">which</span>(SBSprofb<span class="op">$</span>SBS11<span class="op">&gt;</span><span class="dv">0</span>)], sizeInfo[<span class="kw">which</span>(SBSprofb<span class="op">$</span>SBS11<span class="op">&gt;</span><span class="dv">0</span>)], <span class="dt">use=</span><span class="st">&quot;complete&quot;</span>)</span>
<span id="cb482-10"><a href="whole-genome-sequencing-mutations.html#cb482-10"></a><span class="kw">plot</span>(SBSprofb<span class="op">$</span>SBS32<span class="op">+</span>SBSprofb<span class="op">$</span>SBS11, sizeInfo, <span class="dt">xlab=</span><span class="st">&quot;SBS 32 or 11 score&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;tumor size&quot;</span>,</span>
<span id="cb482-11"><a href="whole-genome-sequencing-mutations.html#cb482-11"></a>     <span class="dt">col=</span><span class="kw">ifelse</span>(SBSprofb<span class="op">$</span>SBS11<span class="op">==</span><span class="dv">0</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">main=</span><span class="kw">sprintf</span>(<span class="st">&quot;association between signature score and size, p=%s&quot;</span>, <span class="kw">round</span>(cor1<span class="op">$</span>p.value, <span class="dv">2</span>)))</span>
<span id="cb482-12"><a href="whole-genome-sequencing-mutations.html#cb482-12"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="kw">c</span>(<span class="kw">paste</span>(<span class="st">&quot;SB32&quot;</span>, <span class="kw">round</span>(cor2<span class="op">$</span>p.value,<span class="dv">2</span>)), <span class="kw">paste</span>(<span class="st">&quot;SB11&quot;</span>,<span class="kw">round</span>(cor3<span class="op">$</span>p.value,<span class="dv">2</span>))), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">pch=</span><span class="dv">19</span>)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-139-1.png" width="672" /></p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="whole-genome-sequencing-mutations.html#cb483-1"></a></span>
<span id="cb483-2"><a href="whole-genome-sequencing-mutations.html#cb483-2"></a><span class="co">## Associations version 2</span></span>
<span id="cb483-3"><a href="whole-genome-sequencing-mutations.html#cb483-3"></a>SBSprofb<span class="op">$</span>Age=Cdata<span class="op">$</span>Time.NMU2Sac.days[<span class="kw">sapply</span>(<span class="kw">substr</span>(<span class="kw">rownames</span>(SBSprofb), <span class="dv">7</span>, <span class="dv">30</span>), <span class="cf">function</span>(x) <span class="kw">grep</span>(x, Cdata<span class="op">$</span>WGS))]</span>
<span id="cb483-4"><a href="whole-genome-sequencing-mutations.html#cb483-4"></a>SBSprofb<span class="op">$</span>Cohort=Cdata<span class="op">$</span>Char.Cohort.Batch[<span class="kw">sapply</span>(<span class="kw">substr</span>(<span class="kw">rownames</span>(SBSprofb), <span class="dv">7</span>, <span class="dv">30</span>), <span class="cf">function</span>(x) <span class="kw">grep</span>(x, Cdata<span class="op">$</span>WGS))]</span>
<span id="cb483-5"><a href="whole-genome-sequencing-mutations.html#cb483-5"></a></span>
<span id="cb483-6"><a href="whole-genome-sequencing-mutations.html#cb483-6"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb483-7"><a href="whole-genome-sequencing-mutations.html#cb483-7"></a><span class="kw">plot</span>(SBSprofb<span class="op">$</span>Age,SBSprofb<span class="op">$</span>SBS1,  <span class="dt">ylab=</span><span class="st">&quot;Frequency Mut in SBS1&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Time NMU2Sac&quot;</span>, <span class="dt">main=</span><span class="st">&quot;SBS1&quot;</span>, <span class="dt">col=</span><span class="kw">factor</span>(SBSprofb<span class="op">$</span>Cohort))</span>
<span id="cb483-8"><a href="whole-genome-sequencing-mutations.html#cb483-8"></a><span class="kw">plot</span>( SBSprofb<span class="op">$</span>Age, SBSprofb<span class="op">$</span>SBS5, <span class="dt">ylab=</span><span class="st">&quot;Frequency Mut in SBS5&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Time NMU2Sac&quot;</span>, <span class="dt">main=</span><span class="st">&quot;SBS5&quot;</span>, <span class="dt">col=</span><span class="kw">factor</span>(SBSprofb<span class="op">$</span>Cohort))</span>
<span id="cb483-9"><a href="whole-genome-sequencing-mutations.html#cb483-9"></a><span class="kw">plot</span>(SBSprofb<span class="op">$</span>Age, SBSprofb<span class="op">$</span>SBS32<span class="op">+</span>SBSprofb<span class="op">$</span>SBS11, <span class="dt">ylab=</span><span class="st">&quot;SBS 32 or 11 score&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;tumor size&quot;</span>,</span>
<span id="cb483-10"><a href="whole-genome-sequencing-mutations.html#cb483-10"></a>     <span class="dt">col=</span><span class="kw">ifelse</span>(SBSprofb<span class="op">$</span>SBS11<span class="op">==</span><span class="dv">0</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">main=</span><span class="st">&quot;SBS11/32&quot;</span>)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-139-2.png" width="672" /></p>
</div>
</div>
<div id="annotate-the-data-with-human-common-variants" class="section level2">
<h2><span class="header-section-number">21.2</span> Annotate the data with human common variants</h2>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="whole-genome-sequencing-mutations.html#cb484-1"></a><span class="co">## The following is run independently and saved to fle</span></span>
<span id="cb484-2"><a href="whole-genome-sequencing-mutations.html#cb484-2"></a><span class="co">## issues with the RnvorV87 pointer when cached</span></span>
<span id="cb484-3"><a href="whole-genome-sequencing-mutations.html#cb484-3"></a><span class="co"># remove sourcing CreateRnor87</span></span>
<span id="cb484-4"><a href="whole-genome-sequencing-mutations.html#cb484-4"></a><span class="co">## Append to MeltCosmic?</span></span>
<span id="cb484-5"><a href="whole-genome-sequencing-mutations.html#cb484-5"></a><span class="kw">source</span>(<span class="st">&quot;../rscript/CreateRnor87db.R&quot;</span>)</span>
<span id="cb484-6"><a href="whole-genome-sequencing-mutations.html#cb484-6"></a>AAout=<span class="kw">strsplit</span>(<span class="kw">as.character</span>(MeltCosmic<span class="op">$</span>HGVSp_Short), <span class="st">&quot;[0-9]+&quot;</span>)</span>
<span id="cb484-7"><a href="whole-genome-sequencing-mutations.html#cb484-7"></a>AAwt=<span class="kw">sapply</span>(AAout, <span class="cf">function</span>(x) x[<span class="dv">1</span>])</span>
<span id="cb484-8"><a href="whole-genome-sequencing-mutations.html#cb484-8"></a>AAmt=<span class="kw">sapply</span>(AAout, <span class="cf">function</span>(x) x[<span class="dv">2</span>])</span>
<span id="cb484-9"><a href="whole-genome-sequencing-mutations.html#cb484-9"></a>AAno=<span class="kw">regmatches</span>(MeltCosmic<span class="op">$</span>HGVSp_Short, <span class="kw">gregexpr</span>(<span class="st">&quot;[[:digit:]]+&quot;</span>, MeltCosmic<span class="op">$</span>HGVSp_Short))</span>
<span id="cb484-10"><a href="whole-genome-sequencing-mutations.html#cb484-10"></a></span>
<span id="cb484-11"><a href="whole-genome-sequencing-mutations.html#cb484-11"></a>MeltCosmic<span class="op">$</span>AAno=<span class="ot">NA</span></span>
<span id="cb484-12"><a href="whole-genome-sequencing-mutations.html#cb484-12"></a>MeltCosmic<span class="op">$</span>AAno[<span class="kw">which</span>(<span class="kw">sapply</span>(AAno, length)<span class="op">==</span><span class="dv">1</span>)]=<span class="kw">as.numeric</span>(<span class="kw">as.character</span>(<span class="kw">unlist</span>(AAno)))</span>
<span id="cb484-13"><a href="whole-genome-sequencing-mutations.html#cb484-13"></a>FindVarTest=<span class="kw">FindHumanAAHomolog</span>(MeltCosmic<span class="op">$</span>Gene_Symbol, AAwt, MeltCosmic<span class="op">$</span>AAno, AAmt)</span>
<span id="cb484-14"><a href="whole-genome-sequencing-mutations.html#cb484-14"></a>MeltCosmic=<span class="kw">cbind</span>(MeltCosmic, FindVarTest)</span>
<span id="cb484-15"><a href="whole-genome-sequencing-mutations.html#cb484-15"></a></span>
<span id="cb484-16"><a href="whole-genome-sequencing-mutations.html#cb484-16"></a><span class="kw">dim</span>(MeltCosmic)</span>
<span id="cb484-17"><a href="whole-genome-sequencing-mutations.html#cb484-17"></a></span>
<span id="cb484-18"><a href="whole-genome-sequencing-mutations.html#cb484-18"></a><span class="kw">save</span>(MeltCosmic, <span class="dt">file=</span><span class="kw">sprintf</span>(<span class="st">&quot;outputs/MeltCosmic_coding_genes_WGS_rat_VAFncount%s.RData&quot;</span>, <span class="kw">Sys.Date</span>())) <span class="co">#, sep=&quot;\t&quot;, row.names=F)</span></span>
<span id="cb484-19"><a href="whole-genome-sequencing-mutations.html#cb484-19"></a><span class="kw">write.csv</span>(MeltCosmic, <span class="dt">file=</span><span class="st">&quot;nature-tables/SupplementalTable4_AllRatMutations_annotated_w_human_homolog_VAFncount.csv&quot;</span>, <span class="dt">row.names =</span> F, <span class="dt">quote=</span>F)</span></code></pre></div>
<p>From this analysis, below are the genes with mutations in known human hotpot mutations in common genes</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="whole-genome-sequencing-mutations.html#cb485-1"></a></span>
<span id="cb485-2"><a href="whole-genome-sequencing-mutations.html#cb485-2"></a><span class="kw">load</span>(<span class="st">&quot;outputs/MeltCosmic_coding_genes_WGS_rat_VAFncount2021-01-11.RData&quot;</span>)</span>
<span id="cb485-3"><a href="whole-genome-sequencing-mutations.html#cb485-3"></a></span>
<span id="cb485-4"><a href="whole-genome-sequencing-mutations.html#cb485-4"></a>Xa=<span class="kw">which</span>(MeltCosmic<span class="op">$</span>Gene_Symbol <span class="op">%in%</span><span class="st"> </span>BList<span class="op">$</span>RatGene)</span>
<span id="cb485-5"><a href="whole-genome-sequencing-mutations.html#cb485-5"></a>Xb=<span class="kw">match</span>(<span class="kw">paste</span>(MeltCosmic<span class="op">$</span>Gene_Symbol, MeltCosmic<span class="op">$</span>AAno), <span class="kw">paste</span>(BList<span class="op">$</span>RatGene,BList<span class="op">$</span>RatAAno))</span>
<span id="cb485-6"><a href="whole-genome-sequencing-mutations.html#cb485-6"></a>Xc=<span class="kw">match</span>(<span class="kw">paste</span>(MeltCosmic<span class="op">$</span>Gene_Symbol, MeltCosmic<span class="op">$</span>AAno), <span class="kw">paste</span>(ChangList2<span class="op">$</span>RatGene, ChangList2<span class="op">$</span>RatAAno))</span>
<span id="cb485-7"><a href="whole-genome-sequencing-mutations.html#cb485-7"></a>x2=<span class="kw">c</span>(<span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(Xb)), <span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(Xc)))</span>
<span id="cb485-8"><a href="whole-genome-sequencing-mutations.html#cb485-8"></a></span>
<span id="cb485-9"><a href="whole-genome-sequencing-mutations.html#cb485-9"></a>BList[(<span class="kw">na.omit</span>(Xb)), ]</span>
<span id="cb485-10"><a href="whole-genome-sequencing-mutations.html#cb485-10"></a><span class="co">##       Gene AAno AA1 Variant RatGene    Sequence         HumProt</span></span>
<span id="cb485-11"><a href="whole-genome-sequencing-mutations.html#cb485-11"></a><span class="co">## 128   HRAS   12   G       R    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb485-12"><a href="whole-genome-sequencing-mutations.html#cb485-12"></a><span class="co">## 128.1 HRAS   12   G       R    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb485-13"><a href="whole-genome-sequencing-mutations.html#cb485-13"></a><span class="co">## 128.2 HRAS   12   G       R    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb485-14"><a href="whole-genome-sequencing-mutations.html#cb485-14"></a><span class="co">## 128.3 HRAS   12   G       R    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb485-15"><a href="whole-genome-sequencing-mutations.html#cb485-15"></a><span class="co">## 128.4 HRAS   12   G       R    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb485-16"><a href="whole-genome-sequencing-mutations.html#cb485-16"></a><span class="co">## 128.5 HRAS   12   G       R    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb485-17"><a href="whole-genome-sequencing-mutations.html#cb485-17"></a><span class="co">## 8     BRAF  466   G       E    Braf QRIGSGSFGTV ENSP00000288602</span></span>
<span id="cb485-18"><a href="whole-genome-sequencing-mutations.html#cb485-18"></a><span class="co">## 128.6 HRAS   12   G       R    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb485-19"><a href="whole-genome-sequencing-mutations.html#cb485-19"></a><span class="co">## 414   TP53  266   G       R    Tp53 SGNLLGRNSFE ENSP00000352610</span></span>
<span id="cb485-20"><a href="whole-genome-sequencing-mutations.html#cb485-20"></a><span class="co">##                  RatProt RatAAno RatSequence</span></span>
<span id="cb485-21"><a href="whole-genome-sequencing-mutations.html#cb485-21"></a><span class="co">## 128   ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb485-22"><a href="whole-genome-sequencing-mutations.html#cb485-22"></a><span class="co">## 128.1 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb485-23"><a href="whole-genome-sequencing-mutations.html#cb485-23"></a><span class="co">## 128.2 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb485-24"><a href="whole-genome-sequencing-mutations.html#cb485-24"></a><span class="co">## 128.3 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb485-25"><a href="whole-genome-sequencing-mutations.html#cb485-25"></a><span class="co">## 128.4 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb485-26"><a href="whole-genome-sequencing-mutations.html#cb485-26"></a><span class="co">## 128.5 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb485-27"><a href="whole-genome-sequencing-mutations.html#cb485-27"></a><span class="co">## 8     ENSRNOP00000014604     411 QRIGSGSFGTV</span></span>
<span id="cb485-28"><a href="whole-genome-sequencing-mutations.html#cb485-28"></a><span class="co">## 128.6 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb485-29"><a href="whole-genome-sequencing-mutations.html#cb485-29"></a><span class="co">## 414   ENSRNOP00000047840     264 SGNLLGRDSFE</span></span>
<span id="cb485-30"><a href="whole-genome-sequencing-mutations.html#cb485-30"></a>ChangList2[(<span class="kw">na.omit</span>(Xc)), ]</span>
<span id="cb485-31"><a href="whole-genome-sequencing-mutations.html#cb485-31"></a><span class="co">##         Gene AAno AA1 Variant RatGene    Sequence         HumProt</span></span>
<span id="cb485-32"><a href="whole-genome-sequencing-mutations.html#cb485-32"></a><span class="co">## 415     HRAS   12   G       D    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb485-33"><a href="whole-genome-sequencing-mutations.html#cb485-33"></a><span class="co">## 415.1   HRAS   12   G       D    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb485-34"><a href="whole-genome-sequencing-mutations.html#cb485-34"></a><span class="co">## 415.2   HRAS   12   G       D    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb485-35"><a href="whole-genome-sequencing-mutations.html#cb485-35"></a><span class="co">## 1253  PIK3CA  350   D       N  Pik3ca NVNIRDIDKIY ENSP00000263967</span></span>
<span id="cb485-36"><a href="whole-genome-sequencing-mutations.html#cb485-36"></a><span class="co">## 415.3   HRAS   12   G       D    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb485-37"><a href="whole-genome-sequencing-mutations.html#cb485-37"></a><span class="co">## 415.4   HRAS   12   G       D    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb485-38"><a href="whole-genome-sequencing-mutations.html#cb485-38"></a><span class="co">## 415.5   HRAS   12   G       D    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb485-39"><a href="whole-genome-sequencing-mutations.html#cb485-39"></a><span class="co">## 555     BRAF  466   G       V    Braf QRIGSGSFGTV ENSP00000288602</span></span>
<span id="cb485-40"><a href="whole-genome-sequencing-mutations.html#cb485-40"></a><span class="co">## 347   PIK3CA  118   G       D  Pik3ca LNREIGFAIGM ENSP00000263967</span></span>
<span id="cb485-41"><a href="whole-genome-sequencing-mutations.html#cb485-41"></a><span class="co">## 415.6   HRAS   12   G       D    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb485-42"><a href="whole-genome-sequencing-mutations.html#cb485-42"></a><span class="co">## 299     TP53  266   G       R    Tp53 SGNLLGRNSFE ENSP00000352610</span></span>
<span id="cb485-43"><a href="whole-genome-sequencing-mutations.html#cb485-43"></a><span class="co">## 69    PIK3CA  542   E       K  Pik3ca RDPLSEITEQE ENSP00000263967</span></span>
<span id="cb485-44"><a href="whole-genome-sequencing-mutations.html#cb485-44"></a><span class="co">##                  RatProt RatAAno RatSequence</span></span>
<span id="cb485-45"><a href="whole-genome-sequencing-mutations.html#cb485-45"></a><span class="co">## 415   ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb485-46"><a href="whole-genome-sequencing-mutations.html#cb485-46"></a><span class="co">## 415.1 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb485-47"><a href="whole-genome-sequencing-mutations.html#cb485-47"></a><span class="co">## 415.2 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb485-48"><a href="whole-genome-sequencing-mutations.html#cb485-48"></a><span class="co">## 1253  ENSRNOP00000072496     350 NVNIRDIDKIY</span></span>
<span id="cb485-49"><a href="whole-genome-sequencing-mutations.html#cb485-49"></a><span class="co">## 415.3 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb485-50"><a href="whole-genome-sequencing-mutations.html#cb485-50"></a><span class="co">## 415.4 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb485-51"><a href="whole-genome-sequencing-mutations.html#cb485-51"></a><span class="co">## 415.5 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb485-52"><a href="whole-genome-sequencing-mutations.html#cb485-52"></a><span class="co">## 555   ENSRNOP00000014604     411 QRIGSGSFGTV</span></span>
<span id="cb485-53"><a href="whole-genome-sequencing-mutations.html#cb485-53"></a><span class="co">## 347   ENSRNOP00000072496     118 LNREIGFVIGM</span></span>
<span id="cb485-54"><a href="whole-genome-sequencing-mutations.html#cb485-54"></a><span class="co">## 415.6 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb485-55"><a href="whole-genome-sequencing-mutations.html#cb485-55"></a><span class="co">## 299   ENSRNOP00000047840     264 SGNLLGRDSFE</span></span>
<span id="cb485-56"><a href="whole-genome-sequencing-mutations.html#cb485-56"></a><span class="co">## 69    ENSRNOP00000072496     542 RDPLSEITEQE</span></span>
<span id="cb485-57"><a href="whole-genome-sequencing-mutations.html#cb485-57"></a></span>
<span id="cb485-58"><a href="whole-genome-sequencing-mutations.html#cb485-58"></a>Xb=<span class="kw">match</span>(<span class="kw">paste</span>(MeltCosmic<span class="op">$</span>HumGene, MeltCosmic<span class="op">$</span>HumAAno), <span class="kw">paste</span>(BList<span class="op">$</span>Gene,BList<span class="op">$</span>AAno))</span>
<span id="cb485-59"><a href="whole-genome-sequencing-mutations.html#cb485-59"></a>Xc=<span class="kw">match</span>(<span class="kw">paste</span>(MeltCosmic<span class="op">$</span>HumGene, MeltCosmic<span class="op">$</span>HumAAno), <span class="kw">paste</span>(ChangList2<span class="op">$</span>Gene, ChangList2<span class="op">$</span>AAno))</span>
<span id="cb485-60"><a href="whole-genome-sequencing-mutations.html#cb485-60"></a>x3=<span class="kw">c</span>(<span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(Xb)), <span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(Xc)))</span>
<span id="cb485-61"><a href="whole-genome-sequencing-mutations.html#cb485-61"></a>x4=<span class="kw">unique</span>(<span class="kw">c</span>(x2, x3))</span>
<span id="cb485-62"><a href="whole-genome-sequencing-mutations.html#cb485-62"></a>DT<span class="op">::</span><span class="kw">datatable</span>(MeltCosmic[x4, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">6</span>)], <span class="dt">rownames=</span>F, <span class="dt">class=</span><span class="st">&#39;cell-border stripe&#39;</span>,</span>
<span id="cb485-63"><a href="whole-genome-sequencing-mutations.html#cb485-63"></a>          <span class="dt">extensions=</span><span class="st">&quot;Buttons&quot;</span>, <span class="dt">options=</span><span class="kw">list</span>(<span class="dt">dom=</span><span class="st">&quot;Bfrtip&quot;</span>, <span class="dt">buttons=</span><span class="kw">c</span>(<span class="st">&#39;csv&#39;</span>, <span class="st">&#39;excel&#39;</span>)))</span></code></pre></div>
<div id="htmlwidget-d5e24e6a50139efd7809" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d5e24e6a50139efd7809">{"x":{"filter":"none","extensions":["Buttons"],"data":[["Hras","Hras","Hras","Hras","Hras","Hras","Braf","Hras","Tp53","Pik3ca","Pik3ca","Pik3ca","Atm"],["chr1","chr1","chr1","chr1","chr1","chr1","chr4","chr1","chr10","chr2","chr2","chr2","chr8"],[214180643,214180643,214180643,214180643,214180643,214180643,67432241,214180643,56196089,118835087,118832237,118843669,58018775]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th>Gene_Symbol<\/th>\n      <th>Chromosome<\/th>\n      <th>Start_Position<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["csv","excel"],"columnDefs":[{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="whole-genome-sequencing-mutations.html#cb486-1"></a></span>
<span id="cb486-2"><a href="whole-genome-sequencing-mutations.html#cb486-2"></a>BList[(<span class="kw">na.omit</span>(Xb)), ]</span>
<span id="cb486-3"><a href="whole-genome-sequencing-mutations.html#cb486-3"></a><span class="co">##       Gene AAno AA1 Variant RatGene    Sequence         HumProt</span></span>
<span id="cb486-4"><a href="whole-genome-sequencing-mutations.html#cb486-4"></a><span class="co">## 128   HRAS   12   G       R    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb486-5"><a href="whole-genome-sequencing-mutations.html#cb486-5"></a><span class="co">## 128.1 HRAS   12   G       R    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb486-6"><a href="whole-genome-sequencing-mutations.html#cb486-6"></a><span class="co">## 128.2 HRAS   12   G       R    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb486-7"><a href="whole-genome-sequencing-mutations.html#cb486-7"></a><span class="co">## 128.3 HRAS   12   G       R    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb486-8"><a href="whole-genome-sequencing-mutations.html#cb486-8"></a><span class="co">## 128.4 HRAS   12   G       R    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb486-9"><a href="whole-genome-sequencing-mutations.html#cb486-9"></a><span class="co">## 128.5 HRAS   12   G       R    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb486-10"><a href="whole-genome-sequencing-mutations.html#cb486-10"></a><span class="co">## 8     BRAF  466   G       E    Braf QRIGSGSFGTV ENSP00000288602</span></span>
<span id="cb486-11"><a href="whole-genome-sequencing-mutations.html#cb486-11"></a><span class="co">## 128.6 HRAS   12   G       R    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb486-12"><a href="whole-genome-sequencing-mutations.html#cb486-12"></a><span class="co">## 414   TP53  266   G       R    Tp53 SGNLLGRNSFE ENSP00000352610</span></span>
<span id="cb486-13"><a href="whole-genome-sequencing-mutations.html#cb486-13"></a><span class="co">##                  RatProt RatAAno RatSequence</span></span>
<span id="cb486-14"><a href="whole-genome-sequencing-mutations.html#cb486-14"></a><span class="co">## 128   ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb486-15"><a href="whole-genome-sequencing-mutations.html#cb486-15"></a><span class="co">## 128.1 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb486-16"><a href="whole-genome-sequencing-mutations.html#cb486-16"></a><span class="co">## 128.2 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb486-17"><a href="whole-genome-sequencing-mutations.html#cb486-17"></a><span class="co">## 128.3 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb486-18"><a href="whole-genome-sequencing-mutations.html#cb486-18"></a><span class="co">## 128.4 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb486-19"><a href="whole-genome-sequencing-mutations.html#cb486-19"></a><span class="co">## 128.5 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb486-20"><a href="whole-genome-sequencing-mutations.html#cb486-20"></a><span class="co">## 8     ENSRNOP00000014604     411 QRIGSGSFGTV</span></span>
<span id="cb486-21"><a href="whole-genome-sequencing-mutations.html#cb486-21"></a><span class="co">## 128.6 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb486-22"><a href="whole-genome-sequencing-mutations.html#cb486-22"></a><span class="co">## 414   ENSRNOP00000047840     264 SGNLLGRDSFE</span></span>
<span id="cb486-23"><a href="whole-genome-sequencing-mutations.html#cb486-23"></a>ChangList2[(<span class="kw">na.omit</span>(Xc)), ]</span>
<span id="cb486-24"><a href="whole-genome-sequencing-mutations.html#cb486-24"></a><span class="co">##         Gene AAno AA1 Variant RatGene    Sequence         HumProt</span></span>
<span id="cb486-25"><a href="whole-genome-sequencing-mutations.html#cb486-25"></a><span class="co">## 415     HRAS   12   G       D    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb486-26"><a href="whole-genome-sequencing-mutations.html#cb486-26"></a><span class="co">## 415.1   HRAS   12   G       D    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb486-27"><a href="whole-genome-sequencing-mutations.html#cb486-27"></a><span class="co">## 415.2   HRAS   12   G       D    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb486-28"><a href="whole-genome-sequencing-mutations.html#cb486-28"></a><span class="co">## 1253  PIK3CA  350   D       N  Pik3ca NVNIRDIDKIY ENSP00000263967</span></span>
<span id="cb486-29"><a href="whole-genome-sequencing-mutations.html#cb486-29"></a><span class="co">## 415.3   HRAS   12   G       D    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb486-30"><a href="whole-genome-sequencing-mutations.html#cb486-30"></a><span class="co">## 415.4   HRAS   12   G       D    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb486-31"><a href="whole-genome-sequencing-mutations.html#cb486-31"></a><span class="co">## 415.5   HRAS   12   G       D    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb486-32"><a href="whole-genome-sequencing-mutations.html#cb486-32"></a><span class="co">## 555     BRAF  466   G       V    Braf QRIGSGSFGTV ENSP00000288602</span></span>
<span id="cb486-33"><a href="whole-genome-sequencing-mutations.html#cb486-33"></a><span class="co">## 347   PIK3CA  118   G       D  Pik3ca LNREIGFAIGM ENSP00000263967</span></span>
<span id="cb486-34"><a href="whole-genome-sequencing-mutations.html#cb486-34"></a><span class="co">## 1178     ATM 3008   R       H     Atm NKVAERVLMRL ENSP00000388058</span></span>
<span id="cb486-35"><a href="whole-genome-sequencing-mutations.html#cb486-35"></a><span class="co">## 415.6   HRAS   12   G       D    Hras VVVGAGGVGKS ENSP00000380722</span></span>
<span id="cb486-36"><a href="whole-genome-sequencing-mutations.html#cb486-36"></a><span class="co">## 299     TP53  266   G       R    Tp53 SGNLLGRNSFE ENSP00000352610</span></span>
<span id="cb486-37"><a href="whole-genome-sequencing-mutations.html#cb486-37"></a><span class="co">## 69    PIK3CA  542   E       K  Pik3ca RDPLSEITEQE ENSP00000263967</span></span>
<span id="cb486-38"><a href="whole-genome-sequencing-mutations.html#cb486-38"></a><span class="co">##                  RatProt RatAAno RatSequence</span></span>
<span id="cb486-39"><a href="whole-genome-sequencing-mutations.html#cb486-39"></a><span class="co">## 415   ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb486-40"><a href="whole-genome-sequencing-mutations.html#cb486-40"></a><span class="co">## 415.1 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb486-41"><a href="whole-genome-sequencing-mutations.html#cb486-41"></a><span class="co">## 415.2 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb486-42"><a href="whole-genome-sequencing-mutations.html#cb486-42"></a><span class="co">## 1253  ENSRNOP00000072496     350 NVNIRDIDKIY</span></span>
<span id="cb486-43"><a href="whole-genome-sequencing-mutations.html#cb486-43"></a><span class="co">## 415.3 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb486-44"><a href="whole-genome-sequencing-mutations.html#cb486-44"></a><span class="co">## 415.4 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb486-45"><a href="whole-genome-sequencing-mutations.html#cb486-45"></a><span class="co">## 415.5 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb486-46"><a href="whole-genome-sequencing-mutations.html#cb486-46"></a><span class="co">## 555   ENSRNOP00000014604     411 QRIGSGSFGTV</span></span>
<span id="cb486-47"><a href="whole-genome-sequencing-mutations.html#cb486-47"></a><span class="co">## 347   ENSRNOP00000072496     118 LNREIGFVIGM</span></span>
<span id="cb486-48"><a href="whole-genome-sequencing-mutations.html#cb486-48"></a><span class="co">## 1178  ENSRNOP00000072646    3014 NKVAERVLMRL</span></span>
<span id="cb486-49"><a href="whole-genome-sequencing-mutations.html#cb486-49"></a><span class="co">## 415.6 ENSRNOP00000022363      12 VVVGAGGVGKS</span></span>
<span id="cb486-50"><a href="whole-genome-sequencing-mutations.html#cb486-50"></a><span class="co">## 299   ENSRNOP00000047840     264 SGNLLGRDSFE</span></span>
<span id="cb486-51"><a href="whole-genome-sequencing-mutations.html#cb486-51"></a><span class="co">## 69    ENSRNOP00000072496     542 RDPLSEITEQE</span></span></code></pre></div>
<p>And here, we plot the frequency of these different mutations</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="whole-genome-sequencing-mutations.html#cb487-1"></a>idx=<span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(MeltCosmic<span class="op">$</span>HumAAno))</span>
<span id="cb487-2"><a href="whole-genome-sequencing-mutations.html#cb487-2"></a><span class="kw">length</span>(idx)</span>
<span id="cb487-3"><a href="whole-genome-sequencing-mutations.html#cb487-3"></a><span class="co">## [1] 383</span></span>
<span id="cb487-4"><a href="whole-genome-sequencing-mutations.html#cb487-4"></a>Nx=<span class="kw">paste</span>(MeltCosmic<span class="op">$</span>Gene[idx], MeltCosmic<span class="op">$</span>AAno[idx])</span>
<span id="cb487-5"><a href="whole-genome-sequencing-mutations.html#cb487-5"></a>T2=<span class="kw">sort</span>(<span class="kw">table</span>(Nx), <span class="dt">decreasing =</span> T)</span>
<span id="cb487-6"><a href="whole-genome-sequencing-mutations.html#cb487-6"></a><span class="co">#head(T2)</span></span>
<span id="cb487-7"><a href="whole-genome-sequencing-mutations.html#cb487-7"></a></span>
<span id="cb487-8"><a href="whole-genome-sequencing-mutations.html#cb487-8"></a>ind2=<span class="kw">which</span>(T2<span class="op">&gt;</span><span class="dv">1</span>)</span>
<span id="cb487-9"><a href="whole-genome-sequencing-mutations.html#cb487-9"></a><span class="co">#pdf(&quot;~/Desktop/Frequency_of_mutations.pdf&quot;, height=6, width=9)</span></span>
<span id="cb487-10"><a href="whole-genome-sequencing-mutations.html#cb487-10"></a><span class="kw">barplot</span>(T2[ind2]<span class="op">/</span><span class="dv">31</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">main=</span><span class="st">&quot;most frequent coding mutations with human homolog&quot;</span>, <span class="dt">las=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span id="fig:Ext1k"></span>
<img src="RatDCIS-bookdown_files/figure-html/Ext1k-1.png" alt="most frequent mutations" width="672" />
<p class="caption">
Figure 21.3: most frequent mutations
</p>
</div>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="whole-genome-sequencing-mutations.html#cb488-1"></a><span class="co">#dev.off()</span></span>
<span id="cb488-2"><a href="whole-genome-sequencing-mutations.html#cb488-2"></a></span>
<span id="cb488-3"><a href="whole-genome-sequencing-mutations.html#cb488-3"></a>ttemp=<span class="kw">names</span>(T2[ind2])</span></code></pre></div>
<p>Also filter these to breast specific aberrations: CHECK THIS</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="whole-genome-sequencing-mutations.html#cb489-1"></a>MeltComicB=MeltCosmic[<span class="kw">which</span>(MeltCosmic<span class="op">$</span>Gene_Symbol<span class="op">%in%</span>RatBreastCosmic), ]</span>
<span id="cb489-2"><a href="whole-genome-sequencing-mutations.html#cb489-2"></a></span>
<span id="cb489-3"><a href="whole-genome-sequencing-mutations.html#cb489-3"></a>idx=<span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(MeltComicB<span class="op">$</span>HumAAno))</span>
<span id="cb489-4"><a href="whole-genome-sequencing-mutations.html#cb489-4"></a>Nx=<span class="kw">paste</span>(MeltComicB<span class="op">$</span>Gene[idx], MeltComicB<span class="op">$</span>AAno[idx])</span>
<span id="cb489-5"><a href="whole-genome-sequencing-mutations.html#cb489-5"></a>T2a=<span class="kw">sort</span>(<span class="kw">table</span>(Nx), <span class="dt">decreasing =</span> T)</span>
<span id="cb489-6"><a href="whole-genome-sequencing-mutations.html#cb489-6"></a><span class="co">#head(T2)</span></span>
<span id="cb489-7"><a href="whole-genome-sequencing-mutations.html#cb489-7"></a></span>
<span id="cb489-8"><a href="whole-genome-sequencing-mutations.html#cb489-8"></a><span class="kw">head</span>(T2a)</span>
<span id="cb489-9"><a href="whole-genome-sequencing-mutations.html#cb489-9"></a><span class="co">## integer(0)</span></span>
<span id="cb489-10"><a href="whole-genome-sequencing-mutations.html#cb489-10"></a></span>
<span id="cb489-11"><a href="whole-genome-sequencing-mutations.html#cb489-11"></a>T2b=<span class="kw">sort</span>(<span class="kw">table</span>(MeltComicB<span class="op">$</span>Gene_Symbol), <span class="dt">decreasing =</span> T)</span>
<span id="cb489-12"><a href="whole-genome-sequencing-mutations.html#cb489-12"></a></span>
<span id="cb489-13"><a href="whole-genome-sequencing-mutations.html#cb489-13"></a><span class="kw">head</span>(T2b)</span>
<span id="cb489-14"><a href="whole-genome-sequencing-mutations.html#cb489-14"></a><span class="co">## </span></span>
<span id="cb489-15"><a href="whole-genome-sequencing-mutations.html#cb489-15"></a><span class="co">## Arid1a  Foxa1  Brca2   Flna Pik3ca   Tp53 </span></span>
<span id="cb489-16"><a href="whole-genome-sequencing-mutations.html#cb489-16"></a><span class="co">##      6      5      3      3      3      2</span></span>
<span id="cb489-17"><a href="whole-genome-sequencing-mutations.html#cb489-17"></a></span>
<span id="cb489-18"><a href="whole-genome-sequencing-mutations.html#cb489-18"></a><span class="co">#pdf(&quot;~/Desktop/Frequency_of_mutations.pdf&quot;, height=6, width=9)</span></span>
<span id="cb489-19"><a href="whole-genome-sequencing-mutations.html#cb489-19"></a><span class="co"># par(mfrow=c(1,2))</span></span>
<span id="cb489-20"><a href="whole-genome-sequencing-mutations.html#cb489-20"></a><span class="co"># barplot(T2a/31, ylim=c(0, 0.2), main=&quot;most frequent BRCA with human homolog&quot;, las=2)</span></span>
<span id="cb489-21"><a href="whole-genome-sequencing-mutations.html#cb489-21"></a><span class="co"># barplot(T2b/31, ylim=c(0, 0.2), main=&quot;most frequent coding BRCA mutations&quot;, las=2)</span></span>
<span id="cb489-22"><a href="whole-genome-sequencing-mutations.html#cb489-22"></a></span>
<span id="cb489-23"><a href="whole-genome-sequencing-mutations.html#cb489-23"></a><span class="co">#dev.off()</span></span>
<span id="cb489-24"><a href="whole-genome-sequencing-mutations.html#cb489-24"></a></span>
<span id="cb489-25"><a href="whole-genome-sequencing-mutations.html#cb489-25"></a>ttemp=<span class="kw">names</span>(T2[ind2])</span></code></pre></div>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="whole-genome-sequencing-mutations.html#cb490-1"></a>Nx=<span class="kw">paste</span>(MeltCosmic<span class="op">$</span>Gene, MeltCosmic<span class="op">$</span>AAno)</span>
<span id="cb490-2"><a href="whole-genome-sequencing-mutations.html#cb490-2"></a>T2=<span class="kw">sort</span>(<span class="kw">table</span>(Nx), <span class="dt">decreasing =</span> T)</span>
<span id="cb490-3"><a href="whole-genome-sequencing-mutations.html#cb490-3"></a>ind2=<span class="kw">which</span>(T2<span class="op">&gt;</span><span class="dv">1</span>)</span>
<span id="cb490-4"><a href="whole-genome-sequencing-mutations.html#cb490-4"></a><span class="co">#pdf(&quot;~/Desktop/Frequency_of_mutations_2.pdf&quot;, height=6, width=9)</span></span>
<span id="cb490-5"><a href="whole-genome-sequencing-mutations.html#cb490-5"></a><span class="kw">barplot</span>(T2[ind2]<span class="op">/</span><span class="dv">31</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">main=</span><span class="st">&quot;most frequent coding mutations &quot;</span>, <span class="dt">las=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="whole-genome-sequencing-mutations.html#cb491-1"></a><span class="co">#dev.off()</span></span>
<span id="cb491-2"><a href="whole-genome-sequencing-mutations.html#cb491-2"></a></span>
<span id="cb491-3"><a href="whole-genome-sequencing-mutations.html#cb491-3"></a>tableout=<span class="kw">data.frame</span>(<span class="dt">gene=</span><span class="kw">names</span>(T2[ind2]), <span class="dt">ncount=</span>T2[ind2], <span class="dt">freq=</span>T2[ind2]<span class="op">/</span><span class="dv">31</span>,</span>
<span id="cb491-4"><a href="whole-genome-sequencing-mutations.html#cb491-4"></a>                    <span class="dt">humanHom=</span><span class="kw">ifelse</span>(<span class="kw">names</span>(T2[ind2])<span class="op">%in%</span>ttemp, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb491-5"><a href="whole-genome-sequencing-mutations.html#cb491-5"></a></span>
<span id="cb491-6"><a href="whole-genome-sequencing-mutations.html#cb491-6"></a><span class="co">#write.csv(tableout, file=&quot;nature-tables/Ext1k_maybe.csv&quot;)</span></span>
<span id="cb491-7"><a href="whole-genome-sequencing-mutations.html#cb491-7"></a>DT<span class="op">::</span><span class="kw">datatable</span>(tableout, <span class="dt">rownames=</span>F, <span class="dt">class=</span><span class="st">&#39;cell-border stripe&#39;</span>,</span>
<span id="cb491-8"><a href="whole-genome-sequencing-mutations.html#cb491-8"></a>          <span class="dt">extensions=</span><span class="st">&quot;Buttons&quot;</span>, <span class="dt">options=</span><span class="kw">list</span>(<span class="dt">dom=</span><span class="st">&quot;Bfrtip&quot;</span>, <span class="dt">buttons=</span><span class="kw">c</span>(<span class="st">&#39;csv&#39;</span>, <span class="st">&#39;excel&#39;</span>)))</span></code></pre></div>
<div id="htmlwidget-242cdcac1bd7ae7e6139" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-242cdcac1bd7ae7e6139">{"x":{"filter":"none","extensions":["Buttons"],"data":[["Tert ","Rnf213 ","Prf1 ","Ncor2 ","Atm ","Clip1 ","Muc1 ","Mecom ","Tcf3 ","Akap9 ","Ros1 ","Ccdc6 ","Fat1 ","Fat3 ","Ptprb ","Robo2 ","Cebpa ","Epha3 ","Hras ","Arid1a ","Foxa1 ","Pcm1 ","Pold1 ","Naca ","Pde4dip ","Aff3 ","Arid2 ","Brca2 ","Col3a1 ","Eif3el1 ","Flna ","Med12 ","Men1 ","Pik3ca ","Plcg1 ","Ranbp2 ","Setd2 ","Smarca4 ","Tcl1a ","Apc ","Arhgap26 ","Aspscr1 ","Atr ","Bcl9l ","Bcorl1 ","Braf ","Cacna1d ","Casp3 ","Cbl ","Cdk12 ","Cic ","Ciita ","Cltc ","Creb3l2 ","Crebbp ","Cxcr4 ","Cyld ","Ddx6 ","Erbb3 ","Erc1 ","Fgfr3 ","Foxo4 ","Gata2 ","Gopc ","Hook3 ","Il21r ","Kat6b ","Muc16 ","N4bp2 ","Nras ","Nrg1 ","Pdgfra ","Pms2 ","Polg ","Prdm2 ","Ptpn13 ","Ptprd ","Ret ","Rhoa ","Sf3b1 ","Snd1 ","Src ","Tfg ","Tnc ","Tp53 ","Trim33 ","Zcchc8 ","Zfp384 "],["Tert ","Rnf213 ","Prf1 ","Ncor2 ","Atm ","Clip1 ","Muc1 ","Mecom ","Tcf3 ","Akap9 ","Ros1 ","Ccdc6 ","Fat1 ","Fat3 ","Ptprb ","Robo2 ","Cebpa ","Epha3 ","Hras ","Arid1a ","Foxa1 ","Pcm1 ","Pold1 ","Naca ","Pde4dip ","Aff3 ","Arid2 ","Brca2 ","Col3a1 ","Eif3el1 ","Flna ","Med12 ","Men1 ","Pik3ca ","Plcg1 ","Ranbp2 ","Setd2 ","Smarca4 ","Tcl1a ","Apc ","Arhgap26 ","Aspscr1 ","Atr ","Bcl9l ","Bcorl1 ","Braf ","Cacna1d ","Casp3 ","Cbl ","Cdk12 ","Cic ","Ciita ","Cltc ","Creb3l2 ","Crebbp ","Cxcr4 ","Cyld ","Ddx6 ","Erbb3 ","Erc1 ","Fgfr3 ","Foxo4 ","Gata2 ","Gopc ","Hook3 ","Il21r ","Kat6b ","Muc16 ","N4bp2 ","Nras ","Nrg1 ","Pdgfra ","Pms2 ","Polg ","Prdm2 ","Ptpn13 ","Ptprd ","Ret ","Rhoa ","Sf3b1 ","Snd1 ","Src ","Tfg ","Tnc ","Tp53 ","Trim33 ","Zcchc8 ","Zfp384 "],[54,40,38,36,30,30,19,18,16,15,15,13,12,12,10,8,7,7,7,6,5,5,5,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],["Tert ","Rnf213 ","Prf1 ","Ncor2 ","Atm ","Clip1 ","Muc1 ","Mecom ","Tcf3 ","Akap9 ","Ros1 ","Ccdc6 ","Fat1 ","Fat3 ","Ptprb ","Robo2 ","Cebpa ","Epha3 ","Hras ","Arid1a ","Foxa1 ","Pcm1 ","Pold1 ","Naca ","Pde4dip ","Aff3 ","Arid2 ","Brca2 ","Col3a1 ","Eif3el1 ","Flna ","Med12 ","Men1 ","Pik3ca ","Plcg1 ","Ranbp2 ","Setd2 ","Smarca4 ","Tcl1a ","Apc ","Arhgap26 ","Aspscr1 ","Atr ","Bcl9l ","Bcorl1 ","Braf ","Cacna1d ","Casp3 ","Cbl ","Cdk12 ","Cic ","Ciita ","Cltc ","Creb3l2 ","Crebbp ","Cxcr4 ","Cyld ","Ddx6 ","Erbb3 ","Erc1 ","Fgfr3 ","Foxo4 ","Gata2 ","Gopc ","Hook3 ","Il21r ","Kat6b ","Muc16 ","N4bp2 ","Nras ","Nrg1 ","Pdgfra ","Pms2 ","Polg ","Prdm2 ","Ptpn13 ","Ptprd ","Ret ","Rhoa ","Sf3b1 ","Snd1 ","Src ","Tfg ","Tnc ","Tp53 ","Trim33 ","Zcchc8 ","Zfp384 "],[1.74193548387097,1.29032258064516,1.2258064516129,1.16129032258065,0.967741935483871,0.967741935483871,0.612903225806452,0.580645161290323,0.516129032258065,0.483870967741935,0.483870967741935,0.419354838709677,0.387096774193548,0.387096774193548,0.32258064516129,0.258064516129032,0.225806451612903,0.225806451612903,0.225806451612903,0.193548387096774,0.161290322580645,0.161290322580645,0.161290322580645,0.129032258064516,0.129032258064516,0.0967741935483871,0.0967741935483871,0.0967741935483871,0.0967741935483871,0.0967741935483871,0.0967741935483871,0.0967741935483871,0.0967741935483871,0.0967741935483871,0.0967741935483871,0.0967741935483871,0.0967741935483871,0.0967741935483871,0.0967741935483871,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581,0.0645161290322581],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th>gene<\/th>\n      <th>ncount.Nx<\/th>\n      <th>ncount.Freq<\/th>\n      <th>freq.Nx<\/th>\n      <th>freq.Freq<\/th>\n      <th>humanHom<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["csv","excel"],"columnDefs":[{"className":"dt-right","targets":[2,4,5]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>We can also use the <a href="https://cancer.sanger.ac.uk/cmc/home">cosmic mutational database</a> to see whether any of these mutations overlap: (version 92)</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="whole-genome-sequencing-mutations.html#cb492-1"></a>Cmut=<span class="kw">read.delim</span>(<span class="st">&quot;../anntotations/cmc_export.v92.tsv&quot;</span>)</span></code></pre></div>
<p>Edit the stuff here:</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="whole-genome-sequencing-mutations.html#cb493-1"></a>Ax1=<span class="kw">match</span>(<span class="kw">paste</span>(MeltCosmic<span class="op">$</span>HumGene, MeltCosmic<span class="op">$</span>HumAAno), <span class="kw">paste</span>(Cmut<span class="op">$</span>GENE_NAME, Cmut<span class="op">$</span>AA_MUT_START))</span>
<span id="cb493-2"><a href="whole-genome-sequencing-mutations.html#cb493-2"></a>Ax1</span>
<span id="cb493-3"><a href="whole-genome-sequencing-mutations.html#cb493-3"></a><span class="co">##   [1]      NA      NA      NA      NA      NA 3579426      NA      NA 1934438</span></span>
<span id="cb493-4"><a href="whole-genome-sequencing-mutations.html#cb493-4"></a><span class="co">##  [10]      NA      NA      NA      NA 3182147      NA      NA      NA      NA</span></span>
<span id="cb493-5"><a href="whole-genome-sequencing-mutations.html#cb493-5"></a><span class="co">##  [19]      NA 2997088      NA      NA      NA      NA      NA      NA      NA</span></span>
<span id="cb493-6"><a href="whole-genome-sequencing-mutations.html#cb493-6"></a><span class="co">##  [28]      NA 1059801      NA      NA      NA      NA      NA 2804349      NA</span></span>
<span id="cb493-7"><a href="whole-genome-sequencing-mutations.html#cb493-7"></a><span class="co">##  [37] 4470423      NA      NA      NA      NA      NA      NA 4131069      NA</span></span>
<span id="cb493-8"><a href="whole-genome-sequencing-mutations.html#cb493-8"></a><span class="co">##  [46]      NA      NA      NA      NA      NA      NA      NA      NA      NA</span></span>
<span id="cb493-9"><a href="whole-genome-sequencing-mutations.html#cb493-9"></a><span class="co">##  [55] 2804349      NA 4470423      NA      NA      NA      NA      NA      NA</span></span>
<span id="cb493-10"><a href="whole-genome-sequencing-mutations.html#cb493-10"></a><span class="co">##  [64] 1442364      NA      NA      NA  972952      NA      NA      NA      NA</span></span>
<span id="cb493-11"><a href="whole-genome-sequencing-mutations.html#cb493-11"></a><span class="co">##  [73]      NA 2804349      NA      NA 4470423 1813967 1225033      NA      NA</span></span>
<span id="cb493-12"><a href="whole-genome-sequencing-mutations.html#cb493-12"></a><span class="co">##  [82]      NA      NA 3408942      NA  536410      NA      NA      NA      NA</span></span>
<span id="cb493-13"><a href="whole-genome-sequencing-mutations.html#cb493-13"></a><span class="co">##  [91]      NA      NA      NA      NA      NA 2321788      NA      NA      NA</span></span>
<span id="cb493-14"><a href="whole-genome-sequencing-mutations.html#cb493-14"></a><span class="co">## [100]      NA      NA      NA      NA      NA      NA      NA      NA      NA</span></span>
<span id="cb493-15"><a href="whole-genome-sequencing-mutations.html#cb493-15"></a><span class="co">## [109]      NA      NA      NA      NA 2321788 3579612  249764  249764      NA</span></span>
<span id="cb493-16"><a href="whole-genome-sequencing-mutations.html#cb493-16"></a><span class="co">## [118]      NA      NA      NA      NA      NA      NA 2997088      NA      NA</span></span>
<span id="cb493-17"><a href="whole-genome-sequencing-mutations.html#cb493-17"></a><span class="co">## [127]      NA      NA      NA      NA      NA      NA      NA      NA      NA</span></span>
<span id="cb493-18"><a href="whole-genome-sequencing-mutations.html#cb493-18"></a><span class="co">## [136]      NA      NA      NA 4437142      NA      NA      NA  329517      NA</span></span>
<span id="cb493-19"><a href="whole-genome-sequencing-mutations.html#cb493-19"></a><span class="co">## [145] 2997088      NA      NA      NA      NA 2387389      NA      NA      NA</span></span>
<span id="cb493-20"><a href="whole-genome-sequencing-mutations.html#cb493-20"></a><span class="co">## [154]      NA      NA      NA      NA      NA      NA      NA      NA      NA</span></span>
<span id="cb493-21"><a href="whole-genome-sequencing-mutations.html#cb493-21"></a><span class="co">## [163]      NA      NA 4470675  299229      NA 3947247      NA      NA      NA</span></span>
<span id="cb493-22"><a href="whole-genome-sequencing-mutations.html#cb493-22"></a><span class="co">## [172] 1967695 2997088      NA      NA      NA      NA      NA      NA      NA</span></span>
<span id="cb493-23"><a href="whole-genome-sequencing-mutations.html#cb493-23"></a><span class="co">## [181]      NA      NA      NA 3817808      NA      NA      NA 4325112      NA</span></span>
<span id="cb493-24"><a href="whole-genome-sequencing-mutations.html#cb493-24"></a><span class="co">## [190]      NA 3579612      NA      NA  299229      NA 2997088      NA      NA</span></span>
<span id="cb493-25"><a href="whole-genome-sequencing-mutations.html#cb493-25"></a><span class="co">## [199]      NA      NA      NA      NA      NA      NA      NA      NA      NA</span></span>
<span id="cb493-26"><a href="whole-genome-sequencing-mutations.html#cb493-26"></a><span class="co">## [208]      NA      NA      NA 3579612  249764  249764  299229 1462810 2997088</span></span>
<span id="cb493-27"><a href="whole-genome-sequencing-mutations.html#cb493-27"></a><span class="co">## [217] 1864157      NA      NA      NA      NA 1572878      NA      NA      NA</span></span>
<span id="cb493-28"><a href="whole-genome-sequencing-mutations.html#cb493-28"></a><span class="co">## [226]      NA      NA      NA      NA  323572      NA      NA      NA      NA</span></span>
<span id="cb493-29"><a href="whole-genome-sequencing-mutations.html#cb493-29"></a><span class="co">## [235] 2804349      NA 4470423      NA      NA      NA      NA 2997088      NA</span></span>
<span id="cb493-30"><a href="whole-genome-sequencing-mutations.html#cb493-30"></a><span class="co">## [244]      NA      NA      NA      NA      NA      NA 2321788      NA      NA</span></span>
<span id="cb493-31"><a href="whole-genome-sequencing-mutations.html#cb493-31"></a><span class="co">## [253]  249764  249764      NA 1211561  231932 2997088 1875629      NA      NA</span></span>
<span id="cb493-32"><a href="whole-genome-sequencing-mutations.html#cb493-32"></a><span class="co">## [262]      NA      NA  535044      NA      NA      NA      NA      NA      NA</span></span>
<span id="cb493-33"><a href="whole-genome-sequencing-mutations.html#cb493-33"></a><span class="co">## [271]      NA      NA      NA      NA      NA  858704 1923136      NA      NA</span></span>
<span id="cb493-34"><a href="whole-genome-sequencing-mutations.html#cb493-34"></a><span class="co">## [280] 1706912      NA      NA      NA      NA  220696 2382160      NA      NA</span></span>
<span id="cb493-35"><a href="whole-genome-sequencing-mutations.html#cb493-35"></a><span class="co">## [289]      NA      NA      NA 3140387 3579612      NA      NA      NA      NA</span></span>
<span id="cb493-36"><a href="whole-genome-sequencing-mutations.html#cb493-36"></a><span class="co">## [298]      NA      NA      NA      NA      NA      NA 2997088      NA  569243</span></span>
<span id="cb493-37"><a href="whole-genome-sequencing-mutations.html#cb493-37"></a><span class="co">## [307] 3182147      NA 1238663      NA      NA      NA 2779340      NA      NA</span></span>
<span id="cb493-38"><a href="whole-genome-sequencing-mutations.html#cb493-38"></a><span class="co">## [316] 2493470      NA      NA 3579612 2804611      NA      NA      NA      NA</span></span>
<span id="cb493-39"><a href="whole-genome-sequencing-mutations.html#cb493-39"></a><span class="co">## [325]      NA      NA 3333928      NA  860990      NA      NA 2997088      NA</span></span>
<span id="cb493-40"><a href="whole-genome-sequencing-mutations.html#cb493-40"></a><span class="co">## [334] 1944909      NA      NA      NA  640765      NA      NA      NA      NA</span></span>
<span id="cb493-41"><a href="whole-genome-sequencing-mutations.html#cb493-41"></a><span class="co">## [343]      NA      NA      NA      NA      NA      NA      NA      NA 2804349</span></span>
<span id="cb493-42"><a href="whole-genome-sequencing-mutations.html#cb493-42"></a><span class="co">## [352]      NA      NA      NA      NA      NA      NA      NA      NA      NA</span></span>
<span id="cb493-43"><a href="whole-genome-sequencing-mutations.html#cb493-43"></a><span class="co">## [361]      NA  660372  403079      NA      NA  219815      NA      NA      NA</span></span>
<span id="cb493-44"><a href="whole-genome-sequencing-mutations.html#cb493-44"></a><span class="co">## [370]      NA      NA      NA      NA      NA      NA      NA      NA 2804349</span></span>
<span id="cb493-45"><a href="whole-genome-sequencing-mutations.html#cb493-45"></a><span class="co">## [379]      NA      NA 2997088      NA      NA      NA 2065818      NA      NA</span></span>
<span id="cb493-46"><a href="whole-genome-sequencing-mutations.html#cb493-46"></a><span class="co">## [388]      NA      NA      NA 2762883      NA      NA      NA      NA 3277818</span></span>
<span id="cb493-47"><a href="whole-genome-sequencing-mutations.html#cb493-47"></a><span class="co">## [397]      NA      NA      NA      NA      NA  833869      NA      NA      NA</span></span>
<span id="cb493-48"><a href="whole-genome-sequencing-mutations.html#cb493-48"></a><span class="co">## [406]      NA      NA      NA      NA      NA      NA 3579612      NA      NA</span></span>
<span id="cb493-49"><a href="whole-genome-sequencing-mutations.html#cb493-49"></a><span class="co">## [415]      NA      NA 1863647      NA      NA      NA      NA      NA 4130777</span></span>
<span id="cb493-50"><a href="whole-genome-sequencing-mutations.html#cb493-50"></a><span class="co">## [424]      NA      NA      NA      NA      NA 2321788      NA      NA      NA</span></span>
<span id="cb493-51"><a href="whole-genome-sequencing-mutations.html#cb493-51"></a><span class="co">## [433]      NA 2997088      NA      NA      NA      NA      NA      NA      NA</span></span>
<span id="cb493-52"><a href="whole-genome-sequencing-mutations.html#cb493-52"></a><span class="co">## [442]      NA 4239300 1803203      NA      NA      NA      NA  119744      NA</span></span>
<span id="cb493-53"><a href="whole-genome-sequencing-mutations.html#cb493-53"></a><span class="co">## [451]      NA      NA      NA 2997088 1875594      NA 2169357      NA      NA</span></span>
<span id="cb493-54"><a href="whole-genome-sequencing-mutations.html#cb493-54"></a><span class="co">## [460]      NA      NA 1480666      NA      NA      NA      NA      NA      NA</span></span>
<span id="cb493-55"><a href="whole-genome-sequencing-mutations.html#cb493-55"></a><span class="co">## [469]      NA 4253020      NA 2417918      NA      NA 4107129 3634329      NA</span></span>
<span id="cb493-56"><a href="whole-genome-sequencing-mutations.html#cb493-56"></a><span class="co">## [478] 4341899 2107476      NA      NA      NA      NA 3579612      NA 3447720</span></span>
<span id="cb493-57"><a href="whole-genome-sequencing-mutations.html#cb493-57"></a><span class="co">## [487] 4470284      NA      NA      NA      NA      NA      NA      NA 1026414</span></span>
<span id="cb493-58"><a href="whole-genome-sequencing-mutations.html#cb493-58"></a><span class="co">## [496]      NA 1240808 2997088 1875554 1768181      NA      NA 3913348 3794827</span></span>
<span id="cb493-59"><a href="whole-genome-sequencing-mutations.html#cb493-59"></a><span class="co">## [505]      NA      NA      NA      NA      NA      NA      NA      NA      NA</span></span>
<span id="cb493-60"><a href="whole-genome-sequencing-mutations.html#cb493-60"></a><span class="co">## [514]      NA      NA      NA      NA      NA      NA      NA      NA      NA</span></span>
<span id="cb493-61"><a href="whole-genome-sequencing-mutations.html#cb493-61"></a><span class="co">## [523]      NA      NA 3884698 2997088      NA      NA 2854296      NA      NA</span></span>
<span id="cb493-62"><a href="whole-genome-sequencing-mutations.html#cb493-62"></a><span class="co">## [532]  206581      NA      NA      NA      NA      NA      NA      NA      NA</span></span>
<span id="cb493-63"><a href="whole-genome-sequencing-mutations.html#cb493-63"></a><span class="co">## [541]      NA      NA      NA      NA      NA      NA  860979  860989      NA</span></span>
<span id="cb493-64"><a href="whole-genome-sequencing-mutations.html#cb493-64"></a><span class="co">## [550] 2997088      NA      NA  363033 2381738      NA      NA      NA      NA</span></span>
<span id="cb493-65"><a href="whole-genome-sequencing-mutations.html#cb493-65"></a><span class="co">## [559] 2321788  323180 2603243  249764      NA 3565143      NA      NA      NA</span></span>
<span id="cb493-66"><a href="whole-genome-sequencing-mutations.html#cb493-66"></a><span class="co">## [568]      NA      NA      NA      NA 1545806      NA 1864218      NA      NA</span></span>
<span id="cb493-67"><a href="whole-genome-sequencing-mutations.html#cb493-67"></a><span class="co">## [577]      NA 1550110      NA 3096457      NA      NA      NA      NA      NA</span></span>
<span id="cb493-68"><a href="whole-genome-sequencing-mutations.html#cb493-68"></a><span class="co">## [586]      NA      NA      NA      NA      NA      NA 1813963      NA      NA</span></span>
<span id="cb493-69"><a href="whole-genome-sequencing-mutations.html#cb493-69"></a><span class="co">## [595]  860979  860989      NA      NA 2997088      NA      NA      NA      NA</span></span>
<span id="cb493-70"><a href="whole-genome-sequencing-mutations.html#cb493-70"></a><span class="co">## [604]      NA      NA      NA 4268634      NA      NA 3402625      NA      NA</span></span>
<span id="cb493-71"><a href="whole-genome-sequencing-mutations.html#cb493-71"></a><span class="co">## [613]      NA      NA      NA      NA      NA 1871605      NA      NA      NA</span></span>
<span id="cb493-72"><a href="whole-genome-sequencing-mutations.html#cb493-72"></a><span class="co">## [622]      NA      NA      NA  219815      NA      NA      NA      NA      NA</span></span>
<span id="cb493-73"><a href="whole-genome-sequencing-mutations.html#cb493-73"></a><span class="co">## [631]      NA      NA      NA      NA 2997088      NA      NA      NA      NA</span></span>
<span id="cb493-74"><a href="whole-genome-sequencing-mutations.html#cb493-74"></a><span class="co">## [640]      NA      NA      NA      NA      NA      NA      NA 2198895 3833218</span></span>
<span id="cb493-75"><a href="whole-genome-sequencing-mutations.html#cb493-75"></a><span class="co">## [649]      NA      NA      NA      NA      NA      NA      NA      NA      NA</span></span>
<span id="cb493-76"><a href="whole-genome-sequencing-mutations.html#cb493-76"></a><span class="co">## [658]      NA      NA      NA      NA      NA      NA 2787457      NA      NA</span></span>
<span id="cb493-77"><a href="whole-genome-sequencing-mutations.html#cb493-77"></a><span class="co">## [667]  219815      NA      NA      NA      NA      NA      NA      NA 3451450</span></span>
<span id="cb493-78"><a href="whole-genome-sequencing-mutations.html#cb493-78"></a><span class="co">## [676]      NA 4471138      NA      NA      NA  860979  860989      NA      NA</span></span>
<span id="cb493-79"><a href="whole-genome-sequencing-mutations.html#cb493-79"></a><span class="co">## [685]      NA      NA      NA      NA      NA      NA</span></span>
<span id="cb493-80"><a href="whole-genome-sequencing-mutations.html#cb493-80"></a><span class="kw">head</span>(<span class="kw">paste</span>(MeltCosmic<span class="op">$</span>HumGene, MeltCosmic<span class="op">$</span>HumAAno))</span>
<span id="cb493-81"><a href="whole-genome-sequencing-mutations.html#cb493-81"></a><span class="co">## [1] &quot;NCOR2 NA&quot;   &quot;NCOR2 1990&quot; &quot;CLIP1 NA&quot;   &quot;CLIP1 859&quot;  &quot;CXCR4 10&quot;  </span></span>
<span id="cb493-82"><a href="whole-genome-sequencing-mutations.html#cb493-82"></a><span class="co">## [6] &quot;NRG1 209&quot;</span></span>
<span id="cb493-83"><a href="whole-genome-sequencing-mutations.html#cb493-83"></a><span class="kw">head</span>(<span class="kw">paste</span>(Cmut<span class="op">$</span>GENE_NAME, Cmut<span class="op">$</span>AA_MUT_START))</span>
<span id="cb493-84"><a href="whole-genome-sequencing-mutations.html#cb493-84"></a><span class="co">## [1] &quot;SYNPO2L 251&quot; &quot;SYNPO2L 669&quot; &quot;SYNPO2L 889&quot; &quot;SYNPO2L 407&quot; &quot;SYNPO2L 593&quot;</span></span>
<span id="cb493-85"><a href="whole-genome-sequencing-mutations.html#cb493-85"></a><span class="co">## [6] &quot;SYNPO2L 24&quot;</span></span>
<span id="cb493-86"><a href="whole-genome-sequencing-mutations.html#cb493-86"></a>tempA=Cmut[ <span class="kw">na.omit</span>(Ax1), <span class="kw">c</span>(<span class="st">&quot;GENE_NAME&quot;</span>,<span class="st">&quot;Mutation.CDS&quot;</span>, <span class="st">&quot;Mutation.AA&quot;</span>, <span class="st">&quot;CLINVAR_CLNSIG&quot;</span>)]</span>
<span id="cb493-87"><a href="whole-genome-sequencing-mutations.html#cb493-87"></a>DT<span class="op">::</span><span class="kw">datatable</span>(tempA, </span>
<span id="cb493-88"><a href="whole-genome-sequencing-mutations.html#cb493-88"></a>              <span class="dt">rownames=</span>F, <span class="dt">class=</span><span class="st">&#39;cell-border stripe&#39;</span>,</span>
<span id="cb493-89"><a href="whole-genome-sequencing-mutations.html#cb493-89"></a>          <span class="dt">extensions=</span><span class="st">&quot;Buttons&quot;</span>, <span class="dt">options=</span><span class="kw">list</span>(<span class="dt">dom=</span><span class="st">&quot;Bfrtip&quot;</span>, <span class="dt">buttons=</span><span class="kw">c</span>(<span class="st">&#39;csv&#39;</span>, <span class="st">&#39;excel&#39;</span>)))</span></code></pre></div>
<div id="htmlwidget-de392cb9a83052a67d72" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-de392cb9a83052a67d72">{"x":{"filter":"none","extensions":["Buttons"],"data":[["NRG1","BCL10","PLCG1","MECOM","POLG","RNF213","EPHA3","BRAF","RNF213","EPHA3","JUN","ESR1","RNF213","EPHA3","CACNA1D","TBL1XR1","ROS1","ARID1A","POLD1","POLD1","HRAS","ROBO2","ROBO2","MECOM","IL21R","AKT3","MECOM","TAL2","EPHA3","EIF3E","FGFR3","APC","MECOM","EP300","RHOA","HRAS","EIF3E","MECOM","HRAS","ROBO2","ROBO2","EIF3E","PATZ1","MECOM","PDE4DIP","MSH2","CREBBP","RNF213","EPHA3","MECOM","POLD1","ROBO2","ROBO2","NF2","ARHGEF10","MECOM","PIK3CA","ARID1A","FAT1","SS18","TRIM33","FAT3","SMARCA4","PICALM","HRAS","MECOM","CTNND1","PLCG1","PREX2","ERBB3","MED12","HRAS","RNF213","KAT6B","FAT1","MECOM","NRAS","DICER1","RNF213","CREB3L2","LCK","FAT3","RNF213","MECOM","SND1","TFPT","NOTCH1","ETV1","HRAS","PDE4DIP","BRAF","POLD1","MECOM","MEN1","PTEN","TBX3","MECOM","PIK3CA","BCL9","GOPC","SFPQ","ARHGAP5","CBL","ATM","ATR","MLLT1","HRAS","TP53","EPHA3","PDGFRA","DCC","MECOM","PIK3CA","FAT4","ERC1","EPHA7","ARHGAP26","MECOM","PPP6C","RET","FAT1","FAT1","MECOM","DNM2","SMARCA4","POLD1","CREBBP","RARA","ROBO2","CXCR4","CYLD","PDE4DIP","NCOA1","FOXO4","CACNA1D","FAT1","FAT1","MECOM","RBM10","ERCC2","HOOK3","FAT3","MECOM","MYH11","RABEP1","STRN","FAT3","TP53","EPHA3","FAT1","FAT1"],["c.625T&gt;A","c.407C&gt;G","c.601C&gt;A","c.824A&gt;G","c.616G&gt;T","c.11778C&gt;A","c.1898G&gt;A","c.2193C&gt;T","c.11778C&gt;A","c.1898G&gt;A","c.110G&gt;A","c.1560dup","c.11778C&gt;A","c.1898G&gt;A","c.622G&gt;T","c.595A&gt;G","c.5908G&gt;A","c.5267C&gt;G","c.1955G&gt;T","c.1955G&gt;T","c.35G&gt;A","c.552A&gt;C","c.552A&gt;C","c.824A&gt;G","c.367C&gt;G","c.232C&gt;A","c.824A&gt;G","c.60C&gt;T","c.2005G&gt;A","c.632G&gt;A","c.2390_2391delinsTT","c.699_717dup","c.824A&gt;G","c.512C&gt;T","c.224C&gt;G","c.35G&gt;A","c.632G&gt;A","c.824A&gt;G","c.35G&gt;A","c.552A&gt;C","c.552A&gt;C","c.632G&gt;A","c.457C&gt;T","c.824A&gt;G","c.1023G&gt;A","c.2168C&gt;T","c.1805G&gt;A","c.11778C&gt;A","c.1898G&gt;A","c.824A&gt;G","c.1955G&gt;T","c.552A&gt;C","c.552A&gt;C","c.1164C&gt;T","c.94G&gt;A","c.824A&gt;G","c.1049A&gt;G","c.317_333delinsCGCGGGCCTA","c.11202C&gt;G","c.723C&gt;A","c.1387C&gt;T","c.8109G&gt;A","c.2291G&gt;C","c.547G&gt;A","c.35G&gt;A","c.824A&gt;G","c.1595G&gt;A","c.601C&gt;A","c.4155T&gt;C","c.224C&gt;T","c.1436C&gt;T","c.35G&gt;A","c.8806G&gt;T","c.265C&gt;T","c.6772G&gt;A","c.824A&gt;G","c.420A&gt;G","c.4702G&gt;A","c.11778C&gt;A","c.754C&gt;T","c.1401G&gt;T","c.8521A&gt;G","c.11778C&gt;A","c.824A&gt;G","c.733G&gt;T","c.227A&gt;G","c.927C&gt;G","c.584A&gt;G","c.35G&gt;A","c.5811G&gt;C","c.1397G&gt;A","c.1955G&gt;T","c.824A&gt;G","c.749del","c.284del","c.1137C&gt;T","c.824A&gt;G","c.353G&gt;A","c.3414C&gt;A","c.944T&gt;G","c.1784A&gt;G","c.2977C&gt;T","c.1762G&gt;A","c.9023G&gt;A","c.3528C&gt;A","c.16A&gt;G","c.35G&gt;A","c.797G&gt;T","c.1447A&gt;C","c.2397C&gt;A","c.1671A&gt;T","c.824A&gt;G","c.1624G&gt;A","c.11399C&gt;A","c.223A&gt;T","c.1084G&gt;A","c.1534G&gt;C","c.824A&gt;G","c.265_266delinsAA","c.1249C&gt;T","c.1603A&gt;T","c.1080C&gt;G","c.824A&gt;G","c.1349C&gt;A","c.2738C&gt;T","c.1955G&gt;T","c.4990C&gt;T","c.550G&gt;T","c.552A&gt;C","c.283C&gt;T","c.157C&gt;T","c.6748C&gt;T","c.341C&gt;T","c.1234G&gt;A","c.5311C&gt;T","c.1603A&gt;T","c.1080C&gt;G","c.824A&gt;G","c.472del","c.1820G&gt;C","c.952G&gt;T","c.8521A&gt;G","c.824A&gt;G","c.2797G&gt;T","c.496G&gt;A","c.1849C&gt;A","c.8521A&gt;G","c.49G&gt;A","c.2016C&gt;A","c.1603A&gt;T","c.1080C&gt;G"],["p.L209M","p.S136*","p.L201M","p.H275R","p.G206*","p.T3926=","p.G633E","p.P731=","p.T3926=","p.G633E","p.S37N","p.G521Rfs*18","p.T3926=","p.G633E","p.G208*","p.S199G","p.V1970I","p.P1756R","p.R652L","p.R652L","p.G12D","p.K184N","p.K184N","p.H275R","p.P123A","p.Q78K","p.H275R","p.S20=","p.G669R","p.R211K","p.P797L","p.T240Afs*18","p.H275R","p.A171V","p.P75R","p.G12D","p.R211K","p.H275R","p.G12D","p.K184N","p.K184N","p.R211K","p.Q153*","p.H275R","p.L341=","p.S723F","p.S602N","p.T3926=","p.G633E","p.H275R","p.R652L","p.K184N","p.K184N","p.A388=","p.D32N","p.H275R","p.D350G","p.N106Tfs*4","p.F3734L","p.G241=","p.P463S","p.T2703=","p.W764S","p.V183I","p.G12D","p.H275R","p.G532D","p.L201M","p.S1385=","p.S75F","p.S479F","p.G12D","p.A2936S","p.P89S","p.D2258N","p.H275R","p.P140=","p.G1568S","p.T3926=","p.L252F","p.E467D","p.M2841V","p.T3926=","p.H275R","p.A245S","p.E76G","p.G309=","p.N195S","p.G12D","p.L1937=","p.G466E","p.R652L","p.H275R","p.P250Lfs*36","p.P95Hfs*4","p.A379=","p.H275R","p.G118D","p.P1138=","p.I315S","p.E595G","p.P993S","p.D588N","p.R3008H","p.T1176=","p.T6A","p.G12D","p.G266V","p.S483R","p.T799=","p.P557=","p.H275R","p.E542K","p.S3800Y","p.S75C","p.D362N","p.A512P","p.H275R","p.G89K","p.R417C","p.T535S","p.F360L","p.H275R","p.P450H","p.P913L","p.R652L","p.R1664C","p.V184L","p.K184N","p.L95F","p.R53C","p.L2250F","p.P114L","p.V412I","p.P1771S","p.T535S","p.F360L","p.H275R","p.E158Rfs*4","p.G607A","p.G318C","p.M2841V","p.H275R","p.E933*","p.E166K","p.P617T","p.M2841V","p.E17K","p.S672R","p.T535S","p.F360L"],["","","","","","","","","","","","","","","","","","","","","5&amp;5&amp;5&amp;5&amp;5&amp;4","","","","","","","","","","","","","","","5&amp;5&amp;5&amp;5&amp;5&amp;4","","","5&amp;5&amp;5&amp;5&amp;5&amp;4","","","","","","","","","","","","","","","","","","","","","","","","","","5&amp;5&amp;5&amp;5&amp;5&amp;4","","","","","","","5&amp;5&amp;5&amp;5&amp;5&amp;4","","","","","","","","","","","","","","","","","5&amp;5&amp;5&amp;5&amp;5&amp;4","","4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4","","","","","","","5&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4","","","","","","4&amp;4&amp;4","","","5&amp;5&amp;5&amp;5&amp;5&amp;4","4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4&amp;4","","","","","5&amp;5&amp;5&amp;5&amp;4&amp;4&amp;4&amp;4&amp;5&amp;4&amp;4&amp;4&amp;4&amp;5&amp;4&amp;4&amp;4&amp;4&amp;4&amp;5&amp;4","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th>GENE_NAME<\/th>\n      <th>Mutation.CDS<\/th>\n      <th>Mutation.AA<\/th>\n      <th>CLINVAR_CLNSIG<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["csv","excel"],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="whole-genome-sequencing-mutations.html#cb494-1"></a></span>
<span id="cb494-2"><a href="whole-genome-sequencing-mutations.html#cb494-2"></a><span class="kw">write.csv</span>(tempA, <span class="dt">file=</span><span class="st">&quot;nature-tables/CosmicMutCensus_mutations.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="plots" class="section level2">
<h2><span class="header-section-number">21.3</span> Plots</h2>
<div id="quick-overview" class="section level3">
<h3><span class="header-section-number">21.3.1</span> Quick overview</h3>
<p>WGS all mutations summary: Look at the overall mutation burden, and the tumor mutational burden, defined as # coding mutations per MB.</p>
<p>The following plot lists tumors in increasing size</p>
<p>Make plots of:</p>
<ul>
<li>overall types of mutations per sample (ranked by size)</li>
<li>correlation between mutation type and size</li>
<li>type of mutation?</li>
</ul>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="whole-genome-sequencing-mutations.html#cb495-1"></a><span class="co">#load(&quot;data/wholegenome_mutations/WGS_mutations_coding.RData&quot;)</span></span>
<span id="cb495-2"><a href="whole-genome-sequencing-mutations.html#cb495-2"></a></span>
<span id="cb495-3"><a href="whole-genome-sequencing-mutations.html#cb495-3"></a>TabSamples=<span class="kw">lapply</span>(AllMutWGScoding, <span class="cf">function</span>(x) <span class="kw">table</span>(<span class="kw">factor</span>(x<span class="op">$</span>Variant_Classification, <span class="dt">levels=</span>SearchVars)))</span>
<span id="cb495-4"><a href="whole-genome-sequencing-mutations.html#cb495-4"></a>TabSamples2=<span class="kw">unlist</span>(TabSamples)</span>
<span id="cb495-5"><a href="whole-genome-sequencing-mutations.html#cb495-5"></a>namidx=<span class="kw">sapply</span>(<span class="kw">strsplit</span>(<span class="kw">names</span>(TabSamples2), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>), <span class="cf">function</span>(x) x[<span class="dv">1</span>])</span>
<span id="cb495-6"><a href="whole-genome-sequencing-mutations.html#cb495-6"></a>namidx2=<span class="kw">sapply</span>(<span class="kw">strsplit</span>(<span class="kw">names</span>(TabSamples2), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>), <span class="cf">function</span>(x) x[<span class="dv">2</span>])</span>
<span id="cb495-7"><a href="whole-genome-sequencing-mutations.html#cb495-7"></a>namidx3=<span class="kw">sapply</span>(namidx, <span class="cf">function</span>(x) Cdata<span class="op">$</span>NewID[<span class="kw">grep</span>(x, Cdata<span class="op">$</span>WGS)])</span>
<span id="cb495-8"><a href="whole-genome-sequencing-mutations.html#cb495-8"></a>TotTabl=<span class="kw">data.frame</span>(<span class="dt">val=</span>TabSamples2, <span class="dt">nam=</span>namidx, <span class="dt">variant=</span>namidx2, <span class="dt">nam2=</span>namidx3)</span>
<span id="cb495-9"><a href="whole-genome-sequencing-mutations.html#cb495-9"></a></span>
<span id="cb495-10"><a href="whole-genome-sequencing-mutations.html#cb495-10"></a><span class="co">## remove 0 samples</span></span>
<span id="cb495-11"><a href="whole-genome-sequencing-mutations.html#cb495-11"></a><span class="co"># searchNo=stack(by(TotTabl$val, TotTabl$variant, sum))</span></span>
<span id="cb495-12"><a href="whole-genome-sequencing-mutations.html#cb495-12"></a><span class="co"># TotTabl=TotTabl[ which(TotTabl$variant %in% searchNo$ind[which(searchNo$values!=0)]), ]</span></span>
<span id="cb495-13"><a href="whole-genome-sequencing-mutations.html#cb495-13"></a></span>
<span id="cb495-14"><a href="whole-genome-sequencing-mutations.html#cb495-14"></a>lx1=<span class="kw">match</span>(TotTabl<span class="op">$</span>nam2, Cdata<span class="op">$</span>NewID, <span class="cf">function</span>(x) <span class="kw">tryCatch</span>({x[<span class="dv">1</span>]}, <span class="dt">error=</span><span class="cf">function</span>(e){<span class="ot">NA</span>}))</span>
<span id="cb495-15"><a href="whole-genome-sequencing-mutations.html#cb495-15"></a>TotTabl<span class="op">$</span>Size=Cdata<span class="op">$</span>Tumor.diameter.sac.mm[lx1]</span>
<span id="cb495-16"><a href="whole-genome-sequencing-mutations.html#cb495-16"></a></span>
<span id="cb495-17"><a href="whole-genome-sequencing-mutations.html#cb495-17"></a>TotTabl=TotTabl[<span class="kw">order</span>(TotTabl<span class="op">$</span>Size, TotTabl<span class="op">$</span>val), ]</span>
<span id="cb495-18"><a href="whole-genome-sequencing-mutations.html#cb495-18"></a></span>
<span id="cb495-19"><a href="whole-genome-sequencing-mutations.html#cb495-19"></a>levelNam=<span class="kw">unique</span>(TotTabl<span class="op">$</span>nam2)</span>
<span id="cb495-20"><a href="whole-genome-sequencing-mutations.html#cb495-20"></a></span>
<span id="cb495-21"><a href="whole-genome-sequencing-mutations.html#cb495-21"></a>TotTabl<span class="op">$</span>nam2=<span class="kw">factor</span>(TotTabl<span class="op">$</span>nam2, <span class="dt">levels=</span>levelNam)</span>
<span id="cb495-22"><a href="whole-genome-sequencing-mutations.html#cb495-22"></a><span class="co">##pdf(sprintf(&quot;rslt/WGS/coding_mutation_types_%s.pdf&quot;, Sys.Date()), height=6, width=9)</span></span>
<span id="cb495-23"><a href="whole-genome-sequencing-mutations.html#cb495-23"></a><span class="co">#pdf(&quot;~/Desktop/No_mutations_VAFncount_adjusted_TMB.pdf&quot;, height = 5, width=7)</span></span>
<span id="cb495-24"><a href="whole-genome-sequencing-mutations.html#cb495-24"></a><span class="kw">ggplot</span>(TotTabl, <span class="kw">aes</span>(<span class="dt">x=</span>nam2, <span class="dt">y=</span>val<span class="op">/</span><span class="fl">43.423804</span>, <span class="dt">fill=</span>variant))<span class="op">+</span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="op">+</span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="kw">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;Set1&quot;</span>)))<span class="op">+</span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>))<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Number of coding mutations/Mb&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;sorted by increasing tumor size at sac&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:1i"></span>
<img src="RatDCIS-bookdown_files/figure-html/1i-1.png" alt="summary of mutation burden" width="672" />
<p class="caption">
Figure 21.4: summary of mutation burden
</p>
</div>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="whole-genome-sequencing-mutations.html#cb496-1"></a><span class="co">#dev.off()</span></span>
<span id="cb496-2"><a href="whole-genome-sequencing-mutations.html#cb496-2"></a></span>
<span id="cb496-3"><a href="whole-genome-sequencing-mutations.html#cb496-3"></a><span class="co">#write.csv(TotTabl, file=&quot;nature-tables/1i.csv&quot;)</span></span>
<span id="cb496-4"><a href="whole-genome-sequencing-mutations.html#cb496-4"></a>DT<span class="op">::</span><span class="kw">datatable</span>(TotTabl, <span class="dt">rownames=</span>F, <span class="dt">class=</span><span class="st">&#39;cell-border stripe&#39;</span>,</span>
<span id="cb496-5"><a href="whole-genome-sequencing-mutations.html#cb496-5"></a>          <span class="dt">extensions=</span><span class="st">&quot;Buttons&quot;</span>, <span class="dt">options=</span><span class="kw">list</span>(<span class="dt">dom=</span><span class="st">&quot;Bfrtip&quot;</span>, <span class="dt">buttons=</span><span class="kw">c</span>(<span class="st">&#39;csv&#39;</span>, <span class="st">&#39;excel&#39;</span>)))</span></code></pre></div>
<div class="figure"><span id="fig:1i"></span>
<div id="htmlwidget-11d7dbff1d95b0151d7a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-11d7dbff1d95b0151d7a">{"x":{"filter":"none","extensions":["Buttons"],"data":[[1,1,3,6,6,10,10,14,16,16,437,561,1,4,8,11,14,518,1,2,2,3,7,9,10,11,12,14,15,18,21,22,26,465,543,758,0,4,8,14,16,508,0,2,4,4,9,10,12,13,15,16,475,579,2,3,7,29,29,681,1,1,1,1,2,2,2,2,2,3,4,4,4,4,4,5,5,5,5,5,6,6,6,8,9,9,10,10,12,13,13,16,20,21,32,318,379,386,447,476,499,777,1,2,9,18,18,531,1,4,9,13,27,621,1,3,9,16,21,637,2,2,4,4,4,6,7,8,13,14,307,445,1,3,7,8,11,378,1,1,2,6,6,7,7,7,10,10,11,12,16,16,16,476,531,549,1,2,5,9,9,399,2,10,13,17,19,522,2,2,2,4,6,9,10,13,17,17,475,674,2,7,10,12,15,466],["C2R3-tumor","NMU5-tumor-LA","C2R3-tumor","C2R3-tumor","NMU5-tumor-LA","C2R3-tumor","NMU5-tumor-LA","NMU5-tumor-LA","C2R3-tumor","NMU5-tumor-LA","C2R3-tumor","NMU5-tumor-LA","NMU9-tumor-LL","NMU9-tumor-LL","NMU9-tumor-LL","NMU9-tumor-LL","NMU9-tumor-LL","NMU9-tumor-LL","C1R-tumor","NMU12-tumor-RL","NMU14-tumor","NMU12-tumor-RL","C1R-tumor","NMU12-tumor-RL","NMU14-tumor","C1R-tumor","NMU14-tumor","NMU14-tumor","C1R-tumor","NMU14-tumor","C1R-tumor","NMU12-tumor-RL","NMU12-tumor-RL","NMU14-tumor","C1R-tumor","NMU12-tumor-RL","NMU13-tumor-RLL","NMU13-tumor-RLL","NMU13-tumor-RLL","NMU13-tumor-RLL","NMU13-tumor-RLL","NMU13-tumor-RLL","NMU13-tumor-LAL","NMU13-tumor-RAU","NMU13-tumor-LAL","NMU13-tumor-RAU","NMU13-tumor-LAL","NMU13-tumor-LAL","NMU13-tumor-RAU","NMU13-tumor-RAU","NMU13-tumor-RAU","NMU13-tumor-LAL","NMU13-tumor-LAL","NMU13-tumor-RAU","D16N-tumor","D16N-tumor","D16N-tumor","D16N-tumor","D16N-tumor","D16N-tumor","C2R2-tumor","D2N-tumor","D3N-tumor","NMU1-tumor","D16N2-tumor","D16P-tumor","D2N-tumor","NMU2-tumor","NMU2-tumor","NMU1-tumor","C2R2-tumor","D16N2-tumor","D16P-tumor","D2N-tumor","D3N-tumor","C2R2-tumor","C2R2-tumor","D16P-tumor","D3N-tumor","NMU2-tumor","C2R2-tumor","D16N2-tumor","D3N-tumor","D16P-tumor","D16P-tumor","NMU2-tumor","D3N-tumor","NMU2-tumor","D16N2-tumor","D2N-tumor","NMU1-tumor","D16N2-tumor","D2N-tumor","NMU1-tumor","NMU1-tumor","C2R2-tumor","D16P-tumor","NMU2-tumor","D16N2-tumor","D3N-tumor","D2N-tumor","NMU1-tumor","NMU12-tumor-LA","NMU12-tumor-LA","NMU12-tumor-LA","NMU12-tumor-LA","NMU12-tumor-LA","NMU12-tumor-LA","D14R-tumor","D14R-tumor","D14R-tumor","D14R-tumor","D14R-tumor","D14R-tumor","D11N-tumor","D11N-tumor","D11N-tumor","D11N-tumor","D11N-tumor","D11N-tumor","D16N3-tumor","D9R-tumor","D16N3-tumor","D9R-tumor","D9R-tumor","D9R-tumor","D9R-tumor","D16N3-tumor","D16N3-tumor","D16N3-tumor","D9R-tumor","D16N3-tumor","C2N-tumor","C2N-tumor","C2N-tumor","C2N-tumor","C2N-tumor","C2N-tumor","D9N1-tumor","D9N2-tumor","D3R-tumor","D9N1-tumor","D9N1-tumor","D3R-tumor","D9N2-tumor","D9N2-tumor","D3R-tumor","D9N2-tumor","D3R-tumor","D9N1-tumor","D3R-tumor","D9N1-tumor","D9N2-tumor","D9N2-tumor","D3R-tumor","D9N1-tumor","C2R1-tumor","C2R1-tumor","C2R1-tumor","C2R1-tumor","C2R1-tumor","C2R1-tumor","C4P-tumor","C4P-tumor","C4P-tumor","C4P-tumor","C4P-tumor","C4P-tumor","D17N-tumor","D18N-tumor","D18N-tumor","D17N-tumor","D18N-tumor","D17N-tumor","D18N-tumor","D18N-tumor","D17N-tumor","D17N-tumor","D18N-tumor","D17N-tumor","D4R-tumor","D4R-tumor","D4R-tumor","D4R-tumor","D4R-tumor","D4R-tumor"],["Nonstop_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Frame_Shift_Del","Frame_Shift_Ins","Splice_Site","Frame_Shift_Del","Nonsense_Mutation","Nonsense_Mutation","Splice_Site","Missense_Mutation","Missense_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Frame_Shift_Del","Nonsense_Mutation","Splice_Site","Missense_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Nonstop_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Frame_Shift_Del","Frame_Shift_Ins","Frame_Shift_Del","Frame_Shift_Del","Splice_Site","Nonsense_Mutation","Nonsense_Mutation","Splice_Site","Nonsense_Mutation","Splice_Site","Missense_Mutation","Missense_Mutation","Missense_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Frame_Shift_Del","Nonsense_Mutation","Splice_Site","Missense_Mutation","Nonstop_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Frame_Shift_Ins","Frame_Shift_Del","Splice_Site","Frame_Shift_Del","Nonsense_Mutation","Splice_Site","Nonsense_Mutation","Missense_Mutation","Missense_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Frame_Shift_Del","Splice_Site","Nonsense_Mutation","Missense_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Nonstop_Mutation","Nonstop_Mutation","Nonstop_Mutation","Nonstop_Mutation","Nonstop_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Frame_Shift_Ins","Frame_Shift_Ins","Frame_Shift_Ins","Frame_Shift_Ins","Frame_Shift_Del","Frame_Shift_Ins","Splice_Site","Nonsense_Mutation","Nonsense_Mutation","Nonsense_Mutation","Nonsense_Mutation","Frame_Shift_Del","Frame_Shift_Del","Frame_Shift_Del","Splice_Site","Frame_Shift_Del","Frame_Shift_Del","Splice_Site","Splice_Site","Nonsense_Mutation","Nonsense_Mutation","Frame_Shift_Del","Splice_Site","Splice_Site","Nonsense_Mutation","Splice_Site","Missense_Mutation","Missense_Mutation","Missense_Mutation","Missense_Mutation","Missense_Mutation","Missense_Mutation","Missense_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Frame_Shift_Del","Splice_Site","Nonsense_Mutation","Missense_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Frame_Shift_Del","Nonsense_Mutation","Splice_Site","Missense_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Frame_Shift_Del","Splice_Site","Nonsense_Mutation","Missense_Mutation","Nonstop_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Splice_Site","Frame_Shift_Del","Frame_Shift_Ins","Nonsense_Mutation","Frame_Shift_Del","Splice_Site","Nonsense_Mutation","Missense_Mutation","Missense_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Nonsense_Mutation","Splice_Site","Frame_Shift_Del","Missense_Mutation","Nonstop_Mutation","Nonstop_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Frame_Shift_Del","Frame_Shift_Ins","Frame_Shift_Ins","Frame_Shift_Del","Frame_Shift_Del","Splice_Site","Nonsense_Mutation","Splice_Site","Splice_Site","Nonsense_Mutation","Nonsense_Mutation","Missense_Mutation","Missense_Mutation","Missense_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Frame_Shift_Del","Splice_Site","Nonsense_Mutation","Missense_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Nonsense_Mutation","Frame_Shift_Del","Splice_Site","Missense_Mutation","Nonstop_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Frame_Shift_Ins","Frame_Shift_Del","Frame_Shift_Del","Nonsense_Mutation","Splice_Site","Splice_Site","Nonsense_Mutation","Missense_Mutation","Missense_Mutation","Nonstop_Mutation","Frame_Shift_Ins","Frame_Shift_Del","Nonsense_Mutation","Splice_Site","Missense_Mutation"],["C3T3","C15T1","C3T3","C3T3","C15T1","C3T3","C15T1","C15T1","C3T3","C15T1","C3T3","C15T1","C19T1","C19T1","C19T1","C19T1","C19T1","C19T1","C1T1","C9T2","C11T1","C9T2","C1T1","C9T2","C11T1","C1T1","C11T1","C11T1","C1T1","C11T1","C1T1","C9T2","C9T2","C11T1","C1T1","C9T2","C10T7","C10T7","C10T7","C10T7","C10T7","C10T7","C10T1","C10T6","C10T1","C10T6","C10T1","C10T1","C10T6","C10T6","C10T6","C10T1","C10T1","C10T6","C22T1","C22T1","C22T1","C22T1","C22T1","C22T1","C3T2","C26T1","C27T1","C6T1","C22T2","C23T1","C26T1","C12T1","C12T1","C6T1","C3T2","C22T2","C23T1","C26T1","C27T1","C3T2","C3T2","C23T1","C27T1","C12T1","C3T2","C22T2","C27T1","C23T1","C23T1","C12T1","C27T1","C12T1","C22T2","C26T1","C6T1","C22T2","C26T1","C6T1","C6T1","C3T2","C23T1","C12T1","C22T2","C27T1","C26T1","C6T1","C9T1","C9T1","C9T1","C9T1","C9T1","C9T1","C21T1","C21T1","C21T1","C21T1","C21T1","C21T1","C20T1","C20T1","C20T1","C20T1","C20T1","C20T1","C22T3","C31T1","C22T3","C31T1","C31T1","C31T1","C31T1","C22T3","C22T3","C22T3","C31T1","C22T3","C2T1","C2T1","C2T1","C2T1","C2T1","C2T1","C30T2","C30T3","C28T1","C30T2","C30T2","C28T1","C30T3","C30T3","C28T1","C30T3","C28T1","C30T2","C28T1","C30T2","C30T3","C30T3","C28T1","C30T2","C3T1","C3T1","C3T1","C3T1","C3T1","C3T1","C4T1","C4T1","C4T1","C4T1","C4T1","C4T1","C24T1","C25T1","C25T1","C24T1","C25T1","C24T1","C25T1","C25T1","C24T1","C24T1","C25T1","C24T1","C29T1","C29T1","C29T1","C29T1","C29T1","C29T1"],[3,3,3,3,3,3,3,3,3,3,3,3,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,13,13,13,13,13,13,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,25,25,25,25,25,25,30,30,30,30,30,30,30,30,30,30,30,30,40,40,40,40,40,40]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th>val<\/th>\n      <th>nam<\/th>\n      <th>variant<\/th>\n      <th>nam2<\/th>\n      <th>Size<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["csv","excel"],"columnDefs":[{"className":"dt-right","targets":[0,4]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 21.4: summary of mutation burden
</p>
</div>
<p>We can also see whether any of these correlate with size, but didn’t find associations as shown below:</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="whole-genome-sequencing-mutations.html#cb497-1"></a>ax1=<span class="kw">lapply</span>(<span class="kw">sort</span>(SearchVars), <span class="cf">function</span>(x) <span class="kw">cor.test</span>(TotTabl[TotTabl<span class="op">$</span>variant<span class="op">==</span>x , <span class="st">&quot;val&quot;</span>], TotTabl[TotTabl<span class="op">$</span>variant<span class="op">==</span>x ,  <span class="st">&quot;Size&quot;</span>], <span class="dt">use=</span><span class="st">&quot;complete&quot;</span>, <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>)) </span>
<span id="cb497-2"><a href="whole-genome-sequencing-mutations.html#cb497-2"></a>pvals=<span class="kw">sapply</span>(ax1, <span class="cf">function</span>(x) x<span class="op">$</span>p.value)</span>
<span id="cb497-3"><a href="whole-genome-sequencing-mutations.html#cb497-3"></a>cors=<span class="kw">sapply</span>(ax1, <span class="cf">function</span>(x) x<span class="op">$</span>estimate)</span>
<span id="cb497-4"><a href="whole-genome-sequencing-mutations.html#cb497-4"></a></span>
<span id="cb497-5"><a href="whole-genome-sequencing-mutations.html#cb497-5"></a>ann_text2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">lab=</span><span class="kw">paste</span>(<span class="st">&quot;cor=&quot;</span>, <span class="kw">round</span>(cors, <span class="dv">2</span>),<span class="st">&quot;p=&quot;</span>, <span class="kw">round</span>(pvals,<span class="dv">2</span>),<span class="dt">sep=</span><span class="st">&quot;&quot;</span>), <span class="dt">variant=</span><span class="kw">sort</span>(SearchVars),  <span class="dt">val=</span><span class="dv">1</span>, <span class="dt">Size=</span><span class="dv">5</span>)</span>
<span id="cb497-6"><a href="whole-genome-sequencing-mutations.html#cb497-6"></a></span>
<span id="cb497-7"><a href="whole-genome-sequencing-mutations.html#cb497-7"></a><span class="kw">ggplot</span>(TotTabl, <span class="kw">aes</span>(<span class="dt">x=</span>Size, <span class="dt">y=</span>val, <span class="dt">col=</span>variant))<span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span><span class="kw">facet_wrap</span>(<span class="op">~</span>variant, <span class="dt">scale=</span><span class="st">&quot;free&quot;</span>)<span class="op">+</span><span class="kw">geom_text</span>(<span class="dt">data=</span>ann_text2, <span class="kw">aes</span>(<span class="dt">label=</span>lab))</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="whole-genome-sequencing-mutations.html#cb498-1"></a></span>
<span id="cb498-2"><a href="whole-genome-sequencing-mutations.html#cb498-2"></a><span class="co">#dev.off()</span></span>
<span id="cb498-3"><a href="whole-genome-sequencing-mutations.html#cb498-3"></a><span class="co">#MeltWGSCoding=melt(AllMutWGScoding, measure.vars=c(&quot;Tumor_Sample_Barcode&quot;))</span></span></code></pre></div>
</div>
<div id="coding-variants-tmb" class="section level3">
<h3><span class="header-section-number">21.3.2</span> Coding variants &amp; TMB</h3>
<p>There are a few ways of figuring out the TMB. We can</p>
<ul>
<li>report the number of mutations (missense, insertion/deletion, frameshifts, nonsense)</li>
<li>normalise the above value to the known length of coding regions in the rat genome (UCSC exon length 43,423,804)</li>
<li>plot of TMB vs objective response rate: there is no true relationship between final tumor size and mutational burden. Could also be confounded by subclonality</li>
</ul>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="whole-genome-sequencing-mutations.html#cb499-1"></a>searchThese=<span class="kw">c</span>(<span class="st">&quot;Missense_Mutation&quot;</span>, <span class="st">&quot;Nonsense_Mutation&quot;</span>, <span class="st">&quot;Frame_Shift_Del&quot;</span>, <span class="st">&quot;Frame_Shift_Ins&quot;</span>, <span class="st">&quot;Nonstop_Mutation&quot;</span>)</span>
<span id="cb499-2"><a href="whole-genome-sequencing-mutations.html#cb499-2"></a>NVar2=TotTabl[TotTabl<span class="op">$</span>variant<span class="op">%in%</span>searchThese, ]</span>
<span id="cb499-3"><a href="whole-genome-sequencing-mutations.html#cb499-3"></a>Ntot=<span class="kw">by</span>(NVar2<span class="op">$</span>val, NVar2<span class="op">$</span>nam, sum)</span>
<span id="cb499-4"><a href="whole-genome-sequencing-mutations.html#cb499-4"></a><span class="co"># check this is unique based on the location</span></span>
<span id="cb499-5"><a href="whole-genome-sequencing-mutations.html#cb499-5"></a>Ntot2=<span class="kw">stack</span>(Ntot)</span>
<span id="cb499-6"><a href="whole-genome-sequencing-mutations.html#cb499-6"></a><span class="kw">colnames</span>(Ntot2)[<span class="dv">1</span>]=<span class="st">&quot;NCodingMut&quot;</span></span>
<span id="cb499-7"><a href="whole-genome-sequencing-mutations.html#cb499-7"></a>Ntot2<span class="op">$</span>TMB=Ntot2<span class="op">$</span>NCodingMut<span class="op">/</span><span class="fl">43.423804</span></span>
<span id="cb499-8"><a href="whole-genome-sequencing-mutations.html#cb499-8"></a>TotMut=<span class="kw">sapply</span>(AllMutWGS, nrow)</span>
<span id="cb499-9"><a href="whole-genome-sequencing-mutations.html#cb499-9"></a>Ntot2<span class="op">$</span>TotalMut=TotMut[<span class="kw">match</span>(Ntot2<span class="op">$</span>ind, <span class="kw">names</span>(TotMut))]</span>
<span id="cb499-10"><a href="whole-genome-sequencing-mutations.html#cb499-10"></a>Ntot2<span class="op">$</span>Tum.size=TotTabl<span class="op">$</span>Size[<span class="kw">match</span>(Ntot2<span class="op">$</span>ind, TotTabl<span class="op">$</span>nam)]</span>
<span id="cb499-11"><a href="whole-genome-sequencing-mutations.html#cb499-11"></a>Ntot2=Ntot2[<span class="kw">order</span>(Ntot2<span class="op">$</span>Tum.size), ]</span>
<span id="cb499-12"><a href="whole-genome-sequencing-mutations.html#cb499-12"></a><span class="co">#Ntot2$normCov=Ntot2$values/43.423804</span></span>
<span id="cb499-13"><a href="whole-genome-sequencing-mutations.html#cb499-13"></a></span>
<span id="cb499-14"><a href="whole-genome-sequencing-mutations.html#cb499-14"></a>Ntot2<span class="op">$</span>NsynFreq=Ntot2<span class="op">$</span>NCodingMut<span class="op">/</span>Ntot2<span class="op">$</span>TotalMut</span>
<span id="cb499-15"><a href="whole-genome-sequencing-mutations.html#cb499-15"></a>Ntot2<span class="op">$</span>ID2=<span class="kw">sapply</span>(Ntot2<span class="op">$</span>ind, <span class="cf">function</span>(x) Cdata<span class="op">$</span>NewID[<span class="kw">grep</span>(x, Cdata<span class="op">$</span>WGS)])</span>
<span id="cb499-16"><a href="whole-genome-sequencing-mutations.html#cb499-16"></a>Ntot2=Ntot2[<span class="kw">order</span>(Ntot2<span class="op">$</span>Tum.size), ]</span>
<span id="cb499-17"><a href="whole-genome-sequencing-mutations.html#cb499-17"></a></span>
<span id="cb499-18"><a href="whole-genome-sequencing-mutations.html#cb499-18"></a>IDfact=Ntot2<span class="op">$</span>ID2</span>
<span id="cb499-19"><a href="whole-genome-sequencing-mutations.html#cb499-19"></a>Ntot2<span class="op">$</span>cohort=Cdata<span class="op">$</span>Char.Cohort.Batch[<span class="kw">match</span>(Ntot2<span class="op">$</span>ID2, Cdata<span class="op">$</span>NewID)]</span>
<span id="cb499-20"><a href="whole-genome-sequencing-mutations.html#cb499-20"></a></span>
<span id="cb499-21"><a href="whole-genome-sequencing-mutations.html#cb499-21"></a></span>
<span id="cb499-22"><a href="whole-genome-sequencing-mutations.html#cb499-22"></a>Ntot2melt=<span class="kw">melt</span>(Ntot2)</span>
<span id="cb499-23"><a href="whole-genome-sequencing-mutations.html#cb499-23"></a>Ntot2melt<span class="op">$</span>ID2=<span class="kw">factor</span>(Ntot2melt<span class="op">$</span>ID2, <span class="dt">levels=</span>IDfact)</span>
<span id="cb499-24"><a href="whole-genome-sequencing-mutations.html#cb499-24"></a></span>
<span id="cb499-25"><a href="whole-genome-sequencing-mutations.html#cb499-25"></a><span class="co">#pdf(sprintf(&quot;~/Desktop/frequency_mutational_types_VAF_ncount#2_%s.pdf&quot;, Sys.Date()), height=10, width=6)</span></span>
<span id="cb499-26"><a href="whole-genome-sequencing-mutations.html#cb499-26"></a><span class="kw">ggplot</span>(Ntot2melt, <span class="kw">aes</span>(<span class="dt">x=</span>ID2, <span class="dt">y=</span>value, <span class="dt">col=</span>variable))<span class="op">+</span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="op">+</span><span class="kw">facet_grid</span>(variable<span class="op">~</span>., <span class="dt">scale=</span><span class="st">&quot;free_y&quot;</span>)<span class="op">+</span></span>
<span id="cb499-27"><a href="whole-genome-sequencing-mutations.html#cb499-27"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>))</span></code></pre></div>
<div class="figure"><span id="fig:1ib"></span>
<img src="RatDCIS-bookdown_files/figure-html/1ib-1.png" alt="summary of mutational burden?" width="672" />
<p class="caption">
Figure 21.5: summary of mutational burden?
</p>
</div>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="whole-genome-sequencing-mutations.html#cb500-1"></a><span class="co">#dev.off()</span></span>
<span id="cb500-2"><a href="whole-genome-sequencing-mutations.html#cb500-2"></a><span class="kw">write.csv</span>(Ntot2melt, <span class="dt">file=</span><span class="st">&quot;nature-tables/1i_maybe.csv&quot;</span>)</span>
<span id="cb500-3"><a href="whole-genome-sequencing-mutations.html#cb500-3"></a><span class="co">## As a metric for TMB, comapre the number of mutations to the covered genome</span></span></code></pre></div>
<p>Calculate whether there is an association of TMB with cohort type:</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="whole-genome-sequencing-mutations.html#cb501-1"></a>Ntot2melt<span class="op">$</span>size2=Cdata<span class="op">$</span>Tumor.diameter.sac.mm[<span class="kw">match</span>(Ntot2melt<span class="op">$</span>ID2, Cdata<span class="op">$</span>NewID)]</span>
<span id="cb501-2"><a href="whole-genome-sequencing-mutations.html#cb501-2"></a></span>
<span id="cb501-3"><a href="whole-genome-sequencing-mutations.html#cb501-3"></a>ax1=<span class="kw">lapply</span>(<span class="kw">sort</span>(SearchVars), <span class="cf">function</span>(x) <span class="kw">cor.test</span>(TotTabl[TotTabl<span class="op">$</span>variant<span class="op">==</span>x , <span class="st">&quot;val&quot;</span>], TotTabl[TotTabl<span class="op">$</span>variant<span class="op">==</span>x ,  <span class="st">&quot;Size&quot;</span>], <span class="dt">use=</span><span class="st">&quot;complete&quot;</span>, <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>)) </span>
<span id="cb501-4"><a href="whole-genome-sequencing-mutations.html#cb501-4"></a>pvals=<span class="kw">sapply</span>(ax1, <span class="cf">function</span>(x) x<span class="op">$</span>p.value)</span>
<span id="cb501-5"><a href="whole-genome-sequencing-mutations.html#cb501-5"></a>cors=<span class="kw">sapply</span>(ax1, <span class="cf">function</span>(x) x<span class="op">$</span>estimate)</span>
<span id="cb501-6"><a href="whole-genome-sequencing-mutations.html#cb501-6"></a></span>
<span id="cb501-7"><a href="whole-genome-sequencing-mutations.html#cb501-7"></a><span class="co">## FIGURE OUT WHAT&quot;S WRONG</span></span>
<span id="cb501-8"><a href="whole-genome-sequencing-mutations.html#cb501-8"></a><span class="co"># # p value calculation: figure out the latency and penetrance</span></span>
<span id="cb501-9"><a href="whole-genome-sequencing-mutations.html#cb501-9"></a><span class="co"># pvalOutputs=sapply(c(&quot;NCodingMut&quot;, &quot;TMB&quot;, &quot;TotalMut&quot;,&quot;Tum.size&quot;,</span></span>
<span id="cb501-10"><a href="whole-genome-sequencing-mutations.html#cb501-10"></a><span class="co">#                      &quot;NsynFreq&quot;) , function(x) t.test(Ntot2[ Ntot2$cohort!=&quot;cohort-2&quot;,x]~ Ntot2$cohort[Ntot2$cohort!=&quot;cohort-2&quot;])$p.value)</span></span>
<span id="cb501-11"><a href="whole-genome-sequencing-mutations.html#cb501-11"></a><span class="co"># # cohort size calculation</span></span>
<span id="cb501-12"><a href="whole-genome-sequencing-mutations.html#cb501-12"></a><span class="co"># corOutputs=sapply(c(&quot;NCodingMut&quot;, &quot;TMB&quot;, &quot;TotalMut&quot;,</span></span>
<span id="cb501-13"><a href="whole-genome-sequencing-mutations.html#cb501-13"></a><span class="co">#                      &quot;NsynFreq&quot;) , function(x) cor.test(Ntot2[ ,x], Ntot2$Tum.size)$p.value)</span></span>
<span id="cb501-14"><a href="whole-genome-sequencing-mutations.html#cb501-14"></a><span class="co"># ann_text2 &lt;- data.frame(lab=paste(&quot;p=&quot;, round(pvalOutputs, 2)), val=1, Size=5, cohort=&quot;latency-4&quot;,</span></span>
<span id="cb501-15"><a href="whole-genome-sequencing-mutations.html#cb501-15"></a><span class="co">#                         variable=c(&quot;NCodingMut&quot;, &quot;TMB&quot;, &quot;TotalMut&quot;, &quot;Tum.size&quot;,&quot;NsynFreq&quot;))</span></span>
<span id="cb501-16"><a href="whole-genome-sequencing-mutations.html#cb501-16"></a></span>
<span id="cb501-17"><a href="whole-genome-sequencing-mutations.html#cb501-17"></a><span class="kw">ggplot</span>(Ntot2melt, <span class="kw">aes</span>(<span class="dt">x=</span>cohort, <span class="dt">y=</span>value, <span class="dt">col=</span>cohort))<span class="op">+</span><span class="kw">geom_boxplot</span>()<span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span><span class="kw">facet_wrap</span>(<span class="op">~</span>variable, <span class="dt">scale=</span><span class="st">&quot;free_y&quot;</span>)<span class="op">+</span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>))<span class="co">#+geom_text(data=ann_text2, aes(label=lab, x=1, y=0))</span></span></code></pre></div>
<div class="figure"><span id="fig:Ext1h"></span>
<img src="RatDCIS-bookdown_files/figure-html/Ext1h-1.png" alt="assoc of mutations with cohort" width="672" />
<p class="caption">
Figure 21.6: assoc of mutations with cohort
</p>
</div>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="whole-genome-sequencing-mutations.html#cb502-1"></a><span class="co"># ann_text2 &lt;- data.frame(lab=paste(&quot;p=&quot;, round(corOutputs, 2)), val=1, Size=5, cohort=&quot;latency-4&quot;,</span></span>
<span id="cb502-2"><a href="whole-genome-sequencing-mutations.html#cb502-2"></a><span class="co">#                         variable=c(&quot;NCodingMut&quot;, &quot;TMB&quot;, &quot;TotalMut&quot;,</span></span>
<span id="cb502-3"><a href="whole-genome-sequencing-mutations.html#cb502-3"></a><span class="co">#                      &quot;NsynFreq&quot;))</span></span>
<span id="cb502-4"><a href="whole-genome-sequencing-mutations.html#cb502-4"></a></span>
<span id="cb502-5"><a href="whole-genome-sequencing-mutations.html#cb502-5"></a><span class="kw">ggplot</span>(Ntot2melt, <span class="kw">aes</span>(<span class="dt">x=</span>size2, <span class="dt">y=</span>value, <span class="dt">col=</span>cohort))<span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span><span class="kw">facet_wrap</span>(<span class="op">~</span>variable, <span class="dt">scale=</span><span class="st">&quot;free_y&quot;</span>)<span class="op">+</span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>))<span class="co">#+geom_text(data=ann_text2, aes(label=lab, x=10, y=0))</span></span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-143-1.png" width="672" /></p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="whole-genome-sequencing-mutations.html#cb503-1"></a><span class="co">#dev.off()</span></span>
<span id="cb503-2"><a href="whole-genome-sequencing-mutations.html#cb503-2"></a></span>
<span id="cb503-3"><a href="whole-genome-sequencing-mutations.html#cb503-3"></a><span class="kw">write.csv</span>(Ntot2melt, <span class="dt">file =</span> <span class="st">&quot;nature-tables/Ext1h-i.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="whole-genome-sequencing-mutations.html#cb504-1"></a><span class="co"># To obtain an idea of the coverage:</span></span>
<span id="cb504-2"><a href="whole-genome-sequencing-mutations.html#cb504-2"></a>Using bedtools and samtools</span>
<span id="cb504-3"><a href="whole-genome-sequencing-mutations.html#cb504-3"></a>here, counting only <span class="st">&quot;propoet pairs&quot;</span> with maping quality greater than <span class="dv">30</span></span>
<span id="cb504-4"><a href="whole-genome-sequencing-mutations.html#cb504-4"></a><span class="kw">see</span> (https<span class="op">:</span><span class="er">//</span>www.biostars.org<span class="op">/</span>p<span class="op">/</span><span class="dv">11105</span><span class="op">/</span>)</span>
<span id="cb504-5"><a href="whole-genome-sequencing-mutations.html#cb504-5"></a>samtools view <span class="op">-</span>u <span class="op">-</span>q <span class="dv">30</span> <span class="op">-</span>f <span class="dv">0x2</span> aln.bam <span class="op">|</span><span class="st"> </span>coverageBed <span class="op">-</span>abam stdin <span class="op">-</span>b exons.bed <span class="op">&gt;</span><span class="st"> </span>exons.bed.proper.q30.coverage</span></code></pre></div>
</div>
</div>
<div id="comparison-with-rat-mutational-datasets" class="section level2">
<h2><span class="header-section-number">21.4</span> Comparison with rat mutational datasets</h2>
<div id="sites-which-are-commonly-mutated" class="section level3">
<h3><span class="header-section-number">21.4.1</span> Sites which are commonly mutated?</h3>
<p>Could this be a variant (SD strain “rsSNP”) or is it actually a mutation?</p>
<p>Variants were annotated with snpeff. Raw data from this was obtained from <a href="https://www.biorxiv.org/content/10.1101/412924v1.full" class="uri">https://www.biorxiv.org/content/10.1101/412924v1.full</a></p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="whole-genome-sequencing-mutations.html#cb505-1"></a></span>
<span id="cb505-2"><a href="whole-genome-sequencing-mutations.html#cb505-2"></a>harlanRats=<span class="kw">read.vcfR</span>(<span class="st">&quot;~/Desktop/carlos_study_files/allChr.allSamps.90DR2.maf01.hweE7.noIBD.HarlanOnly.vcf.gz&quot;</span>)</span>
<span id="cb505-3"><a href="whole-genome-sequencing-mutations.html#cb505-3"></a>harlanRats<span class="op">@</span>fix[ ,<span class="dv">1</span>]=<span class="kw">paste</span>(<span class="st">&quot;chr&quot;</span>, harlanRats<span class="op">@</span>fix[ ,<span class="dv">1</span>], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb505-4"><a href="whole-genome-sequencing-mutations.html#cb505-4"></a>harlanRats<span class="op">@</span>fix[ ,<span class="dv">3</span>]=<span class="kw">paste</span>(<span class="st">&quot;H&quot;</span>, harlanRats<span class="op">@</span>fix[ ,<span class="dv">3</span>], <span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)</span>
<span id="cb505-5"><a href="whole-genome-sequencing-mutations.html#cb505-5"></a>harlanRats<span class="op">@</span>meta=harlanRats<span class="op">@</span>meta[<span class="op">-</span><span class="kw">grep</span>(<span class="st">&quot;##contig&quot;</span>,harlanRats<span class="op">@</span>meta )]</span>
<span id="cb505-6"><a href="whole-genome-sequencing-mutations.html#cb505-6"></a></span>
<span id="cb505-7"><a href="whole-genome-sequencing-mutations.html#cb505-7"></a><span class="co"># figure out the genotype distribution</span></span>
<span id="cb505-8"><a href="whole-genome-sequencing-mutations.html#cb505-8"></a>GT=<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(harlanRats<span class="op">@</span>gt), <span class="cf">function</span>(x) </span>
<span id="cb505-9"><a href="whole-genome-sequencing-mutations.html#cb505-9"></a>  <span class="kw">table</span>(<span class="kw">factor</span>(harlanRats<span class="op">@</span>gt[x, <span class="dv">-1</span>],<span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;0/0&quot;</span>,<span class="st">&quot;0/1&quot;</span>,<span class="st">&quot;1/1&quot;</span>))))</span>
<span id="cb505-10"><a href="whole-genome-sequencing-mutations.html#cb505-10"></a>GT2=<span class="kw">paste</span>(GT[<span class="dv">1</span>, ], GT[<span class="dv">2</span>, ], GT[<span class="dv">3</span>, ], <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)</span>
<span id="cb505-11"><a href="whole-genome-sequencing-mutations.html#cb505-11"></a>GT3=<span class="kw">paste</span>(GT[<span class="dv">1</span>, ]<span class="op">/</span><span class="dv">2281</span>, GT[<span class="dv">2</span>, ]<span class="op">/</span><span class="dv">2281</span>, GT[<span class="dv">3</span>, ]<span class="op">/</span><span class="dv">2281</span>, <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)</span>
<span id="cb505-12"><a href="whole-genome-sequencing-mutations.html#cb505-12"></a></span>
<span id="cb505-13"><a href="whole-genome-sequencing-mutations.html#cb505-13"></a>GenotypeS=<span class="kw">cbind</span>(<span class="dt">FORMAT=</span><span class="st">&quot;GT&quot;</span>, <span class="dt">Annot=</span><span class="kw">c</span>(<span class="st">&quot;0/0,0/1,1/1&quot;</span>), GT2, GT3 )</span>
<span id="cb505-14"><a href="whole-genome-sequencing-mutations.html#cb505-14"></a>harlanRats<span class="op">@</span>gt=GenotypeS</span>
<span id="cb505-15"><a href="whole-genome-sequencing-mutations.html#cb505-15"></a><span class="co">## save this to file or something</span></span>
<span id="cb505-16"><a href="whole-genome-sequencing-mutations.html#cb505-16"></a><span class="kw">write.vcf</span>(harlanRats, <span class="dt">file=</span><span class="st">&quot;~/Desktop/dbSNP_info/harlan_snps_mod_1-5-2020.vcf.gz&quot;</span>)</span>
<span id="cb505-17"><a href="whole-genome-sequencing-mutations.html#cb505-17"></a></span>
<span id="cb505-18"><a href="whole-genome-sequencing-mutations.html#cb505-18"></a><span class="co"># loading the charles river rat snp sites</span></span>
<span id="cb505-19"><a href="whole-genome-sequencing-mutations.html#cb505-19"></a>CRRats=<span class="kw">read.vcfR</span>(<span class="st">&quot;~/Desktop/dbSNP_info/charles_river_200Ksnps.gz&quot;</span>)</span>
<span id="cb505-20"><a href="whole-genome-sequencing-mutations.html#cb505-20"></a>CRRats<span class="op">@</span>fix[ ,<span class="dv">1</span>]=<span class="kw">paste</span>(<span class="st">&quot;chr&quot;</span>, CRRats<span class="op">@</span>fix[ ,<span class="dv">1</span>], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb505-21"><a href="whole-genome-sequencing-mutations.html#cb505-21"></a>CRRats<span class="op">@</span>fix[ ,<span class="dv">3</span>]=<span class="kw">paste</span>(<span class="st">&quot;CR&quot;</span>, CRRats<span class="op">@</span>fix[ ,<span class="dv">3</span>], <span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)</span>
<span id="cb505-22"><a href="whole-genome-sequencing-mutations.html#cb505-22"></a>CRRats<span class="op">@</span>meta=CRRats<span class="op">@</span>meta[<span class="op">-</span><span class="kw">grep</span>(<span class="st">&quot;##contig&quot;</span>,CRRats<span class="op">@</span>meta )]</span>
<span id="cb505-23"><a href="whole-genome-sequencing-mutations.html#cb505-23"></a></span>
<span id="cb505-24"><a href="whole-genome-sequencing-mutations.html#cb505-24"></a>crGT=<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(CRRats<span class="op">@</span>gt), <span class="cf">function</span>(x) </span>
<span id="cb505-25"><a href="whole-genome-sequencing-mutations.html#cb505-25"></a>  <span class="kw">table</span>(<span class="kw">factor</span>(CRRats<span class="op">@</span>gt[x, <span class="dv">-1</span>],<span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;0/0&quot;</span>,<span class="st">&quot;0/1&quot;</span>,<span class="st">&quot;1/1&quot;</span>))))</span>
<span id="cb505-26"><a href="whole-genome-sequencing-mutations.html#cb505-26"></a>crGT2=<span class="kw">paste</span>(crGT[<span class="dv">1</span>, ], crGT[<span class="dv">2</span>, ], crGT[<span class="dv">3</span>, ], <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)</span>
<span id="cb505-27"><a href="whole-genome-sequencing-mutations.html#cb505-27"></a>crGT3=<span class="kw">paste</span>(crGT[<span class="dv">1</span>, ]<span class="op">/</span><span class="dv">1780</span>, crGT[<span class="dv">2</span>, ]<span class="op">/</span><span class="dv">1780</span>, crGT[<span class="dv">3</span>, ]<span class="op">/</span><span class="dv">1780</span>, <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)</span>
<span id="cb505-28"><a href="whole-genome-sequencing-mutations.html#cb505-28"></a>GenotypeS=<span class="kw">cbind</span>(<span class="dt">FORMAT=</span><span class="st">&quot;GT&quot;</span>, <span class="dt">Annot=</span><span class="kw">c</span>(<span class="st">&quot;0/0,0/1,1/1&quot;</span>), crGT2, crGT3 )</span>
<span id="cb505-29"><a href="whole-genome-sequencing-mutations.html#cb505-29"></a>CRRats<span class="op">@</span>gt=GenotypeS</span>
<span id="cb505-30"><a href="whole-genome-sequencing-mutations.html#cb505-30"></a><span class="kw">write.vcf</span>(CRRats, <span class="dt">file=</span><span class="st">&quot;~/Desktop/dbSNP_info/charlesRiver_snps_mod_1-5-2020.vcf.gz&quot;</span>)</span></code></pre></div>
<p>Note that the nihRats package may not be required here. We probably just want the harlan snps</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="whole-genome-sequencing-mutations.html#cb506-1"></a><span class="co"># loading known list of rat snp sites</span></span>
<span id="cb506-2"><a href="whole-genome-sequencing-mutations.html#cb506-2"></a>nihRats=<span class="kw">read.vcfR</span>(<span class="st">&quot;../anntotations/rat_10116_00-All.wchr.SDsort.vcf.gz&quot;</span>)</span>
<span id="cb506-3"><a href="whole-genome-sequencing-mutations.html#cb506-3"></a><span class="co">#nihRats@fix[ ,1]=paste(&quot;chr&quot;, nihRats@fix[ ,1], sep=&quot;&quot;)</span></span>
<span id="cb506-4"><a href="whole-genome-sequencing-mutations.html#cb506-4"></a>r=<span class="kw">regexpr</span>(<span class="st">&quot;[a-z]+_[a-z]+&quot;</span>,nihRats<span class="op">@</span>fix[ ,<span class="dv">8</span>]) <span class="co">#ANN=[A-Z]\\|</span></span>
<span id="cb506-5"><a href="whole-genome-sequencing-mutations.html#cb506-5"></a>ModType=<span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(nihRats<span class="op">@</span>fix[ ,<span class="dv">8</span>]))</span>
<span id="cb506-6"><a href="whole-genome-sequencing-mutations.html#cb506-6"></a>ModType[r<span class="op">!=-</span><span class="dv">1</span>]=<span class="kw">regmatches</span>(nihRats<span class="op">@</span>fix[ ,<span class="dv">8</span>], r)</span>
<span id="cb506-7"><a href="whole-genome-sequencing-mutations.html#cb506-7"></a><span class="co">#ModType=substr(ModType, 7, 25)</span></span>
<span id="cb506-8"><a href="whole-genome-sequencing-mutations.html#cb506-8"></a><span class="co"># Harlan samples</span></span>
<span id="cb506-9"><a href="whole-genome-sequencing-mutations.html#cb506-9"></a>harlanRats=<span class="kw">read.vcfR</span>(<span class="st">&quot;../anntotations/dbSNP/harlan_snps_mod_1-5-2020.SDsort.vcf.gz&quot;</span>)</span>
<span id="cb506-10"><a href="whole-genome-sequencing-mutations.html#cb506-10"></a></span>
<span id="cb506-11"><a href="whole-genome-sequencing-mutations.html#cb506-11"></a>GT3=crGT3=<span class="dv">1</span><span class="op">-</span><span class="kw">as.numeric</span>(<span class="kw">sapply</span>(<span class="kw">strsplit</span>(harlanRats<span class="op">@</span>gt[ ,<span class="dv">4</span>], <span class="st">&quot;,&quot;</span>), <span class="cf">function</span>(x) x[<span class="dv">1</span>]))</span>
<span id="cb506-12"><a href="whole-genome-sequencing-mutations.html#cb506-12"></a></span>
<span id="cb506-13"><a href="whole-genome-sequencing-mutations.html#cb506-13"></a>r=<span class="kw">regexpr</span>(<span class="st">&quot;ANN=[A-Z]</span><span class="ch">\\</span><span class="st">|[a-z]+_[a-z]+&quot;</span>, harlanRats<span class="op">@</span>fix[ ,<span class="dv">8</span>])</span>
<span id="cb506-14"><a href="whole-genome-sequencing-mutations.html#cb506-14"></a>HarType=<span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(harlanRats<span class="op">@</span>fix[ ,<span class="dv">8</span>]))</span>
<span id="cb506-15"><a href="whole-genome-sequencing-mutations.html#cb506-15"></a>HarType[r<span class="op">!=-</span><span class="dv">1</span>]=<span class="kw">regmatches</span>(harlanRats<span class="op">@</span>fix[ ,<span class="dv">8</span>], r)</span>
<span id="cb506-16"><a href="whole-genome-sequencing-mutations.html#cb506-16"></a>HarType=<span class="kw">substr</span>(HarType, <span class="dv">7</span>, <span class="dv">25</span>)</span>
<span id="cb506-17"><a href="whole-genome-sequencing-mutations.html#cb506-17"></a><span class="co"># charles river samples</span></span>
<span id="cb506-18"><a href="whole-genome-sequencing-mutations.html#cb506-18"></a>CRRats=<span class="kw">read.vcfR</span>(<span class="st">&quot;../anntotations/dbSNP/charlesRiver_snps_mod_1-5-2020.SDsort.vcf.gz&quot;</span>)</span>
<span id="cb506-19"><a href="whole-genome-sequencing-mutations.html#cb506-19"></a>crGT3=<span class="dv">1</span><span class="op">-</span><span class="kw">as.numeric</span>(<span class="kw">sapply</span>(<span class="kw">strsplit</span>(CRRats<span class="op">@</span>gt[ ,<span class="dv">4</span>], <span class="st">&quot;,&quot;</span>), <span class="cf">function</span>(x) x[<span class="dv">1</span>]))</span>
<span id="cb506-20"><a href="whole-genome-sequencing-mutations.html#cb506-20"></a></span>
<span id="cb506-21"><a href="whole-genome-sequencing-mutations.html#cb506-21"></a>r=<span class="kw">regexpr</span>(<span class="st">&quot;ANN=[A-Z]</span><span class="ch">\\</span><span class="st">|[a-z]+_[a-z]+&quot;</span>, CRRats<span class="op">@</span>fix[ ,<span class="dv">8</span>])</span>
<span id="cb506-22"><a href="whole-genome-sequencing-mutations.html#cb506-22"></a>CRType=<span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(CRRats<span class="op">@</span>fix[ ,<span class="dv">8</span>]))</span>
<span id="cb506-23"><a href="whole-genome-sequencing-mutations.html#cb506-23"></a>CRType[r<span class="op">!=-</span><span class="dv">1</span>]=<span class="kw">regmatches</span>(CRRats<span class="op">@</span>fix[ ,<span class="dv">8</span>], r)</span>
<span id="cb506-24"><a href="whole-genome-sequencing-mutations.html#cb506-24"></a></span>
<span id="cb506-25"><a href="whole-genome-sequencing-mutations.html#cb506-25"></a>CRType=<span class="kw">substr</span>(CRType, <span class="dv">7</span>, <span class="dv">25</span>)</span></code></pre></div>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="whole-genome-sequencing-mutations.html#cb507-1"></a><span class="co"># This is just a plot that compares the different databases.</span></span>
<span id="cb507-2"><a href="whole-genome-sequencing-mutations.html#cb507-2"></a><span class="co">## Look at the overlap between all the databases:</span></span>
<span id="cb507-3"><a href="whole-genome-sequencing-mutations.html#cb507-3"></a>NIHr=<span class="kw">paste</span>(nihRats<span class="op">@</span>fix[ ,<span class="dv">1</span>], nihRats<span class="op">@</span>fix[ ,<span class="dv">2</span>])</span>
<span id="cb507-4"><a href="whole-genome-sequencing-mutations.html#cb507-4"></a>harr=<span class="kw">paste</span>(harlanRats<span class="op">@</span>fix[ ,<span class="dv">1</span>], harlanRats<span class="op">@</span>fix[ ,<span class="dv">2</span>])</span>
<span id="cb507-5"><a href="whole-genome-sequencing-mutations.html#cb507-5"></a>crr=<span class="kw">paste</span>(CRRats<span class="op">@</span>fix[ ,<span class="dv">1</span>], CRRats<span class="op">@</span>fix[ ,<span class="dv">2</span>])</span>
<span id="cb507-6"><a href="whole-genome-sequencing-mutations.html#cb507-6"></a></span>
<span id="cb507-7"><a href="whole-genome-sequencing-mutations.html#cb507-7"></a><span class="co"># overview of the overlaps</span></span>
<span id="cb507-8"><a href="whole-genome-sequencing-mutations.html#cb507-8"></a><span class="kw">venn</span>(<span class="kw">list</span>(<span class="dt">NIH=</span>NIHr, <span class="dt">harlan=</span>harr, <span class="dt">CR=</span>crr))</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-145-1.png" width="672" /></p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="whole-genome-sequencing-mutations.html#cb508-1"></a></span>
<span id="cb508-2"><a href="whole-genome-sequencing-mutations.html#cb508-2"></a><span class="co">## Annotate the above variants for protein coding regions first, then narrow down to known </span></span>
<span id="cb508-3"><a href="whole-genome-sequencing-mutations.html#cb508-3"></a>AllLevels=<span class="kw">unique</span>(<span class="kw">c</span>(HarType, CRType, ModType))</span>
<span id="cb508-4"><a href="whole-genome-sequencing-mutations.html#cb508-4"></a>allTypes=<span class="kw">rbind</span>(<span class="kw">table</span>(<span class="kw">factor</span>(ModType, <span class="dt">levels=</span>AllLevels)), <span class="kw">table</span>(<span class="kw">factor</span>(HarType, <span class="dt">levels=</span>AllLevels)),</span>
<span id="cb508-5"><a href="whole-genome-sequencing-mutations.html#cb508-5"></a>               <span class="kw">table</span>(<span class="kw">factor</span>(CRType, <span class="dt">levels =</span> AllLevels)))</span>
<span id="cb508-6"><a href="whole-genome-sequencing-mutations.html#cb508-6"></a><span class="kw">rownames</span>(allTypes)=<span class="kw">c</span>(<span class="st">&quot;NIH&quot;</span>, <span class="st">&quot;harlan&quot;</span>, <span class="st">&quot;CR&quot;</span>)</span>
<span id="cb508-7"><a href="whole-genome-sequencing-mutations.html#cb508-7"></a>allTypesNorm=allTypes<span class="op">/</span><span class="kw">rowSums</span>(allTypes)</span>
<span id="cb508-8"><a href="whole-genome-sequencing-mutations.html#cb508-8"></a></span>
<span id="cb508-9"><a href="whole-genome-sequencing-mutations.html#cb508-9"></a>t2=<span class="kw">melt</span>(allTypesNorm)</span>
<span id="cb508-10"><a href="whole-genome-sequencing-mutations.html#cb508-10"></a><span class="kw">ggplot</span>(t2[<span class="kw">which</span>(t2<span class="op">$</span>value<span class="op">&lt;</span><span class="fl">0.04</span>),  ], <span class="kw">aes</span>(<span class="dt">x=</span>Var1, <span class="dt">y=</span>value, <span class="dt">fill=</span>Var2))<span class="op">+</span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;frequency snp type&quot;</span>)<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;dataset&quot;</span>)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-145-2.png" width="672" /></p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="whole-genome-sequencing-mutations.html#cb509-1"></a>SearchVars=<span class="kw">c</span>(<span class="st">&quot;missense_variant&quot;</span>,<span class="st">&quot;stop_lost&quot;</span>, <span class="st">&quot;stop_gained&quot;</span>, <span class="st">&quot;initiator_codon&quot;</span>, <span class="st">&quot;start_lost&quot;</span>, <span class="st">&quot;frameshift_variant&quot;</span>)</span>
<span id="cb509-2"><a href="whole-genome-sequencing-mutations.html#cb509-2"></a>NIHr2=NIHr[<span class="kw">which</span>(ModType<span class="op">%in%</span>SearchVars)]</span>
<span id="cb509-3"><a href="whole-genome-sequencing-mutations.html#cb509-3"></a>harr2=harr[<span class="kw">which</span>(HarType<span class="op">%in%</span>SearchVars)]</span>
<span id="cb509-4"><a href="whole-genome-sequencing-mutations.html#cb509-4"></a>crr2=crr[<span class="kw">which</span>(CRType<span class="op">%in%</span>SearchVars)]</span>
<span id="cb509-5"><a href="whole-genome-sequencing-mutations.html#cb509-5"></a></span>
<span id="cb509-6"><a href="whole-genome-sequencing-mutations.html#cb509-6"></a><span class="kw">venn</span>(<span class="kw">list</span>(<span class="dt">NIH=</span>NIHr2, <span class="dt">harlan=</span>harr2, <span class="dt">CR=</span>crr2))</span>
<span id="cb509-7"><a href="whole-genome-sequencing-mutations.html#cb509-7"></a><span class="kw">mtext</span>(<span class="st">&quot;any coding variant&quot;</span>, <span class="dt">side=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-146-1.png" width="672" /></p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="whole-genome-sequencing-mutations.html#cb510-1"></a></span>
<span id="cb510-2"><a href="whole-genome-sequencing-mutations.html#cb510-2"></a><span class="co">## Genes affected</span></span>
<span id="cb510-3"><a href="whole-genome-sequencing-mutations.html#cb510-3"></a>r=<span class="kw">regexpr</span>(<span class="st">&quot;[A-Za-z0-9</span><span class="ch">\\</span><span class="st">.]+</span><span class="ch">\\</span><span class="st">|ENSRNOG&quot;</span>, harlanRats<span class="op">@</span>fix[<span class="kw">which</span>(HarType<span class="op">%in%</span>SearchVars),<span class="dv">8</span>])</span>
<span id="cb510-4"><a href="whole-genome-sequencing-mutations.html#cb510-4"></a>codhrgrp=<span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(<span class="kw">which</span>(HarType<span class="op">%in%</span>SearchVars)))</span>
<span id="cb510-5"><a href="whole-genome-sequencing-mutations.html#cb510-5"></a>codhrgrp[r<span class="op">!=-</span><span class="dv">1</span>]=<span class="kw">regmatches</span>(harlanRats<span class="op">@</span>fix[<span class="kw">which</span>(HarType<span class="op">%in%</span>SearchVars),<span class="dv">8</span>], r)</span>
<span id="cb510-6"><a href="whole-genome-sequencing-mutations.html#cb510-6"></a>codhrgrp=<span class="kw">substr</span>(codhrgrp, <span class="dv">1</span>, <span class="kw">nchar</span>(codhrgrp)<span class="op">-</span><span class="dv">8</span>)</span>
<span id="cb510-7"><a href="whole-genome-sequencing-mutations.html#cb510-7"></a></span>
<span id="cb510-8"><a href="whole-genome-sequencing-mutations.html#cb510-8"></a>r=<span class="kw">regexpr</span>(<span class="st">&quot;[A-Za-z0-9</span><span class="ch">\\</span><span class="st">.]+</span><span class="ch">\\</span><span class="st">|ENSRNOG&quot;</span>, CRRats<span class="op">@</span>fix[<span class="kw">which</span>(CRType<span class="op">%in%</span>SearchVars),<span class="dv">8</span>])</span>
<span id="cb510-9"><a href="whole-genome-sequencing-mutations.html#cb510-9"></a>codcrgrp=<span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(<span class="kw">which</span>(CRType<span class="op">%in%</span>SearchVars)))</span>
<span id="cb510-10"><a href="whole-genome-sequencing-mutations.html#cb510-10"></a>codcrgrp[r<span class="op">!=-</span><span class="dv">1</span>]=<span class="kw">regmatches</span>(CRRats<span class="op">@</span>fix[<span class="kw">which</span>(CRType<span class="op">%in%</span>SearchVars),<span class="dv">8</span>], r)</span>
<span id="cb510-11"><a href="whole-genome-sequencing-mutations.html#cb510-11"></a>codcrgrp=<span class="kw">substr</span>(codhrgrp, <span class="dv">1</span>, <span class="kw">nchar</span>(codcrgrp)<span class="op">-</span><span class="dv">8</span>)</span>
<span id="cb510-12"><a href="whole-genome-sequencing-mutations.html#cb510-12"></a></span>
<span id="cb510-13"><a href="whole-genome-sequencing-mutations.html#cb510-13"></a>r=<span class="kw">regexpr</span>(<span class="st">&quot;[A-Za-z0-9</span><span class="ch">\\</span><span class="st">.]+</span><span class="ch">\\</span><span class="st">|ENSRNOG&quot;</span>, nihRats<span class="op">@</span>fix[<span class="kw">which</span>(ModType<span class="op">%in%</span>SearchVars),<span class="dv">8</span>])</span>
<span id="cb510-14"><a href="whole-genome-sequencing-mutations.html#cb510-14"></a>codnihgrp=<span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(<span class="kw">which</span>(ModType<span class="op">%in%</span>SearchVars)))</span>
<span id="cb510-15"><a href="whole-genome-sequencing-mutations.html#cb510-15"></a>codnihgrp[r<span class="op">!=-</span><span class="dv">1</span>]=<span class="kw">regmatches</span>(nihRats<span class="op">@</span>fix[<span class="kw">which</span>(ModType<span class="op">%in%</span>SearchVars),<span class="dv">8</span>], r)</span>
<span id="cb510-16"><a href="whole-genome-sequencing-mutations.html#cb510-16"></a>codnihgrp=<span class="kw">substr</span>(codnihgrp, <span class="dv">1</span>, <span class="kw">nchar</span>(codnihgrp)<span class="op">-</span><span class="dv">8</span>)</span>
<span id="cb510-17"><a href="whole-genome-sequencing-mutations.html#cb510-17"></a></span>
<span id="cb510-18"><a href="whole-genome-sequencing-mutations.html#cb510-18"></a><span class="kw">venn</span>(<span class="kw">list</span>(<span class="dt">NIH=</span>codnihgrp, <span class="dt">harlan=</span>codhrgrp, <span class="dt">CR=</span>codcrgrp))</span>
<span id="cb510-19"><a href="whole-genome-sequencing-mutations.html#cb510-19"></a><span class="kw">mtext</span>(<span class="st">&quot;any cosmic coding variant&quot;</span>, <span class="dt">side=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-146-2.png" width="672" /></p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="whole-genome-sequencing-mutations.html#cb511-1"></a></span>
<span id="cb511-2"><a href="whole-genome-sequencing-mutations.html#cb511-2"></a><span class="co">## Look for Cosmic specific genes</span></span>
<span id="cb511-3"><a href="whole-genome-sequencing-mutations.html#cb511-3"></a>codcrgrp2=codcrgrp[codcrgrp<span class="op">%in%</span>RatCosmic]</span>
<span id="cb511-4"><a href="whole-genome-sequencing-mutations.html#cb511-4"></a>codhrgrp2=codhrgrp[codhrgrp<span class="op">%in%</span>RatCosmic]</span>
<span id="cb511-5"><a href="whole-genome-sequencing-mutations.html#cb511-5"></a>codnihgrp2=codnihgrp[codnihgrp<span class="op">%in%</span>RatCosmic] <span class="co">#c(RatBreastCosmic, codhrgrp2, &quot;Tert&quot;, &quot;Atm&quot;)]</span></span></code></pre></div>
<p>Look at the distribution of mutations:</p>
<p>Whole genome</p>
<ul>
<li>1188 genes in more than 2 animals (1435 in at least 2)</li>
<li>59 variants were identified as population variant in Harlan</li>
<li>47 in charles river (6 are novel in this cohort only)</li>
</ul>
<p>Cosmic genes:</p>
<ul>
<li>42 sites which have mutations in more than 2 animals</li>
<li>50 sites in more than 1 animal</li>
<li>5 sites which have been identified in GWAS studies of harlan rats. On average, the variant is found at a frequency of ~15%. The CR set, these variants appear in 50% of the population</li>
<li>4 of the 5 rats from above were identified in</li>
<li>0 sites in the nih dbSNP database for rats</li>
</ul>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="whole-genome-sequencing-mutations.html#cb512-1"></a><span class="co"># Check TGFBr polymorphisms:</span></span>
<span id="cb512-2"><a href="whole-genome-sequencing-mutations.html#cb512-2"></a></span>
<span id="cb512-3"><a href="whole-genome-sequencing-mutations.html#cb512-3"></a>r=<span class="kw">grep</span>(<span class="st">&quot;Tgfb&quot;</span>, harlanRats<span class="op">@</span>fix[,<span class="dv">8</span>])</span>
<span id="cb512-4"><a href="whole-genome-sequencing-mutations.html#cb512-4"></a>harlanRatsTgfb=harlanRats[r]</span>
<span id="cb512-5"><a href="whole-genome-sequencing-mutations.html#cb512-5"></a><span class="kw">write.vcf</span>(harlanRatsTgfb, <span class="dt">file=</span><span class="st">&quot;~/Desktop/harlanRats_Tgfb.vcf.gz&quot;</span>)</span>
<span id="cb512-6"><a href="whole-genome-sequencing-mutations.html#cb512-6"></a></span>
<span id="cb512-7"><a href="whole-genome-sequencing-mutations.html#cb512-7"></a>r=<span class="kw">grep</span>(<span class="st">&quot;Tgfb&quot;</span>, CRRats<span class="op">@</span>fix[,<span class="dv">8</span>])</span>
<span id="cb512-8"><a href="whole-genome-sequencing-mutations.html#cb512-8"></a>CRRatsTgfb=CRRats[r]</span>
<span id="cb512-9"><a href="whole-genome-sequencing-mutations.html#cb512-9"></a><span class="kw">write.vcf</span>(CRRatsTgfb, <span class="dt">file=</span><span class="st">&quot;~/Desktop/CRRats_Tgfb.vcf.gz&quot;</span>)</span>
<span id="cb512-10"><a href="whole-genome-sequencing-mutations.html#cb512-10"></a></span>
<span id="cb512-11"><a href="whole-genome-sequencing-mutations.html#cb512-11"></a>r=<span class="kw">grep</span>(<span class="st">&quot;Tgfb&quot;</span>, nihRats<span class="op">@</span>fix[,<span class="dv">8</span>])</span>
<span id="cb512-12"><a href="whole-genome-sequencing-mutations.html#cb512-12"></a>nihRatsTgfb=nihRats[r]</span>
<span id="cb512-13"><a href="whole-genome-sequencing-mutations.html#cb512-13"></a><span class="kw">write.vcf</span>(nihRatsTgfb, <span class="dt">file=</span><span class="st">&quot;~/Desktop/nih_Tgfb.vcf.gz&quot;</span>)</span></code></pre></div>
<p>Here, compare the frequencies of the most common mutations in our population with those reported in the harlan and charles river data-bases:</p>
<ul>
<li>filter out mutatations occuring in 2+ samples</li>
</ul>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="whole-genome-sequencing-mutations.html#cb513-1"></a>Nsamp=<span class="dv">1</span></span>
<span id="cb513-2"><a href="whole-genome-sequencing-mutations.html#cb513-2"></a><span class="co">## Firstly whole genome</span></span>
<span id="cb513-3"><a href="whole-genome-sequencing-mutations.html#cb513-3"></a>lx1=<span class="kw">table</span>(<span class="kw">paste</span>(MeltWGSCoding<span class="op">$</span>Chromosome, MeltWGSCoding<span class="op">$</span>Start_Position))</span>
<span id="cb513-4"><a href="whole-genome-sequencing-mutations.html#cb513-4"></a>lx1=<span class="kw">sort</span>(lx1, <span class="dt">decreasing=</span>T)</span>
<span id="cb513-5"><a href="whole-genome-sequencing-mutations.html#cb513-5"></a><span class="kw">hist</span>(lx1)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/pop-gen-plot-1.png" width="672" /></p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="whole-genome-sequencing-mutations.html#cb514-1"></a><span class="kw">length</span>(<span class="kw">which</span>(lx1<span class="op">&gt;</span>Nsamp))</span>
<span id="cb514-2"><a href="whole-genome-sequencing-mutations.html#cb514-2"></a><span class="co">## [1] 1346</span></span>
<span id="cb514-3"><a href="whole-genome-sequencing-mutations.html#cb514-3"></a>WGSList=<span class="kw">names</span>(lx1)[<span class="kw">which</span>(lx1<span class="op">&gt;</span>Nsamp)]</span>
<span id="cb514-4"><a href="whole-genome-sequencing-mutations.html#cb514-4"></a>WGSList=<span class="kw">strsplit</span>(WGSList, <span class="st">&quot; &quot;</span>)</span>
<span id="cb514-5"><a href="whole-genome-sequencing-mutations.html#cb514-5"></a>WGSList=<span class="kw">data.frame</span>(<span class="dt">chr=</span><span class="kw">sapply</span>(WGSList, <span class="cf">function</span>(x) x[<span class="dv">1</span>]), <span class="dt">pos=</span><span class="kw">sapply</span>(WGSList, <span class="cf">function</span>(x) x[<span class="dv">2</span>]), <span class="dt">freq=</span>lx1[<span class="kw">which</span>(lx1<span class="op">&gt;</span>Nsamp)])</span>
<span id="cb514-6"><a href="whole-genome-sequencing-mutations.html#cb514-6"></a>WGSList<span class="op">$</span>gene=<span class="kw">as.character</span>(MeltWGSCoding<span class="op">$</span>Gene_Symbol[<span class="kw">match</span>(WGSList[ ,<span class="dv">2</span>], MeltWGSCoding<span class="op">$</span>Start_Position)])</span>
<span id="cb514-7"><a href="whole-genome-sequencing-mutations.html#cb514-7"></a>WGSList<span class="op">$</span>AA=<span class="kw">as.character</span>(MeltWGSCoding<span class="op">$</span>HGVSp_Short[<span class="kw">match</span>(WGSList[ ,<span class="dv">2</span>], MeltWGSCoding<span class="op">$</span>Start_Position)])</span>
<span id="cb514-8"><a href="whole-genome-sequencing-mutations.html#cb514-8"></a>WGSList<span class="op">$</span>VariantClass=<span class="kw">as.character</span>(MeltWGSCoding<span class="op">$</span>Variant_Classification[<span class="kw">match</span>(WGSList[ ,<span class="dv">2</span>], MeltWGSCoding<span class="op">$</span>Start_Position)])</span>
<span id="cb514-9"><a href="whole-genome-sequencing-mutations.html#cb514-9"></a>WGSList<span class="op">$</span>Cosmic=<span class="kw">ifelse</span>(WGSList<span class="op">$</span>gene<span class="op">%in%</span>RatCosmic, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb514-10"><a href="whole-genome-sequencing-mutations.html#cb514-10"></a></span>
<span id="cb514-11"><a href="whole-genome-sequencing-mutations.html#cb514-11"></a><span class="co">## Secondly, cosmic specific genes</span></span>
<span id="cb514-12"><a href="whole-genome-sequencing-mutations.html#cb514-12"></a></span>
<span id="cb514-13"><a href="whole-genome-sequencing-mutations.html#cb514-13"></a><span class="co">## WGSList</span></span>
<span id="cb514-14"><a href="whole-genome-sequencing-mutations.html#cb514-14"></a>midx=<span class="kw">match</span>(WGSList<span class="op">$</span>freq.Var1, <span class="kw">paste</span>(harlanRats<span class="op">@</span>fix[ ,<span class="dv">1</span>], harlanRats<span class="op">@</span>fix[ ,<span class="dv">2</span>], <span class="dt">sep=</span><span class="st">&quot; &quot;</span>))</span>
<span id="cb514-15"><a href="whole-genome-sequencing-mutations.html#cb514-15"></a>WGSList<span class="op">$</span>HarlanFreq=GT3[midx]</span>
<span id="cb514-16"><a href="whole-genome-sequencing-mutations.html#cb514-16"></a>midx=<span class="kw">match</span>(WGSList<span class="op">$</span>freq.Var1, <span class="kw">paste</span>(nihRats<span class="op">@</span>fix[ ,<span class="dv">1</span>], nihRats<span class="op">@</span>fix[ ,<span class="dv">2</span>], <span class="dt">sep=</span><span class="st">&quot; &quot;</span>))</span>
<span id="cb514-17"><a href="whole-genome-sequencing-mutations.html#cb514-17"></a>WGSList<span class="op">$</span>rsID=nihRats<span class="op">@</span>fix[midx, <span class="dv">3</span>]</span>
<span id="cb514-18"><a href="whole-genome-sequencing-mutations.html#cb514-18"></a><span class="co">## CR</span></span>
<span id="cb514-19"><a href="whole-genome-sequencing-mutations.html#cb514-19"></a>midx=<span class="kw">match</span>(WGSList<span class="op">$</span>freq.Var1, <span class="kw">paste</span>(CRRats<span class="op">@</span>fix[ ,<span class="dv">1</span>], CRRats<span class="op">@</span>fix[ ,<span class="dv">2</span>], <span class="dt">sep=</span><span class="st">&quot; &quot;</span>))</span>
<span id="cb514-20"><a href="whole-genome-sequencing-mutations.html#cb514-20"></a>WGSList<span class="op">$</span>CRFreq=crGT3[midx]</span>
<span id="cb514-21"><a href="whole-genome-sequencing-mutations.html#cb514-21"></a></span>
<span id="cb514-22"><a href="whole-genome-sequencing-mutations.html#cb514-22"></a>WGSplot=<span class="kw">melt</span>(WGSList[ ,<span class="kw">c</span>(<span class="st">&quot;freq.Freq&quot;</span>, <span class="st">&quot;gene&quot;</span>, <span class="st">&quot;VariantClass&quot;</span>, <span class="st">&quot;HarlanFreq&quot;</span>, <span class="st">&quot;CRFreq&quot;</span>, <span class="st">&quot;Cosmic&quot;</span>)], <span class="dt">measure.vars =</span> <span class="kw">c</span>(<span class="st">&quot;HarlanFreq&quot;</span>, <span class="st">&quot;CRFreq&quot;</span>))</span>
<span id="cb514-23"><a href="whole-genome-sequencing-mutations.html#cb514-23"></a>WGSplot=WGSplot[<span class="op">-</span><span class="kw">which</span>(<span class="kw">is.na</span>(WGSplot<span class="op">$</span>value)), ]</span>
<span id="cb514-24"><a href="whole-genome-sequencing-mutations.html#cb514-24"></a></span>
<span id="cb514-25"><a href="whole-genome-sequencing-mutations.html#cb514-25"></a><span class="kw">ggplot</span>(WGSplot, <span class="kw">aes</span>(<span class="dt">x=</span>freq.Freq<span class="op">/</span><span class="dv">16</span>, <span class="dt">y=</span>value, <span class="dt">col=</span>VariantClass, <span class="dt">label=</span>WGSplot<span class="op">$</span>gene))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>variable)<span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb514-26"><a href="whole-genome-sequencing-mutations.html#cb514-26"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">size=</span>(WGSplot<span class="op">$</span>Cosmic<span class="op">+</span><span class="dv">3</span>), <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">nudge_y=</span><span class="fl">0.01</span>)<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Cohort frequency&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Database frequency&quot;</span>)<span class="op">+</span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;all genes compared to Harlan Frequencies&quot;</span>)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/pop-gen-plot-2.png" width="672" /></p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="whole-genome-sequencing-mutations.html#cb515-1"></a></span>
<span id="cb515-2"><a href="whole-genome-sequencing-mutations.html#cb515-2"></a>DT<span class="op">::</span><span class="kw">datatable</span>(WGSplot[WGSplot<span class="op">$</span>Cosmic<span class="op">==</span><span class="dv">1</span>, ],<span class="dt">class=</span><span class="st">&#39;cell-border stripe&#39;</span>, <span class="dt">extensions=</span><span class="st">&quot;Buttons&quot;</span>, <span class="dt">options=</span><span class="kw">list</span>(<span class="dt">dom=</span><span class="st">&quot;Bfrtip&quot;</span>, <span class="dt">buttons=</span><span class="kw">c</span>(<span class="st">&#39;csv&#39;</span>, <span class="st">&#39;excel&#39;</span>), <span class="dt">scrollX=</span>T))</span></code></pre></div>
<div id="htmlwidget-31686100ff1bd9547a73" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-31686100ff1bd9547a73">{"x":{"filter":"none","extensions":["Buttons"],"data":[["142","530","676","677","678","1195","1876","2022","2023","2024"],[19,8,6,6,6,2,8,6,6,6],["Prf1","Tcf3","Rnf213","Rnf213","Rnf213","Ptpn13","Tcf3","Rnf213","Rnf213","Rnf213"],["Missense_Mutation","Missense_Mutation","Missense_Mutation","Missense_Mutation","Missense_Mutation","Missense_Mutation","Missense_Mutation","Missense_Mutation","Missense_Mutation","Missense_Mutation"],[1,1,1,1,1,1,1,1,1,1],["HarlanFreq","HarlanFreq","HarlanFreq","HarlanFreq","HarlanFreq","HarlanFreq","CRFreq","CRFreq","CRFreq","CRFreq"],[0.452871547566857,0.067952652345463,0.140289346777729,0.140289346777729,0.14116615519509,0.027181060938185,0.148876404494382,0.526404494382022,0.526404494382022,0.536516853932584]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>freq.Freq<\/th>\n      <th>gene<\/th>\n      <th>VariantClass<\/th>\n      <th>Cosmic<\/th>\n      <th>variable<\/th>\n      <th>value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["csv","excel"],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,4,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="overview-of-the-mutations" class="section level2">
<h2><span class="header-section-number">21.5</span> Overview of the mutations</h2>
<div id="all-mutations" class="section level3">
<h3><span class="header-section-number">21.5.1</span> All mutations</h3>
<p>SNPs are removed from this analysis: based on frequencies in the harlan cohort</p>
<p>Color codes:</p>
<ul>
<li>black:</li>
<li>pink:</li>
<li>green:</li>
<li>blue:</li>
</ul>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="whole-genome-sequencing-mutations.html#cb516-1"></a><span class="kw">palette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;Set1&quot;</span>))</span>
<span id="cb516-2"><a href="whole-genome-sequencing-mutations.html#cb516-2"></a></span>
<span id="cb516-3"><a href="whole-genome-sequencing-mutations.html#cb516-3"></a>Nmut=<span class="dv">86</span> <span class="co">## was previously 92: this appears at least 17 times</span></span>
<span id="cb516-4"><a href="whole-genome-sequencing-mutations.html#cb516-4"></a></span>
<span id="cb516-5"><a href="whole-genome-sequencing-mutations.html#cb516-5"></a>rmHarlanSNP=WGSList[<span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(WGSList<span class="op">$</span>HarlanFreq)), ]</span>
<span id="cb516-6"><a href="whole-genome-sequencing-mutations.html#cb516-6"></a>x1a=<span class="kw">which</span>(MeltWGSCoding<span class="op">$</span>Gene_Symbol<span class="op">%in%</span>rmHarlanSNP<span class="op">$</span>gene <span class="op">&amp;</span><span class="st">  </span>MeltWGSCoding<span class="op">$</span>Start_Position<span class="op">%in%</span>rmHarlanSNP<span class="op">$</span>pos)</span>
<span id="cb516-7"><a href="whole-genome-sequencing-mutations.html#cb516-7"></a>MeltWGSCodingB=MeltWGSCoding[<span class="op">-</span>x1a, ]</span>
<span id="cb516-8"><a href="whole-genome-sequencing-mutations.html#cb516-8"></a></span>
<span id="cb516-9"><a href="whole-genome-sequencing-mutations.html#cb516-9"></a>rGeneOut=<span class="kw">acast</span>(MeltWGSCodingB[ ,<span class="kw">c</span>(<span class="st">&quot;Gene_Symbol&quot;</span>, <span class="st">&quot;L1&quot;</span>, <span class="st">&quot;Variant_Classification&quot;</span>)], L1<span class="op">~</span>Gene_Symbol, </span>
<span id="cb516-10"><a href="whole-genome-sequencing-mutations.html#cb516-10"></a>               <span class="dt">value.var=</span><span class="st">&quot;Variant_Classification&quot;</span>, <span class="dt">fun.aggregate=</span><span class="cf">function</span>(x) <span class="kw">paste</span>(x, <span class="dt">collapse =</span> <span class="st">&quot;, &quot;</span>))</span>
<span id="cb516-11"><a href="whole-genome-sequencing-mutations.html#cb516-11"></a></span>
<span id="cb516-12"><a href="whole-genome-sequencing-mutations.html#cb516-12"></a>mxl=<span class="kw">unique</span>(<span class="kw">as.vector</span>(rGeneOut))</span>
<span id="cb516-13"><a href="whole-genome-sequencing-mutations.html#cb516-13"></a>rGeneOut2=rGeneOut</span>
<span id="cb516-14"><a href="whole-genome-sequencing-mutations.html#cb516-14"></a>rGeneOut2[<span class="kw">grep</span>(<span class="st">&quot;Nonsense&quot;</span>,rGeneOut2)]=<span class="dv">3</span></span>
<span id="cb516-15"><a href="whole-genome-sequencing-mutations.html#cb516-15"></a>rGeneOut2[<span class="kw">grep</span>(<span class="st">&quot;Frame_Shift&quot;</span>,rGeneOut2)]=<span class="dv">2</span></span>
<span id="cb516-16"><a href="whole-genome-sequencing-mutations.html#cb516-16"></a>rGeneOut2[<span class="kw">grep</span>(<span class="st">&quot;Missense_&quot;</span>, rGeneOut2)]=<span class="dv">1</span></span>
<span id="cb516-17"><a href="whole-genome-sequencing-mutations.html#cb516-17"></a>rGeneOut2[<span class="kw">grep</span>(<span class="st">&quot;Splice_&quot;</span>, rGeneOut2)]=<span class="dv">4</span></span>
<span id="cb516-18"><a href="whole-genome-sequencing-mutations.html#cb516-18"></a>rGeneOut2[<span class="kw">which</span>(rGeneOut2<span class="op">==</span><span class="st">&quot;&quot;</span>)]=<span class="dv">0</span></span>
<span id="cb516-19"><a href="whole-genome-sequencing-mutations.html#cb516-19"></a></span>
<span id="cb516-20"><a href="whole-genome-sequencing-mutations.html#cb516-20"></a>rGeneOut2=<span class="kw">apply</span>(rGeneOut2, <span class="dv">2</span>, as.numeric)</span>
<span id="cb516-21"><a href="whole-genome-sequencing-mutations.html#cb516-21"></a><span class="kw">rownames</span>(rGeneOut2)=<span class="kw">rownames</span>(rGeneOut) </span>
<span id="cb516-22"><a href="whole-genome-sequencing-mutations.html#cb516-22"></a></span>
<span id="cb516-23"><a href="whole-genome-sequencing-mutations.html#cb516-23"></a><span class="co">#get rid of genes which are associated with Olfactory receptors, AABR etc mutations</span></span>
<span id="cb516-24"><a href="whole-genome-sequencing-mutations.html#cb516-24"></a>rmThese=<span class="kw">c</span>(<span class="st">&quot;^AABR&quot;</span>, <span class="st">&quot;^Olr&quot;</span>, <span class="st">&quot;^LOC&quot;</span>, <span class="st">&quot;^AC[0-9]+&quot;</span>, <span class="st">&quot;^RGD&quot;</span>, <span class="st">&quot;^Rpl&quot;</span>, <span class="st">&quot;^1700&quot;</span>, <span class="st">&quot;^RT1&quot;</span>, <span class="st">&quot;^ENSRNOG&quot;</span>, <span class="st">&quot;^Vom2&quot;</span>)</span>
<span id="cb516-25"><a href="whole-genome-sequencing-mutations.html#cb516-25"></a>rmList=<span class="kw">unlist</span>(<span class="kw">sapply</span>(rmThese, <span class="cf">function</span>(x) <span class="kw">grep</span>(x, <span class="kw">colnames</span>(rGeneOut2))))</span>
<span id="cb516-26"><a href="whole-genome-sequencing-mutations.html#cb516-26"></a>rGeneOut2=rGeneOut2[ ,<span class="op">-</span>rmList]</span>
<span id="cb516-27"><a href="whole-genome-sequencing-mutations.html#cb516-27"></a></span>
<span id="cb516-28"><a href="whole-genome-sequencing-mutations.html#cb516-28"></a>GeneList=<span class="kw">colSums</span>(<span class="kw">sign</span>(rGeneOut2), <span class="dt">na.rm=</span>T)</span>
<span id="cb516-29"><a href="whole-genome-sequencing-mutations.html#cb516-29"></a>samp2=<span class="kw">rowSums</span>(<span class="kw">sign</span>(rGeneOut2), <span class="dt">na.rm=</span>T)</span>
<span id="cb516-30"><a href="whole-genome-sequencing-mutations.html#cb516-30"></a>rGeneOut2=rGeneOut2[ <span class="kw">order</span>(samp2, <span class="dt">decreasing=</span>T),]</span>
<span id="cb516-31"><a href="whole-genome-sequencing-mutations.html#cb516-31"></a></span>
<span id="cb516-32"><a href="whole-genome-sequencing-mutations.html#cb516-32"></a>topN=<span class="kw">names</span>(<span class="kw">sort</span>(GeneList, <span class="dt">decreasing=</span>T)[<span class="dv">1</span><span class="op">:</span>Nmut])</span>
<span id="cb516-33"><a href="whole-genome-sequencing-mutations.html#cb516-33"></a></span>
<span id="cb516-34"><a href="whole-genome-sequencing-mutations.html#cb516-34"></a><span class="co"># do a plot of the top 30 most common mutations</span></span>
<span id="cb516-35"><a href="whole-genome-sequencing-mutations.html#cb516-35"></a>tempx=rGeneOut2[ ,topN]</span>
<span id="cb516-36"><a href="whole-genome-sequencing-mutations.html#cb516-36"></a>a2=<span class="kw">heatmap</span>(tempx, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>), <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">main=</span><span class="st">&quot;all mutations in cosmic&quot;</span>)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-148-1.png" width="672" /></p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="whole-genome-sequencing-mutations.html#cb517-1"></a>RowSC=<span class="kw">ifelse</span>(<span class="kw">colnames</span>(tempx)<span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(RatCosmic, <span class="kw">as.character</span>(AllCancerPathwayGenes)), <span class="st">&quot;black&quot;</span>, <span class="st">&quot;white&quot;</span>)</span>
<span id="cb517-2"><a href="whole-genome-sequencing-mutations.html#cb517-2"></a></span>
<span id="cb517-3"><a href="whole-genome-sequencing-mutations.html#cb517-3"></a><span class="kw">heatmap.2</span>(tempx, <span class="dt">Rowv =</span> <span class="ot">NA</span>, <span class="dt">Colv =</span> <span class="ot">NA</span>,<span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">trace=</span><span class="st">&quot;none&quot;</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">ColSideColors=</span>RowSC)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-148-2.png" width="672" /></p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="whole-genome-sequencing-mutations.html#cb518-1"></a><span class="co"># check if any of these are hotspot mutations</span></span>
<span id="cb518-2"><a href="whole-genome-sequencing-mutations.html#cb518-2"></a>Hotspots=MeltCosmic[<span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(MeltCosmic<span class="op">$</span>HumSequence)<span class="op">==</span>T), ]</span>
<span id="cb518-3"><a href="whole-genome-sequencing-mutations.html#cb518-3"></a><span class="kw">head</span>(Hotspots)</span>
<span id="cb518-4"><a href="whole-genome-sequencing-mutations.html#cb518-4"></a><span class="co">##  [1] Gene_Symbol                   Entrez_Gene_Id               </span></span>
<span id="cb518-5"><a href="whole-genome-sequencing-mutations.html#cb518-5"></a><span class="co">##  [3] Center                        NCBI_Build                   </span></span>
<span id="cb518-6"><a href="whole-genome-sequencing-mutations.html#cb518-6"></a><span class="co">##  [5] Chromosome                    Start_Position               </span></span>
<span id="cb518-7"><a href="whole-genome-sequencing-mutations.html#cb518-7"></a><span class="co">##  [7] End_Position                  Strand                       </span></span>
<span id="cb518-8"><a href="whole-genome-sequencing-mutations.html#cb518-8"></a><span class="co">##  [9] Variant_Classification        Variant_Type                 </span></span>
<span id="cb518-9"><a href="whole-genome-sequencing-mutations.html#cb518-9"></a><span class="co">## [11] Reference_Allele              Tumor_Seq_Allele1            </span></span>
<span id="cb518-10"><a href="whole-genome-sequencing-mutations.html#cb518-10"></a><span class="co">## [13] Tumor_Seq_Allele2             dbSNP_RS                     </span></span>
<span id="cb518-11"><a href="whole-genome-sequencing-mutations.html#cb518-11"></a><span class="co">## [15] dbSNP_Val_Status              Matched_Norm_Sample_Barcode  </span></span>
<span id="cb518-12"><a href="whole-genome-sequencing-mutations.html#cb518-12"></a><span class="co">## [17] Match_Norm_Seq_Allele1        Match_Norm_Seq_Allele2       </span></span>
<span id="cb518-13"><a href="whole-genome-sequencing-mutations.html#cb518-13"></a><span class="co">## [19] Tumor_Validation_Allele1      Tumor_Validation_Allele2     </span></span>
<span id="cb518-14"><a href="whole-genome-sequencing-mutations.html#cb518-14"></a><span class="co">## [21] Match_Norm_Validation_Allele1 Match_Norm_Validation_Allele2</span></span>
<span id="cb518-15"><a href="whole-genome-sequencing-mutations.html#cb518-15"></a><span class="co">## [23] Verification_Status           Validation_Status            </span></span>
<span id="cb518-16"><a href="whole-genome-sequencing-mutations.html#cb518-16"></a><span class="co">## [25] Mutation_Status               Sequencing_Phase             </span></span>
<span id="cb518-17"><a href="whole-genome-sequencing-mutations.html#cb518-17"></a><span class="co">## [27] Sequence_Source               Validation_Method            </span></span>
<span id="cb518-18"><a href="whole-genome-sequencing-mutations.html#cb518-18"></a><span class="co">## [29] Score                         BAM_file                     </span></span>
<span id="cb518-19"><a href="whole-genome-sequencing-mutations.html#cb518-19"></a><span class="co">## [31] Sequencer                     t_alt_count                  </span></span>
<span id="cb518-20"><a href="whole-genome-sequencing-mutations.html#cb518-20"></a><span class="co">## [33] t_ref_count                   n_alt_count                  </span></span>
<span id="cb518-21"><a href="whole-genome-sequencing-mutations.html#cb518-21"></a><span class="co">## [35] n_ref_count                   HGVSp_Short                  </span></span>
<span id="cb518-22"><a href="whole-genome-sequencing-mutations.html#cb518-22"></a><span class="co">## [37] VAF                           variable                     </span></span>
<span id="cb518-23"><a href="whole-genome-sequencing-mutations.html#cb518-23"></a><span class="co">## [39] value                         L1                           </span></span>
<span id="cb518-24"><a href="whole-genome-sequencing-mutations.html#cb518-24"></a><span class="co">## &lt;0 rows&gt; (or 0-length row.names)</span></span>
<span id="cb518-25"><a href="whole-genome-sequencing-mutations.html#cb518-25"></a></span>
<span id="cb518-26"><a href="whole-genome-sequencing-mutations.html#cb518-26"></a>hotspotLocExtract=<span class="cf">function</span>(amat){</span>
<span id="cb518-27"><a href="whole-genome-sequencing-mutations.html#cb518-27"></a>HList=<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(Hotspots), <span class="cf">function</span>(i) <span class="kw">ifelse</span>(amat[<span class="kw">match</span>(Hotspots<span class="op">$</span>L1[i], <span class="kw">rownames</span>(amat)),<span class="kw">match</span>(Hotspots<span class="op">$</span>Gene_Symbol[i], <span class="kw">colnames</span>(amat))]<span class="op">&gt;</span><span class="dv">0</span>, </span>
<span id="cb518-28"><a href="whole-genome-sequencing-mutations.html#cb518-28"></a>                                                 <span class="kw">paste</span>(<span class="kw">match</span>(Hotspots<span class="op">$</span>L1[i], <span class="kw">rownames</span>(amat)),<span class="kw">match</span>(Hotspots<span class="op">$</span>Gene_Symbol[i], <span class="kw">colnames</span>(amat))), <span class="st">&quot;0 0&quot;</span>))</span>
<span id="cb518-29"><a href="whole-genome-sequencing-mutations.html#cb518-29"></a>List2=<span class="kw">strsplit</span>(<span class="kw">as.character</span>(HList), <span class="st">&quot; &quot;</span>)</span>
<span id="cb518-30"><a href="whole-genome-sequencing-mutations.html#cb518-30"></a>Xcord=<span class="kw">na.omit</span>(<span class="kw">as.numeric</span>(<span class="kw">sapply</span>(List2, <span class="cf">function</span>(x) x[<span class="dv">1</span>])))</span>
<span id="cb518-31"><a href="whole-genome-sequencing-mutations.html#cb518-31"></a>Ycord=<span class="kw">na.omit</span>(<span class="kw">as.numeric</span>(<span class="kw">sapply</span>(List2, <span class="cf">function</span>(x) x[<span class="dv">2</span>])))</span>
<span id="cb518-32"><a href="whole-genome-sequencing-mutations.html#cb518-32"></a><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">X=</span>Xcord, <span class="dt">Y=</span>Ycord))</span>
<span id="cb518-33"><a href="whole-genome-sequencing-mutations.html#cb518-33"></a>}</span>
<span id="cb518-34"><a href="whole-genome-sequencing-mutations.html#cb518-34"></a></span>
<span id="cb518-35"><a href="whole-genome-sequencing-mutations.html#cb518-35"></a><span class="co">## top 90 mutations</span></span>
<span id="cb518-36"><a href="whole-genome-sequencing-mutations.html#cb518-36"></a>a2=<span class="kw">heatmap.2</span>(<span class="kw">sign</span>(tempx), <span class="dt">trace=</span><span class="st">&quot;none&quot;</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;grey&quot;</span>))</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-148-3.png" width="672" /></p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="whole-genome-sequencing-mutations.html#cb519-1"></a>tempxb=tempx[a2<span class="op">$</span>rowInd, a2<span class="op">$</span>colInd]</span>
<span id="cb519-2"><a href="whole-genome-sequencing-mutations.html#cb519-2"></a>hotspot1b=<span class="kw">hotspotLocExtract</span>(tempxb)</span>
<span id="cb519-3"><a href="whole-genome-sequencing-mutations.html#cb519-3"></a><span class="kw">rownames</span>(tempxb)=Cdata<span class="op">$</span>NewID[<span class="kw">sapply</span>(<span class="kw">rownames</span>(tempxb), <span class="cf">function</span>(x) <span class="kw">grep</span>(x, Cdata<span class="op">$</span>WGS))]</span>
<span id="cb519-4"><a href="whole-genome-sequencing-mutations.html#cb519-4"></a></span>
<span id="cb519-5"><a href="whole-genome-sequencing-mutations.html#cb519-5"></a>GeneList=<span class="kw">unique</span>(Hotspots<span class="op">$</span>Gene_Symbol)</span>
<span id="cb519-6"><a href="whole-genome-sequencing-mutations.html#cb519-6"></a>Hotspots<span class="op">$</span>Gene_Symbol</span>
<span id="cb519-7"><a href="whole-genome-sequencing-mutations.html#cb519-7"></a><span class="co">## character(0)</span></span>
<span id="cb519-8"><a href="whole-genome-sequencing-mutations.html#cb519-8"></a></span>
<span id="cb519-9"><a href="whole-genome-sequencing-mutations.html#cb519-9"></a>tempy=rGeneOut2[ ,<span class="kw">match</span>(GeneList, <span class="kw">colnames</span>(rGeneOut2))]</span>
<span id="cb519-10"><a href="whole-genome-sequencing-mutations.html#cb519-10"></a><span class="co">#a2=heatmap.2(sign(tempy), trace=&quot;none&quot;, col=c(&quot;white&quot;, &quot;grey&quot;))</span></span>
<span id="cb519-11"><a href="whole-genome-sequencing-mutations.html#cb519-11"></a><span class="co">#tempyb=tempy[a2$rowInd, a2$colInd]</span></span>
<span id="cb519-12"><a href="whole-genome-sequencing-mutations.html#cb519-12"></a><span class="co">#hotspot2=hotspotLocExtract(tempyb)</span></span>
<span id="cb519-13"><a href="whole-genome-sequencing-mutations.html#cb519-13"></a><span class="co">#rownames(tempyb)=Cdata$NewID[sapply(rownames(tempyb), function(x) grep(x, Cdata$WGS))]</span></span>
<span id="cb519-14"><a href="whole-genome-sequencing-mutations.html#cb519-14"></a></span>
<span id="cb519-15"><a href="whole-genome-sequencing-mutations.html#cb519-15"></a><span class="co">##cosmic genes</span></span>
<span id="cb519-16"><a href="whole-genome-sequencing-mutations.html#cb519-16"></a>x1=<span class="kw">which</span>(<span class="kw">colnames</span>(rGeneOut2)<span class="op">%in%</span>RatCosmic)</span>
<span id="cb519-17"><a href="whole-genome-sequencing-mutations.html#cb519-17"></a>tempz=rGeneOut2[ ,x1]</span>
<span id="cb519-18"><a href="whole-genome-sequencing-mutations.html#cb519-18"></a>a2=<span class="kw">heatmap.2</span>(<span class="kw">sign</span>(tempz), <span class="dt">trace=</span><span class="st">&quot;none&quot;</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>))</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-148-4.png" width="672" /></p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="whole-genome-sequencing-mutations.html#cb520-1"></a>tempzb=tempz[a2<span class="op">$</span>rowInd, a2<span class="op">$</span>colInd]</span>
<span id="cb520-2"><a href="whole-genome-sequencing-mutations.html#cb520-2"></a>hotspotzb=<span class="kw">hotspotLocExtract</span>(tempzb)</span>
<span id="cb520-3"><a href="whole-genome-sequencing-mutations.html#cb520-3"></a></span>
<span id="cb520-4"><a href="whole-genome-sequencing-mutations.html#cb520-4"></a></span>
<span id="cb520-5"><a href="whole-genome-sequencing-mutations.html#cb520-5"></a>x2=<span class="kw">which</span>(<span class="kw">colSums</span>(<span class="kw">sign</span>(tempzb))<span class="op">==</span><span class="dv">1</span>)</span>
<span id="cb520-6"><a href="whole-genome-sequencing-mutations.html#cb520-6"></a>tempz2=tempzb[ , <span class="op">-</span>x2]</span>
<span id="cb520-7"><a href="whole-genome-sequencing-mutations.html#cb520-7"></a></span>
<span id="cb520-8"><a href="whole-genome-sequencing-mutations.html#cb520-8"></a>hotspotzb2=<span class="kw">hotspotLocExtract</span>(tempz2)</span>
<span id="cb520-9"><a href="whole-genome-sequencing-mutations.html#cb520-9"></a></span>
<span id="cb520-10"><a href="whole-genome-sequencing-mutations.html#cb520-10"></a><span class="kw">rownames</span>(tempzb)=Cdata<span class="op">$</span>NewID[<span class="kw">sapply</span>(<span class="kw">rownames</span>(tempzb), <span class="cf">function</span>(x) <span class="kw">grep</span>(x, Cdata<span class="op">$</span>WGS))]</span>
<span id="cb520-11"><a href="whole-genome-sequencing-mutations.html#cb520-11"></a><span class="kw">rownames</span>(tempz2)=Cdata<span class="op">$</span>NewID[<span class="kw">sapply</span>(<span class="kw">rownames</span>(tempz2), <span class="cf">function</span>(x) <span class="kw">grep</span>(x, Cdata<span class="op">$</span>WGS))]</span>
<span id="cb520-12"><a href="whole-genome-sequencing-mutations.html#cb520-12"></a></span>
<span id="cb520-13"><a href="whole-genome-sequencing-mutations.html#cb520-13"></a></span>
<span id="cb520-14"><a href="whole-genome-sequencing-mutations.html#cb520-14"></a>topCOSMIC=<span class="kw">colnames</span>(tempz2)</span>
<span id="cb520-15"><a href="whole-genome-sequencing-mutations.html#cb520-15"></a></span>
<span id="cb520-16"><a href="whole-genome-sequencing-mutations.html#cb520-16"></a><span class="kw">save</span>(topN, topCOSMIC, <span class="dt">file=</span><span class="st">&quot;outputs/genes-selected-common-WGX-mutations.RData&quot;</span>)</span>
<span id="cb520-17"><a href="whole-genome-sequencing-mutations.html#cb520-17"></a></span>
<span id="cb520-18"><a href="whole-genome-sequencing-mutations.html#cb520-18"></a><span class="co">#x3=table(colSums(rGeneOut2))</span></span>
<span id="cb520-19"><a href="whole-genome-sequencing-mutations.html#cb520-19"></a><span class="kw">write.csv</span>(rGeneOut[ , x1], <span class="dt">file=</span><span class="st">&quot;nature-tables/1k-mutations.csv&quot;</span>)</span></code></pre></div>
<p>Note that in this table, the distribution of samples with mutations is as follows:</p>
<p>2695, 591, 289, 282, 131, 70, 45, 39, 40, 23, 15, 20, 19, 8, 8, 18, 10, 14, 5, 4, 14, 8, 6, 6, 1, 4, 8, 3, 2, 4, 1, 1, 1, 1, 1, 1</p>
<p>The number of genes which have shared mutations in 10 or more samples is:</p>
<p>4622, which is why we have use these values here.</p>
<p>The number of genes which are cosmic associated are:</p>
<p>221 and the number which appear in more than 1 sample is 82.</p>
<p>These genes are tabulated below: (nice figures generated here).</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="whole-genome-sequencing-mutations.html#cb521-1"></a><span class="co">### keep these values</span></span>
<span id="cb521-2"><a href="whole-genome-sequencing-mutations.html#cb521-2"></a>top90genes=<span class="kw">colnames</span>(rGeneOut2)</span>
<span id="cb521-3"><a href="whole-genome-sequencing-mutations.html#cb521-3"></a></span>
<span id="cb521-4"><a href="whole-genome-sequencing-mutations.html#cb521-4"></a><span class="co">#pdf(sprintf(&quot;~/Desktop/summary_mutations_top90_human_homology_%s.pdf&quot;, Sys.Date()), width=14, height=7)</span></span>
<span id="cb521-5"><a href="whole-genome-sequencing-mutations.html#cb521-5"></a></span>
<span id="cb521-6"><a href="whole-genome-sequencing-mutations.html#cb521-6"></a>hotspot1b</span>
<span id="cb521-7"><a href="whole-genome-sequencing-mutations.html#cb521-7"></a><span class="co">## $X</span></span>
<span id="cb521-8"><a href="whole-genome-sequencing-mutations.html#cb521-8"></a><span class="co">##  [1] 19  9  9  6  8  7 11 11 13 13 13 12 12 24 24 22 22 23 23  4  4 21 21 21 18</span></span>
<span id="cb521-9"><a href="whole-genome-sequencing-mutations.html#cb521-9"></a><span class="co">## [26] 16 16 16 17 17 17 30 30  5  5 15 14 25 25 25 31 31 31 27 27 27 27 28 28 28</span></span>
<span id="cb521-10"><a href="whole-genome-sequencing-mutations.html#cb521-10"></a><span class="co">## [51] 28  3  3  3  1  2  2  2 10 10 20 20 29 29 26 26</span></span>
<span id="cb521-11"><a href="whole-genome-sequencing-mutations.html#cb521-11"></a><span class="co">## attr(,&quot;na.action&quot;)</span></span>
<span id="cb521-12"><a href="whole-genome-sequencing-mutations.html#cb521-12"></a><span class="co">##   [1]   2   3   4   5   6   7   8   9  13  14  15  16  17  18  19  21  22  23</span></span>
<span id="cb521-13"><a href="whole-genome-sequencing-mutations.html#cb521-13"></a><span class="co">##  [19]  24  25  26  28  29  30  31  32  33  34  35  36  37  38  40  42  43  44</span></span>
<span id="cb521-14"><a href="whole-genome-sequencing-mutations.html#cb521-14"></a><span class="co">##  [37]  45  46  48  49  50  51  53  55  56  57  58  59  61  62  63  64  65  67</span></span>
<span id="cb521-15"><a href="whole-genome-sequencing-mutations.html#cb521-15"></a><span class="co">##  [55]  68  69  70  72  73  74  75  76  77  78  79  80  81  82  83  85  86  87</span></span>
<span id="cb521-16"><a href="whole-genome-sequencing-mutations.html#cb521-16"></a><span class="co">##  [73]  88  89  90  91  92  93  94  96  97  98  99 101 102 103 104 105 106 107</span></span>
<span id="cb521-17"><a href="whole-genome-sequencing-mutations.html#cb521-17"></a><span class="co">##  [91] 109 110 111 112 113 115 116 117 118 119 120 121 122 123 125 128 129 130</span></span>
<span id="cb521-18"><a href="whole-genome-sequencing-mutations.html#cb521-18"></a><span class="co">## [109] 132 133 135 136 137 138 140 141 142 143 144 145 146 147 148 149 150 151</span></span>
<span id="cb521-19"><a href="whole-genome-sequencing-mutations.html#cb521-19"></a><span class="co">## [127] 153 154 156 157 158 160 161 162 163 164 165 166 167 168 169 171 172 174</span></span>
<span id="cb521-20"><a href="whole-genome-sequencing-mutations.html#cb521-20"></a><span class="co">## [145] 175 176 177 179 180 181 182 183 184 186 187 189 190 191 192 193 194 195</span></span>
<span id="cb521-21"><a href="whole-genome-sequencing-mutations.html#cb521-21"></a><span class="co">## [163] 196 197 198 199 201 203 204 206 207 208 209 210 211 212 213 214 216 217</span></span>
<span id="cb521-22"><a href="whole-genome-sequencing-mutations.html#cb521-22"></a><span class="co">## [181] 218 219 220 221 222 223 225 227 229 231 232 233 234 235 236 237 238 240</span></span>
<span id="cb521-23"><a href="whole-genome-sequencing-mutations.html#cb521-23"></a><span class="co">## [199] 241 242 243 244 245 246 247 248 249 250 251 253 254 255 257 258 259 260</span></span>
<span id="cb521-24"><a href="whole-genome-sequencing-mutations.html#cb521-24"></a><span class="co">## [217] 262 263 264 265 266 268 269 270 271 272 273 274 277 278 281 282 283 284</span></span>
<span id="cb521-25"><a href="whole-genome-sequencing-mutations.html#cb521-25"></a><span class="co">## [235] 286 287 288 289 290 291 292 293 296 297 298 299 300 302 303 304 306 307</span></span>
<span id="cb521-26"><a href="whole-genome-sequencing-mutations.html#cb521-26"></a><span class="co">## [253] 308 309 310 311 312 313 314 315 316 317 318 319 320 321 323 324 326 327</span></span>
<span id="cb521-27"><a href="whole-genome-sequencing-mutations.html#cb521-27"></a><span class="co">## [271] 328 329 330 332 333 334 335 336 338 339 341 342 343 344 345 346 347 348</span></span>
<span id="cb521-28"><a href="whole-genome-sequencing-mutations.html#cb521-28"></a><span class="co">## [289] 349 350 353 354 356 357 358 360 361 362 363 364 365 366 367 368 369 370</span></span>
<span id="cb521-29"><a href="whole-genome-sequencing-mutations.html#cb521-29"></a><span class="co">## [307] 371 372 374 375 376 378 379 380 381 382 383</span></span>
<span id="cb521-30"><a href="whole-genome-sequencing-mutations.html#cb521-30"></a><span class="co">## attr(,&quot;class&quot;)</span></span>
<span id="cb521-31"><a href="whole-genome-sequencing-mutations.html#cb521-31"></a><span class="co">## [1] &quot;omit&quot;</span></span>
<span id="cb521-32"><a href="whole-genome-sequencing-mutations.html#cb521-32"></a><span class="co">## </span></span>
<span id="cb521-33"><a href="whole-genome-sequencing-mutations.html#cb521-33"></a><span class="co">## $Y</span></span>
<span id="cb521-34"><a href="whole-genome-sequencing-mutations.html#cb521-34"></a><span class="co">##  [1]  7 78  1 78 78 78 78  7 78  7  1 78  1 78  1 78  1 78  1  7  1 78  7  1  7</span></span>
<span id="cb521-35"><a href="whole-genome-sequencing-mutations.html#cb521-35"></a><span class="co">## [26] 78  7  1 78  7  1 78  7 78  1 78 78 78  7  1 78  1 73 78  7  1 73 78  7  7</span></span>
<span id="cb521-36"><a href="whole-genome-sequencing-mutations.html#cb521-36"></a><span class="co">## [51]  1 78  7  1 78 78  7  1 78  7  7  1 78  7 78  7</span></span>
<span id="cb521-37"><a href="whole-genome-sequencing-mutations.html#cb521-37"></a><span class="co">## attr(,&quot;na.action&quot;)</span></span>
<span id="cb521-38"><a href="whole-genome-sequencing-mutations.html#cb521-38"></a><span class="co">##   [1]   2   3   4   5   6   7   8   9  13  14  15  16  17  18  19  21  22  23</span></span>
<span id="cb521-39"><a href="whole-genome-sequencing-mutations.html#cb521-39"></a><span class="co">##  [19]  24  25  26  28  29  30  31  32  33  34  35  36  37  38  40  42  43  44</span></span>
<span id="cb521-40"><a href="whole-genome-sequencing-mutations.html#cb521-40"></a><span class="co">##  [37]  45  46  48  49  50  51  53  55  56  57  58  59  61  62  63  64  65  67</span></span>
<span id="cb521-41"><a href="whole-genome-sequencing-mutations.html#cb521-41"></a><span class="co">##  [55]  68  69  70  72  73  74  75  76  77  78  79  80  81  82  83  85  86  87</span></span>
<span id="cb521-42"><a href="whole-genome-sequencing-mutations.html#cb521-42"></a><span class="co">##  [73]  88  89  90  91  92  93  94  96  97  98  99 101 102 103 104 105 106 107</span></span>
<span id="cb521-43"><a href="whole-genome-sequencing-mutations.html#cb521-43"></a><span class="co">##  [91] 109 110 111 112 113 115 116 117 118 119 120 121 122 123 125 128 129 130</span></span>
<span id="cb521-44"><a href="whole-genome-sequencing-mutations.html#cb521-44"></a><span class="co">## [109] 132 133 135 136 137 138 140 141 142 143 144 145 146 147 148 149 150 151</span></span>
<span id="cb521-45"><a href="whole-genome-sequencing-mutations.html#cb521-45"></a><span class="co">## [127] 153 154 156 157 158 160 161 162 163 164 165 166 167 168 169 171 172 174</span></span>
<span id="cb521-46"><a href="whole-genome-sequencing-mutations.html#cb521-46"></a><span class="co">## [145] 175 176 177 179 180 181 182 183 184 186 187 189 190 191 192 193 194 195</span></span>
<span id="cb521-47"><a href="whole-genome-sequencing-mutations.html#cb521-47"></a><span class="co">## [163] 196 197 198 199 201 203 204 206 207 208 209 210 211 212 213 214 216 217</span></span>
<span id="cb521-48"><a href="whole-genome-sequencing-mutations.html#cb521-48"></a><span class="co">## [181] 218 219 220 221 222 223 225 227 229 231 232 233 234 235 236 237 238 240</span></span>
<span id="cb521-49"><a href="whole-genome-sequencing-mutations.html#cb521-49"></a><span class="co">## [199] 241 242 243 244 245 246 247 248 249 250 251 253 254 255 257 258 259 260</span></span>
<span id="cb521-50"><a href="whole-genome-sequencing-mutations.html#cb521-50"></a><span class="co">## [217] 262 263 264 265 266 268 269 270 271 272 273 274 277 278 281 282 283 284</span></span>
<span id="cb521-51"><a href="whole-genome-sequencing-mutations.html#cb521-51"></a><span class="co">## [235] 286 287 288 289 290 291 292 293 296 297 298 299 300 302 303 304 306 307</span></span>
<span id="cb521-52"><a href="whole-genome-sequencing-mutations.html#cb521-52"></a><span class="co">## [253] 308 309 310 311 312 313 314 315 316 317 318 319 320 321 323 324 326 327</span></span>
<span id="cb521-53"><a href="whole-genome-sequencing-mutations.html#cb521-53"></a><span class="co">## [271] 328 329 330 332 333 334 335 336 338 339 341 342 343 344 345 346 347 348</span></span>
<span id="cb521-54"><a href="whole-genome-sequencing-mutations.html#cb521-54"></a><span class="co">## [289] 349 350 353 354 356 357 358 360 361 362 363 364 365 366 367 368 369 370</span></span>
<span id="cb521-55"><a href="whole-genome-sequencing-mutations.html#cb521-55"></a><span class="co">## [307] 371 372 374 375 376 378 379 380 381 382 383</span></span>
<span id="cb521-56"><a href="whole-genome-sequencing-mutations.html#cb521-56"></a><span class="co">## attr(,&quot;class&quot;)</span></span>
<span id="cb521-57"><a href="whole-genome-sequencing-mutations.html#cb521-57"></a><span class="co">## [1] &quot;omit&quot;</span></span>
<span id="cb521-58"><a href="whole-genome-sequencing-mutations.html#cb521-58"></a></span>
<span id="cb521-59"><a href="whole-genome-sequencing-mutations.html#cb521-59"></a> <span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">2</span>),  <span class="dt">xpd =</span> <span class="ot">TRUE</span>)</span>
<span id="cb521-60"><a href="whole-genome-sequencing-mutations.html#cb521-60"></a> <span class="kw">image</span>(<span class="kw">t</span>(tempxb), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>), <span class="dt">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="dt">yaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb521-61"><a href="whole-genome-sequencing-mutations.html#cb521-61"></a> <span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length=</span><span class="kw">ncol</span>(tempxb)), <span class="kw">colnames</span>(tempxb), <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">cex.axis=</span><span class="fl">0.7</span>)</span>
<span id="cb521-62"><a href="whole-genome-sequencing-mutations.html#cb521-62"></a> <span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length=</span><span class="kw">nrow</span>(tempxb)), <span class="kw">rownames</span>(tempxb), <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">cex.axis=</span><span class="fl">0.7</span>)</span></code></pre></div>
<div class="figure"><span id="fig:1k"></span>
<img src="RatDCIS-bookdown_files/figure-html/1k-1.png" alt="summary of mutations acccording to frequency cosmic" width="672" />
<p class="caption">
Figure 21.7: summary of mutations acccording to frequency cosmic
</p>
</div>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="whole-genome-sequencing-mutations.html#cb522-1"></a><span class="co"># text(na.omit(hotspot1b$Y-1)/(ncol(tempxb)-1), na.omit(hotspot1b$X-1)/(nrow(tempxb)-1) , &quot;*&quot;)</span></span>
<span id="cb522-2"><a href="whole-genome-sequencing-mutations.html#cb522-2"></a><span class="co"># legend(&quot;top&quot;, inset = c(-0.5, -0.15),    legend = c(&quot;missense&quot;,&quot;frameshift&quot;, &quot;Nonsense&quot;, &quot;splice&quot;, &quot;hotspot human&quot;),  pch = c(19, 19, 19,19, 8),  col = c(1:4, &quot;black&quot;), horiz = T)</span></span>
<span id="cb522-3"><a href="whole-genome-sequencing-mutations.html#cb522-3"></a><span class="co"># mtext(&quot;top 90 mutations&quot;, side=3, line=-1, outer=T)</span></span></code></pre></div>
<p>Below is the above list refined according to cosmic specifc genes, and listing</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="whole-genome-sequencing-mutations.html#cb523-1"></a><span class="co"># par(mar = c(4, 8, 4, 2),  xpd = TRUE)</span></span>
<span id="cb523-2"><a href="whole-genome-sequencing-mutations.html#cb523-2"></a><span class="co"># image(t(tempyb), col=c(&quot;white&quot;, 1:4), xaxt=&#39;n&#39;, yaxt=&#39;n&#39;)</span></span>
<span id="cb523-3"><a href="whole-genome-sequencing-mutations.html#cb523-3"></a><span class="co"># axis(1, at=seq(0, 1, length=ncol(tempyb)), colnames(tempyb), las=2, cex.axis=0.5)</span></span>
<span id="cb523-4"><a href="whole-genome-sequencing-mutations.html#cb523-4"></a><span class="co"># axis(2, at=seq(0, 1, length=nrow(tempyb)), rownames(tempyb), las=2, cex.axis=0.5)</span></span>
<span id="cb523-5"><a href="whole-genome-sequencing-mutations.html#cb523-5"></a><span class="co"># text(na.omit(hotspot2$Y-1)/(ncol(tempyb)-1), na.omit(hotspot2$X-1)/(nrow(tempyb)-1) , &quot;*&quot;)</span></span>
<span id="cb523-6"><a href="whole-genome-sequencing-mutations.html#cb523-6"></a><span class="co"># legend(&quot;top&quot;, inset = c(-0.5, -0.15),    legend = c(&quot;missense&quot;,&quot;frameshift&quot;, &quot;Nonsense&quot;, &quot;splice&quot;, &quot;hotspot human&quot;),  pch = c(19, 19, 19,19, 8),  col = c(1:4, &quot;black&quot;), horiz = T)</span></span>
<span id="cb523-7"><a href="whole-genome-sequencing-mutations.html#cb523-7"></a><span class="co"># mtext(&quot; &#39;Hotspot&#39; mutations only&quot;, side=3, line=-1, outer=T)</span></span>
<span id="cb523-8"><a href="whole-genome-sequencing-mutations.html#cb523-8"></a></span>
<span id="cb523-9"><a href="whole-genome-sequencing-mutations.html#cb523-9"></a><span class="co">## Plot by picking out cancer related genes</span></span>
<span id="cb523-10"><a href="whole-genome-sequencing-mutations.html#cb523-10"></a><span class="co">#pdf(&quot;figure-outputs/1k_redo.pdf&quot;, height=7.5, width=17.3)</span></span>
<span id="cb523-11"><a href="whole-genome-sequencing-mutations.html#cb523-11"></a><span class="kw">palette</span>(<span class="kw">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&quot;Set1&quot;</span>))</span>
<span id="cb523-12"><a href="whole-genome-sequencing-mutations.html#cb523-12"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">2</span>),  <span class="dt">xpd =</span> <span class="ot">TRUE</span>)</span>
<span id="cb523-13"><a href="whole-genome-sequencing-mutations.html#cb523-13"></a><span class="kw">image</span>(<span class="kw">t</span>(tempzb), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="dt">yaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb523-14"><a href="whole-genome-sequencing-mutations.html#cb523-14"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length=</span><span class="kw">ncol</span>(tempzb)), <span class="kw">colnames</span>(tempzb), <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">cex.axis=</span><span class="fl">0.7</span>)</span>
<span id="cb523-15"><a href="whole-genome-sequencing-mutations.html#cb523-15"></a><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length=</span><span class="kw">nrow</span>(tempzb)), <span class="kw">rownames</span>(tempzb), <span class="dt">las=</span><span class="dv">2</span>,  <span class="dt">cex.axis=</span><span class="fl">0.7</span>)</span>
<span id="cb523-16"><a href="whole-genome-sequencing-mutations.html#cb523-16"></a><span class="co">#text(na.omit(hotspotzb$Y-1)/(ncol(tempzb)-1), na.omit(hotspotzb$X-1)/(nrow(tempzb)-1) , &quot;*&quot;)</span></span>
<span id="cb523-17"><a href="whole-genome-sequencing-mutations.html#cb523-17"></a><span class="kw">legend</span>(<span class="st">&quot;top&quot;</span>, <span class="dt">inset =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">-0.15</span>),    <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;missense&quot;</span>,<span class="st">&quot;frameshift&quot;</span>, <span class="st">&quot;Nonsense&quot;</span>, <span class="st">&quot;splice&quot;</span>, <span class="st">&quot;hotspot human&quot;</span>),  <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">19</span>, <span class="dv">19</span>, <span class="dv">19</span>,<span class="dv">19</span>, <span class="dv">8</span>),  <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="st">&quot;black&quot;</span>), <span class="dt">horiz =</span> T)</span>
<span id="cb523-18"><a href="whole-genome-sequencing-mutations.html#cb523-18"></a><span class="kw">mtext</span>(<span class="st">&quot;Cancer related genes&quot;</span>, <span class="dt">side=</span><span class="dv">3</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">outer=</span>T)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-149-1.png" width="672" /></p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="whole-genome-sequencing-mutations.html#cb524-1"></a><span class="co">#dev.off()</span></span>
<span id="cb524-2"><a href="whole-genome-sequencing-mutations.html#cb524-2"></a></span>
<span id="cb524-3"><a href="whole-genome-sequencing-mutations.html#cb524-3"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">2</span>),  <span class="dt">xpd =</span> <span class="ot">TRUE</span>)</span>
<span id="cb524-4"><a href="whole-genome-sequencing-mutations.html#cb524-4"></a><span class="kw">image</span>(<span class="kw">t</span>(tempz2), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="dt">yaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb524-5"><a href="whole-genome-sequencing-mutations.html#cb524-5"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length=</span><span class="kw">ncol</span>(tempz2)), <span class="kw">colnames</span>(tempz2), <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">cex.axis=</span><span class="fl">0.7</span>)</span>
<span id="cb524-6"><a href="whole-genome-sequencing-mutations.html#cb524-6"></a><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length=</span><span class="kw">nrow</span>(tempz2)), <span class="kw">rownames</span>(tempz2), <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">cex.axis=</span><span class="fl">0.7</span>)</span>
<span id="cb524-7"><a href="whole-genome-sequencing-mutations.html#cb524-7"></a><span class="co">#text(na.omit(hotspotzb2$Y-1)/(ncol(tempz2)-1), na.omit(hotspotzb2$X-1)/(nrow(tempz2)-1) , &quot;*&quot;)</span></span>
<span id="cb524-8"><a href="whole-genome-sequencing-mutations.html#cb524-8"></a><span class="kw">legend</span>(<span class="st">&quot;top&quot;</span>, <span class="dt">inset =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">-0.15</span>),    <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;missense&quot;</span>,<span class="st">&quot;frameshift&quot;</span>, <span class="st">&quot;Nonsense&quot;</span>, <span class="st">&quot;splice&quot;</span>, <span class="st">&quot;hotspot human&quot;</span>),  <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">19</span>, <span class="dv">19</span>, <span class="dv">19</span>,<span class="dv">19</span>, <span class="dv">8</span>),  <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="st">&quot;black&quot;</span>), <span class="dt">horiz =</span> T)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-149-2.png" width="672" /></p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="whole-genome-sequencing-mutations.html#cb525-1"></a></span>
<span id="cb525-2"><a href="whole-genome-sequencing-mutations.html#cb525-2"></a><span class="co">#dev.off()</span></span></code></pre></div>
<p>Extract breast-cancer related information:</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="whole-genome-sequencing-mutations.html#cb526-1"></a>OtherBreast=<span class="kw">c</span>(<span class="st">&quot;Kmt2d&quot;</span>, <span class="st">&quot;Kmt2c&quot;</span>, <span class="st">&quot;Gata3&quot;</span>, <span class="st">&quot;Pten&quot;</span>)</span>
<span id="cb526-2"><a href="whole-genome-sequencing-mutations.html#cb526-2"></a>X2=rGeneOut2[, <span class="kw">na.omit</span>(<span class="kw">match</span>(<span class="kw">c</span>(RatBreastCosmic, OtherBreast), <span class="kw">colnames</span>(rGeneOut2)))]</span>
<span id="cb526-3"><a href="whole-genome-sequencing-mutations.html#cb526-3"></a><span class="kw">rownames</span>(X2)=Cdata<span class="op">$</span>NewID[<span class="kw">sapply</span>(<span class="kw">rownames</span>(X2), <span class="cf">function</span>(x) <span class="kw">grep</span>(x, Cdata<span class="op">$</span>WGS))]</span>
<span id="cb526-4"><a href="whole-genome-sequencing-mutations.html#cb526-4"></a>X2b=X2[<span class="kw">order</span>(X2[ ,<span class="dv">1</span>], X2[ ,<span class="dv">2</span>], X2[ ,<span class="dv">7</span>], X2[ ,<span class="dv">17</span>], X2[ ,<span class="dv">11</span>]),]</span>
<span id="cb526-5"><a href="whole-genome-sequencing-mutations.html#cb526-5"></a><span class="kw">heatmap.2</span>(X2b, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">trace=</span><span class="st">&quot;none&quot;</span>, <span class="dt">sepcolor=</span><span class="st">&quot;grey85&quot;</span>, <span class="dt">colsep=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X2b)), <span class="dt">rowsep=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(X2b)), <span class="dt">sepwidth=</span><span class="kw">c</span>(<span class="fl">0.005</span>, <span class="fl">0.005</span>))</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-150-1.png" width="672" /></p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="whole-genome-sequencing-mutations.html#cb527-1"></a></span>
<span id="cb527-2"><a href="whole-genome-sequencing-mutations.html#cb527-2"></a><span class="co"># Also save this information to file for pathway maps:</span></span>
<span id="cb527-3"><a href="whole-genome-sequencing-mutations.html#cb527-3"></a>rGene2=<span class="kw">colSums</span>(<span class="kw">sign</span>(rGeneOut2))<span class="op">/</span><span class="kw">nrow</span>(rGeneOut2)</span>
<span id="cb527-4"><a href="whole-genome-sequencing-mutations.html#cb527-4"></a><span class="kw">names</span>(rGene2)=<span class="kw">toupper</span>(<span class="kw">names</span>(rGene2))</span></code></pre></div>
</div>
</div>
<div id="metacore-analysis-of-commonly-mutated-pathways" class="section level2">
<h2><span class="header-section-number">21.6</span> Metacore analysis of commonly mutated pathways</h2>
<p>Save these lists for metacore</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="whole-genome-sequencing-mutations.html#cb528-1"></a>allMut=<span class="kw">unique</span>(MeltWGSCodingB<span class="op">$</span>Gene_Symbol)</span>
<span id="cb528-2"><a href="whole-genome-sequencing-mutations.html#cb528-2"></a><span class="kw">write.csv</span>(allMut, <span class="dt">file=</span><span class="kw">sprintf</span>(<span class="st">&quot;outputs/all_mut_rat_WGS_coding_metacore_%s.csv&quot;</span>, <span class="kw">Sys.Date</span>()), <span class="dt">row.names =</span> F, <span class="dt">quote=</span>F)</span>
<span id="cb528-3"><a href="whole-genome-sequencing-mutations.html#cb528-3"></a></span>
<span id="cb528-4"><a href="whole-genome-sequencing-mutations.html#cb528-4"></a>allMut=<span class="kw">unique</span>(MeltCosmic<span class="op">$</span>Gene_Symbol)</span>
<span id="cb528-5"><a href="whole-genome-sequencing-mutations.html#cb528-5"></a><span class="kw">write.csv</span>(allMut, <span class="dt">file=</span><span class="kw">sprintf</span>(<span class="st">&quot;outputs/all_mut_rat_WES_cosmic_metacore_%s.csv&quot;</span>, <span class="kw">Sys.Date</span>()), <span class="dt">row.names =</span> F, <span class="dt">quote=</span>F)</span></code></pre></div>
<p>Load the metacore results:</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="whole-genome-sequencing-mutations.html#cb529-1"></a>Process_Networks=readxl<span class="op">::</span><span class="kw">read_excel</span>(<span class="st">&quot;../data/wholegenome_mutations/all rat WES coding process networks-jan2021.xls&quot;</span>, <span class="dv">1</span>, <span class="dt">skip=</span><span class="dv">2</span>)</span>
<span id="cb529-2"><a href="whole-genome-sequencing-mutations.html#cb529-2"></a><span class="co">#Pathway_Maps=readxl::read_excel(&quot;../data/wholegenome_mutations/all rat WES pathway maps coding-cosmic.xls&quot;, 1, skip = 2)</span></span>
<span id="cb529-3"><a href="whole-genome-sequencing-mutations.html#cb529-3"></a></span>
<span id="cb529-4"><a href="whole-genome-sequencing-mutations.html#cb529-4"></a>Terms_PN=<span class="kw">strsplit</span>(Process_Networks<span class="op">$</span>Networks, <span class="st">&quot;_&quot;</span>)</span>
<span id="cb529-5"><a href="whole-genome-sequencing-mutations.html#cb529-5"></a>TermsPN1=<span class="kw">sapply</span>(Terms_PN, <span class="cf">function</span>(x) x[<span class="dv">1</span>])</span>
<span id="cb529-6"><a href="whole-genome-sequencing-mutations.html#cb529-6"></a>TermsPN2=<span class="kw">sapply</span>(Terms_PN, <span class="cf">function</span>(x) x[<span class="dv">2</span>])</span>
<span id="cb529-7"><a href="whole-genome-sequencing-mutations.html#cb529-7"></a></span>
<span id="cb529-8"><a href="whole-genome-sequencing-mutations.html#cb529-8"></a></span>
<span id="cb529-9"><a href="whole-genome-sequencing-mutations.html#cb529-9"></a><span class="kw">load</span>(<span class="st">&quot;../anntotations/Metacore_extracted_Process_networks_nov2020.RData&quot;</span>)</span>
<span id="cb529-10"><a href="whole-genome-sequencing-mutations.html#cb529-10"></a>n2=<span class="kw">which</span>(Process_Networks<span class="op">$</span>FDR<span class="op">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb529-11"><a href="whole-genome-sequencing-mutations.html#cb529-11"></a>m1=<span class="kw">match</span>(Process_Networks<span class="op">$</span>Networks[n2], <span class="kw">names</span>(PathwayMapSet))</span>
<span id="cb529-12"><a href="whole-genome-sequencing-mutations.html#cb529-12"></a><span class="co">#figure out which is significant</span></span>
<span id="cb529-13"><a href="whole-genome-sequencing-mutations.html#cb529-13"></a></span>
<span id="cb529-14"><a href="whole-genome-sequencing-mutations.html#cb529-14"></a></span>
<span id="cb529-15"><a href="whole-genome-sequencing-mutations.html#cb529-15"></a>N2=<span class="kw">lapply</span>(m1, <span class="cf">function</span>(x) <span class="kw">which</span>(MeltWGSCodingB<span class="op">$</span>Hum_Gene <span class="op">%in%</span><span class="st"> </span>PathwayMapSet[[x]]))</span>
<span id="cb529-16"><a href="whole-genome-sequencing-mutations.html#cb529-16"></a>GList2=<span class="kw">lapply</span>(N2, <span class="cf">function</span>(x) MeltWGSCodingB[x, <span class="kw">c</span>(<span class="st">&quot;Hum_Gene&quot;</span>, <span class="st">&quot;L1&quot;</span>)])</span>
<span id="cb529-17"><a href="whole-genome-sequencing-mutations.html#cb529-17"></a>SumTable2=<span class="kw">sapply</span>(GList2, <span class="cf">function</span>(x) <span class="kw">summary</span>(<span class="kw">factor</span>(x[ ,<span class="st">&quot;L1&quot;</span>], <span class="dt">levels=</span><span class="kw">unique</span>(MeltWGSCodingB<span class="op">$</span>L1))))</span>
<span id="cb529-18"><a href="whole-genome-sequencing-mutations.html#cb529-18"></a><span class="kw">colnames</span>(SumTable2)=Process_Networks<span class="op">$</span>Networks[n2]</span>
<span id="cb529-19"><a href="whole-genome-sequencing-mutations.html#cb529-19"></a><span class="co">#listGenes=strsplit(Process_Networks$Network.Objects.from.Active.Data[1:15], &quot;,&quot;)</span></span>
<span id="cb529-20"><a href="whole-genome-sequencing-mutations.html#cb529-20"></a></span>
<span id="cb529-21"><a href="whole-genome-sequencing-mutations.html#cb529-21"></a><span class="co">## do this for ERS1 networks</span></span>
<span id="cb529-22"><a href="whole-genome-sequencing-mutations.html#cb529-22"></a>er1=GList2[[<span class="dv">8</span>]] <span class="co">#6,8, 35</span></span>
<span id="cb529-23"><a href="whole-genome-sequencing-mutations.html#cb529-23"></a>axtemp=<span class="kw">table</span>(er1[ ,<span class="dv">1</span>], er1[,<span class="dv">2</span>])</span>
<span id="cb529-24"><a href="whole-genome-sequencing-mutations.html#cb529-24"></a><span class="kw">colnames</span>(axtemp)=Cdata<span class="op">$</span>NewID[<span class="kw">sapply</span>(<span class="kw">colnames</span>(axtemp), <span class="cf">function</span>(x) <span class="kw">grep</span>(x, Cdata<span class="op">$</span>WGS) ) ]</span>
<span id="cb529-25"><a href="whole-genome-sequencing-mutations.html#cb529-25"></a>a2=<span class="kw">heatmap.2</span>(<span class="kw">sign</span>(axtemp), <span class="dt">col=</span><span class="kw">brewer.pal</span>(<span class="dv">3</span>, <span class="st">&quot;Blues&quot;</span>), <span class="dt">trace=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:1l-1"></span>
<img src="RatDCIS-bookdown_files/figure-html/1l-1.png" alt="summary of metacore common mutated pathways" width="672" />
<p class="caption">
Figure 21.8: summary of metacore common mutated pathways
</p>
</div>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="whole-genome-sequencing-mutations.html#cb530-1"></a></span>
<span id="cb530-2"><a href="whole-genome-sequencing-mutations.html#cb530-2"></a><span class="kw">image</span>(<span class="kw">t</span>(a2<span class="op">$</span>carpet), <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;skyblue&quot;</span>))</span>
<span id="cb530-3"><a href="whole-genome-sequencing-mutations.html#cb530-3"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length=</span><span class="kw">nrow</span>(axtemp)), <span class="kw">colnames</span>(a2<span class="op">$</span>carpet), <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">cex.axis=</span><span class="fl">0.7</span>)</span>
<span id="cb530-4"><a href="whole-genome-sequencing-mutations.html#cb530-4"></a><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length=</span><span class="kw">ncol</span>(axtemp)), <span class="kw">rownames</span>(a2<span class="op">$</span>carpet), <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">cex.axis=</span><span class="fl">0.7</span>)</span></code></pre></div>
<div class="figure"><span id="fig:1l-2"></span>
<img src="RatDCIS-bookdown_files/figure-html/1l-2.png" alt="summary of metacore common mutated pathways" width="672" />
<p class="caption">
Figure 21.9: summary of metacore common mutated pathways
</p>
</div>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="whole-genome-sequencing-mutations.html#cb531-1"></a></span>
<span id="cb531-2"><a href="whole-genome-sequencing-mutations.html#cb531-2"></a><span class="co"># load(&quot;../anntotations/Metacore_extracted_pathway_maps_nov2020.RData&quot;)</span></span>
<span id="cb531-3"><a href="whole-genome-sequencing-mutations.html#cb531-3"></a><span class="co"># n2=which(Pathway_Maps$FDR...7&lt;0.001)</span></span>
<span id="cb531-4"><a href="whole-genome-sequencing-mutations.html#cb531-4"></a><span class="co"># m1=match(Pathway_Maps$Maps[n2], names(PathwayMapSet))</span></span>
<span id="cb531-5"><a href="whole-genome-sequencing-mutations.html#cb531-5"></a></span>
<span id="cb531-6"><a href="whole-genome-sequencing-mutations.html#cb531-6"></a></span>
<span id="cb531-7"><a href="whole-genome-sequencing-mutations.html#cb531-7"></a><span class="co"># N2=lapply(m1, function(x) which(MeltWGSCodingB$Hum_Gene %in% PathwayMapSet[[x]]))</span></span>
<span id="cb531-8"><a href="whole-genome-sequencing-mutations.html#cb531-8"></a><span class="co"># GList2=lapply(N2, function(x) MeltWGSCodingB[x, c(&quot;Hum_Gene&quot;, &quot;L1&quot;)])</span></span>
<span id="cb531-9"><a href="whole-genome-sequencing-mutations.html#cb531-9"></a><span class="co"># SumTable3=sapply(GList2, function(x) summary(factor(x[ ,&quot;L1&quot;], levels=unique(MeltWGSCodingB$L1))))</span></span>
<span id="cb531-10"><a href="whole-genome-sequencing-mutations.html#cb531-10"></a><span class="co"># colnames(SumTable3)=Pathway_Maps$Maps[n2]</span></span>
<span id="cb531-11"><a href="whole-genome-sequencing-mutations.html#cb531-11"></a><span class="co"># #listGenes=strsplit(Process_Networks$Network.Objects.from.Active.Data[1:15], &quot;,&quot;)</span></span>
<span id="cb531-12"><a href="whole-genome-sequencing-mutations.html#cb531-12"></a><span class="co"># head(SumTable3)</span></span>
<span id="cb531-13"><a href="whole-genome-sequencing-mutations.html#cb531-13"></a></span>
<span id="cb531-14"><a href="whole-genome-sequencing-mutations.html#cb531-14"></a><span class="co">#pdf(&quot;rslt/WGS/Metacore_analysis_coding_mutations.pdf&quot;, height=13, width=13)</span></span>
<span id="cb531-15"><a href="whole-genome-sequencing-mutations.html#cb531-15"></a></span>
<span id="cb531-16"><a href="whole-genome-sequencing-mutations.html#cb531-16"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb531-17"><a href="whole-genome-sequencing-mutations.html#cb531-17"></a>n2=<span class="kw">order</span>(Process_Networks<span class="op">$</span>FDR)</span>
<span id="cb531-18"><a href="whole-genome-sequencing-mutations.html#cb531-18"></a><span class="kw">barplot</span>(<span class="op">-</span><span class="kw">log10</span>(<span class="kw">as.numeric</span>(Process_Networks<span class="op">$</span>FDR[n2[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>]])), <span class="dt">names.arg =</span> Process_Networks<span class="op">$</span>Networks[n2[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>]], <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">main=</span><span class="st">&quot;Process networks all coding&quot;</span>, <span class="dt">horiz =</span> T, <span class="dt">cex.names =</span> <span class="fl">0.5</span>)</span>
<span id="cb531-19"><a href="whole-genome-sequencing-mutations.html#cb531-19"></a>n2=<span class="kw">order</span>(Process_Networks<span class="op">$</span>FDR)</span>
<span id="cb531-20"><a href="whole-genome-sequencing-mutations.html#cb531-20"></a><span class="co"># barplot(-log10(as.numeric(Process_Networks$FDR...11[n2[1:15]])), names.arg = Process_Networks$Networks[n2[1:15]], las=2, main=&quot;Process networks cosmic only&quot;, horiz = T, cex.names = 0.5)</span></span>
<span id="cb531-21"><a href="whole-genome-sequencing-mutations.html#cb531-21"></a><span class="co"># barplot(-log10(as.numeric(Pathway_Maps$FDR[1:15])), names.arg = Pathway_Maps$Maps[1:15], las=2, main=&quot;Pathway Maps&quot;, horiz = T, cex.names = 0.5)</span></span></code></pre></div>
<div class="figure"><span id="fig:1l-3"></span>
<img src="RatDCIS-bookdown_files/figure-html/1l-3.png" alt="summary of metacore common mutated pathways" width="672" />
<p class="caption">
Figure 21.10: summary of metacore common mutated pathways
</p>
</div>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="whole-genome-sequencing-mutations.html#cb532-1"></a><span class="kw">par</span>(<span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>))</span>
<span id="cb532-2"><a href="whole-genome-sequencing-mutations.html#cb532-2"></a>rNames=<span class="kw">strsplit</span>(<span class="kw">colnames</span>(SumTable2), <span class="st">&quot;_&quot;</span>)</span>
<span id="cb532-3"><a href="whole-genome-sequencing-mutations.html#cb532-3"></a>rNames2=<span class="kw">sapply</span>(rNames, <span class="cf">function</span>(x) x[<span class="dv">1</span>])</span>
<span id="cb532-4"><a href="whole-genome-sequencing-mutations.html#cb532-4"></a>cCols=<span class="kw">brewer.pal</span>(<span class="dv">12</span>,<span class="st">&quot;Set3&quot;</span>)[<span class="kw">factor</span>(rNames2)]</span>
<span id="cb532-5"><a href="whole-genome-sequencing-mutations.html#cb532-5"></a>lx=<span class="kw">order</span>(cCols)</span>
<span id="cb532-6"><a href="whole-genome-sequencing-mutations.html#cb532-6"></a><span class="kw">colnames</span>(SumTable2)=<span class="kw">sapply</span>(rNames, <span class="cf">function</span>(x) x[<span class="dv">2</span>])</span>
<span id="cb532-7"><a href="whole-genome-sequencing-mutations.html#cb532-7"></a><span class="kw">rownames</span>(SumTable2)=Cdata<span class="op">$</span>NewID[<span class="kw">sapply</span>(<span class="kw">rownames</span>(SumTable2), <span class="cf">function</span>(x) <span class="kw">grep</span>(x, Cdata<span class="op">$</span>WGS))]</span>
<span id="cb532-8"><a href="whole-genome-sequencing-mutations.html#cb532-8"></a><span class="kw">heatmap.2</span>(<span class="kw">sign</span>(SumTable2[, lx]), <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">trace=</span><span class="st">&quot;none&quot;</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;skyblue&quot;</span>), <span class="dt">main=</span><span class="st">&quot;Process Networks: scaled No mutations affecting each pathway&quot;</span>,</span>
<span id="cb532-9"><a href="whole-genome-sequencing-mutations.html#cb532-9"></a>          <span class="dt">ColSideColors =</span> cCols[lx], <span class="dt">Colv =</span> <span class="ot">NA</span>)</span></code></pre></div>
<div class="figure"><span id="fig:1lb"></span>
<img src="RatDCIS-bookdown_files/figure-html/1lb-1.png" alt="summary of metacore common mutated pathways" width="672" />
<p class="caption">
Figure 21.11: summary of metacore common mutated pathways
</p>
</div>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="whole-genome-sequencing-mutations.html#cb533-1"></a></span>
<span id="cb533-2"><a href="whole-genome-sequencing-mutations.html#cb533-2"></a></span>
<span id="cb533-3"><a href="whole-genome-sequencing-mutations.html#cb533-3"></a><span class="kw">write.csv</span>(<span class="kw">cbind</span>(SumTable2[, lx],rNames2[lx]), <span class="dt">file=</span><span class="st">&quot;nature-tables/1l_samples_with_muttions.csv&quot;</span>)</span>
<span id="cb533-4"><a href="whole-genome-sequencing-mutations.html#cb533-4"></a><span class="co">#rNames2[lx]</span></span>
<span id="cb533-5"><a href="whole-genome-sequencing-mutations.html#cb533-5"></a><span class="co"># par(oma=c(2, 0,0,3))</span></span>
<span id="cb533-6"><a href="whole-genome-sequencing-mutations.html#cb533-6"></a><span class="co"># # rNames=strsplit(colnames(SumTable3), &quot;_&quot;)</span></span>
<span id="cb533-7"><a href="whole-genome-sequencing-mutations.html#cb533-7"></a><span class="co"># # rNames2=sapply(rNames, function(x) x[1])</span></span>
<span id="cb533-8"><a href="whole-genome-sequencing-mutations.html#cb533-8"></a><span class="co"># # cCols=brewer.pal(12,&quot;Set3&quot;)[factor(rNames2)]</span></span>
<span id="cb533-9"><a href="whole-genome-sequencing-mutations.html#cb533-9"></a><span class="co"># # lx=order(cCols)r</span></span>
<span id="cb533-10"><a href="whole-genome-sequencing-mutations.html#cb533-10"></a><span class="co"># heatmap.2(SumTable3, scale=&quot;col&quot;, trace=&quot;none&quot;, col=brewer.pal(9, &quot;Blues&quot;), main=&quot;Pathway Maps&quot;)</span></span>
<span id="cb533-11"><a href="whole-genome-sequencing-mutations.html#cb533-11"></a><span class="co"># write.csv(SumTable3, file=&quot;outputs/no mutations pathway maps all coding.csv&quot;)</span></span>
<span id="cb533-12"><a href="whole-genome-sequencing-mutations.html#cb533-12"></a><span class="co"># write.csv(SumTable2, file=&quot;outputs/no mutations process networks all coding.csv&quot;)</span></span>
<span id="cb533-13"><a href="whole-genome-sequencing-mutations.html#cb533-13"></a><span class="co">#dev.off()</span></span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bcr-clonotype-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mutations-in-rna.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["RatDCIS-bookdown.pdf", "RatDCIS-bookdown.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
