<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Spatial statistics | NMU-induced rat tumor models for I/O</title>
  <meta name="description" content="This is a summary of the code required in the study: ‘NMU-induced rat tumor models for I/O’" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Spatial statistics | NMU-induced rat tumor models for I/O" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://polyak-lab.github.io/RatDCISbookdown/" />
  
  <meta property="og:description" content="This is a summary of the code required in the study: ‘NMU-induced rat tumor models for I/O’" />
  <meta name="github-repo" content="polyak-lab/RatDCISbookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Spatial statistics | NMU-induced rat tumor models for I/O" />
  
  <meta name="twitter:description" content="This is a summary of the code required in the study: ‘NMU-induced rat tumor models for I/O’" />
  

<meta name="author" content="Anne Trinh" />


<meta name="date" content="2021-06-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="whole-slide-imaging.html"/>
<link rel="next" href="expression-data.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.17/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<script src="libs/jszip-1.10.20/jszip.min.js"></script>
<link href="libs/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/forceGraph-0.1.0.9/common.css" rel="stylesheet" />
<script src="libs/forceGraph-0.1.0.9/common.js"></script>
<script src="libs/forceGraph-0.1.0.9/jquery.min.js"></script>
<script src="libs/forceGraph-0.1.0.9/settings.js"></script>
<script src="libs/forceGraph-0.1.0.9/sigma.min.js"></script>
<script src="libs/forceGraph-0.1.0.9/plugins.min.js"></script>
<script src="libs/forceGraph-binding-0.99.19/forceGraph.js"></script>
<script type="text/javascript">
  
  // toggle visibility of R source blocks in R Markdown output
function toggle_R() {
  var x = document.getElementsByClassName('r');
  if (x.length == 0) return;
  function toggle_vis(o) {
    var d = o.style.display;
    o.style.display = (d == 'block' || d == '') ? 'none':'block';
  }
  
  for (i = 0; i < x.length; i++) {
    var y = x[i];
    if (y.tagName.toLowerCase() === 'pre') toggle_vis(y);
  }
  
  var elem = document.getElementById("myButton1");
  if (elem.value === "Hide Global") elem.value = "Show Global";
  else elem.value = "Hide Global";
}

document.write('<input onclick="toggle_R();" type="button" value="Hide Global" id="myButton1" style="position: absolute; top: 10%; right: 2%; z-index: 200"></input>')

</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Rat prevention study</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a><ul>
<li class="chapter" data-level="1.1" data-path="prerequisites.html"><a href="prerequisites.html#packages-and-software"><i class="fa fa-check"></i><b>1.1</b> Packages and Software</a></li>
<li class="chapter" data-level="1.2" data-path="prerequisites.html"><a href="prerequisites.html#external-software"><i class="fa fa-check"></i><b>1.2</b> External software</a></li>
<li class="chapter" data-level="1.3" data-path="prerequisites.html"><a href="prerequisites.html#annotations"><i class="fa fa-check"></i><b>1.3</b> Annotations</a><ul>
<li class="chapter" data-level="1.3.1" data-path="prerequisites.html"><a href="prerequisites.html#genomic-properties"><i class="fa fa-check"></i><b>1.3.1</b> Genomic properties</a></li>
<li class="chapter" data-level="1.3.2" data-path="prerequisites.html"><a href="prerequisites.html#gene-name-homologs-between-organisms"><i class="fa fa-check"></i><b>1.3.2</b> Gene name homologs between organisms</a></li>
<li class="chapter" data-level="1.3.3" data-path="prerequisites.html"><a href="prerequisites.html#gene-signatures-and-data-bases"><i class="fa fa-check"></i><b>1.3.3</b> Gene signatures and data-bases</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cohort-characteristics.html"><a href="cohort-characteristics.html"><i class="fa fa-check"></i><b>2</b> Cohort characteristics</a><ul>
<li class="chapter" data-level="2.1" data-path="cohort-characteristics.html"><a href="cohort-characteristics.html#size-information"><i class="fa fa-check"></i><b>2.1</b> Size information</a></li>
<li class="chapter" data-level="2.2" data-path="cohort-characteristics.html"><a href="cohort-characteristics.html#calculating-growth-rates"><i class="fa fa-check"></i><b>2.2</b> Calculating growth rates</a></li>
<li class="chapter" data-level="2.3" data-path="cohort-characteristics.html"><a href="cohort-characteristics.html#km-curves-for-survival"><i class="fa fa-check"></i><b>2.3</b> KM curves for survival</a></li>
<li class="chapter" data-level="2.4" data-path="cohort-characteristics.html"><a href="cohort-characteristics.html#facs-data-dncd45epcam"><i class="fa fa-check"></i><b>2.4</b> FACS data (DN/CD45/EpCAM)</a></li>
<li class="chapter" data-level="2.5" data-path="cohort-characteristics.html"><a href="cohort-characteristics.html#facs-data"><i class="fa fa-check"></i><b>2.5</b> FACS data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cohort-summary-table.html"><a href="cohort-summary-table.html"><i class="fa fa-check"></i><b>3</b> Cohort Summary Table</a><ul>
<li class="chapter" data-level="3.1" data-path="cohort-summary-table.html"><a href="cohort-summary-table.html#total-number-of-samples"><i class="fa fa-check"></i><b>3.1</b> Total number of samples</a></li>
<li class="chapter" data-level="3.2" data-path="cohort-summary-table.html"><a href="cohort-summary-table.html#compare-the-characterisation-vs-progression-cohort"><i class="fa fa-check"></i><b>3.2</b> Compare the characterisation vs progression cohort</a></li>
<li class="chapter" data-level="3.3" data-path="cohort-summary-table.html"><a href="cohort-summary-table.html#summary-of-the-rna-data"><i class="fa fa-check"></i><b>3.3</b> Summary of the RNA data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="whole-slide-imaging.html"><a href="whole-slide-imaging.html"><i class="fa fa-check"></i><b>4</b> Whole-slide imaging</a><ul>
<li class="chapter" data-level="4.1" data-path="whole-slide-imaging.html"><a href="whole-slide-imaging.html#associate-the-frequencies-with-other-data-types"><i class="fa fa-check"></i><b>4.1</b> Associate the frequencies with other data types</a></li>
<li class="chapter" data-level="4.2" data-path="whole-slide-imaging.html"><a href="whole-slide-imaging.html#cellular-composition"><i class="fa fa-check"></i><b>4.2</b> Cellular composition</a></li>
<li class="chapter" data-level="4.3" data-path="whole-slide-imaging.html"><a href="whole-slide-imaging.html#associate-composition-with-other-covariates"><i class="fa fa-check"></i><b>4.3</b> Associate composition with other covariates</a></li>
<li class="chapter" data-level="4.4" data-path="whole-slide-imaging.html"><a href="whole-slide-imaging.html#estimate-tumor-size"><i class="fa fa-check"></i><b>4.4</b> Estimate tumor size</a></li>
<li class="chapter" data-level="4.5" data-path="whole-slide-imaging.html"><a href="whole-slide-imaging.html#correlations-between-different-subpopulations"><i class="fa fa-check"></i><b>4.5</b> Correlations between different subpopulations</a></li>
<li class="chapter" data-level="4.6" data-path="whole-slide-imaging.html"><a href="whole-slide-imaging.html#associations-between-cd8-counts-with-other-clinical-variables"><i class="fa fa-check"></i><b>4.6</b> Associations between CD8 counts with other clinical variables</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spatial-statistics.html"><a href="spatial-statistics.html"><i class="fa fa-check"></i><b>5</b> Spatial statistics</a><ul>
<li class="chapter" data-level="5.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#knn-distances"><i class="fa fa-check"></i><b>5.1</b> knn-Distances:</a><ul>
<li class="chapter" data-level="5.1.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#comparison-to-manual-classification"><i class="fa fa-check"></i><b>5.1.1</b> Comparison to manual classification</a></li>
<li class="chapter" data-level="5.1.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#associations-with-outcome-to-treatment"><i class="fa fa-check"></i><b>5.1.2</b> Associations with outcome to treatment</a></li>
<li class="chapter" data-level="5.1.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#growth"><i class="fa fa-check"></i><b>5.1.3</b> Growth</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#the-interacting-fraction"><i class="fa fa-check"></i><b>5.2</b> The interacting fraction</a><ul>
<li class="chapter" data-level="5.2.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#comparison-to-manual-select-optimal-r"><i class="fa fa-check"></i><b>5.2.1</b> Comparison to manual &amp; select optimal r</a></li>
<li class="chapter" data-level="5.2.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#growth-1"><i class="fa fa-check"></i><b>5.2.2</b> Growth</a></li>
<li class="chapter" data-level="5.2.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#treatment"><i class="fa fa-check"></i><b>5.2.3</b> Treatment</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#m-h-distances"><i class="fa fa-check"></i><b>5.3</b> M-H distances</a><ul>
<li class="chapter" data-level="5.3.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#comparison-to-manual-scoring"><i class="fa fa-check"></i><b>5.3.1</b> Comparison to Manual Scoring</a></li>
<li class="chapter" data-level="5.3.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#growth-2"><i class="fa fa-check"></i><b>5.3.2</b> Growth</a></li>
<li class="chapter" data-level="5.3.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#treatment-1"><i class="fa fa-check"></i><b>5.3.3</b> Treatment</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="spatial-statistics.html"><a href="spatial-statistics.html#comparison-between-metrics"><i class="fa fa-check"></i><b>5.4</b> Comparison between metrics</a></li>
<li class="chapter" data-level="5.5" data-path="spatial-statistics.html"><a href="spatial-statistics.html#distances-to-unclassified-cells"><i class="fa fa-check"></i><b>5.5</b> Distances to “unclassified cells”</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="expression-data.html"><a href="expression-data.html"><i class="fa fa-check"></i><b>6</b> Expression data</a><ul>
<li class="chapter" data-level="6.1" data-path="expression-data.html"><a href="expression-data.html#running-alignment"><i class="fa fa-check"></i><b>6.1</b> Running alignment</a></li>
<li class="chapter" data-level="6.2" data-path="expression-data.html"><a href="expression-data.html#rna-initial-qc"><i class="fa fa-check"></i><b>6.2</b> RNA Initial QC</a></li>
<li class="chapter" data-level="6.3" data-path="expression-data.html"><a href="expression-data.html#normalisation"><i class="fa fa-check"></i><b>6.3</b> Normalisation</a><ul>
<li class="chapter" data-level="6.3.1" data-path="expression-data.html"><a href="expression-data.html#preliminary-visualisation-to-remove-outliers"><i class="fa fa-check"></i><b>6.3.1</b> preliminary visualisation (to remove outliers)</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="expression-data.html"><a href="expression-data.html#processing-files-for-external-software"><i class="fa fa-check"></i><b>6.4</b> Processing files for external software</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rna-data-preliminary-plots.html"><a href="rna-data-preliminary-plots.html"><i class="fa fa-check"></i><b>7</b> RNA data: preliminary plots</a><ul>
<li class="chapter" data-level="7.1" data-path="rna-data-preliminary-plots.html"><a href="rna-data-preliminary-plots.html#pca-plots"><i class="fa fa-check"></i><b>7.1</b> PCA plots</a></li>
<li class="chapter" data-level="7.2" data-path="rna-data-preliminary-plots.html"><a href="rna-data-preliminary-plots.html#expression-patterns-by-cell-type"><i class="fa fa-check"></i><b>7.2</b> Expression patterns by cell type</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="deseq-analysis-progressionimmunotherapy-cohort.html"><a href="deseq-analysis-progressionimmunotherapy-cohort.html"><i class="fa fa-check"></i><b>8</b> DESeq analysis: Progression/Immunotherapy cohort</a><ul>
<li class="chapter" data-level="8.1" data-path="deseq-analysis-progressionimmunotherapy-cohort.html"><a href="deseq-analysis-progressionimmunotherapy-cohort.html#dn-vs-ep"><i class="fa fa-check"></i><b>8.1</b> DN vs Ep</a></li>
<li class="chapter" data-level="8.2" data-path="deseq-analysis-progressionimmunotherapy-cohort.html"><a href="deseq-analysis-progressionimmunotherapy-cohort.html#no.-samples-in-comparisons"><i class="fa fa-check"></i><b>8.2</b> No. samples in comparisons</a></li>
<li class="chapter" data-level="8.3" data-path="deseq-analysis-progressionimmunotherapy-cohort.html"><a href="deseq-analysis-progressionimmunotherapy-cohort.html#set-up-cell-type-specific-the-comparisons"><i class="fa fa-check"></i><b>8.3</b> Set-up cell-type specific the comparisons</a></li>
<li class="chapter" data-level="8.4" data-path="deseq-analysis-progressionimmunotherapy-cohort.html"><a href="deseq-analysis-progressionimmunotherapy-cohort.html#pca-plots-1"><i class="fa fa-check"></i><b>8.4</b> PCA plots</a><ul>
<li class="chapter" data-level="8.4.1" data-path="deseq-analysis-progressionimmunotherapy-cohort.html"><a href="deseq-analysis-progressionimmunotherapy-cohort.html#epcam"><i class="fa fa-check"></i><b>8.4.1</b> EpCAM</a></li>
<li class="chapter" data-level="8.4.2" data-path="deseq-analysis-progressionimmunotherapy-cohort.html"><a href="deseq-analysis-progressionimmunotherapy-cohort.html#cd45"><i class="fa fa-check"></i><b>8.4.2</b> CD45</a></li>
<li class="chapter" data-level="8.4.3" data-path="deseq-analysis-progressionimmunotherapy-cohort.html"><a href="deseq-analysis-progressionimmunotherapy-cohort.html#dn"><i class="fa fa-check"></i><b>8.4.3</b> DN</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="deseq-analysis-progressionimmunotherapy-cohort.html"><a href="deseq-analysis-progressionimmunotherapy-cohort.html#pearson-correlation-plots-of-samples"><i class="fa fa-check"></i><b>8.5</b> Pearson correlation plots of samples</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="collating-results-and-running-gsea.html"><a href="collating-results-and-running-gsea.html"><i class="fa fa-check"></i><b>9</b> Collating results and running GSEA</a></li>
<li class="chapter" data-level="10" data-path="erpgr-subtyping.html"><a href="erpgr-subtyping.html"><i class="fa fa-check"></i><b>10</b> ER/Pgr Subtyping</a><ul>
<li class="chapter" data-level="10.1" data-path="erpgr-subtyping.html"><a href="erpgr-subtyping.html#gene-list"><i class="fa fa-check"></i><b>10.1</b> Gene List</a></li>
<li class="chapter" data-level="10.2" data-path="erpgr-subtyping.html"><a href="erpgr-subtyping.html#progression-cohort"><i class="fa fa-check"></i><b>10.2</b> Progression cohort</a></li>
<li class="chapter" data-level="10.3" data-path="erpgr-subtyping.html"><a href="erpgr-subtyping.html#charcterisation-cohort"><i class="fa fa-check"></i><b>10.3</b> Charcterisation cohort</a></li>
<li class="chapter" data-level="10.4" data-path="erpgr-subtyping.html"><a href="erpgr-subtyping.html#dn-samples"><i class="fa fa-check"></i><b>10.4</b> DN samples</a></li>
<li class="chapter" data-level="10.5" data-path="erpgr-subtyping.html"><a href="erpgr-subtyping.html#comparison-with-staining"><i class="fa fa-check"></i><b>10.5</b> Comparison with staining</a></li>
<li class="chapter" data-level="10.6" data-path="erpgr-subtyping.html"><a href="erpgr-subtyping.html#summary-of-expression-markers-for-each-subtypecell-fraction"><i class="fa fa-check"></i><b>10.6</b> Summary of expression markers for each subtype/cell fraction</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="expression-in-specific-pathways.html"><a href="expression-in-specific-pathways.html"><i class="fa fa-check"></i><b>11</b> Expression in Specific pathways</a></li>
<li class="chapter" data-level="12" data-path="deseq-analysis-immunotherapygrowth-comparisons.html"><a href="deseq-analysis-immunotherapygrowth-comparisons.html"><i class="fa fa-check"></i><b>12</b> DESeq analysis: Immunotherapy/Growth comparisons</a><ul>
<li class="chapter" data-level="12.1" data-path="deseq-analysis-immunotherapygrowth-comparisons.html"><a href="deseq-analysis-immunotherapygrowth-comparisons.html#summary-of-comparisons"><i class="fa fa-check"></i><b>12.1</b> Summary of comparisons</a></li>
<li class="chapter" data-level="12.2" data-path="deseq-analysis-immunotherapygrowth-comparisons.html"><a href="deseq-analysis-immunotherapygrowth-comparisons.html#deseq-immunotherapy"><i class="fa fa-check"></i><b>12.2</b> DESeq: immunotherapy</a></li>
<li class="chapter" data-level="12.3" data-path="deseq-analysis-immunotherapygrowth-comparisons.html"><a href="deseq-analysis-immunotherapygrowth-comparisons.html#growing-vs-stable-emphasis"><i class="fa fa-check"></i><b>12.3</b> Growing vs stable emphasis</a><ul>
<li class="chapter" data-level="12.3.1" data-path="deseq-analysis-immunotherapygrowth-comparisons.html"><a href="deseq-analysis-immunotherapygrowth-comparisons.html#dn-fraction"><i class="fa fa-check"></i><b>12.3.1</b> DN fraction</a></li>
<li class="chapter" data-level="12.3.2" data-path="deseq-analysis-immunotherapygrowth-comparisons.html"><a href="deseq-analysis-immunotherapygrowth-comparisons.html#cd-fraction"><i class="fa fa-check"></i><b>12.3.2</b> CD fraction</a></li>
<li class="chapter" data-level="12.3.3" data-path="deseq-analysis-immunotherapygrowth-comparisons.html"><a href="deseq-analysis-immunotherapygrowth-comparisons.html#ep-fraction"><i class="fa fa-check"></i><b>12.3.3</b> Ep Fraction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="summary-of-gsea-runs.html"><a href="summary-of-gsea-runs.html"><i class="fa fa-check"></i><b>13</b> Summary of GSEA runs</a><ul>
<li class="chapter" data-level="13.1" data-path="summary-of-gsea-runs.html"><a href="summary-of-gsea-runs.html#stable-vs-growing-all-samples"><i class="fa fa-check"></i><b>13.1</b> Stable vs growing: all samples</a><ul>
<li class="chapter" data-level="13.1.1" data-path="summary-of-gsea-runs.html"><a href="summary-of-gsea-runs.html#barplots-of-enriched-pathways"><i class="fa fa-check"></i><b>13.1.1</b> barplots of enriched pathways</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="summary-of-gsea-runs.html"><a href="summary-of-gsea-runs.html#comparisons-based-on-treatment"><i class="fa fa-check"></i><b>13.2</b> Comparisons based on treatment</a></li>
<li class="chapter" data-level="13.3" data-path="summary-of-gsea-runs.html"><a href="summary-of-gsea-runs.html#pathways-of-interest-2"><i class="fa fa-check"></i><b>13.3</b> Pathways of Interest 2</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="epcam-inflammatory-vs-non-inflammatory-samples.html"><a href="epcam-inflammatory-vs-non-inflammatory-samples.html"><i class="fa fa-check"></i><b>14</b> Epcam+ Inflammatory vs non-inflammatory samples</a><ul>
<li class="chapter" data-level="14.1" data-path="epcam-inflammatory-vs-non-inflammatory-samples.html"><a href="epcam-inflammatory-vs-non-inflammatory-samples.html#identification-of-inflammatory-samples"><i class="fa fa-check"></i><b>14.1</b> Identification of inflammatory samples</a></li>
<li class="chapter" data-level="14.2" data-path="epcam-inflammatory-vs-non-inflammatory-samples.html"><a href="epcam-inflammatory-vs-non-inflammatory-samples.html#deg-inflammatory-vs-non-inflammatory"><i class="fa fa-check"></i><b>14.2</b> DEG: inflammatory vs non-inflammatory</a></li>
<li class="chapter" data-level="14.3" data-path="epcam-inflammatory-vs-non-inflammatory-samples.html"><a href="epcam-inflammatory-vs-non-inflammatory-samples.html#finding-3-signatures-for-3-branches"><i class="fa fa-check"></i><b>14.3</b> Finding 3 signatures for 3 branches</a></li>
<li class="chapter" data-level="14.4" data-path="epcam-inflammatory-vs-non-inflammatory-samples.html"><a href="epcam-inflammatory-vs-non-inflammatory-samples.html#analyse-the-non-inflammatory-samples"><i class="fa fa-check"></i><b>14.4</b> Analyse the non-inflammatory samples</a><ul>
<li class="chapter" data-level="14.4.1" data-path="epcam-inflammatory-vs-non-inflammatory-samples.html"><a href="epcam-inflammatory-vs-non-inflammatory-samples.html#gsea"><i class="fa fa-check"></i><b>14.4.1</b> GSEA</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="epcam-inflammatory-vs-non-inflammatory-samples.html"><a href="epcam-inflammatory-vs-non-inflammatory-samples.html#luminal-only-non-inflammtory-samples-samples"><i class="fa fa-check"></i><b>14.5</b> Luminal-only non-inflammtory samples samples</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html"><i class="fa fa-check"></i><b>15</b> TCGA: Associate Epcam+ inflammatory with survival</a><ul>
<li class="chapter" data-level="15.1" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#associating-cd74-with-phenotype-and-outcome"><i class="fa fa-check"></i><b>15.1</b> Associating CD74 with phenotype and outcome</a></li>
<li class="chapter" data-level="15.2" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#associating-admats10-with-phenotype-and-outcome"><i class="fa fa-check"></i><b>15.2</b> Associating ADMATS10 with phenotype and outcome</a><ul>
<li class="chapter" data-level="15.2.1" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#all-samples"><i class="fa fa-check"></i><b>15.2.1</b> All samples</a></li>
<li class="chapter" data-level="15.2.2" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#redone-using-only-er-cases"><i class="fa fa-check"></i><b>15.2.2</b> Redone using only ER cases</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#signature-lum-cases-non-inflammatory-growing-vs-stable"><i class="fa fa-check"></i><b>15.3</b> Signature: Lum cases non-inflammatory: growing vs stable</a></li>
<li class="chapter" data-level="15.4" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#comparison-to-oncotype-and-mammaprint"><i class="fa fa-check"></i><b>15.4</b> Comparison to oncotype and mammaprint</a><ul>
<li class="chapter" data-level="15.4.1" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#overall-survival"><i class="fa fa-check"></i><b>15.4.1</b> Overall survival</a></li>
<li class="chapter" data-level="15.4.2" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#dfs-survival"><i class="fa fa-check"></i><b>15.4.2</b> DFS survival</a></li>
<li class="chapter" data-level="15.4.3" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#redo-the-survival-plots-based-on-luminal-cases-only"><i class="fa fa-check"></i><b>15.4.3</b> Redo the survival plots based on Luminal cases only</a></li>
<li class="chapter" data-level="15.4.4" data-path="tcga-associate-epcam-inflammatory-with-survival.html"><a href="tcga-associate-epcam-inflammatory-with-survival.html#tcga-luma-high-vs-low-signatures"><i class="fa fa-check"></i><b>15.4.4</b> TCGA: LumA high vs low signatures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="metabric-associate-epcam-inflammatory-with-survival.html"><a href="metabric-associate-epcam-inflammatory-with-survival.html"><i class="fa fa-check"></i><b>16</b> METABRIC: Associate Epcam+ inflammatory with survival</a><ul>
<li class="chapter" data-level="16.1" data-path="metabric-associate-epcam-inflammatory-with-survival.html"><a href="metabric-associate-epcam-inflammatory-with-survival.html#associating-cd74-with-phenotype-and-outcome-1"><i class="fa fa-check"></i><b>16.1</b> Associating CD74 with phenotype and outcome</a></li>
<li class="chapter" data-level="16.2" data-path="metabric-associate-epcam-inflammatory-with-survival.html"><a href="metabric-associate-epcam-inflammatory-with-survival.html#associating-admats10-with-phenotype-and-outcome-1"><i class="fa fa-check"></i><b>16.2</b> Associating ADMATS10 with phenotype and outcome</a><ul>
<li class="chapter" data-level="16.2.1" data-path="metabric-associate-epcam-inflammatory-with-survival.html"><a href="metabric-associate-epcam-inflammatory-with-survival.html#all-samples-1"><i class="fa fa-check"></i><b>16.2.1</b> All samples</a></li>
<li class="chapter" data-level="16.2.2" data-path="metabric-associate-epcam-inflammatory-with-survival.html"><a href="metabric-associate-epcam-inflammatory-with-survival.html#redone-using-only-er-cases-1"><i class="fa fa-check"></i><b>16.2.2</b> Redone using only ER cases</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="metabric-associate-epcam-inflammatory-with-survival.html"><a href="metabric-associate-epcam-inflammatory-with-survival.html#signature-lum-cases-non-inflammatory-growing-vs-stable-1"><i class="fa fa-check"></i><b>16.3</b> Signature: Lum cases non-inflammatory: growing vs stable</a><ul>
<li class="chapter" data-level="16.3.1" data-path="metabric-associate-epcam-inflammatory-with-survival.html"><a href="metabric-associate-epcam-inflammatory-with-survival.html#met-luma-high-vs-low-signatures"><i class="fa fa-check"></i><b>16.3.1</b> MET: LumA high vs low signatures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="deseq-analysis-characterisation-cohort-big-vs-small.html"><a href="deseq-analysis-characterisation-cohort-big-vs-small.html"><i class="fa fa-check"></i><b>17</b> DESeq analysis: Characterisation cohort (big vs small)</a><ul>
<li class="chapter" data-level="17.1" data-path="deseq-analysis-characterisation-cohort-big-vs-small.html"><a href="deseq-analysis-characterisation-cohort-big-vs-small.html#cd45-samples-1"><i class="fa fa-check"></i><b>17.1</b> CD45 samples</a><ul>
<li class="chapter" data-level="17.1.1" data-path="deseq-analysis-characterisation-cohort-big-vs-small.html"><a href="deseq-analysis-characterisation-cohort-big-vs-small.html#pca-plot"><i class="fa fa-check"></i><b>17.1.1</b> PCA plot</a></li>
<li class="chapter" data-level="17.1.2" data-path="deseq-analysis-characterisation-cohort-big-vs-small.html"><a href="deseq-analysis-characterisation-cohort-big-vs-small.html#differential-gene-expression"><i class="fa fa-check"></i><b>17.1.2</b> Differential Gene Expression</a></li>
<li class="chapter" data-level="17.1.3" data-path="deseq-analysis-characterisation-cohort-big-vs-small.html"><a href="deseq-analysis-characterisation-cohort-big-vs-small.html#gsea-1"><i class="fa fa-check"></i><b>17.1.3</b> GSEA</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="deseq-analysis-characterisation-cohort-big-vs-small.html"><a href="deseq-analysis-characterisation-cohort-big-vs-small.html#epithelial-samples-1"><i class="fa fa-check"></i><b>17.2</b> Epithelial samples</a><ul>
<li class="chapter" data-level="17.2.1" data-path="deseq-analysis-characterisation-cohort-big-vs-small.html"><a href="deseq-analysis-characterisation-cohort-big-vs-small.html#pca-plot-1"><i class="fa fa-check"></i><b>17.2.1</b> PCA plot</a></li>
<li class="chapter" data-level="17.2.2" data-path="deseq-analysis-characterisation-cohort-big-vs-small.html"><a href="deseq-analysis-characterisation-cohort-big-vs-small.html#gsea-2"><i class="fa fa-check"></i><b>17.2.2</b> GSEA</a></li>
<li class="chapter" data-level="17.2.3" data-path="deseq-analysis-characterisation-cohort-big-vs-small.html"><a href="deseq-analysis-characterisation-cohort-big-vs-small.html#check-expression-of-checkpoint-proteins"><i class="fa fa-check"></i><b>17.2.3</b> Check expression of checkpoint proteins</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="signature-analysis.html"><a href="signature-analysis.html"><i class="fa fa-check"></i><b>18</b> Signature analysis</a><ul>
<li class="chapter" data-level="18.1" data-path="signature-analysis.html"><a href="signature-analysis.html#mhc-signature-analysis"><i class="fa fa-check"></i><b>18.1</b> MHC signature analysis</a><ul>
<li class="chapter" data-level="18.1.1" data-path="signature-analysis.html"><a href="signature-analysis.html#mhc-i"><i class="fa fa-check"></i><b>18.1.1</b> MHC-I</a></li>
<li class="chapter" data-level="18.1.2" data-path="signature-analysis.html"><a href="signature-analysis.html#mhc-ii"><i class="fa fa-check"></i><b>18.1.2</b> MHC-II</a></li>
<li class="chapter" data-level="18.1.3" data-path="signature-analysis.html"><a href="signature-analysis.html#mhc-presentation-proteins"><i class="fa fa-check"></i><b>18.1.3</b> MHC presentation proteins</a></li>
<li class="chapter" data-level="18.1.4" data-path="signature-analysis.html"><a href="signature-analysis.html#inflammation-related-genes-il6-jak-stat-and-tnfnfkb"><i class="fa fa-check"></i><b>18.1.4</b> inflammation related genes: IL6-JAK-STAT and TNF/NFKB</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="immune-estimation.html"><a href="immune-estimation.html"><i class="fa fa-check"></i><b>19</b> Immune estimation</a><ul>
<li class="chapter" data-level="19.1" data-path="immune-estimation.html"><a href="immune-estimation.html#overview-of-the-cell-types"><i class="fa fa-check"></i><b>19.1</b> Overview of the cell types</a></li>
<li class="chapter" data-level="19.2" data-path="immune-estimation.html"><a href="immune-estimation.html#characterisation-cohort-assoc-with-size"><i class="fa fa-check"></i><b>19.2</b> characterisation cohort: assoc with size</a></li>
<li class="chapter" data-level="19.3" data-path="immune-estimation.html"><a href="immune-estimation.html#comparison-with-facs-data"><i class="fa fa-check"></i><b>19.3</b> Comparison with FACS data</a></li>
<li class="chapter" data-level="19.4" data-path="immune-estimation.html"><a href="immune-estimation.html#progression-cohort-1"><i class="fa fa-check"></i><b>19.4</b> Progression cohort</a></li>
<li class="chapter" data-level="19.5" data-path="immune-estimation.html"><a href="immune-estimation.html#clinical-associations"><i class="fa fa-check"></i><b>19.5</b> Clinical associations</a><ul>
<li class="chapter" data-level="19.5.1" data-path="immune-estimation.html"><a href="immune-estimation.html#associate-with-treatment"><i class="fa fa-check"></i><b>19.5.1</b> Associate with Treatment</a></li>
<li class="chapter" data-level="19.5.2" data-path="immune-estimation.html"><a href="immune-estimation.html#association-with-growth"><i class="fa fa-check"></i><b>19.5.2</b> Association with Growth</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="immune-estimation.html"><a href="immune-estimation.html#summary-of-the-outcome"><i class="fa fa-check"></i><b>19.6</b> Summary of the outcome</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="bcr-clonotype-analysis.html"><a href="bcr-clonotype-analysis.html"><i class="fa fa-check"></i><b>20</b> BCR clonotype analysis</a><ul>
<li class="chapter" data-level="20.1" data-path="bcr-clonotype-analysis.html"><a href="bcr-clonotype-analysis.html#processing-summary"><i class="fa fa-check"></i><b>20.1</b> Processing summary</a></li>
<li class="chapter" data-level="20.2" data-path="bcr-clonotype-analysis.html"><a href="bcr-clonotype-analysis.html#summary-stats"><i class="fa fa-check"></i><b>20.2</b> Summary Stats</a></li>
<li class="chapter" data-level="20.3" data-path="bcr-clonotype-analysis.html"><a href="bcr-clonotype-analysis.html#diversity-metrics"><i class="fa fa-check"></i><b>20.3</b> Diversity metrics</a></li>
<li class="chapter" data-level="20.4" data-path="bcr-clonotype-analysis.html"><a href="bcr-clonotype-analysis.html#compare-the-characterisation-cohort"><i class="fa fa-check"></i><b>20.4</b> Compare the characterisation cohort</a></li>
<li class="chapter" data-level="20.5" data-path="bcr-clonotype-analysis.html"><a href="bcr-clonotype-analysis.html#associate-with-clinicopathological-data-progression"><i class="fa fa-check"></i><b>20.5</b> Associate with clinicopathological data (progression)</a></li>
<li class="chapter" data-level="20.6" data-path="bcr-clonotype-analysis.html"><a href="bcr-clonotype-analysis.html#associate-with-signature-scores"><i class="fa fa-check"></i><b>20.6</b> Associate with signature scores</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html"><i class="fa fa-check"></i><b>21</b> Whole Genome Sequencing Mutations</a><ul>
<li class="chapter" data-level="21.1" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#data"><i class="fa fa-check"></i><b>21.1</b> Data</a><ul>
<li class="chapter" data-level="21.1.1" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#extract-mutation-signatures"><i class="fa fa-check"></i><b>21.1.1</b> Extract mutation signatures</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#annotate-the-data-with-human-common-variants"><i class="fa fa-check"></i><b>21.2</b> Annotate the data with human common variants</a></li>
<li class="chapter" data-level="21.3" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#plots"><i class="fa fa-check"></i><b>21.3</b> Plots</a><ul>
<li class="chapter" data-level="21.3.1" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#quick-overview"><i class="fa fa-check"></i><b>21.3.1</b> Quick overview</a></li>
<li class="chapter" data-level="21.3.2" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#coding-variants-tmb"><i class="fa fa-check"></i><b>21.3.2</b> Coding variants &amp; TMB</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#comparison-with-rat-mutational-datasets"><i class="fa fa-check"></i><b>21.4</b> Comparison with rat mutational datasets</a><ul>
<li class="chapter" data-level="21.4.1" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#sites-which-are-commonly-mutated"><i class="fa fa-check"></i><b>21.4.1</b> Sites which are commonly mutated?</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#overview-of-the-mutations"><i class="fa fa-check"></i><b>21.5</b> Overview of the mutations</a><ul>
<li class="chapter" data-level="21.5.1" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#all-mutations"><i class="fa fa-check"></i><b>21.5.1</b> All mutations</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="whole-genome-sequencing-mutations.html"><a href="whole-genome-sequencing-mutations.html#metacore-analysis-of-commonly-mutated-pathways"><i class="fa fa-check"></i><b>21.6</b> Metacore analysis of commonly mutated pathways</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="mutations-in-rna.html"><a href="mutations-in-rna.html"><i class="fa fa-check"></i><b>22</b> Mutations in RNA</a><ul>
<li class="chapter" data-level="22.1" data-path="mutations-in-rna.html"><a href="mutations-in-rna.html#haplotype-caller"><i class="fa fa-check"></i><b>22.1</b> Haplotype caller</a></li>
<li class="chapter" data-level="22.2" data-path="mutations-in-rna.html"><a href="mutations-in-rna.html#load-files"><i class="fa fa-check"></i><b>22.2</b> Load files</a></li>
<li class="chapter" data-level="22.3" data-path="mutations-in-rna.html"><a href="mutations-in-rna.html#identifying-polymorphisms-compare-frequencies-in-cd45-and-ep-data"><i class="fa fa-check"></i><b>22.3</b> Identifying polymorphisms: compare frequencies in CD45 and Ep data</a></li>
<li class="chapter" data-level="22.4" data-path="mutations-in-rna.html"><a href="mutations-in-rna.html#find-coding-mutations-which-are-specific-to-ep-cells"><i class="fa fa-check"></i><b>22.4</b> Find coding mutations which are specific to ep cells</a></li>
<li class="chapter" data-level="22.5" data-path="mutations-in-rna.html"><a href="mutations-in-rna.html#filtering-wgs-data-based-on-cd45-data"><i class="fa fa-check"></i><b>22.5</b> Filtering WGS data based on CD45 data</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="mutations-in-progression-cohort.html"><a href="mutations-in-progression-cohort.html"><i class="fa fa-check"></i><b>23</b> Mutations in progression cohort</a><ul>
<li class="chapter" data-level="23.1" data-path="mutations-in-progression-cohort.html"><a href="mutations-in-progression-cohort.html#summary-of-common-mutations"><i class="fa fa-check"></i><b>23.1</b> Summary of common mutations:</a></li>
<li class="chapter" data-level="23.2" data-path="mutations-in-progression-cohort.html"><a href="mutations-in-progression-cohort.html#look-at-the-common-mutations-cosmic-ones"><i class="fa fa-check"></i><b>23.2</b> Look at the common mutations (cosmic ones)</a></li>
<li class="chapter" data-level="23.3" data-path="mutations-in-progression-cohort.html"><a href="mutations-in-progression-cohort.html#also-look-at-the-top-rna-mutations-with-are-epdn-specific"><i class="fa fa-check"></i><b>23.3</b> Also look at the top RNA-mutations with are Ep/DN specific</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="trichrome-staining.html"><a href="trichrome-staining.html"><i class="fa fa-check"></i><b>24</b> Trichrome staining</a><ul>
<li class="chapter" data-level="24.1" data-path="trichrome-staining.html"><a href="trichrome-staining.html#associations-with-cellular-fraction-wsi"><i class="fa fa-check"></i><b>24.1</b> Associations with cellular fraction (wsi)</a></li>
<li class="chapter" data-level="24.2" data-path="trichrome-staining.html"><a href="trichrome-staining.html#associations-with-cd8-content"><i class="fa fa-check"></i><b>24.2</b> Associations with CD8 content</a></li>
<li class="chapter" data-level="24.3" data-path="trichrome-staining.html"><a href="trichrome-staining.html#associations-with-growth-and-treatment"><i class="fa fa-check"></i><b>24.3</b> Associations with growth and treatment</a></li>
<li class="chapter" data-level="24.4" data-path="trichrome-staining.html"><a href="trichrome-staining.html#association-with-hyperinflammatory-status"><i class="fa fa-check"></i><b>24.4</b> Association with hyperinflammatory status</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="cnv-calling.html"><a href="cnv-calling.html"><i class="fa fa-check"></i><b>25</b> CNV calling</a><ul>
<li class="chapter" data-level="25.1" data-path="cnv-calling.html"><a href="cnv-calling.html#sample-data"><i class="fa fa-check"></i><b>25.1</b> Sample data</a></li>
<li class="chapter" data-level="25.2" data-path="cnv-calling.html"><a href="cnv-calling.html#data-summary"><i class="fa fa-check"></i><b>25.2</b> Data Summary</a><ul>
<li class="chapter" data-level="25.2.1" data-path="cnv-calling.html"><a href="cnv-calling.html#frequency-of-gains-and-losses-across-the-genome"><i class="fa fa-check"></i><b>25.2.1</b> Frequency of gains and losses across the genome</a></li>
<li class="chapter" data-level="25.2.2" data-path="cnv-calling.html"><a href="cnv-calling.html#loci-which-have-a-hit-in-at-least-30-of-samples"><i class="fa fa-check"></i><b>25.2.2</b> Loci which have a hit in at least 30% of samples</a></li>
<li class="chapter" data-level="25.2.3" data-path="cnv-calling.html"><a href="cnv-calling.html#annotated-plot-of-genome-and-locations-of-genes"><i class="fa fa-check"></i><b>25.2.3</b> Annotated plot of genome and locations of genes</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="cnv-calling.html"><a href="cnv-calling.html#samples-with-cnvs-in-breast-related-genes"><i class="fa fa-check"></i><b>25.3</b> Samples with CNVs in breast-related genes</a></li>
<li class="chapter" data-level="25.4" data-path="cnv-calling.html"><a href="cnv-calling.html#summary-of-the-sequencing-depth"><i class="fa fa-check"></i><b>25.4</b> Summary of the sequencing depth</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="writing-files-to-file.html"><a href="writing-files-to-file.html"><i class="fa fa-check"></i><b>26</b> Writing files to file</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="list-of-figures.html"><a href="list-of-figures.html"><i class="fa fa-check"></i><b>A</b> List of Figures</a><ul>
<li class="chapter" data-level="" data-path="list-of-figures.html"><a href="list-of-figures.html#main-figures"><i class="fa fa-check"></i>Main Figures</a></li>
<li class="chapter" data-level="" data-path="list-of-figures.html"><a href="list-of-figures.html#figure-1-nmu-induced-mammary-tumors"><i class="fa fa-check"></i>Figure 1: NMU-induced mammary tumors</a></li>
<li class="chapter" data-level="" data-path="list-of-figures.html"><a href="list-of-figures.html#figure-2-immune-system-of-nmu-rat"><i class="fa fa-check"></i>Figure 2: Immune system of NMU-rat</a></li>
<li class="chapter" data-level="" data-path="list-of-figures.html"><a href="list-of-figures.html#figure-3-immunotherapy-applied-to-nmu-rats"><i class="fa fa-check"></i>Figure 3: Immunotherapy applied to NMU rats</a></li>
<li class="chapter" data-level="" data-path="list-of-figures.html"><a href="list-of-figures.html#figure-4-characterizing-cd45-cells-in-tumors"><i class="fa fa-check"></i>Figure 4: Characterizing CD45 cells in tumors</a></li>
<li class="chapter" data-level="" data-path="list-of-figures.html"><a href="list-of-figures.html#figure-5-epithelial-cells-in-growing-vs-stable-rats"><i class="fa fa-check"></i>Figure 5 : Epithelial cells in growing vs stable rats</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="extended-figures.html"><a href="extended-figures.html"><i class="fa fa-check"></i>Extended Figures</a><ul>
<li class="chapter" data-level="" data-path="extended-figures.html"><a href="extended-figures.html#extended-data-1"><i class="fa fa-check"></i>Extended data 1</a></li>
<li class="chapter" data-level="" data-path="extended-figures.html"><a href="extended-figures.html#extended-data-2"><i class="fa fa-check"></i>Extended data 2</a></li>
<li class="chapter" data-level="" data-path="extended-figures.html"><a href="extended-figures.html#extended-data-3"><i class="fa fa-check"></i>Extended data 3</a></li>
<li class="chapter" data-level="" data-path="extended-figures.html"><a href="extended-figures.html#extended-data-4"><i class="fa fa-check"></i>Extended data 4</a></li>
<li class="chapter" data-level="" data-path="extended-figures.html"><a href="extended-figures.html#extended-data-5"><i class="fa fa-check"></i>Extended data 5</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NMU-induced rat tumor models for I/O</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spatial-statistics" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Spatial statistics</h1>
<p>Below, we use three different metrics to compare spatial distributions:</p>
<ul>
<li>k-nearest neighbour distances</li>
<li>the interacting fraction</li>
<li>morisita-horn distances</li>
</ul>
<p>These are compared to manual inspection of the result</p>
<div id="knn-distances" class="section level2">
<h2><span class="header-section-number">5.1</span> knn-Distances:</h2>
<p>The k-nearest neighbour distances looks at the average distance from a given cell type of class A to a cell type of class B. In this section, the reference class A is the CD8 T cell, and we will look at the mean distance to SMA, Epcam, double positive and unclassified cells in each image.</p>
<p>To account for potential fluctuations due to misclassified cells, or isolated single cells, k values of 1, 3, 5 will be used. I.e. for each cell, we will compute the mean distance from each Cd8Tcell to its 1, 3, and 5 nearest neighbours.</p>
<div id="comparison-to-manual-classification" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Comparison to manual classification</h3>
<p>Overall, we see that the differences in infiltrating vs restricted are similar. We see statistical differences (using anova followed by Tukey’s test) between:</p>
<ul>
<li>epcam and SMA-epcam in both cases (higher distances to EpCAM on average)</li>
<li>SMA-Epcam to SMA (CD8s are closer to SMA+)</li>
<li>Unclass to Epcam-SMA (CD8s closer to unclass)</li>
</ul>
<p>In the infiltrating case:</p>
<ul>
<li>Unclass to Epcam (CD8s closer to unclass, borderline significant)</li>
</ul>
<p>In the restricted cases, we see:</p>
<ul>
<li>Unclass to SMA (higher distance to unclass in the restricted case)</li>
<li>SMA to epcam (CD8s are closer to the SMA)</li>
</ul>
<p>This last result is consistent with what we expect for a CD8+ cell which is stroma-restricted.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="spatial-statistics.html#cb72-1"></a>knnMelt=<span class="kw">melt</span>(WSIknn, <span class="dt">measure.vars=</span><span class="kw">c</span>(<span class="st">&quot;KS.pval&quot;</span>))</span>
<span id="cb72-2"><a href="spatial-statistics.html#cb72-2"></a></span>
<span id="cb72-3"><a href="spatial-statistics.html#cb72-3"></a>knnTemp1=knnMelt[knnMelt<span class="op">$</span>CellType<span class="op">==</span><span class="st">&quot;CD8&quot;</span> <span class="op">&amp;</span><span class="st"> </span>knnMelt<span class="op">$</span>NearestCellType<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;EpCAM&quot;</span>, <span class="st">&quot;SMA&quot;</span>, <span class="st">&quot;EpCAM: SMA&quot;</span>, <span class="st">&quot;Unclass&quot;</span>), ]</span>
<span id="cb72-4"><a href="spatial-statistics.html#cb72-4"></a>knnTemp1<span class="op">$</span>SpatialManual=Cdata<span class="op">$</span>Pathologist.CD8.Spatial[<span class="kw">match</span>(knnTemp1<span class="op">$</span>L1, <span class="kw">gsub</span>(<span class="st">&quot;_&quot;</span>, <span class="st">&quot;&quot;</span>, Cdata<span class="op">$</span>TumorID))]</span>
<span id="cb72-5"><a href="spatial-statistics.html#cb72-5"></a></span>
<span id="cb72-6"><a href="spatial-statistics.html#cb72-6"></a><span class="co"># compute p values?</span></span>
<span id="cb72-7"><a href="spatial-statistics.html#cb72-7"></a>ptest=<span class="kw">sapply</span>(<span class="kw">levels</span>(knnTemp1<span class="op">$</span>knn), <span class="cf">function</span>(x) <span class="kw">wilcox.test</span>(knnTemp1<span class="op">$</span>MeanDistance[<span class="kw">which</span>(knnTemp1<span class="op">$</span>knn<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>knnTemp1<span class="op">$</span>NearestCellType<span class="op">==</span><span class="st">&quot;EpCAM&quot;</span> <span class="op">&amp;</span><span class="st"> </span>knnTemp1<span class="op">$</span>SpatialManual<span class="op">==</span><span class="st">&quot;Infiltrating&quot;</span>)], knnTemp1<span class="op">$</span>MeanDistance[<span class="kw">which</span>(knnTemp1<span class="op">$</span>knn<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>knnTemp1<span class="op">$</span>NearestCellType<span class="op">==</span><span class="st">&quot;SMA&quot;</span> <span class="op">&amp;</span><span class="st"> </span>knnTemp1<span class="op">$</span>SpatialManual<span class="op">==</span><span class="st">&quot;Infiltrating&quot;</span>)])<span class="op">$</span>p.value)</span>
<span id="cb72-8"><a href="spatial-statistics.html#cb72-8"></a></span>
<span id="cb72-9"><a href="spatial-statistics.html#cb72-9"></a>fit1=<span class="kw">aov</span>(MeanDistance<span class="op">~</span>NearestCellType<span class="op">+</span>knn, <span class="dt">data=</span>knnTemp1[knnTemp1<span class="op">$</span>SpatialManual<span class="op">==</span><span class="st">&quot;Infiltrating&quot;</span>, ])</span>
<span id="cb72-10"><a href="spatial-statistics.html#cb72-10"></a>fit2=<span class="kw">aov</span>(MeanDistance<span class="op">~</span>NearestCellType<span class="op">+</span>knn, <span class="dt">data=</span>knnTemp1[knnTemp1<span class="op">$</span>SpatialManual<span class="op">==</span><span class="st">&quot;restricted&quot;</span>, ])</span>
<span id="cb72-11"><a href="spatial-statistics.html#cb72-11"></a></span>
<span id="cb72-12"><a href="spatial-statistics.html#cb72-12"></a></span>
<span id="cb72-13"><a href="spatial-statistics.html#cb72-13"></a>fit1b=<span class="kw">aov</span>(MedianDistance<span class="op">~</span>NearestCellType<span class="op">+</span>knn, <span class="dt">data=</span>knnTemp1[knnTemp1<span class="op">$</span>SpatialManual<span class="op">==</span><span class="st">&quot;Infiltrating&quot;</span>, ])</span>
<span id="cb72-14"><a href="spatial-statistics.html#cb72-14"></a>fit2b=<span class="kw">aov</span>(MedianDistance<span class="op">~</span>NearestCellType<span class="op">+</span>knn, <span class="dt">data=</span>knnTemp1[knnTemp1<span class="op">$</span>SpatialManual<span class="op">==</span><span class="st">&quot;restricted&quot;</span>, ])</span>
<span id="cb72-15"><a href="spatial-statistics.html#cb72-15"></a></span>
<span id="cb72-16"><a href="spatial-statistics.html#cb72-16"></a><span class="co">#pdf(sprintf(&quot;rslt/WSI-analysis/knn_distances_vs_manualspatial_%s.pdf&quot;, Sys.Date()), height=7, width=12)</span></span>
<span id="cb72-17"><a href="spatial-statistics.html#cb72-17"></a></span>
<span id="cb72-18"><a href="spatial-statistics.html#cb72-18"></a>p&lt;-<span class="kw">ggplot</span>(knnTemp1, <span class="kw">aes</span>(<span class="dt">x=</span>NearestCellType, <span class="dt">y=</span>MeanDistance, <span class="dt">fill=</span>SpatialManual))<span class="op">+</span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape=</span><span class="ot">NA</span>)<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>knn<span class="op">+</span>SpatialManual)<span class="op">+</span><span class="kw">scale_y_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>)<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))<span class="op">+</span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#e41a1c&quot;</span>, <span class="st">&quot;#377eb8&quot;</span>),<span class="dt">na.value=</span><span class="st">&quot;black&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;CD8-CelltypeX spatial distributions: mean values&quot;</span>)</span>
<span id="cb72-19"><a href="spatial-statistics.html#cb72-19"></a></span>
<span id="cb72-20"><a href="spatial-statistics.html#cb72-20"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="spatial-statistics.html#cb73-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>))</span>
<span id="cb73-2"><a href="spatial-statistics.html#cb73-2"></a><span class="kw">plot</span>(<span class="kw">TukeyHSD</span>(fit1, <span class="st">&quot;NearestCellType&quot;</span>), <span class="dt">las=</span><span class="dv">2</span>)</span>
<span id="cb73-3"><a href="spatial-statistics.html#cb73-3"></a><span class="kw">title</span>(<span class="st">&quot;Infiltrating Mean Distance from CD8&quot;</span>, <span class="dt">line=</span><span class="fl">3.3</span>)</span>
<span id="cb73-4"><a href="spatial-statistics.html#cb73-4"></a><span class="kw">plot</span>(<span class="kw">TukeyHSD</span>(fit2, <span class="st">&quot;NearestCellType&quot;</span>), <span class="dt">las=</span><span class="dv">2</span>)</span>
<span id="cb73-5"><a href="spatial-statistics.html#cb73-5"></a><span class="kw">title</span>(<span class="st">&quot;Restricted Mean Distance from CD8&quot;</span>, <span class="dt">line=</span><span class="fl">3.3</span>)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-33-2.png" width="672" /></p>
<p>Note above the infiltrating samples have shorter distances to EpCAM cells relative to SMA cells compared to restricted samples. (Tukey’s test shows that SMA-EPCAM distances for inf. are large but small in resis.)</p>
</div>
<div id="associations-with-outcome-to-treatment" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Associations with outcome to treatment</h3>
<p>We can also see if there is an association between these distances with growth and treatment</p>
<p>Treatment:</p>
<ul>
<li>CD8 cells in PDL1 sample are further away to SMA+ cells and EpCAM+ (compared to vehicle or double agent)</li>
<li>CD8 cells in LY treated samples are further away from unclassified cells (compared to any of the other treatments)</li>
</ul>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="spatial-statistics.html#cb74-1"></a></span>
<span id="cb74-2"><a href="spatial-statistics.html#cb74-2"></a><span class="co">#pdf(&quot;~/Desktop/4C-knn-summary-treatment.pdf&quot;, height=5, width=7)</span></span>
<span id="cb74-3"><a href="spatial-statistics.html#cb74-3"></a></span>
<span id="cb74-4"><a href="spatial-statistics.html#cb74-4"></a>knnTemp1<span class="op">$</span>Treatment=Cdata<span class="op">$</span>Treatment[<span class="kw">match</span>(knnTemp1<span class="op">$</span>L1, <span class="kw">gsub</span>(<span class="st">&quot;_&quot;</span>, <span class="st">&quot;&quot;</span>, Cdata<span class="op">$</span>TumorID))]</span>
<span id="cb74-5"><a href="spatial-statistics.html#cb74-5"></a></span>
<span id="cb74-6"><a href="spatial-statistics.html#cb74-6"></a>fit1=<span class="kw">aov</span>(MedianDistance<span class="op">~</span>Treatment, <span class="dt">data=</span>knnTemp1[knnTemp1<span class="op">$</span>NearestCellType<span class="op">==</span><span class="st">&quot;EpCAM&quot;</span> <span class="op">&amp;</span><span class="st"> </span>knnTemp1<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span>, ])</span>
<span id="cb74-7"><a href="spatial-statistics.html#cb74-7"></a>fit2=<span class="kw">aov</span>(MedianDistance<span class="op">~</span>Treatment, <span class="dt">data=</span>knnTemp1[knnTemp1<span class="op">$</span>NearestCellType<span class="op">==</span><span class="st">&quot;SMA&quot;</span><span class="op">&amp;</span><span class="st"> </span>knnTemp1<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span>, ])</span>
<span id="cb74-8"><a href="spatial-statistics.html#cb74-8"></a>fit3=<span class="kw">aov</span>(MedianDistance<span class="op">~</span>Treatment, <span class="dt">data=</span>knnTemp1[knnTemp1<span class="op">$</span>NearestCellType<span class="op">==</span><span class="st">&quot;EpCAM: SMA&quot;</span><span class="op">&amp;</span><span class="st"> </span>knnTemp1<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span>, ])</span>
<span id="cb74-9"><a href="spatial-statistics.html#cb74-9"></a>fit4=<span class="kw">aov</span>(MedianDistance<span class="op">~</span>Treatment, <span class="dt">data=</span>knnTemp1[knnTemp1<span class="op">$</span>NearestCellType<span class="op">==</span><span class="st">&quot;Unclass&quot;</span><span class="op">&amp;</span><span class="st"> </span>knnTemp1<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span>, ])</span>
<span id="cb74-10"><a href="spatial-statistics.html#cb74-10"></a></span>
<span id="cb74-11"><a href="spatial-statistics.html#cb74-11"></a>knnTemp1<span class="op">$</span>Growth=Cdata<span class="op">$</span>Tumor.Growth[<span class="kw">match</span>(knnTemp1<span class="op">$</span>L1, <span class="kw">gsub</span>(<span class="st">&quot;_&quot;</span>, <span class="st">&quot;&quot;</span>, Cdata<span class="op">$</span>TumorID))]</span>
<span id="cb74-12"><a href="spatial-statistics.html#cb74-12"></a></span>
<span id="cb74-13"><a href="spatial-statistics.html#cb74-13"></a>fit1b=<span class="kw">aov</span>(MeanDistance<span class="op">~</span>Growth, <span class="dt">data=</span>knnTemp1[knnTemp1<span class="op">$</span>NearestCellType<span class="op">==</span><span class="st">&quot;EpCAM&quot;</span><span class="op">&amp;</span><span class="st"> </span>knnTemp1<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span>, ])</span>
<span id="cb74-14"><a href="spatial-statistics.html#cb74-14"></a>fit2b=<span class="kw">aov</span>(MeanDistance<span class="op">~</span>Growth, <span class="dt">data=</span>knnTemp1[knnTemp1<span class="op">$</span>NearestCellType<span class="op">==</span><span class="st">&quot;SMA&quot;</span><span class="op">&amp;</span><span class="st"> </span>knnTemp1<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span>, ])</span>
<span id="cb74-15"><a href="spatial-statistics.html#cb74-15"></a>fit3b=<span class="kw">aov</span>(MeanDistance<span class="op">~</span>Growth, <span class="dt">data=</span>knnTemp1[knnTemp1<span class="op">$</span>NearestCellType<span class="op">==</span><span class="st">&quot;EpCAM: SMA&quot;</span><span class="op">&amp;</span><span class="st"> </span>knnTemp1<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span>, ])</span>
<span id="cb74-16"><a href="spatial-statistics.html#cb74-16"></a>fit4b=<span class="kw">aov</span>(MeanDistance<span class="op">~</span>Growth, <span class="dt">data=</span>knnTemp1[knnTemp1<span class="op">$</span>NearestCellType<span class="op">==</span><span class="st">&quot;Unclass&quot;</span><span class="op">&amp;</span><span class="st"> </span>knnTemp1<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span>, ])</span>
<span id="cb74-17"><a href="spatial-statistics.html#cb74-17"></a></span>
<span id="cb74-18"><a href="spatial-statistics.html#cb74-18"></a><span class="co">#pdf(sprintf(&quot;rslt/WSI-analysis/knn_distances_vs_treatment_growth_%s.pdf&quot;, Sys.Date()), height=7, width=12)</span></span>
<span id="cb74-19"><a href="spatial-statistics.html#cb74-19"></a></span>
<span id="cb74-20"><a href="spatial-statistics.html#cb74-20"></a>p&lt;-<span class="kw">ggplot</span>(knnTemp1, <span class="kw">aes</span>(<span class="dt">col=</span>Treatment, <span class="dt">y=</span>MedianDistance, <span class="dt">x=</span>Treatment))<span class="op">+</span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape=</span><span class="ot">NA</span>)<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">position=</span><span class="kw">position_jitterdodge</span>(),<span class="dt">alpha=</span><span class="fl">0.3</span>)<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>knn<span class="op">+</span>NearestCellType)<span class="op">+</span><span class="kw">scale_y_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>)<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))<span class="op">+</span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> ColMerge[ ,<span class="dv">1</span>],<span class="dt">na.value=</span><span class="st">&quot;black&quot;</span>)<span class="op">+</span><span class="kw">theme_bw</span>()</span>
<span id="cb74-21"><a href="spatial-statistics.html#cb74-21"></a><span class="kw">print</span>(p)</span></code></pre></div>
<div class="figure"><span id="fig:Fig4c"></span>
<img src="RatDCIS-bookdown_files/figure-html/Fig4c-1.png" alt="knn Distances" width="672" />
<p class="caption">
Figure 5.1: knn Distances
</p>
</div>
<p>Below, check whether any of the above are significant using Tukey’s ad-hoc test. Note that not many values cross 0 here, except for the LY samples for stromal cells</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="spatial-statistics.html#cb75-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>))</span>
<span id="cb75-2"><a href="spatial-statistics.html#cb75-2"></a>tukey.test &lt;-<span class="st"> </span><span class="kw">TukeyHSD</span>(fit1)</span>
<span id="cb75-3"><a href="spatial-statistics.html#cb75-3"></a><span class="kw">plot</span>(<span class="kw">TukeyHSD</span>(fit1, <span class="st">&quot;Treatment&quot;</span>), <span class="dt">las=</span><span class="dv">2</span>)</span>
<span id="cb75-4"><a href="spatial-statistics.html#cb75-4"></a><span class="kw">title</span>(<span class="st">&quot;EpCAM Mean Distance&quot;</span>, <span class="dt">line=</span><span class="fl">3.3</span>)</span>
<span id="cb75-5"><a href="spatial-statistics.html#cb75-5"></a><span class="kw">plot</span>(<span class="kw">TukeyHSD</span>(fit2, <span class="st">&quot;Treatment&quot;</span>), <span class="dt">las=</span><span class="dv">2</span>)</span>
<span id="cb75-6"><a href="spatial-statistics.html#cb75-6"></a><span class="kw">title</span>(<span class="st">&quot;SMA Mean Distance&quot;</span>, <span class="dt">line=</span><span class="fl">3.3</span>)</span>
<span id="cb75-7"><a href="spatial-statistics.html#cb75-7"></a><span class="kw">plot</span>(<span class="kw">TukeyHSD</span>(fit3, <span class="st">&quot;Treatment&quot;</span>), <span class="dt">las=</span><span class="dv">2</span>)</span>
<span id="cb75-8"><a href="spatial-statistics.html#cb75-8"></a><span class="kw">title</span>(<span class="st">&quot;EpCAM:SMA Mean Distance&quot;</span>, <span class="dt">line=</span><span class="fl">3.3</span>)</span>
<span id="cb75-9"><a href="spatial-statistics.html#cb75-9"></a><span class="kw">plot</span>(<span class="kw">TukeyHSD</span>(fit4, <span class="st">&quot;Treatment&quot;</span>), <span class="dt">las=</span><span class="dv">2</span>)</span>
<span id="cb75-10"><a href="spatial-statistics.html#cb75-10"></a><span class="kw">title</span>(<span class="st">&quot;Unclass Distance&quot;</span>, <span class="dt">line=</span><span class="fl">3.3</span>)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/knn-tukey-1.png" width="672" /></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="spatial-statistics.html#cb76-1"></a><span class="co">#dev.off()</span></span>
<span id="cb76-2"><a href="spatial-statistics.html#cb76-2"></a></span>
<span id="cb76-3"><a href="spatial-statistics.html#cb76-3"></a><span class="kw">summary</span>(fit1)</span>
<span id="cb76-4"><a href="spatial-statistics.html#cb76-4"></a><span class="co">##             Df Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span id="cb76-5"><a href="spatial-statistics.html#cb76-5"></a><span class="co">## Treatment    3    365   121.7   0.307   0.82</span></span>
<span id="cb76-6"><a href="spatial-statistics.html#cb76-6"></a><span class="co">## Residuals   54  21435   396.9</span></span>
<span id="cb76-7"><a href="spatial-statistics.html#cb76-7"></a><span class="kw">summary</span>(fit2)</span>
<span id="cb76-8"><a href="spatial-statistics.html#cb76-8"></a><span class="co">##             Df   Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span id="cb76-9"><a href="spatial-statistics.html#cb76-9"></a><span class="co">## Treatment    3  2147233  715744   0.907  0.444</span></span>
<span id="cb76-10"><a href="spatial-statistics.html#cb76-10"></a><span class="co">## Residuals   52 41037326  789179</span></span>
<span id="cb76-11"><a href="spatial-statistics.html#cb76-11"></a><span class="kw">summary</span>(fit3)</span>
<span id="cb76-12"><a href="spatial-statistics.html#cb76-12"></a><span class="co">##             Df   Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span id="cb76-13"><a href="spatial-statistics.html#cb76-13"></a><span class="co">## Treatment    3  1969380  656460   0.467  0.707</span></span>
<span id="cb76-14"><a href="spatial-statistics.html#cb76-14"></a><span class="co">## Residuals   29 40735615 1404676</span></span>
<span id="cb76-15"><a href="spatial-statistics.html#cb76-15"></a><span class="kw">summary</span>(fit4)</span>
<span id="cb76-16"><a href="spatial-statistics.html#cb76-16"></a><span class="co">##             Df Sum Sq Mean Sq F value Pr(&gt;F)  </span></span>
<span id="cb76-17"><a href="spatial-statistics.html#cb76-17"></a><span class="co">## Treatment    3   5763  1920.9    2.68 0.0559 .</span></span>
<span id="cb76-18"><a href="spatial-statistics.html#cb76-18"></a><span class="co">## Residuals   54  38700   716.7                 </span></span>
<span id="cb76-19"><a href="spatial-statistics.html#cb76-19"></a><span class="co">## ---</span></span>
<span id="cb76-20"><a href="spatial-statistics.html#cb76-20"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb76-21"><a href="spatial-statistics.html#cb76-21"></a></span>
<span id="cb76-22"><a href="spatial-statistics.html#cb76-22"></a>knnTemp1b=knnTemp1[<span class="kw">which</span>(knnTemp1<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span>), ]</span>
<span id="cb76-23"><a href="spatial-statistics.html#cb76-23"></a></span>
<span id="cb76-24"><a href="spatial-statistics.html#cb76-24"></a><span class="co"># save data to file</span></span>
<span id="cb76-25"><a href="spatial-statistics.html#cb76-25"></a>knnTemp1<span class="op">$</span>sample=Cdata<span class="op">$</span>NewID[<span class="kw">match</span>(knnTemp1<span class="op">$</span>L1, <span class="kw">gsub</span>(<span class="st">&quot;_&quot;</span>, <span class="st">&quot;&quot;</span>, Cdata<span class="op">$</span>TumorID))]</span>
<span id="cb76-26"><a href="spatial-statistics.html#cb76-26"></a>DT<span class="op">::</span><span class="kw">datatable</span>(knnTemp1[<span class="kw">which</span>(knnTemp1<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span>), <span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">10</span><span class="op">:</span><span class="dv">13</span>)], <span class="dt">rownames=</span>F, <span class="dt">class=</span><span class="st">&#39;cell-border stripe&#39;</span>,</span>
<span id="cb76-27"><a href="spatial-statistics.html#cb76-27"></a>          <span class="dt">extensions=</span><span class="st">&quot;Buttons&quot;</span>, <span class="dt">options=</span><span class="kw">list</span>(<span class="dt">dom=</span><span class="st">&quot;Bfrtip&quot;</span>, <span class="dt">buttons=</span><span class="kw">c</span>(<span class="st">&#39;csv&#39;</span>, <span class="st">&#39;excel&#39;</span>), <span class="dt">scrollX=</span>T))</span></code></pre></div>
<div id="htmlwidget-b17109e76c35b752f47b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b17109e76c35b752f47b">{"x":{"filter":"none","extensions":["Buttons"],"data":[["knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3"],["EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","Unclass","EpCAM","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","SMA","Unclass"],["CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8"],[39.9619294720996,52.7225336699768,16.9493539789847,28.0762263357204,32.1225777378723,34.5773378976414,17.8734545331956,24.2862577170351,34.3310980038422,30.1813313277352,15.9708642750149,35.9949538858457,23.8097655692235,27.4927614773069,48.1920548844928,26.2080114341122,30.0620994045927,40.017617335768,44.9270325366952,67.362948168925,18.227737713612,26.0789306004034,87.1290119223447,76.1212139820092,20.7838391797493,35.2322583582712,25.684014726961,94.6472227236652,31.71923347689,16.9412440359339,69.1029642114784,7919.73814699934,6967.17454887033,17.4776096943474,26.8977347268818,115.537832166079,92.9823657270467,27.030770888554,153.335126312092,178.570277858514,70.2646798349859,25.5393123173911,73.8246082169253,68.8985902373071,24.2694839967484,26.2698530241219,23.9679514376733,185.039122479244,202.99399882031,19.4196462214514,12.7475805953277,285.853432885354,355.949147074118,26.9763572577945,70.8010078561864,22.2120559237338,41.3666397039867,49.2224298887209,100.58772933057,30.4816294488985,18.5134968484564,45.494853238138,76.7638756921953,44.4668605181252,19.2643222967983,22.1832643188894,43.2761676430318,31.5034609637733,22.4092032065563,32.6957878212506,70.4688204470277,20.8917800036548,15.8320599193818,39.2281808267701,23.0636859928962,22.1894313245735,15.5442937646535,53.4327554106199,37.2896843417231,17.3359761878132,91.0751669576987,11.5258914612054,31.2686681101422,19.1900617014782,27.7974963810797,71.6454218187546,65.5135345792109,21.5624234388354,38.8586183513779,19.424460317679,22.6161297328567,29.8404496162519,40.3470121992023,26.3342130305681,47.0690260529832,56.3160400554865,16.5123579147296,34.656263513854,61.8664174149397,22.481602620028,21.5710061661331,15.0638795777243,232.024379910668,111.853705641937,18.0178993686866,16.7082773675647,88.4812071266105,95.1323048182837,35.714729746502,47.7725991706215,87.6000093785154,35.1541298238559,19.2026160560444,44.8085737802091,534.054430609626,132.807954298937,15.3104812717432,38.6122145002545,73.1522125847403,27.6663367297125,21.6238408687143,46.0960082025034,104.055734519621,65.9897286838817,41.8889614629541,32.3115937542865,62.6416107193287,29.7078643603586,42.6316241357437,29.9925367263929,46.1609657575577,32.119384471498,55.928337202601,37.3275801509165,27.3109998317383,30.9911728633493,57.0493044709923,28.0693742368886,16.6699339357226,15.3310577263542,30.6815942217687,155.449558378573,20.7555590473918,14.3065744610314,39.6727092985905,53.314776980707,62.7976147236252,25.0942035849043,28.6675824524931,41.1287139668391,15.8426660535938,35.1720187405611,41.9117660468402,15.0586712374606,82.6844819777013,23.5663635673463,61.0293555829066,91.4153920179871,174.120791862865,36.4707396817286,28.6802979136778,39.0060168186523,20.8880435007379,28.6650991971117,111.447853299894,21.0949983566855,421.712247888895,28.4155576684344,47.8689096441585,30.7031325699884,51.9269272737,76.3795461306288,15.7533613944404,43.3021456962063,50.2145283791539,66.4967414431172,18.1618832812065,34.8130814419572,80.1757958702196,23.0233995983015,30.7152673543528,89.3439919916032,18.5242660198185,73.4872616229125,33.3595777381586,39.1764931259774,17.0139243356616,25.1219651776875,34.3973736056909,14.9960405514937,27.3522464773458,37.0914136017499,44.137697243663,14.334286608678,38.1089497207397,16.3662319888764,350.732082707665,292.950791222238,22.7293734162238,15.1296644410754,36.8731415232591,33.1293133462461,50.0010143574618,24.5631667570772,37.0732105268674],["Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating",null,null,null,null,"Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted",null,null,null,null,"Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted",null,null,null,null,"Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted"],["PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","Vehicle","Vehicle","Vehicle","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY"],["growing","growing","growing","growing","growing","growing","growing","growing","stable","stable","stable","stable",null,null,null,"stable","stable","stable","growing","growing","growing","growing",null,null,null,null,null,null,null,null,"growing","growing","growing","growing","stable","stable","stable","stable","growing","growing","growing","growing","growing","growing","growing","growing",null,null,null,null,"stable","stable","stable","stable","growing","growing","growing","growing","growing","growing","growing","stable","stable","stable","stable","stable","stable","stable","stable","growing","growing","growing","growing","growing","growing","growing","stable","stable","stable","stable","growing","growing",null,null,null,"stable","stable","stable","stable","stable","stable","stable","stable","stable","stable","stable","stable","stable","growing","growing","growing","stable","stable","stable","stable","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","stable","stable","stable","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","stable","stable","stable","growing","growing","growing","growing","growing","stable","stable","stable","stable","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","stable","stable","stable","stable","growing","growing","growing","growing","stable","stable","stable","stable","stable","stable","stable","growing","growing","growing","growing","growing","growing"],["P24T1","P24T1","P24T1","P24T1","P24T2","P24T2","P24T2","P24T2","P24T3","P24T3","P24T3","P24T3","P25T1","P25T1","P25T1","P25T2","P25T2","P25T2","P26T1","P26T1","P26T1","P26T1","P26T2","P26T2","P26T2","P26T2","P26T3","P26T3","P26T3","P26T3","P27T1","P27T1","P27T1","P27T1","P28T1","P28T1","P28T1","P28T1","P29T1","P29T1","P29T1","P29T1","P29T2","P29T2","P29T2","P29T2","P30T1","P30T1","P30T1","P30T1","P30T2","P30T2","P30T2","P30T2","P41T1","P41T1","P41T1","P31T1","P31T1","P31T1","P31T1","P31T2","P31T2","P31T2","P31T2","P32T2","P32T2","P32T2","P32T2","P33T1","P33T1","P33T1","P33T1","P34T2","P34T2","P34T2","P34T3","P34T3","P34T3","P34T3","P35T1","P35T1","P36T1","P36T1","P36T1","P36T2","P36T2","P36T2","P36T3","P36T3","P36T3","P37T1","P37T1","P37T1","P37T1","P38T2","P38T2","P38T2","P39T1","P39T1","P39T1","P39T3","P39T3","P39T3","P39T3","P40T1","P40T1","P40T1","P40T1","P4T1","P4T1","P4T1","P4T1","P5T1","P5T1","P5T1","P5T1","P5T3","P5T3","P5T3","P5T3","P6T1","P6T1","P6T1","P6T1","P7T1","P7T1","P7T1","P8T1","P8T1","P8T1","P8T2","P8T2","P8T2","P8T2","P9T1","P9T1","P9T1","P9T1","P10T1","P10T1","P10T1","P10T2","P10T2","P10T2","P11T1","P11T1","P11T1","P11T1","P12T1","P12T1","P12T1","P12T2","P12T2","P12T3","P12T3","P12T3","P12T4","P12T4","P12T4","P12T4","P14T1","P14T1","P14T1","P15T2","P15T2","P15T2","P16T1","P16T1","P16T1","P16T1","P17T1","P17T1","P17T1","P17T2","P17T2","P17T2","P17T2","P19T2","P19T2","P19T2","P19T3","P19T3","P19T3","P20T1","P20T1","P20T1","P20T1","P20T2","P20T2","P20T2","P20T2","P20T3","P20T3","P20T3","P21T1","P21T1","P21T1","P21T1","P22T1","P22T1","P22T1","P22T2","P22T2","P22T2"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th>knn<\/th>\n      <th>NearestCellType<\/th>\n      <th>CellType<\/th>\n      <th>MeanDistance<\/th>\n      <th>SpatialManual<\/th>\n      <th>Treatment<\/th>\n      <th>Growth<\/th>\n      <th>sample<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["csv","excel"],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="spatial-statistics.html#cb77-1"></a><span class="co">#write.csv(knnTemp1[which(knnTemp1$knn==&quot;knn3&quot;), c(2:5, 10:13)], file=&quot;nature-tables/Fig4c_Ext4e.csv&quot;)</span></span></code></pre></div>
<p>We can refine this comaprison to just knn3. We compare to the vehicle using a wilcox.test below:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="spatial-statistics.html#cb78-1"></a>knnTemp1b=knnTemp1[<span class="kw">which</span>(knnTemp1<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span>), ]</span>
<span id="cb78-2"><a href="spatial-statistics.html#cb78-2"></a>ctypes=<span class="kw">unique</span>(knnTemp1b<span class="op">$</span>NearestCellType)</span>
<span id="cb78-3"><a href="spatial-statistics.html#cb78-3"></a>t2=knnTemp1b[<span class="kw">which</span>(knnTemp1b<span class="op">$</span>CellType<span class="op">==</span><span class="st">&quot;CD8&quot;</span> <span class="op">&amp;</span><span class="st"> </span>knnTemp1b<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span>) , ]</span>
<span id="cb78-4"><a href="spatial-statistics.html#cb78-4"></a></span>
<span id="cb78-5"><a href="spatial-statistics.html#cb78-5"></a>pval2=<span class="kw">sapply</span>(ctypes, <span class="cf">function</span>(x) <span class="kw">wilcox.test</span>(t2<span class="op">$</span>MeanDistance[t2<span class="op">$</span>NearestCellType<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>t2<span class="op">$</span>Treatment<span class="op">==</span><span class="st">&quot;Vehicle&quot;</span> ], t2<span class="op">$</span>MeanDistance[t2<span class="op">$</span>NearestCellType<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>t2<span class="op">$</span>Treatment<span class="op">==</span><span class="st">&quot;LY&quot;</span>])<span class="op">$</span>p.value)</span>
<span id="cb78-6"><a href="spatial-statistics.html#cb78-6"></a></span>
<span id="cb78-7"><a href="spatial-statistics.html#cb78-7"></a>pval3=<span class="kw">sapply</span>(ctypes, <span class="cf">function</span>(x) <span class="kw">wilcox.test</span>(t2<span class="op">$</span>MeanDistance[t2<span class="op">$</span>NearestCellType<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>t2<span class="op">$</span>Treatment<span class="op">==</span><span class="st">&quot;Vehicle&quot;</span> ], t2<span class="op">$</span>MeanDistance[t2<span class="op">$</span>NearestCellType<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>t2<span class="op">$</span>Treatment<span class="op">==</span><span class="st">&quot;PDL1&quot;</span>])<span class="op">$</span>p.value)</span>
<span id="cb78-8"><a href="spatial-statistics.html#cb78-8"></a></span>
<span id="cb78-9"><a href="spatial-statistics.html#cb78-9"></a>pval4=<span class="kw">sapply</span>(ctypes, <span class="cf">function</span>(x) <span class="kw">wilcox.test</span>(t2<span class="op">$</span>MeanDistance[t2<span class="op">$</span>NearestCellType<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>t2<span class="op">$</span>Treatment<span class="op">==</span><span class="st">&quot;Vehicle&quot;</span> ], t2<span class="op">$</span>MeanDistance[t2<span class="op">$</span>NearestCellType<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>t2<span class="op">$</span>Treatment<span class="op">==</span><span class="st">&quot;PDL1+LY&quot;</span>])<span class="op">$</span>p.value)</span>
<span id="cb78-10"><a href="spatial-statistics.html#cb78-10"></a></span>
<span id="cb78-11"><a href="spatial-statistics.html#cb78-11"></a>pmelt=<span class="kw">melt</span>(<span class="kw">cbind</span>(<span class="dt">LY=</span>pval2, <span class="dt">PDL1=</span>pval3, <span class="st">&#39;PDL1+LY&#39;</span>=pval4))</span>
<span id="cb78-12"><a href="spatial-statistics.html#cb78-12"></a><span class="kw">colnames</span>(pmelt)=<span class="kw">c</span>(<span class="st">&quot;NearestCellType&quot;</span>,<span class="st">&quot;Treatment&quot;</span>,<span class="st">&quot;label&quot;</span>)</span>
<span id="cb78-13"><a href="spatial-statistics.html#cb78-13"></a>pmelt<span class="op">$</span>label=<span class="kw">round</span>(pmelt<span class="op">$</span>label, <span class="dv">2</span>)</span>
<span id="cb78-14"><a href="spatial-statistics.html#cb78-14"></a>pmelt<span class="op">$</span>value=<span class="fl">0.8</span></span>
<span id="cb78-15"><a href="spatial-statistics.html#cb78-15"></a>pmelt<span class="op">$</span>Treatment[<span class="kw">which</span>(pmelt<span class="op">$</span>Treatment<span class="op">==</span><span class="st">&quot;pval4&quot;</span>)]=<span class="st">&quot;PDL1+LY&quot;</span></span>
<span id="cb78-16"><a href="spatial-statistics.html#cb78-16"></a></span>
<span id="cb78-17"><a href="spatial-statistics.html#cb78-17"></a>p=<span class="kw">ggplot</span>(knnTemp1b[knnTemp1b<span class="op">$</span>CellType<span class="op">==</span><span class="st">&quot;CD8&quot;</span> , ], <span class="kw">aes</span>(<span class="dt">x=</span>Treatment, <span class="dt">y=</span>MeanDistance, <span class="dt">col=</span>Treatment))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>NearestCellType)<span class="op">+</span><span class="kw">geom_boxplot</span>()<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;knn3&quot;</span>)<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Distance in microns&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;knn3 mean distance to cd8 cell &quot;</span>)<span class="op">+</span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">position=</span><span class="kw">position_jitterdodge</span>(),<span class="dt">alpha=</span><span class="fl">0.3</span>)<span class="op">+</span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(ColMerge[ ,<span class="dv">1</span>], <span class="st">&quot;black&quot;</span>))<span class="op">+</span><span class="kw">scale_y_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>)</span>
<span id="cb78-18"><a href="spatial-statistics.html#cb78-18"></a>p<span class="op">+</span><span class="kw">geom_text</span>(<span class="dt">data=</span>pmelt, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>Treatment, <span class="dt">y=</span><span class="fl">0.8</span>, <span class="dt">label=</span>label))</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/knnTemp-1.png" width="672" /></p>
</div>
<div id="growth" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Growth</h3>
<p>All 95% confidence lines cross 0, but it appears that stable cases have a closer unclass-CD8 interaction distance compared to growing.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="spatial-statistics.html#cb79-1"></a></span>
<span id="cb79-2"><a href="spatial-statistics.html#cb79-2"></a>p&lt;-<span class="kw">ggplot</span>(knnTemp1, <span class="kw">aes</span>(<span class="dt">col=</span>Growth, <span class="dt">y=</span>MeanDistance, <span class="dt">x=</span>Growth))<span class="op">+</span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape=</span><span class="ot">NA</span>)<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">position=</span><span class="kw">position_jitterdodge</span>(),<span class="dt">alpha=</span><span class="fl">0.3</span>)<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>knn<span class="op">+</span>NearestCellType)<span class="op">+</span><span class="kw">scale_y_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>)<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))<span class="op">+</span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(ColSizeb, <span class="st">&quot;black&quot;</span>),<span class="dt">na.value=</span><span class="st">&quot;black&quot;</span>)<span class="op">+</span><span class="kw">theme_bw</span>()</span>
<span id="cb79-3"><a href="spatial-statistics.html#cb79-3"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="spatial-statistics.html#cb80-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>))</span>
<span id="cb80-2"><a href="spatial-statistics.html#cb80-2"></a><span class="kw">plot</span>(<span class="kw">TukeyHSD</span>(fit1b, <span class="st">&quot;Growth&quot;</span>), <span class="dt">las=</span><span class="dv">2</span>)</span>
<span id="cb80-3"><a href="spatial-statistics.html#cb80-3"></a><span class="kw">title</span>(<span class="st">&quot;EpCAM Mean Distance&quot;</span>, <span class="dt">line=</span><span class="fl">3.3</span>)</span>
<span id="cb80-4"><a href="spatial-statistics.html#cb80-4"></a><span class="kw">plot</span>(<span class="kw">TukeyHSD</span>(fit2b, <span class="st">&quot;Growth&quot;</span>), <span class="dt">las=</span><span class="dv">2</span>)</span>
<span id="cb80-5"><a href="spatial-statistics.html#cb80-5"></a><span class="kw">title</span>(<span class="st">&quot;SMA Mean Distance&quot;</span>, <span class="dt">line=</span><span class="fl">3.3</span>)</span>
<span id="cb80-6"><a href="spatial-statistics.html#cb80-6"></a><span class="kw">plot</span>(<span class="kw">TukeyHSD</span>(fit3b, <span class="st">&quot;Growth&quot;</span>), <span class="dt">las=</span><span class="dv">2</span>)</span>
<span id="cb80-7"><a href="spatial-statistics.html#cb80-7"></a><span class="kw">title</span>(<span class="st">&quot;EpCAM:SMA Mean Distance&quot;</span>, <span class="dt">line=</span><span class="fl">3.3</span>)</span>
<span id="cb80-8"><a href="spatial-statistics.html#cb80-8"></a><span class="kw">plot</span>(<span class="kw">TukeyHSD</span>(fit4b, <span class="st">&quot;Growth&quot;</span>), <span class="dt">las=</span><span class="dv">2</span>)</span>
<span id="cb80-9"><a href="spatial-statistics.html#cb80-9"></a><span class="kw">title</span>(<span class="st">&quot;Unclass Distance&quot;</span>, <span class="dt">line=</span><span class="fl">3.3</span>)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-34-2.png" width="672" /></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="spatial-statistics.html#cb81-1"></a></span>
<span id="cb81-2"><a href="spatial-statistics.html#cb81-2"></a><span class="co">#dev.off()</span></span>
<span id="cb81-3"><a href="spatial-statistics.html#cb81-3"></a></span>
<span id="cb81-4"><a href="spatial-statistics.html#cb81-4"></a><span class="kw">summary</span>(fit1b)</span>
<span id="cb81-5"><a href="spatial-statistics.html#cb81-5"></a><span class="co">##             Df Sum Sq Mean Sq F value Pr(&gt;F)  </span></span>
<span id="cb81-6"><a href="spatial-statistics.html#cb81-6"></a><span class="co">## Growth       1   3209    3209   4.568 0.0374 *</span></span>
<span id="cb81-7"><a href="spatial-statistics.html#cb81-7"></a><span class="co">## Residuals   51  35824     702                 </span></span>
<span id="cb81-8"><a href="spatial-statistics.html#cb81-8"></a><span class="co">## ---</span></span>
<span id="cb81-9"><a href="spatial-statistics.html#cb81-9"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb81-10"><a href="spatial-statistics.html#cb81-10"></a><span class="co">## 5 observations deleted due to missingness</span></span>
<span id="cb81-11"><a href="spatial-statistics.html#cb81-11"></a><span class="kw">summary</span>(fit2b)</span>
<span id="cb81-12"><a href="spatial-statistics.html#cb81-12"></a><span class="co">##             Df   Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span id="cb81-13"><a href="spatial-statistics.html#cb81-13"></a><span class="co">## Growth       1   342252  342252   0.358  0.552</span></span>
<span id="cb81-14"><a href="spatial-statistics.html#cb81-14"></a><span class="co">## Residuals   49 46806661  955238               </span></span>
<span id="cb81-15"><a href="spatial-statistics.html#cb81-15"></a><span class="co">## 5 observations deleted due to missingness</span></span>
<span id="cb81-16"><a href="spatial-statistics.html#cb81-16"></a><span class="kw">summary</span>(fit3b)</span>
<span id="cb81-17"><a href="spatial-statistics.html#cb81-17"></a><span class="co">##             Df   Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span id="cb81-18"><a href="spatial-statistics.html#cb81-18"></a><span class="co">## Growth       1   999209  999209    0.48  0.494</span></span>
<span id="cb81-19"><a href="spatial-statistics.html#cb81-19"></a><span class="co">## Residuals   28 58307461 2082409               </span></span>
<span id="cb81-20"><a href="spatial-statistics.html#cb81-20"></a><span class="co">## 3 observations deleted due to missingness</span></span>
<span id="cb81-21"><a href="spatial-statistics.html#cb81-21"></a><span class="kw">summary</span>(fit4b)</span>
<span id="cb81-22"><a href="spatial-statistics.html#cb81-22"></a><span class="co">##             Df Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span id="cb81-23"><a href="spatial-statistics.html#cb81-23"></a><span class="co">## Growth       1   3469    3469   1.053   0.31</span></span>
<span id="cb81-24"><a href="spatial-statistics.html#cb81-24"></a><span class="co">## Residuals   51 168073    3296               </span></span>
<span id="cb81-25"><a href="spatial-statistics.html#cb81-25"></a><span class="co">## 5 observations deleted due to missingness</span></span></code></pre></div>
<p>Can also plot the single result for knn=3</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="spatial-statistics.html#cb82-1"></a>knnTemp1b=knnTemp1[<span class="kw">which</span>(knnTemp1<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span>), ]</span>
<span id="cb82-2"><a href="spatial-statistics.html#cb82-2"></a>ctypes=<span class="kw">unique</span>(knnTemp1b<span class="op">$</span>NearestCellType)</span>
<span id="cb82-3"><a href="spatial-statistics.html#cb82-3"></a>t2=knnTemp1b[<span class="kw">which</span>(knnTemp1b<span class="op">$</span>CellType<span class="op">==</span><span class="st">&quot;CD8&quot;</span> <span class="op">&amp;</span><span class="st"> </span>knnTemp1b<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span>) , ]</span>
<span id="cb82-4"><a href="spatial-statistics.html#cb82-4"></a></span>
<span id="cb82-5"><a href="spatial-statistics.html#cb82-5"></a>pval2=<span class="kw">sapply</span>(ctypes, <span class="cf">function</span>(x) <span class="kw">wilcox.test</span>(t2<span class="op">$</span>MeanDistance[t2<span class="op">$</span>NearestCellType<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>t2<span class="op">$</span>Growth<span class="op">==</span><span class="st">&quot;growing&quot;</span> ], t2<span class="op">$</span>MeanDistance[t2<span class="op">$</span>NearestCellType<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>t2<span class="op">$</span>Growth<span class="op">==</span><span class="st">&quot;stable&quot;</span> ])<span class="op">$</span>p.value)</span>
<span id="cb82-6"><a href="spatial-statistics.html#cb82-6"></a></span>
<span id="cb82-7"><a href="spatial-statistics.html#cb82-7"></a>ann_text=<span class="kw">data.frame</span>(<span class="dt">Glabel=</span><span class="kw">round</span>(pval2,<span class="dv">2</span>), <span class="dt">NearestCellType=</span>(ctypes ), <span class="dt">Growth=</span><span class="st">&quot;stable&quot;</span>, <span class="dt">value=</span><span class="fl">0.7</span>)</span>
<span id="cb82-8"><a href="spatial-statistics.html#cb82-8"></a></span>
<span id="cb82-9"><a href="spatial-statistics.html#cb82-9"></a>p=<span class="kw">ggplot</span>(knnTemp1b[knnTemp1b<span class="op">$</span>CellType<span class="op">==</span><span class="st">&quot;CD8&quot;</span> , ], <span class="kw">aes</span>(<span class="dt">x=</span>Growth, <span class="dt">y=</span>MeanDistance, <span class="dt">col=</span>Growth))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>NearestCellType)<span class="op">+</span><span class="kw">geom_boxplot</span>()<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;knn3&quot;</span>)<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Distance in microns&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;kkn3 nearest neighbor distance to cd8 cell&quot;</span>)<span class="op">+</span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">position=</span><span class="kw">position_jitterdodge</span>(),<span class="dt">alpha=</span><span class="fl">0.3</span>)<span class="op">+</span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(ColSizeb, <span class="st">&quot;black&quot;</span>))<span class="op">+</span><span class="kw">scale_y_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>)</span>
<span id="cb82-10"><a href="spatial-statistics.html#cb82-10"></a>p<span class="op">+</span><span class="kw">geom_text</span>(<span class="dt">data=</span>ann_text, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">2</span>, <span class="dt">y=</span><span class="fl">0.75</span>, <span class="dt">label=</span>Glabel))</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p>Is there a plot showing the different knn values? If there is, delete this section</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="spatial-statistics.html#cb83-1"></a></span>
<span id="cb83-2"><a href="spatial-statistics.html#cb83-2"></a>Combine the Epithelial samples, and SMA<span class="op">/</span>unclassified samples together<span class="op">:</span><span class="st"> </span>Is there a difference here?</span>
<span id="cb83-3"><a href="spatial-statistics.html#cb83-3"></a></span>
<span id="cb83-4"><a href="spatial-statistics.html#cb83-4"></a>knnTemp1b=knnTemp1[<span class="kw">which</span>(knnTemp1<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn1&quot;</span>), ]</span>
<span id="cb83-5"><a href="spatial-statistics.html#cb83-5"></a>knnTemp1b<span class="op">$</span>CD8=WSIvalFracs[<span class="dv">1</span>, <span class="kw">match</span>(knnTemp1b<span class="op">$</span>L1, <span class="kw">colnames</span>(WSIvalFracs))]</span>
<span id="cb83-6"><a href="spatial-statistics.html#cb83-6"></a>knnTemp1b<span class="op">$</span>CD8frac=<span class="kw">ifelse</span>(knnTemp1b<span class="op">$</span>CD8<span class="op">&gt;</span><span class="fl">0.1</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;low&quot;</span>)</span>
<span id="cb83-7"><a href="spatial-statistics.html#cb83-7"></a>knnTemp1b<span class="op">$</span>Ep=WSIvalFracs[<span class="dv">2</span>, <span class="kw">match</span>(knnTemp1b<span class="op">$</span>L1, <span class="kw">colnames</span>(WSIvalFracs))]</span>
<span id="cb83-8"><a href="spatial-statistics.html#cb83-8"></a>knnTemp1b<span class="op">$</span>Epfrac=<span class="kw">ifelse</span>(knnTemp1b<span class="op">$</span>CD8<span class="op">&gt;</span><span class="fl">0.1</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;low&quot;</span>)</span>
<span id="cb83-9"><a href="spatial-statistics.html#cb83-9"></a></span>
<span id="cb83-10"><a href="spatial-statistics.html#cb83-10"></a></span>
<span id="cb83-11"><a href="spatial-statistics.html#cb83-11"></a>knnTemp1c=knnTemp1b[knnTemp1b<span class="op">$</span>NearestCellType<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;EpCAM&quot;</span>),  ]</span>
<span id="cb83-12"><a href="spatial-statistics.html#cb83-12"></a>knnTemp1d=knnTemp1b[knnTemp1b<span class="op">$</span>NearestCellType<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;EpCAM: SMA&quot;</span>),  ]</span>
<span id="cb83-13"><a href="spatial-statistics.html#cb83-13"></a></span>
<span id="cb83-14"><a href="spatial-statistics.html#cb83-14"></a>knnEpMerge=<span class="kw">merge</span>(knnTemp1c, knnTemp1d[ ,<span class="kw">c</span>(<span class="st">&quot;MeanDistance&quot;</span>, <span class="st">&quot;MedianDistance&quot;</span>, <span class="st">&quot;variable&quot;</span>, </span>
<span id="cb83-15"><a href="spatial-statistics.html#cb83-15"></a>                                          <span class="st">&quot;value&quot;</span>,<span class="st">&quot;L1&quot;</span>)], <span class="dt">by.x=</span><span class="st">&quot;L1&quot;</span>, <span class="dt">by.y=</span><span class="st">&quot;L1&quot;</span>, <span class="dt">all=</span>T)</span>
<span id="cb83-16"><a href="spatial-statistics.html#cb83-16"></a>knnEpMerge<span class="op">$</span>EpDist2=<span class="kw">ifelse</span>(knnEpMerge<span class="op">$</span>MedianDistance.x<span class="op">&lt;</span>knnEpMerge<span class="op">$</span>MedianDistance.y, </span>
<span id="cb83-17"><a href="spatial-statistics.html#cb83-17"></a>                          knnEpMerge<span class="op">$</span>MedianDistance.x, knnEpMerge<span class="op">$</span>MedianDistance.y)</span>
<span id="cb83-18"><a href="spatial-statistics.html#cb83-18"></a>knnEpMerge<span class="op">$</span>EpDist2[<span class="kw">which</span>(<span class="kw">is.na</span>(knnEpMerge<span class="op">$</span>EpDist2))]=knnEpMerge<span class="op">$</span>MedianDistance.x[<span class="kw">which</span>(<span class="kw">is.na</span>(knnEpMerge<span class="op">$</span>EpDist2))]</span>
<span id="cb83-19"><a href="spatial-statistics.html#cb83-19"></a></span>
<span id="cb83-20"><a href="spatial-statistics.html#cb83-20"></a><span class="kw">ggplot</span>(knnEpMerge, <span class="kw">aes</span>(<span class="dt">x=</span>Growth , <span class="dt">y=</span>EpDist2, <span class="dt">col=</span>Growth))<span class="op">+</span><span class="kw">geom_boxplot</span>()<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">position=</span><span class="kw">position_jitterdodge</span>(),<span class="dt">alpha=</span><span class="fl">0.3</span>)<span class="op">+</span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">200</span>))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>CD8frac)</span>
<span id="cb83-21"><a href="spatial-statistics.html#cb83-21"></a></span>
<span id="cb83-22"><a href="spatial-statistics.html#cb83-22"></a><span class="kw">ggplot</span>(knnEpMerge, <span class="kw">aes</span>(<span class="dt">x=</span>Treatment, <span class="dt">y=</span>EpDist2, <span class="dt">col=</span>Treatment))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>CD8frac)<span class="op">+</span><span class="kw">geom_boxplot</span>()<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">position=</span><span class="kw">position_jitterdodge</span>(),<span class="dt">alpha=</span><span class="fl">0.3</span>)<span class="op">+</span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">200</span>))</span>
<span id="cb83-23"><a href="spatial-statistics.html#cb83-23"></a></span>
<span id="cb83-24"><a href="spatial-statistics.html#cb83-24"></a><span class="kw">plot</span>(knnEpMerge<span class="op">$</span>CD8, knnEpMerge<span class="op">$</span>EpDist2, <span class="dt">col=</span><span class="kw">factor</span>(knnEpMerge<span class="op">$</span>Growth))</span>
<span id="cb83-25"><a href="spatial-statistics.html#cb83-25"></a><span class="kw">text</span>(knnEpMerge<span class="op">$</span>CD8, knnEpMerge<span class="op">$</span>EpDist2, knnEpMerge<span class="op">$</span>L1)</span>
<span id="cb83-26"><a href="spatial-statistics.html#cb83-26"></a><span class="kw">plot</span>(knnEpMerge<span class="op">$</span>Ep, knnEpMerge<span class="op">$</span>EpDist2, <span class="dt">col=</span><span class="kw">factor</span>(knnEpMerge<span class="op">$</span>Growth))</span>
<span id="cb83-27"><a href="spatial-statistics.html#cb83-27"></a><span class="kw">text</span>(knnEpMerge<span class="op">$</span>Ep, knnEpMerge<span class="op">$</span>EpDist2, knnEpMerge<span class="op">$</span>L1)</span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="spatial-statistics.html#cb84-1"></a><span class="co">## what is this used for?</span></span>
<span id="cb84-2"><a href="spatial-statistics.html#cb84-2"></a>knnTempSumm=knnTemp1[<span class="kw">which</span>(knnTemp1<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span>), ]</span>
<span id="cb84-3"><a href="spatial-statistics.html#cb84-3"></a>knnreshape=<span class="kw">acast</span>(knnTempSumm[ ,<span class="kw">c</span>(<span class="st">&quot;NearestCellType&quot;</span>, <span class="st">&quot;MeanDistance&quot;</span>, <span class="st">&quot;L1&quot;</span>)], L1<span class="op">~</span>NearestCellType, <span class="dt">value.var=</span><span class="st">&quot;MeanDistance&quot;</span> )</span>
<span id="cb84-4"><a href="spatial-statistics.html#cb84-4"></a>knnreshape=<span class="kw">data.frame</span>(knnreshape)</span>
<span id="cb84-5"><a href="spatial-statistics.html#cb84-5"></a>knnreshape<span class="op">$</span>EpMIN=<span class="kw">ifelse</span>(knnreshape<span class="op">$</span>EpCAM..SMA<span class="op">&lt;</span>knnreshape<span class="op">$</span>EpCAM, knnreshape<span class="op">$</span>EpCAM..SMA, knnreshape<span class="op">$</span>EpCAM)</span>
<span id="cb84-6"><a href="spatial-statistics.html#cb84-6"></a>knnreshape<span class="op">$</span>EpMIN[<span class="kw">which</span>(<span class="kw">is.na</span>(knnreshape<span class="op">$</span>EpMIN))]=knnreshape<span class="op">$</span>EpCAM[<span class="kw">which</span>(<span class="kw">is.na</span>(knnreshape<span class="op">$</span>EpMIN))]</span>
<span id="cb84-7"><a href="spatial-statistics.html#cb84-7"></a>knnreshape<span class="op">$</span>EpStrRatio1=knnreshape<span class="op">$</span>EpCAM<span class="op">/</span><span class="kw">rowSums</span>(knnreshape[ ,<span class="kw">c</span>(<span class="st">&quot;EpCAM..SMA&quot;</span>, <span class="st">&quot;SMA&quot;</span>)], <span class="dt">na.rm=</span>T)</span>
<span id="cb84-8"><a href="spatial-statistics.html#cb84-8"></a>knnreshape<span class="op">$</span>EpStrRatio2=knnreshape<span class="op">$</span>EpCAM<span class="op">/</span>(knnreshape<span class="op">$</span>SMA)</span>
<span id="cb84-9"><a href="spatial-statistics.html#cb84-9"></a>knnreshape<span class="op">$</span>EpStrRatio3=<span class="kw">rowSums</span>(knnreshape[ ,<span class="kw">c</span>(<span class="st">&quot;EpCAM..SMA&quot;</span>, <span class="st">&quot;EpCAM&quot;</span>)], <span class="dt">na.rm=</span>T)<span class="op">/</span><span class="kw">rowSums</span>(knnreshape[ ,<span class="kw">c</span>(<span class="st">&quot;EpCAM..SMA&quot;</span>, <span class="st">&quot;SMA&quot;</span>)], <span class="dt">na.rm=</span>T)</span>
<span id="cb84-10"><a href="spatial-statistics.html#cb84-10"></a>knnreshape<span class="op">$</span>EpStrRatio4=<span class="kw">rowSums</span>(knnreshape[ ,<span class="kw">c</span>(<span class="st">&quot;EpCAM..SMA&quot;</span>, <span class="st">&quot;EpCAM&quot;</span>)], <span class="dt">na.rm=</span>T)<span class="op">/</span>(knnreshape<span class="op">$</span>SMA)</span></code></pre></div>
</div>
</div>
<div id="the-interacting-fraction" class="section level2">
<h2><span class="header-section-number">5.2</span> The interacting fraction</h2>
<p>The interacting fraction uses the knn-distances and determines the proportion of CD8 cells which are within a proximity of r um from celltype B.</p>
<div id="comparison-to-manual-select-optimal-r" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Comparison to manual &amp; select optimal r</h3>
<p>Below are plots of the proportion of CD8 cells within an “interacting distance” as we increase r. This looks at both the interacting fraction of CD8 cells with Epcam+ and SMA+ cells. Lines are color coded according to the manual spatial-infiltration annotation.</p>
<p>We notice from the line plots for each single sample that the restricted samples generally have low interacting fractins with EpCAM and SMA compared to the infiltrating samples. In addition, there is a statistical difference in EpCAM measurements compared to SMA.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="spatial-statistics.html#cb85-1"></a>IFmelt=<span class="kw">melt</span>(WSIIF, <span class="dt">measure.vars=</span><span class="kw">c</span>(<span class="st">&quot;IF&quot;</span>))</span>
<span id="cb85-2"><a href="spatial-statistics.html#cb85-2"></a></span>
<span id="cb85-3"><a href="spatial-statistics.html#cb85-3"></a>IFmelt<span class="op">$</span>SpatialManual=Cdata<span class="op">$</span>Pathologist.CD8.Spatial[<span class="kw">match</span>(IFmelt<span class="op">$</span>L1, <span class="kw">gsub</span>(<span class="st">&quot;_&quot;</span>, <span class="st">&quot;&quot;</span>, Cdata<span class="op">$</span>TumorID))]</span>
<span id="cb85-4"><a href="spatial-statistics.html#cb85-4"></a>IFmelt<span class="op">$</span>Treatment=Cdata<span class="op">$</span>Treatment[<span class="kw">match</span>(IFmelt<span class="op">$</span>L1, <span class="kw">gsub</span>(<span class="st">&quot;_&quot;</span>, <span class="st">&quot;&quot;</span>, Cdata<span class="op">$</span>TumorID))]</span>
<span id="cb85-5"><a href="spatial-statistics.html#cb85-5"></a>IFmelt<span class="op">$</span>Growth=Cdata<span class="op">$</span>Tumor.Growth[<span class="kw">match</span>(IFmelt<span class="op">$</span>L1, <span class="kw">gsub</span>(<span class="st">&quot;_&quot;</span>, <span class="st">&quot;&quot;</span>, Cdata<span class="op">$</span>TumorID))]</span>
<span id="cb85-6"><a href="spatial-statistics.html#cb85-6"></a><span class="co">#IFmelt$Growth=IFmelt$Growth</span></span>
<span id="cb85-7"><a href="spatial-statistics.html#cb85-7"></a><span class="co">#IFmelt$Growth[grep(&quot;no data&quot;, IFmelt$Growth)]=&quot;no data&quot;</span></span>
<span id="cb85-8"><a href="spatial-statistics.html#cb85-8"></a></span>
<span id="cb85-9"><a href="spatial-statistics.html#cb85-9"></a>IFmelt<span class="op">$</span>Dist=(<span class="kw">substr</span>(IFmelt<span class="op">$</span>Grid, <span class="dv">6</span>, <span class="dv">7</span>))</span>
<span id="cb85-10"><a href="spatial-statistics.html#cb85-10"></a>IFmelt<span class="op">$</span>knn=<span class="kw">substr</span>(IFmelt<span class="op">$</span>Grid, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb85-11"><a href="spatial-statistics.html#cb85-11"></a>IFmelt<span class="op">$</span>sample=Cdata<span class="op">$</span>NewID[<span class="kw">match</span>(IFmelt<span class="op">$</span>L1, <span class="kw">gsub</span>(<span class="st">&quot;_&quot;</span>, <span class="st">&quot;&quot;</span>, Cdata<span class="op">$</span>TumorID))]</span>
<span id="cb85-12"><a href="spatial-statistics.html#cb85-12"></a></span>
<span id="cb85-13"><a href="spatial-statistics.html#cb85-13"></a>IFTempSumm=IFmelt[IFmelt<span class="op">$</span>Grid<span class="op">==</span><span class="st">&quot;knn3-15&quot;</span> <span class="op">&amp;</span><span class="st"> </span>IFmelt<span class="op">$</span>Reference<span class="op">==</span><span class="st">&quot;CD8&quot;</span>, ]</span>
<span id="cb85-14"><a href="spatial-statistics.html#cb85-14"></a>IFreshape=<span class="kw">acast</span>(IFTempSumm[ ,<span class="kw">c</span>(<span class="st">&quot;NearestNeighbor&quot;</span>, <span class="st">&quot;value&quot;</span>, <span class="st">&quot;L1&quot;</span>)], L1<span class="op">~</span>NearestNeighbor, <span class="dt">value.var=</span><span class="st">&quot;value&quot;</span> )</span>
<span id="cb85-15"><a href="spatial-statistics.html#cb85-15"></a>IFreshape=<span class="kw">data.frame</span>(IFreshape)</span>
<span id="cb85-16"><a href="spatial-statistics.html#cb85-16"></a></span>
<span id="cb85-17"><a href="spatial-statistics.html#cb85-17"></a>IFreshape<span class="op">$</span>EpMIN=<span class="kw">ifelse</span>(IFreshape<span class="op">$</span>EpCAM..SMA<span class="op">&lt;</span>IFreshape<span class="op">$</span>EpCAM, IFreshape<span class="op">$</span>EpCAM..SMA, IFreshape<span class="op">$</span>EpCAM)</span>
<span id="cb85-18"><a href="spatial-statistics.html#cb85-18"></a>IFreshape<span class="op">$</span>EpMIN[<span class="kw">which</span>(<span class="kw">is.na</span>(IFreshape<span class="op">$</span>EpMIN))]=IFreshape<span class="op">$</span>EpCAM[<span class="kw">which</span>(<span class="kw">is.na</span>(IFreshape<span class="op">$</span>EpMIN))]</span>
<span id="cb85-19"><a href="spatial-statistics.html#cb85-19"></a>IFreshape<span class="op">$</span>EpStrRatio1=IFreshape<span class="op">$</span>EpCAM<span class="op">/</span><span class="kw">rowSums</span>(IFreshape[ ,<span class="kw">c</span>(<span class="st">&quot;EpCAM..SMA&quot;</span>, <span class="st">&quot;SMA&quot;</span>)], <span class="dt">na.rm=</span>T)</span>
<span id="cb85-20"><a href="spatial-statistics.html#cb85-20"></a>IFreshape<span class="op">$</span>EpStrRatio2=IFreshape<span class="op">$</span>EpCAM<span class="op">/</span>(IFreshape<span class="op">$</span>SMA)</span>
<span id="cb85-21"><a href="spatial-statistics.html#cb85-21"></a>IFreshape<span class="op">$</span>EpStrRatio3=<span class="kw">rowSums</span>(IFreshape[ ,<span class="kw">c</span>(<span class="st">&quot;EpCAM..SMA&quot;</span>, <span class="st">&quot;EpCAM&quot;</span>)], <span class="dt">na.rm=</span>T)<span class="op">/</span><span class="kw">rowSums</span>(IFreshape[ ,<span class="kw">c</span>(<span class="st">&quot;EpCAM..SMA&quot;</span>, <span class="st">&quot;SMA&quot;</span>)], <span class="dt">na.rm=</span>T)</span>
<span id="cb85-22"><a href="spatial-statistics.html#cb85-22"></a>IFreshape<span class="op">$</span>EpStrRatio4=<span class="kw">rowSums</span>(IFreshape[ ,<span class="kw">c</span>(<span class="st">&quot;EpCAM..SMA&quot;</span>, <span class="st">&quot;EpCAM&quot;</span>)], <span class="dt">na.rm=</span>T)<span class="op">/</span>(IFreshape<span class="op">$</span>SMA)</span>
<span id="cb85-23"><a href="spatial-statistics.html#cb85-23"></a></span>
<span id="cb85-24"><a href="spatial-statistics.html#cb85-24"></a></span>
<span id="cb85-25"><a href="spatial-statistics.html#cb85-25"></a>IFreshape<span class="op">$</span>Treatment=<span class="kw">factor</span>(IFTempSumm<span class="op">$</span>Treatment[<span class="kw">match</span>(<span class="kw">rownames</span>(IFreshape), IFTempSumm<span class="op">$</span>L1)])</span>
<span id="cb85-26"><a href="spatial-statistics.html#cb85-26"></a>IFreshape<span class="op">$</span>Growth=<span class="kw">factor</span>(IFTempSumm<span class="op">$</span>Growth[<span class="kw">match</span>(<span class="kw">rownames</span>(IFreshape), IFTempSumm<span class="op">$</span>L1)])</span>
<span id="cb85-27"><a href="spatial-statistics.html#cb85-27"></a>IFreshape<span class="op">$</span>Infil=<span class="kw">factor</span>(IFTempSumm<span class="op">$</span>SpatialManual[<span class="kw">match</span>(<span class="kw">rownames</span>(IFreshape), IFTempSumm<span class="op">$</span>L1)])</span>
<span id="cb85-28"><a href="spatial-statistics.html#cb85-28"></a>IFreshape<span class="op">$</span>CD8frac=SummaryData<span class="op">$</span>CD8Frac.WSI[<span class="kw">match</span>(<span class="kw">rownames</span>(IFreshape), <span class="kw">rownames</span>(SummaryData))]</span>
<span id="cb85-29"><a href="spatial-statistics.html#cb85-29"></a>IFreshape<span class="op">$</span>TumSize=SummaryData<span class="op">$</span>TumSize[<span class="kw">match</span>(<span class="kw">rownames</span>(IFreshape), <span class="kw">rownames</span>(SummaryData))]</span>
<span id="cb85-30"><a href="spatial-statistics.html#cb85-30"></a></span>
<span id="cb85-31"><a href="spatial-statistics.html#cb85-31"></a><span class="co">####</span></span>
<span id="cb85-32"><a href="spatial-statistics.html#cb85-32"></a><span class="co"># line plots to see the best separation between infiltrating and restricted</span></span>
<span id="cb85-33"><a href="spatial-statistics.html#cb85-33"></a><span class="co">###</span></span>
<span id="cb85-34"><a href="spatial-statistics.html#cb85-34"></a></span>
<span id="cb85-35"><a href="spatial-statistics.html#cb85-35"></a><span class="co">#pdf(sprintf(&quot;rslt/WSI-analysis/interacting_fraction_compared_manual_%s.pdf&quot;, Sys.Date()), height=8, width=14)</span></span>
<span id="cb85-36"><a href="spatial-statistics.html#cb85-36"></a></span>
<span id="cb85-37"><a href="spatial-statistics.html#cb85-37"></a>IFmelt2=IFmelt[IFmelt<span class="op">$</span>NearestNeighbor<span class="op">==</span><span class="st">&quot;EpCAM&quot;</span> <span class="op">&amp;</span><span class="st"> </span>IFmelt<span class="op">$</span>Reference<span class="op">==</span><span class="st">&quot;CD8&quot;</span> , ]</span>
<span id="cb85-38"><a href="spatial-statistics.html#cb85-38"></a>IFmelt2<span class="op">$</span>label=IFmelt2<span class="op">$</span>L1</span>
<span id="cb85-39"><a href="spatial-statistics.html#cb85-39"></a>IFmelt2<span class="op">$</span>label[<span class="kw">which</span>(IFmelt2<span class="op">$</span>Dist<span class="op">!=</span><span class="dv">30</span>)]=<span class="ot">NA</span></span>
<span id="cb85-40"><a href="spatial-statistics.html#cb85-40"></a>p&lt;-<span class="kw">ggplot</span>(IFmelt2, <span class="kw">aes</span>(<span class="dt">x=</span>Dist, <span class="dt">y=</span>value, <span class="dt">col=</span>SpatialManual, <span class="dt">group=</span>L1, <span class="dt">label=</span>label))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>knn)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span>L1))<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Interacting Fraction&quot;</span>)<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Distance in microns&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;CD8-EpCAM interacting fraction: spatial manual&quot;</span>)<span class="op">+</span><span class="kw">geom_label</span>()</span>
<span id="cb85-41"><a href="spatial-statistics.html#cb85-41"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="spatial-statistics.html#cb86-1"></a></span>
<span id="cb86-2"><a href="spatial-statistics.html#cb86-2"></a><span class="co">#IFmelt2$Dist=as.numeric(IFmelt2$Dist)</span></span>
<span id="cb86-3"><a href="spatial-statistics.html#cb86-3"></a></span>
<span id="cb86-4"><a href="spatial-statistics.html#cb86-4"></a>p&lt;-<span class="kw">ggplot</span>(IFmelt2, <span class="kw">aes</span>(<span class="dt">x=</span>Dist, <span class="dt">y=</span>value, <span class="dt">col=</span>SpatialManual, <span class="dt">label=</span>label))<span class="op">+</span><span class="kw">geom_boxplot</span>()<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Interacting Fraction&quot;</span>)<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Distance in microns&quot;</span>)<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>knn)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;CD8-EpCAM knn3&quot;</span>)<span class="op">+</span><span class="kw">stat_smooth</span>()</span>
<span id="cb86-5"><a href="spatial-statistics.html#cb86-5"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-38-2.png" width="672" /></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="spatial-statistics.html#cb87-1"></a></span>
<span id="cb87-2"><a href="spatial-statistics.html#cb87-2"></a>IFmelt2=IFmelt[IFmelt<span class="op">$</span>NearestNeighbor<span class="op">==</span><span class="st">&quot;SMA&quot;</span> <span class="op">&amp;</span><span class="st"> </span>IFmelt<span class="op">$</span>Reference<span class="op">==</span><span class="st">&quot;CD8&quot;</span> , ]</span>
<span id="cb87-3"><a href="spatial-statistics.html#cb87-3"></a>IFmelt2<span class="op">$</span>label=IFmelt2<span class="op">$</span>L1</span>
<span id="cb87-4"><a href="spatial-statistics.html#cb87-4"></a>IFmelt2<span class="op">$</span>label[<span class="kw">which</span>(IFmelt2<span class="op">$</span>Dist<span class="op">!=</span><span class="dv">30</span>)]=<span class="ot">NA</span></span>
<span id="cb87-5"><a href="spatial-statistics.html#cb87-5"></a></span>
<span id="cb87-6"><a href="spatial-statistics.html#cb87-6"></a>p&lt;-<span class="kw">ggplot</span>(IFmelt2, <span class="kw">aes</span>(<span class="dt">x=</span>Dist, <span class="dt">y=</span>value, <span class="dt">col=</span>SpatialManual, <span class="dt">group=</span>L1, <span class="dt">label=</span>label))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>knn)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span>L1))<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Interacting Fraction&quot;</span>)<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Distance in microns&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;CD8-SMA interacting fraction: spatial manual&quot;</span>)<span class="op">+</span><span class="kw">geom_label</span>()</span>
<span id="cb87-7"><a href="spatial-statistics.html#cb87-7"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-38-3.png" width="672" /></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="spatial-statistics.html#cb88-1"></a></span>
<span id="cb88-2"><a href="spatial-statistics.html#cb88-2"></a></span>
<span id="cb88-3"><a href="spatial-statistics.html#cb88-3"></a>p&lt;-<span class="kw">ggplot</span>(IFmelt2, <span class="kw">aes</span>(<span class="dt">x=</span>Dist, <span class="dt">y=</span>value, <span class="dt">col=</span>SpatialManual, <span class="dt">label=</span>label))<span class="op">+</span><span class="kw">geom_boxplot</span>()<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Interacting Fraction&quot;</span>)<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Distance in microns&quot;</span>)<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>knn)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;CD8-SMA knn3 &quot;</span>)</span>
<span id="cb88-4"><a href="spatial-statistics.html#cb88-4"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-38-4.png" width="672" /></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="spatial-statistics.html#cb89-1"></a></span>
<span id="cb89-2"><a href="spatial-statistics.html#cb89-2"></a><span class="co"># ggplot(IFmelt2, aes(x=Dist, y=value, col=SpatialManual, linetype=SpatialManual))+geom_point()+stat_smooth()+ggtitle(&quot;CD8-EpCAM interacting fraction: spatial manual&quot;)+ylab(&quot;Interacting Fraction&quot;)</span></span>
<span id="cb89-3"><a href="spatial-statistics.html#cb89-3"></a></span>
<span id="cb89-4"><a href="spatial-statistics.html#cb89-4"></a><span class="co"># ## Do a dot plot</span></span>
<span id="cb89-5"><a href="spatial-statistics.html#cb89-5"></a> <span class="co"># p&lt;-ggplot(IFmelt2, aes(x=Dist, y=value, col=SpatialManual, label=label))+geom_boxplot()+ylab(&quot;Interacting Fraction&quot;)+xlab(&quot;Distance in microns&quot;)+facet_grid(~knn)+ggtitle(&quot;CD8-SMA knn3 &quot;)</span></span>
<span id="cb89-6"><a href="spatial-statistics.html#cb89-6"></a> <span class="co"># print(p)</span></span></code></pre></div>
<p>Using the boxplots as a guide, we can determine optimal “interacting distances” at which to perform downstream analysis. The best separation between restricted and infiltrating for EpCAM appears at:</p>
<ul>
<li>1-nn: 10-15 um</li>
<li>3-nn: 15 um</li>
<li>5-nn: 20 um</li>
</ul>
<p>The interacting fraction does not distinguish SMA fractions (all restricted boxplots overlap with the infiltrating boxplots)</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="spatial-statistics.html#cb90-1"></a></span>
<span id="cb90-2"><a href="spatial-statistics.html#cb90-2"></a><span class="co">#The following plots use 3NN analysis with an interacting distance of 15um. We can firstly check if there is an association between different &quot;interacting fraction&quot; types and manual scoring, similar to what was performed for knn-analysis. Only CD8-EpCAM interacting distances is associated with manual scoring. All other metrics are not significant.</span></span>
<span id="cb90-3"><a href="spatial-statistics.html#cb90-3"></a></span>
<span id="cb90-4"><a href="spatial-statistics.html#cb90-4"></a></span>
<span id="cb90-5"><a href="spatial-statistics.html#cb90-5"></a><span class="co">## reshape and do a correlation plot like for the knn analysis</span></span>
<span id="cb90-6"><a href="spatial-statistics.html#cb90-6"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb90-7"><a href="spatial-statistics.html#cb90-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>){</span>
<span id="cb90-8"><a href="spatial-statistics.html#cb90-8"></a>  a1=<span class="kw">wilcox.test</span>(IFreshape[ ,i]<span class="op">~</span>IFreshape<span class="op">$</span>Infil)</span>
<span id="cb90-9"><a href="spatial-statistics.html#cb90-9"></a>  <span class="kw">boxplot</span>(IFreshape[ ,i]<span class="op">~</span>IFreshape<span class="op">$</span>Infil, <span class="dt">main=</span><span class="kw">paste</span>(<span class="kw">colnames</span>(IFreshape)[i],<span class="st">&quot; p=&quot;</span>, <span class="kw">round</span>(a1<span class="op">$</span>p.value,<span class="dv">2</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span> ), <span class="dt">xlab=</span><span class="st">&quot;IF: knn3, 15um&quot;</span>)</span>
<span id="cb90-10"><a href="spatial-statistics.html#cb90-10"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="spatial-statistics.html#cb91-1"></a></span>
<span id="cb91-2"><a href="spatial-statistics.html#cb91-2"></a><span class="co"># Again, association between CD8 content and interacting fraction was observed ONLY in the growing samples or restricted cases. </span></span>
<span id="cb91-3"><a href="spatial-statistics.html#cb91-3"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb91-4"><a href="spatial-statistics.html#cb91-4"></a>a1x=<span class="kw">cor.test</span>(IFreshape<span class="op">$</span>CD8frac[IFreshape<span class="op">$</span>Infil<span class="op">==</span><span class="st">&quot;Infiltrating&quot;</span>], IFreshape<span class="op">$</span>EpCAM[IFreshape<span class="op">$</span>Infil<span class="op">==</span><span class="st">&quot;Infiltrating&quot;</span>])</span>
<span id="cb91-5"><a href="spatial-statistics.html#cb91-5"></a>a1y=<span class="kw">cor.test</span>(IFreshape<span class="op">$</span>CD8frac[IFreshape<span class="op">$</span>Infil<span class="op">==</span><span class="st">&quot;restricted&quot;</span>], IFreshape<span class="op">$</span>EpCAM[IFreshape<span class="op">$</span>Infil<span class="op">==</span><span class="st">&quot;restricted&quot;</span>])</span>
<span id="cb91-6"><a href="spatial-statistics.html#cb91-6"></a><span class="kw">plot</span>(IFreshape<span class="op">$</span>CD8frac, IFreshape<span class="op">$</span>EpCAM, <span class="dt">col=</span>IFreshape<span class="op">$</span>Infil, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">xlab=</span><span class="st">&quot;CD8 fraction&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;CD8-EpCAM IF (knn3-15um)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;spatial scoring&quot;</span>)</span>
<span id="cb91-7"><a href="spatial-statistics.html#cb91-7"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="kw">paste</span>(<span class="st">&quot;infil p=&quot;</span>, <span class="kw">round</span>(a1x<span class="op">$</span>p.value,<span class="dv">2</span>)), <span class="kw">paste</span>(<span class="st">&quot;restrict p=&quot;</span>, <span class="kw">round</span>(a1y<span class="op">$</span>p.value,<span class="dv">2</span>))), <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb91-8"><a href="spatial-statistics.html#cb91-8"></a></span>
<span id="cb91-9"><a href="spatial-statistics.html#cb91-9"></a>a1x=<span class="kw">cor.test</span>(IFreshape<span class="op">$</span>CD8frac[IFreshape<span class="op">$</span>Growth<span class="op">==</span><span class="st">&quot;growing&quot;</span>], IFreshape<span class="op">$</span>EpCAM[IFreshape<span class="op">$</span>Growth<span class="op">==</span><span class="st">&quot;growing&quot;</span>])</span>
<span id="cb91-10"><a href="spatial-statistics.html#cb91-10"></a>a1y=<span class="kw">cor.test</span>(IFreshape<span class="op">$</span>CD8frac[IFreshape<span class="op">$</span>Growth<span class="op">==</span><span class="st">&quot;stable&quot;</span>], IFreshape<span class="op">$</span>EpCAM[IFreshape<span class="op">$</span>Growth<span class="op">==</span><span class="st">&quot;stable&quot;</span>])</span>
<span id="cb91-11"><a href="spatial-statistics.html#cb91-11"></a></span>
<span id="cb91-12"><a href="spatial-statistics.html#cb91-12"></a><span class="kw">plot</span>(IFreshape<span class="op">$</span>CD8frac, IFreshape<span class="op">$</span>EpCAM, <span class="dt">col=</span>IFreshape<span class="op">$</span>Growth, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">xlab=</span><span class="st">&quot;CD8 fraction&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;CD8-EpCAM IF (knn3-15um)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;tumor growth&quot;</span>)</span>
<span id="cb91-13"><a href="spatial-statistics.html#cb91-13"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="kw">paste</span>(<span class="st">&quot;growing p=&quot;</span>, <span class="kw">round</span>(a1x<span class="op">$</span>p.value,<span class="dv">2</span>)), <span class="kw">paste</span>(<span class="st">&quot;stable p=&quot;</span>, <span class="kw">round</span>(a1y<span class="op">$</span>p.value,<span class="dv">2</span>))), <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
<div id="growth-1" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Growth</h3>
<p>Here, we check if there is an association between the spatial pattern and tumor growth. P value by wilcox test shown</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="spatial-statistics.html#cb92-1"></a></span>
<span id="cb92-2"><a href="spatial-statistics.html#cb92-2"></a><span class="co">######</span></span>
<span id="cb92-3"><a href="spatial-statistics.html#cb92-3"></a><span class="co"># compare these metrics with growth</span></span>
<span id="cb92-4"><a href="spatial-statistics.html#cb92-4"></a><span class="co">####</span></span>
<span id="cb92-5"><a href="spatial-statistics.html#cb92-5"></a><span class="co">#pdf(&quot;~/Desktop/4D-IF-summary-growth.pdf&quot;, height=5, width=7)</span></span>
<span id="cb92-6"><a href="spatial-statistics.html#cb92-6"></a></span>
<span id="cb92-7"><a href="spatial-statistics.html#cb92-7"></a><span class="co">#pdf(sprintf(&quot;rslt/WSI-analysis/interacting_fraction_vs_treatment_growth_%s.pdf&quot;, Sys.Date()), height=7, width=12)</span></span>
<span id="cb92-8"><a href="spatial-statistics.html#cb92-8"></a>ctypes=<span class="kw">unique</span>(IFmelt<span class="op">$</span>NearestNeighbor)</span>
<span id="cb92-9"><a href="spatial-statistics.html#cb92-9"></a>t2=IFmelt[<span class="kw">which</span>(IFmelt<span class="op">$</span>Reference<span class="op">==</span><span class="st">&quot;CD8&quot;</span> <span class="op">&amp;</span><span class="st"> </span>IFmelt<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span> <span class="op">&amp;</span><span class="st"> </span>IFmelt<span class="op">$</span>Dist<span class="op">==</span><span class="dv">15</span>) , ]</span>
<span id="cb92-10"><a href="spatial-statistics.html#cb92-10"></a></span>
<span id="cb92-11"><a href="spatial-statistics.html#cb92-11"></a>pval2=<span class="kw">sapply</span>(ctypes, <span class="cf">function</span>(x) <span class="kw">wilcox.test</span>(t2<span class="op">$</span>value[t2<span class="op">$</span>NearestNeighbor<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>t2<span class="op">$</span>Growth<span class="op">==</span><span class="st">&quot;growing&quot;</span> ], t2<span class="op">$</span>value[t2<span class="op">$</span>NearestNeighbor<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>t2<span class="op">$</span>Growth<span class="op">==</span><span class="st">&quot;stable&quot;</span> ])<span class="op">$</span>p.value)</span>
<span id="cb92-12"><a href="spatial-statistics.html#cb92-12"></a></span>
<span id="cb92-13"><a href="spatial-statistics.html#cb92-13"></a>ann_text=<span class="kw">data.frame</span>(<span class="dt">Glabel=</span><span class="kw">round</span>(pval2,<span class="dv">3</span>), <span class="dt">NearestNeighbor=</span>(ctypes ), <span class="dt">Growth=</span><span class="st">&quot;stable&quot;</span>, <span class="dt">value=</span><span class="fl">0.7</span>)</span>
<span id="cb92-14"><a href="spatial-statistics.html#cb92-14"></a></span>
<span id="cb92-15"><a href="spatial-statistics.html#cb92-15"></a>p=<span class="kw">ggplot</span>(IFmelt[IFmelt<span class="op">$</span>Reference<span class="op">==</span><span class="st">&quot;CD8&quot;</span> <span class="op">&amp;</span><span class="st"> </span>IFmelt<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span> <span class="op">&amp;</span><span class="st"> </span>IFmelt<span class="op">$</span>Dist<span class="op">==</span><span class="dv">15</span> , ], <span class="kw">aes</span>(<span class="dt">x=</span>Growth, <span class="dt">y=</span>value, <span class="dt">col=</span>Growth))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>NearestNeighbor)<span class="op">+</span><span class="kw">geom_boxplot</span>()<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Interacting Fraction&quot;</span>)<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Distance in microns&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;Interacting fraction, knn3, dist=15&quot;</span>)<span class="op">+</span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">position=</span><span class="kw">position_jitterdodge</span>(),<span class="dt">alpha=</span><span class="fl">0.3</span>)<span class="op">+</span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(ColSizeb, <span class="st">&quot;black&quot;</span>))</span>
<span id="cb92-16"><a href="spatial-statistics.html#cb92-16"></a>p<span class="op">+</span><span class="kw">geom_text</span>(<span class="dt">data=</span>ann_text, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">2</span>, <span class="dt">y=</span><span class="fl">0.75</span>, <span class="dt">label=</span>Glabel))</span></code></pre></div>
<div class="figure"><span id="fig:if-growth"></span>
<img src="RatDCIS-bookdown_files/figure-html/if-growth-1.png" alt="interacting fraction" width="672" />
<p class="caption">
Figure 5.2: interacting fraction
</p>
</div>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="spatial-statistics.html#cb93-1"></a></span>
<span id="cb93-2"><a href="spatial-statistics.html#cb93-2"></a>DT<span class="op">::</span><span class="kw">datatable</span>(IFmelt[IFmelt<span class="op">$</span>Reference<span class="op">==</span><span class="st">&quot;CD8&quot;</span> <span class="op">&amp;</span><span class="st"> </span>IFmelt<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span> <span class="op">&amp;</span><span class="st"> </span>IFmelt<span class="op">$</span>Dist<span class="op">==</span><span class="dv">15</span> , <span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span><span class="op">:</span><span class="dv">9</span>, <span class="dv">12</span>)], <span class="dt">rownames=</span>F, <span class="dt">class=</span><span class="st">&#39;cell-border stripe&#39;</span>,</span>
<span id="cb93-3"><a href="spatial-statistics.html#cb93-3"></a>          <span class="dt">extensions=</span><span class="st">&quot;Buttons&quot;</span>, <span class="dt">options=</span><span class="kw">list</span>(<span class="dt">dom=</span><span class="st">&quot;Bfrtip&quot;</span>, <span class="dt">buttons=</span><span class="kw">c</span>(<span class="st">&#39;csv&#39;</span>, <span class="st">&#39;excel&#39;</span>), <span class="dt">scrollX=</span>T))</span></code></pre></div>
<div class="figure"><span id="fig:if-growth"></span>
<div id="htmlwidget-326d3b0d3b26e868ecee" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-326d3b0d3b26e868ecee">{"x":{"filter":"none","extensions":["Buttons"],"data":[["knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15","knn3-15"],["CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","EpCAM: SMA","SMA","Unclass","CD8","EpCAM","SMA","Unclass","CD8","EpCAM","SMA","Unclass"],["CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8"],[0.205382630863877,0.223655487199841,0.0803883554429298,0.590501778435892,0.301082327079549,0.0784257397299627,0.316862970410801,0.237575409365125,0.476874461361678,0.37144498707268,0.281622167443794,0.294437349648065,0.256377891954501,0.578673042083692,0.145020937899082,0.35915415397041,0.480854656925731,0.320716619552847,0.111274275854473,0.300866566451499,0.440887788487046,0.173843841188434,0.142629763904855,0.127910403772473,0.221338048924256,0.203949307397583,0.575891541408783,0.45446507515473,0.43176872689031,0.0816202095465047,0.311947954600122,0.472341092036002,0.287748857451319,0.169500822819528,0.411958310477235,0.0142622051563357,0.157981349424026,0.579813494240263,0.692943711696291,0.208010474138151,0,1.01888503410718e-05,0.577473470780924,0.895123167921705,0.4326199016557,0.0146566263629237,0.00798156638240255,0.276599282609212,0.789417223829957,0.0386687955293883,0.0222283205268935,0.05326314739048,0.428649835345774,0.26605627662072,0.232350672435188,0.125129959419123,0.344769762216185,0.443371231176845,0.511887072808321,0.434249628528975,0.0115156017830609,0.00185735512630015,0.540118870728083,0.107865168539326,0.83623595505618,0.0230337078651685,0.000280898876404494,0.389606741573034,0.467845923586783,0.12793375108962,0.484983799608559,0.260538477985559,0.505367119118383,0.254006189294359,0.0380039015023848,0.248899510780198,0.543044193195862,0.420674551029347,0.393517301795883,0.118615856329391,0.123959702146299,0.495575996495839,0.121695533272562,0.5,0.192798541476755,0.168185961713765,0.479945305378304,0.106456692913386,0.222677165354331,0.0332283464566929,0.461574803149606,0.650236220472441,0.134485349361382,0.129977460555973,0.36839469070874,0.300525920360631,0.0286054827175209,0.602502979737783,0.0643623361144219,0.187723480333731,0.49284862932062,0.221662992388004,0.157896926084605,0.881910070296577,0.353618689756576,0.275036758699559,0.448047704623428,0.301829766378043,0.654297812895621,0.241148993757367,0.12934910725979,0.363513336534684,0.242000603456946,0.300162358654578,0.492047299530166,0.380652020862369,0.449265895911806,0.284293873877797,0.0509409450819018,0.309818778259197,0.0600419488050397,0.295986253689915,0.235493677578535,0.61149050535313,0.282504295721902,0.375712334368665,0.0907524861013233,0.386196156221996,0.552449560201498,0.324635283501278,0.666416002406377,0.000300797112347721,0.00293277184539028,0.485185742216875,0.389057290087905,0.627556135891995,0.078800102595192,0.0414694429547415,0.213374682304661,0.384651849690959,0.28264080077306,0.0808521888161613,0.244872098747425,0.590296643389793,0.346467844051983,0.437104298567144,0.000958013995334888,0.0452765744751749,0.685688103965345,0.321979330993851,0.197900904671453,0.17401242715946,0.24921927819452,0.521618750201217,0.42436282932417,0.286523959526537,0.0929863497518137,0.0477520045819015,0.238795819014891,0.723386802770689,0.437791145137117,0.0275246080933285,0.221877911451371,0.177995891349007,0.291075097009815,0.359233051814654,0.205569504679297,0.20391754340946,0.296210760413994,0.0879308870070995,0.200496108117355,0.316568300402019,0.217271959459459,0.290329391891892,0.122387035472973,0.238175675675676,0.571473817567568,0.267504488330341,0.685143626570916,0.218806104129264,0.0832585278276481,0.0356608478802993,0.476807980049875,0.716957605985037,0.127182044887781,0.367229442837198,0.176547634468961,0.118283748578666,0.334643119305669,0.32107028225168,0.390197493602782,0.247129453447936,0.582442096975264,0.19982284626993,0.337961750065496,0.280717841236573,0.650248886560126,0.529703235196541,0.116854485718261,0.451653984867456,0.106666238589056,0.494372060750906,0.0735101380001542,0.0027368745663403,0.140004625703492,0.253064528563719,0.482081474048295,0.193431475115827,0.521307940303606,0.294505412387642,0.411064068557437,0.109288920628443,0.622245460110182,0.0145633544174658,0.599144867442707,0.275662786463534,0.0305404484747395,0.212908038011112,0.079839780108771,0.525801426992262,0.144683951361672,0.671251633001708,0.265350216058688,0.383061827188721,0.196602203804262,0.0674351401987869,0.542485154488584,0.241199072750945,0.388782565748858,0.0728176318063958,0.384677120632177,0.306087171255711,0.552614212719422,0.0531232912872146,0.523379904594905,0.0517751758206535,0.295153460051016,0.225129597630215,0.18667544364903,0.499218300008228,0.190844510271812,0.0670603121045972,0.191733445803458,0.67874314635175,0.115563053563897,0.10970054829186,0.301384137470017,0.238645747316268,0.684243639652393,0.174590067240769,0.345674300254453,0.65089058524173,0.00089058524173028,0.00356234096692112,0.387150127226463,0.105135015493581,0.618636564851704,0.366976538291279,0.267374944665781,0.27468062476846,0.234742288985289,0.469735536992555,0.28898528902114],["Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating",null,null,null,null,null,"Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted",null,null,null,null,null,"Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted",null,null,null,null,null,"Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted"],["PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","Vehicle","Vehicle","Vehicle","Vehicle","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY"],["knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3","knn3"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th>Grid<\/th>\n      <th>NearestNeighbor<\/th>\n      <th>Reference<\/th>\n      <th>value<\/th>\n      <th>SpatialManual<\/th>\n      <th>Treatment<\/th>\n      <th>knn<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["csv","excel"],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 5.2: interacting fraction
</p>
</div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="spatial-statistics.html#cb94-1"></a>pval2</span>
<span id="cb94-2"><a href="spatial-statistics.html#cb94-2"></a><span class="co">##         CD8       EpCAM  EpCAM: SMA         SMA     Unclass </span></span>
<span id="cb94-3"><a href="spatial-statistics.html#cb94-3"></a><span class="co">## 0.716774420 0.001914251 0.395488483 0.154356972 0.428393111</span></span></code></pre></div>
</div>
<div id="treatment" class="section level3">
<h3><span class="header-section-number">5.2.3</span> Treatment</h3>
<p>Similarly, compare the distances with treatment:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="spatial-statistics.html#cb95-1"></a><span class="co">#pdf(&quot;~/Desktop/4D-IF-summary-treatment.pdf&quot;, height=5, width=7)</span></span>
<span id="cb95-2"><a href="spatial-statistics.html#cb95-2"></a></span>
<span id="cb95-3"><a href="spatial-statistics.html#cb95-3"></a>ctypes=<span class="kw">unique</span>(IFmelt<span class="op">$</span>NearestNeighbor)</span>
<span id="cb95-4"><a href="spatial-statistics.html#cb95-4"></a>t2=IFmelt[<span class="kw">which</span>(IFmelt<span class="op">$</span>Reference<span class="op">==</span><span class="st">&quot;CD8&quot;</span> <span class="op">&amp;</span><span class="st"> </span>IFmelt<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span> <span class="op">&amp;</span><span class="st"> </span>IFmelt<span class="op">$</span>Dist<span class="op">==</span><span class="dv">15</span>) , ]</span>
<span id="cb95-5"><a href="spatial-statistics.html#cb95-5"></a>TreatV=<span class="kw">sort</span>(<span class="kw">unique</span>(IFmelt<span class="op">$</span>Treatment))</span>
<span id="cb95-6"><a href="spatial-statistics.html#cb95-6"></a></span>
<span id="cb95-7"><a href="spatial-statistics.html#cb95-7"></a>pval2=<span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">5</span>)</span>
<span id="cb95-8"><a href="spatial-statistics.html#cb95-8"></a><span class="kw">colnames</span>(pval2)=ctypes</span>
<span id="cb95-9"><a href="spatial-statistics.html#cb95-9"></a><span class="kw">rownames</span>(pval2)=TreatV[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb95-10"><a href="spatial-statistics.html#cb95-10"></a></span>
<span id="cb95-11"><a href="spatial-statistics.html#cb95-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){</span>
<span id="cb95-12"><a href="spatial-statistics.html#cb95-12"></a>pval2[i, ]=<span class="kw">sapply</span>(ctypes, <span class="cf">function</span>(x) <span class="kw">wilcox.test</span>(t2<span class="op">$</span>value[t2<span class="op">$</span>NearestNeighbor<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>t2<span class="op">$</span>Treatment<span class="op">==</span>TreatV[i]], t2<span class="op">$</span>value[t2<span class="op">$</span>NearestNeighbor<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>t2<span class="op">$</span>Treatment<span class="op">==</span><span class="st">&quot;Vehicle&quot;</span>])<span class="op">$</span>p.value)</span>
<span id="cb95-13"><a href="spatial-statistics.html#cb95-13"></a>}</span>
<span id="cb95-14"><a href="spatial-statistics.html#cb95-14"></a></span>
<span id="cb95-15"><a href="spatial-statistics.html#cb95-15"></a>pmelt=<span class="kw">melt</span>(pval2)</span>
<span id="cb95-16"><a href="spatial-statistics.html#cb95-16"></a><span class="kw">colnames</span>(pmelt)=<span class="kw">c</span>(<span class="st">&quot;Treatment&quot;</span>, <span class="st">&quot;NearestNeighbor&quot;</span>, <span class="st">&quot;label&quot;</span>)</span>
<span id="cb95-17"><a href="spatial-statistics.html#cb95-17"></a>pmelt<span class="op">$</span>label=<span class="kw">round</span>(pmelt<span class="op">$</span>label, <span class="dv">2</span>)</span>
<span id="cb95-18"><a href="spatial-statistics.html#cb95-18"></a>pmelt<span class="op">$</span>value=<span class="fl">0.8</span></span>
<span id="cb95-19"><a href="spatial-statistics.html#cb95-19"></a></span>
<span id="cb95-20"><a href="spatial-statistics.html#cb95-20"></a>p&lt;-<span class="kw">ggplot</span>(IFmelt[IFmelt<span class="op">$</span>Reference<span class="op">==</span><span class="st">&quot;CD8&quot;</span> <span class="op">&amp;</span><span class="st"> </span>IFmelt<span class="op">$</span>knn<span class="op">==</span><span class="st">&quot;knn3&quot;</span> <span class="op">&amp;</span><span class="st"> </span>IFmelt<span class="op">$</span>Dist<span class="op">==</span><span class="dv">15</span> , ], <span class="kw">aes</span>(<span class="dt">x=</span>Treatment, <span class="dt">y=</span>value, <span class="dt">col=</span>Treatment))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>NearestNeighbor)<span class="op">+</span><span class="kw">geom_boxplot</span>()<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Interacting Fraction&quot;</span>)<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Distance in microns&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;Interacting fraction, knn3, dist=15&quot;</span>)<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">position=</span><span class="kw">position_jitterdodge</span>(),<span class="dt">alpha=</span><span class="fl">0.3</span>)<span class="op">+</span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(ColMerge[,<span class="dv">1</span>]))</span>
<span id="cb95-21"><a href="spatial-statistics.html#cb95-21"></a>p<span class="op">+</span><span class="kw">geom_text</span>(<span class="dt">data=</span>pmelt, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>Treatment, <span class="dt">y=</span><span class="fl">0.75</span>, <span class="dt">label=</span>label, <span class="dt">col=</span>Treatment))</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="spatial-statistics.html#cb96-1"></a></span>
<span id="cb96-2"><a href="spatial-statistics.html#cb96-2"></a>fit1=<span class="kw">aov</span>(value<span class="op">~</span>Treatment, <span class="dt">data=</span>IFmelt[IFmelt<span class="op">$</span>NearestNeighbor<span class="op">==</span><span class="st">&quot;EpCAM&quot;</span> <span class="op">&amp;</span><span class="st"> </span>IFmelt<span class="op">$</span>Reference<span class="op">==</span><span class="st">&quot;CD8&quot;</span>, ])</span>
<span id="cb96-3"><a href="spatial-statistics.html#cb96-3"></a>fit2=<span class="kw">aov</span>(value<span class="op">~</span>Treatment, <span class="dt">data=</span>IFmelt[IFmelt<span class="op">$</span>NearestNeighbor<span class="op">==</span><span class="st">&quot;SMA&quot;</span><span class="op">&amp;</span><span class="st"> </span>IFmelt<span class="op">$</span>Reference<span class="op">==</span><span class="st">&quot;CD8&quot;</span>, ])</span>
<span id="cb96-4"><a href="spatial-statistics.html#cb96-4"></a>fit3=<span class="kw">aov</span>(value<span class="op">~</span>Treatment, <span class="dt">data=</span>IFmelt[IFmelt<span class="op">$</span>NearestNeighbor<span class="op">==</span><span class="st">&quot;EpCAM: SMA&quot;</span><span class="op">&amp;</span><span class="st"> </span>IFmelt<span class="op">$</span>Reference<span class="op">==</span><span class="st">&quot;CD8&quot;</span>, ])</span>
<span id="cb96-5"><a href="spatial-statistics.html#cb96-5"></a>fit4=<span class="kw">aov</span>(value<span class="op">~</span>Treatment, <span class="dt">data=</span>IFmelt[IFmelt<span class="op">$</span>NearestNeighbor<span class="op">==</span><span class="st">&quot;Unclass&quot;</span><span class="op">&amp;</span><span class="st"> </span>IFmelt<span class="op">$</span>Reference<span class="op">==</span><span class="st">&quot;CD8&quot;</span>, ])</span></code></pre></div>
<p>There appears to be a difference in CD8-unclass interactions in LY treated samples (LY, PDL1+LY), but not in the other cases</p>
</div>
</div>
<div id="m-h-distances" class="section level2">
<h2><span class="header-section-number">5.3</span> M-H distances</h2>
<p>The M-H distance (or Morisita Horn index) can be considered as a correlation coefficient in spatial distribution between cell type A and cell type B. To calculate this metric, the whole slide image is divided into grids of size 50 to 500um. Within each grid, the total number of cells A and B are determined.</p>
<p>The M-H index is thus determined as:</p>
<p><span class="math display">\[ \frac{2\sum_{i=1}^n a_ib_i}{(D_a+D_b)AB} \]</span>
where <span class="math inline">\(a_i\)</span> and <span class="math inline">\(b_i\)</span> are the number of cells in grid <span class="math inline">\(i\)</span>, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> the total number of cells, and <span class="math inline">\(D_x\)</span> is the Simpson’s index.</p>
<div id="comparison-to-manual-scoring" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Comparison to Manual Scoring</h3>
<p>Similar to the interacting fraction, we plot the MH index for increasing values of gridsize to determine an optimal metric to compare spatial patterns. Ideally, we would pick a metric has the following properties:</p>
<ul>
<li>good separation of the different values</li>
<li>a reasonable number of cells within each grid (avoid too small grids which give counts of 0)</li>
<li>avoid plateauing of MH values because the grid size is too large</li>
</ul>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="spatial-statistics.html#cb97-1"></a>MHgridsize=<span class="dv">150</span></span>
<span id="cb97-2"><a href="spatial-statistics.html#cb97-2"></a></span>
<span id="cb97-3"><a href="spatial-statistics.html#cb97-3"></a>MHmeltsumm=<span class="kw">melt</span>(WSIMHsetup, <span class="dt">id.vars=</span><span class="kw">c</span>(<span class="st">&quot;gridsize&quot;</span>, <span class="st">&quot;Ntiles&quot;</span>))</span>
<span id="cb97-4"><a href="spatial-statistics.html#cb97-4"></a></span>
<span id="cb97-5"><a href="spatial-statistics.html#cb97-5"></a>MHmelt=<span class="kw">melt</span>(WSIMH, <span class="dt">measure.vars=</span><span class="st">&quot;MH.mean&quot;</span>)</span>
<span id="cb97-6"><a href="spatial-statistics.html#cb97-6"></a>MHmelt<span class="op">$</span>SpatialManual=Cdata<span class="op">$</span>Pathologist.CD8.Spatial[<span class="kw">match</span>(MHmelt<span class="op">$</span>L1, <span class="kw">gsub</span>(<span class="st">&quot;_&quot;</span>, <span class="st">&quot;&quot;</span>, Cdata<span class="op">$</span>TumorID))]</span>
<span id="cb97-7"><a href="spatial-statistics.html#cb97-7"></a>MHmeltsumm<span class="op">$</span>SpatialManual=Cdata<span class="op">$</span>Pathologist.CD8.Spatial[<span class="kw">match</span>(MHmeltsumm<span class="op">$</span>L1, <span class="kw">gsub</span>(<span class="st">&quot;_&quot;</span>, <span class="st">&quot;&quot;</span>, Cdata<span class="op">$</span>TumorID))]</span>
<span id="cb97-8"><a href="spatial-statistics.html#cb97-8"></a>MHmelt<span class="op">$</span>Treatment=<span class="kw">factor</span>(Cdata<span class="op">$</span>Treatment[<span class="kw">match</span>(MHmelt<span class="op">$</span>L1, <span class="kw">gsub</span>(<span class="st">&quot;_&quot;</span>, <span class="st">&quot;&quot;</span>, Cdata<span class="op">$</span>TumorID))])</span>
<span id="cb97-9"><a href="spatial-statistics.html#cb97-9"></a>MHmelt<span class="op">$</span>Growth=<span class="kw">factor</span>(Cdata<span class="op">$</span>Tumor.Growth[<span class="kw">match</span>(MHmelt<span class="op">$</span>L1, <span class="kw">gsub</span>(<span class="st">&quot;_&quot;</span>, <span class="st">&quot;&quot;</span>, Cdata<span class="op">$</span>TumorID))])</span>
<span id="cb97-10"><a href="spatial-statistics.html#cb97-10"></a>MHmelt<span class="op">$</span>Growth=MHmelt<span class="op">$</span>Growth</span>
<span id="cb97-11"><a href="spatial-statistics.html#cb97-11"></a><span class="co">#MHmelt$Growth[grep(&quot;no data&quot;, MHmelt$Growth)]=&quot;no data&quot;</span></span>
<span id="cb97-12"><a href="spatial-statistics.html#cb97-12"></a></span>
<span id="cb97-13"><a href="spatial-statistics.html#cb97-13"></a>A1=MHmelt[MHmelt<span class="op">$</span>Var2<span class="op">==</span><span class="st">&quot;CD8&quot;</span>, ]</span>
<span id="cb97-14"><a href="spatial-statistics.html#cb97-14"></a>A1<span class="op">$</span>label=A1<span class="op">$</span>L1</span>
<span id="cb97-15"><a href="spatial-statistics.html#cb97-15"></a>A1<span class="op">$</span>label[<span class="kw">which</span>(A1<span class="op">$</span>gridsize<span class="op">!=</span><span class="dv">500</span>)]=<span class="ot">NA</span></span>
<span id="cb97-16"><a href="spatial-statistics.html#cb97-16"></a></span>
<span id="cb97-17"><a href="spatial-statistics.html#cb97-17"></a>A2=MHmelt[MHmelt<span class="op">$</span>Var2<span class="op">==</span><span class="st">&quot;CD8&quot;</span> <span class="op">&amp;</span><span class="st"> </span>MHmelt<span class="op">$</span>gridsize<span class="op">==</span>MHgridsize <span class="op">&amp;</span><span class="st"> </span>MHmelt<span class="op">$</span>Var1<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;EpCAM&quot;</span>, <span class="st">&quot;SMA&quot;</span>), ]</span>
<span id="cb97-18"><a href="spatial-statistics.html#cb97-18"></a>A3=MHmelt[MHmelt<span class="op">$</span>Var2<span class="op">==</span><span class="st">&quot;CD8&quot;</span> <span class="op">&amp;</span><span class="st"> </span>MHmelt<span class="op">$</span>gridsize<span class="op">==</span>MHgridsize, ]</span>
<span id="cb97-19"><a href="spatial-statistics.html#cb97-19"></a>A3<span class="op">$</span>CD8frac=WSIvalFracs[ <span class="dv">1</span>, <span class="kw">match</span>(A3<span class="op">$</span>L1, <span class="kw">colnames</span>(WSIvals))]</span>
<span id="cb97-20"><a href="spatial-statistics.html#cb97-20"></a></span>
<span id="cb97-21"><a href="spatial-statistics.html#cb97-21"></a>MHTempSumm=A3 <span class="co">#MHmelt[which(MHmelt$gridsize==300 &amp; MHmelt$Var2==&quot;CD8&quot;), ]</span></span>
<span id="cb97-22"><a href="spatial-statistics.html#cb97-22"></a>MHreshape=<span class="kw">acast</span>(A3[ ,<span class="kw">c</span>(<span class="st">&quot;Var1&quot;</span>, <span class="st">&quot;value&quot;</span>, <span class="st">&quot;L1&quot;</span>)], L1<span class="op">~</span>Var1, <span class="dt">value.var=</span><span class="st">&quot;value&quot;</span> )</span>
<span id="cb97-23"><a href="spatial-statistics.html#cb97-23"></a>MHreshape=<span class="kw">data.frame</span>(MHreshape)</span>
<span id="cb97-24"><a href="spatial-statistics.html#cb97-24"></a>MHreshape<span class="op">$</span>EpMIN=<span class="kw">ifelse</span>(MHreshape<span class="op">$</span>EpCAM..SMA<span class="op">&lt;</span>MHreshape<span class="op">$</span>EpCAM, MHreshape<span class="op">$</span>EpCAM..SMA, MHreshape<span class="op">$</span>EpCAM)</span>
<span id="cb97-25"><a href="spatial-statistics.html#cb97-25"></a>MHreshape<span class="op">$</span>EpMIN[<span class="kw">which</span>(<span class="kw">is.na</span>(MHreshape<span class="op">$</span>EpMIN))]=MHreshape<span class="op">$</span>EpCAM[<span class="kw">which</span>(<span class="kw">is.na</span>(MHreshape<span class="op">$</span>EpMIN))]</span>
<span id="cb97-26"><a href="spatial-statistics.html#cb97-26"></a>MHreshape<span class="op">$</span>EpStrRatio1=MHreshape<span class="op">$</span>EpCAM<span class="op">/</span><span class="kw">rowSums</span>(MHreshape[ ,<span class="kw">c</span>(<span class="st">&quot;EpCAM..SMA&quot;</span>, <span class="st">&quot;SMA&quot;</span>)], <span class="dt">na.rm=</span>T)</span>
<span id="cb97-27"><a href="spatial-statistics.html#cb97-27"></a></span>
<span id="cb97-28"><a href="spatial-statistics.html#cb97-28"></a>MHreshape<span class="op">$</span>EpStrRatio2=MHreshape<span class="op">$</span>EpCAM<span class="op">/</span>(MHreshape<span class="op">$</span>SMA)</span>
<span id="cb97-29"><a href="spatial-statistics.html#cb97-29"></a>MHreshape<span class="op">$</span>EpStrRatio3=<span class="kw">rowSums</span>(MHreshape[ ,<span class="kw">c</span>(<span class="st">&quot;EpCAM..SMA&quot;</span>, <span class="st">&quot;EpCAM&quot;</span>)], <span class="dt">na.rm=</span>T)<span class="op">/</span><span class="kw">rowSums</span>(MHreshape[ ,<span class="kw">c</span>(<span class="st">&quot;EpCAM..SMA&quot;</span>, <span class="st">&quot;SMA&quot;</span>)], <span class="dt">na.rm=</span>T)</span>
<span id="cb97-30"><a href="spatial-statistics.html#cb97-30"></a>MHreshape<span class="op">$</span>EpStrRatio4=<span class="kw">rowSums</span>(MHreshape[ ,<span class="kw">c</span>(<span class="st">&quot;EpCAM..SMA&quot;</span>, <span class="st">&quot;EpCAM&quot;</span>)], <span class="dt">na.rm=</span>T)<span class="op">/</span>(MHreshape<span class="op">$</span>SMA)</span>
<span id="cb97-31"><a href="spatial-statistics.html#cb97-31"></a>MHreshape<span class="op">$</span>Treatment=<span class="kw">factor</span>(A3<span class="op">$</span>Treatment[<span class="kw">match</span>(<span class="kw">rownames</span>(MHreshape), A3<span class="op">$</span>L1)])</span>
<span id="cb97-32"><a href="spatial-statistics.html#cb97-32"></a>MHreshape<span class="op">$</span>Growth=<span class="kw">factor</span>(A3<span class="op">$</span>Growth[<span class="kw">match</span>(<span class="kw">rownames</span>(MHreshape), A3<span class="op">$</span>L1)])</span>
<span id="cb97-33"><a href="spatial-statistics.html#cb97-33"></a>MHreshape<span class="op">$</span>Infil=<span class="kw">factor</span>(A3<span class="op">$</span>SpatialManual[<span class="kw">match</span>(<span class="kw">rownames</span>(MHreshape), A3<span class="op">$</span>L1)])</span>
<span id="cb97-34"><a href="spatial-statistics.html#cb97-34"></a></span>
<span id="cb97-35"><a href="spatial-statistics.html#cb97-35"></a><span class="co">#pdf(sprintf(&quot;rslt/WSI-analysis/MHplots_compare_spatial_manual_%s.pdf&quot;, Sys.Date()), height=7, width=12)</span></span>
<span id="cb97-36"><a href="spatial-statistics.html#cb97-36"></a></span>
<span id="cb97-37"><a href="spatial-statistics.html#cb97-37"></a>p&lt;-<span class="kw">ggplot</span>(A1, <span class="kw">aes</span>(<span class="dt">x=</span>gridsize, <span class="dt">y=</span>value, <span class="dt">col=</span>SpatialManual, <span class="dt">label=</span>label))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>Var1)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span>L1))<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;grid size&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Morisita Horn index&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;MH index with CD8: spatial manual&quot;</span>)<span class="op">+</span><span class="kw">geom_label</span>()</span>
<span id="cb97-38"><a href="spatial-statistics.html#cb97-38"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="spatial-statistics.html#cb98-1"></a></span>
<span id="cb98-2"><a href="spatial-statistics.html#cb98-2"></a><span class="kw">ggplot</span>(A1, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">factor</span>(gridsize), <span class="dt">y=</span>value, <span class="dt">col=</span>SpatialManual, <span class="dt">label=</span>label))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>Var1)<span class="op">+</span><span class="kw">geom_boxplot</span>()<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;grid size&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Morisita Horn index&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;MH index with CD8: spatial manual&quot;</span>)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-42-2.png" width="672" /></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="spatial-statistics.html#cb99-1"></a></span>
<span id="cb99-2"><a href="spatial-statistics.html#cb99-2"></a><span class="kw">ggplot</span>(MHmeltsumm, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">factor</span>(gridsize), <span class="dt">y=</span>value, <span class="dt">col=</span>SpatialManual))<span class="op">+</span><span class="kw">facet_wrap</span>(<span class="op">~</span>variable, <span class="dt">scale=</span><span class="st">&quot;free_y&quot;</span>)<span class="op">+</span><span class="kw">geom_boxplot</span>()<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;grid size&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Morisita Horn index&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;expected number of cells in each grid size&quot;</span>)<span class="op">+</span><span class="kw">scale_y_log10</span>()</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-42-3.png" width="672" /></p>
<p>With increasing grid size, optimal differences between infiltrating and restricted appear at the following sizes:</p>
<ul>
<li>epCAML 100um+</li>
<li>epcam:SMA most significant at 350+</li>
<li>SMA: 150+</li>
<li>Unclass:200+</li>
</ul>
<p>We probably want to use a metric/gridsize of 250 um as the expected/mean number of cells in each grid is 10 here.
Other notes:</p>
<ul>
<li>double positive cells (EpCAM+SMA+) appear in predominantly the restricted cases?</li>
<li>higher SMA- stromal cells in restricted</li>
</ul>
</div>
<div id="growth-2" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Growth</h3>
<p>Below are the MH indices with increasing grid-size for individual samples. In general, there is a subset of stable samples which have very high intermixing</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="spatial-statistics.html#cb100-1"></a></span>
<span id="cb100-2"><a href="spatial-statistics.html#cb100-2"></a>p&lt;-<span class="kw">ggplot</span>(A1, <span class="kw">aes</span>(<span class="dt">x=</span>gridsize, <span class="dt">y=</span>value, <span class="dt">col=</span>Growth))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>Var1)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span>L1))<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;grid size&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Morisita Horn index&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;MH index with CD8: growth&quot;</span>)<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">position=</span><span class="kw">position_jitterdodge</span>(),<span class="dt">alpha=</span><span class="fl">0.3</span>)</span>
<span id="cb100-3"><a href="spatial-statistics.html#cb100-3"></a><span class="kw">print</span>(p)</span></code></pre></div>
<div class="figure"><span id="fig:4e"></span>
<img src="RatDCIS-bookdown_files/figure-html/4e-1.png" alt="Fig4e MH index with CD8 growth" width="672" />
<p class="caption">
Figure 5.3: Fig4e MH index with CD8 growth
</p>
</div>
<p>We can condense these values based on growing vs stable cases:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="spatial-statistics.html#cb101-1"></a><span class="co">#pdf(&quot;figure-outputs/4E-MH-summary-growth.pdf&quot;, height=5, width=7)</span></span>
<span id="cb101-2"><a href="spatial-statistics.html#cb101-2"></a></span>
<span id="cb101-3"><a href="spatial-statistics.html#cb101-3"></a>pvals=<span class="kw">sapply</span>(<span class="kw">unique</span>(A3<span class="op">$</span>Var1), <span class="cf">function</span>(x) <span class="kw">wilcox.test</span>(A3<span class="op">$</span>value[A3<span class="op">$</span>Var1<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>A3<span class="op">$</span>Growth<span class="op">==</span><span class="st">&quot;growing&quot;</span>], </span>
<span id="cb101-4"><a href="spatial-statistics.html#cb101-4"></a>                                                      A3<span class="op">$</span>value[A3<span class="op">$</span>Var1<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>A3<span class="op">$</span>Growth<span class="op">==</span><span class="st">&quot;stable&quot;</span>])<span class="op">$</span>p.value)</span>
<span id="cb101-5"><a href="spatial-statistics.html#cb101-5"></a></span>
<span id="cb101-6"><a href="spatial-statistics.html#cb101-6"></a>ann_text=<span class="kw">data.frame</span>(<span class="dt">label=</span><span class="kw">round</span>(pvals,<span class="dv">2</span>), <span class="dt">Var1=</span><span class="kw">unique</span>(A3<span class="op">$</span>Var1), <span class="dt">Growth=</span><span class="st">&quot;growing&quot;</span>)</span>
<span id="cb101-7"><a href="spatial-statistics.html#cb101-7"></a></span>
<span id="cb101-8"><a href="spatial-statistics.html#cb101-8"></a><span class="kw">ggplot</span>(A3, <span class="kw">aes</span>(<span class="dt">x=</span>Growth, <span class="dt">y=</span>value, <span class="dt">col=</span>Growth))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>Var1)<span class="op">+</span><span class="kw">geom_boxplot</span>()<span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;grid size&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Morisita Horn index&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;MH index with CD8: growth&quot;</span>)<span class="op">+</span><span class="kw">geom_text</span>(<span class="dt">data=</span>ann_text, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">2</span>, <span class="dt">y=</span><span class="fl">0.75</span>, <span class="dt">label=</span>label))<span class="op">+</span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(ColSizeb, <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/4E-MH-summary-1.png" width="672" /></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="spatial-statistics.html#cb102-1"></a><span class="co">#dev.off()</span></span>
<span id="cb102-2"><a href="spatial-statistics.html#cb102-2"></a></span>
<span id="cb102-3"><a href="spatial-statistics.html#cb102-3"></a>DT<span class="op">::</span><span class="kw">datatable</span>(A3, <span class="dt">rownames=</span>F, <span class="dt">class=</span><span class="st">&#39;cell-border stripe&#39;</span>,</span>
<span id="cb102-4"><a href="spatial-statistics.html#cb102-4"></a>          <span class="dt">extensions=</span><span class="st">&quot;Buttons&quot;</span>, <span class="dt">options=</span><span class="kw">list</span>(<span class="dt">dom=</span><span class="st">&quot;Bfrtip&quot;</span>, <span class="dt">buttons=</span><span class="kw">c</span>(<span class="st">&#39;csv&#39;</span>, <span class="st">&#39;excel&#39;</span>), <span class="dt">scrollX=</span>T))</span></code></pre></div>
<div id="htmlwidget-08ecba8e7084a1f6cda5" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-08ecba8e7084a1f6cda5">{"x":{"filter":"none","extensions":["Buttons"],"data":[["EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","Unclass","EpCAM","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","EpCAM: SMA","SMA","Unclass","EpCAM","SMA","Unclass","EpCAM","SMA","Unclass"],["CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8","CD8"],[0.353884650341547,0.34663738490322,0.493034289231373,0.441684243290937,0.307629231147099,0.34150638819711,0.36402520705218,0.410996883820861,0.615792696990425,0.554818709587738,0.647760692410721,0.53357667524057,0.378983000487372,0.420916996419042,0.338575224381835,0.299622429677754,0.245378106554285,0.228472079207891,0.409270651229662,0.396758883828673,0.539116648721967,0.503781841996888,0.301719353193712,0.362162337620265,0.524623438286274,0.501106256985053,0.525313583958451,0.338934749125873,0.521968574180238,0.581031058746882,0.237005485985485,0.000276652727184301,0.000223149133229001,0.563442828024218,0.674461785176736,0.382675232654497,0.414576142675932,0.675280148116157,0.0257534740058103,0.0263603857586442,0.0414539475739311,0.191653378682924,0.256283387627802,0.245351401831093,0.295484976324146,0.395564628074784,0.434538449645467,0.295722156280626,0.207754493784704,0.624512924355908,0.66045531601504,0.155799106697477,0.0838041493337647,0.630436608016474,0.215466564883092,0.325964226695729,0.241258624381745,0.366259091599116,0.257430392732439,0.439661126651529,0.616210871151383,0.246587789603683,0.203770824066125,0.31405077065299,0.545278418318029,0.428746286761019,0.41014374001276,0.437192081087737,0.448707009512455,0.274117696818625,0.243072708016352,0.324145771596176,0.323086341841021,0.306002670083718,0.39251541989828,0.289609037611647,0.454162167539208,0.553059954367149,0.51844833175744,0.400732613055791,0.300473036778566,0.427934041244568,0.185852226132932,0.206614605175732,0.330980671029904,0.0572225579483615,0.0528332488117906,0.156740565891968,0.450995894850226,0.477360142270381,0.601000264966332,0.42585890209447,0.4155987383582,0.485176036557421,0.378905567831684,0.29210322882718,0.392799064642716,0.378143855914037,0.254700777648506,0.282072137802795,0.571834364007765,0.763222895737117,0.169598942881833,0.422894038727531,0.737999597138263,0.382263826998058,0.272462361017799,0.235338856284132,0.454363223016298,0.345199993166775,0.235258029226626,0.310421220436134,0.450744003924312,0.560321043431854,0.0297844907185343,0.266587416397817,0.729722526209829,0.567595758742378,0.459276023974776,0.542872228855248,0.578409622614193,0.33097649549032,0.301473455517007,0.295309671569899,0.314615459833051,0.641316182166096,0.488026293939258,0.614527640316804,0.34952463611751,0.406912065104477,0.400070503114185,0.371857221801662,0.370545386987479,0.428093203691975,0.372023741742777,0.419542194497935,0.395982557358963,0.495037150228629,0.522034701122698,0.0795505717045109,0.0772216788347014,0.0551858162902068,0.393453429219114,0.423445303270338,0.341954676321557,0.246691535866313,0.223367985362879,0.365416593182621,0.345454549346422,0.289491214612367,0.407825975506047,0.458438097357901,0.328174163005568,0.439706601028961,0.142276413908655,0.291369030714071,0.17835764592352,0.130246374513735,0.179551634592688,0.375955242956353,0.175913823517305,0.358963370745546,0.460661806607505,0.60311061800419,0.202560042186425,0.436479249707233,0.122003809593294,0.324374989958308,0.322197338662236,0.367556132300087,0.292837368355789,0.498474222178074,0.710925777804827,0.553252140971699,0.469838207647944,0.482375299802947,0.639715186434808,0.528998842824857,0.117160165863974,0.235026822660469,0.212020865402713,0.150818366044381,0.242955938901937,0.234794178029312,0.332755954057456,0.34518331047095,0.388390563121017,0.359174345270198,0.53510229011586,0.568901855013476,0.553857506118659,0.514729437264179,0.313515517442517,0.418969234841685,0.379085261429842,0.635027546749694,0.173614898214924,0.166834379056172,0.580193008824621,0.557897772067752,0.530965697438847,0.405283359995888,0.362557413666211,0.361869613134015,0.45308008314241],[0.362284333278439,0.357778443817487,0.503120388518214,0.455855106363291,0.35332853580495,0.396537548582381,0.418301020415312,0.464866174033672,0.624680359361646,0.564541035355473,0.658241272306555,0.542670444366518,0.391519307643465,0.429195798441409,0.343156812460041,0.321806572477192,0.259294713997694,0.243352429769532,0.45593903764939,0.446270037979947,0.587180105077212,0.529859008673864,0.304297696990359,0.367927779805056,0.530220509912207,0.509663313080613,0.585187831838748,0.392255529113456,0.558226864218085,0.636247467482766,0.236384830489421,0.000144589033824337,0.00013572660398537,0.563572154510294,0.686311356014196,0.398870799988446,0.476638080377151,0.684074370247521,0.026173004367829,0.0271739099928953,0.0423377787513908,0.198310347573126,0.273129490742867,0.259949869480245,0.313286833731104,0.426960679407641,0.474560649151226,0.362084414140497,0.263405464955564,0.66910379145311,0.698624913790479,0.16659822240353,0.104050043607495,0.642945718344992,0.220498607999355,0.333203777143876,0.248224427485025,0.368966986520394,0.259617583259478,0.446702303899339,0.621975826164953,0.275136535807486,0.227484404634745,0.331473489478765,0.576023479959611,0.485949764278485,0.438871832732918,0.494935421691417,0.47364382193959,0.336718932439351,0.280027508724963,0.391084867819246,0.382860134920348,0.338423317100112,0.417308735483223,0.321685322319021,0.47232586903986,0.569357091346878,0.569664539575458,0.421328090940003,0.317830045902935,0.446974539674958,0.204608498655076,0.226842051077008,0.35959585642821,0.0570946855275797,0.0513973838012718,0.159863414393057,0.463667297105752,0.487710439953835,0.611965172926771,0.429142839452293,0.421141051453749,0.485616671980466,0.380835690072748,0.306320659938951,0.414840277818859,0.398167842811154,0.256664405859488,0.286645460488663,0.581996353657838,0.769646106354625,0.214773733388169,0.484888158191354,0.747520770651834,0.38913666824799,0.278053621205684,0.238826517933816,0.462187324946639,0.351815546752594,0.239945519307932,0.315720638270649,0.461087351559158,0.564144025746691,0.0257389611479216,0.286172935441682,0.742504741041974,0.573740640120345,0.463953691393195,0.558357270812967,0.588461205674279,0.336175629191922,0.3078032739969,0.302783437749814,0.320603715127728,0.638124252759998,0.503465510136443,0.611463146714405,0.357945461570337,0.419613068439856,0.412426954662641,0.397233760805266,0.392757542257918,0.443190220226788,0.388338795339992,0.436058380454833,0.414865515381541,0.514771456458001,0.540297432464425,0.0859395245074709,0.0813931323505601,0.0599220561352426,0.414024563349805,0.451228099804048,0.341446556681928,0.255099489218309,0.232176352540912,0.375325571307658,0.357711099135865,0.301561261046309,0.420346957446263,0.475890571340403,0.353741132667171,0.46551440293225,0.145536681409468,0.297403817917921,0.179312132813739,0.134906392007185,0.187019167420539,0.390216580093967,0.180917657814055,0.363266560915292,0.466552276178576,0.60920614965352,0.204396805938489,0.44774994954677,0.127121637618849,0.327776719108152,0.325760048272761,0.370022043921018,0.295396948690289,0.508244123454028,0.718112038032604,0.556067909365561,0.47375701748292,0.488373815696549,0.6433663093226,0.534721206416378,0.121721659348454,0.237824785877435,0.218133706948143,0.154926366199161,0.247129723415637,0.239364137855991,0.34286681280425,0.356472853039066,0.399148287293908,0.369012330572441,0.552372563514532,0.591869790715496,0.569099601615379,0.535359529930628,0.324395932969217,0.431189072388904,0.390594401656989,0.656101450608483,0.130070782853203,0.156291926877942,0.588657555289809,0.587679706783469,0.551831869798721,0.443612620982535,0.370688925847109,0.373340210210504,0.459388455736934],[150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150],["MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean","MH.mean"],[0.358014288482878,0.351080794577143,0.499020043159828,0.451370275251266,0.333823897052082,0.369071548469592,0.393756587710418,0.437058310444382,0.619188600369958,0.559622352044717,0.654266516700005,0.538381373918263,0.384919964275964,0.425420726212795,0.338213406453039,0.310797422717848,0.252828317891371,0.236752932077242,0.437652145932401,0.427840273019011,0.567694647606992,0.510137131654764,0.303427530168004,0.366120820732285,0.52823563536701,0.50517263214561,0.565387864632493,0.355684884722381,0.538584895238271,0.609673735494596,0.237714655738112,0.000262380251542153,0.000219777945644102,0.565557023359154,0.677785426855763,0.394741505650151,0.443402759838575,0.686870422182526,0.026178252509128,0.026940263222674,0.0417948352537976,0.195037078281943,0.264607307635754,0.251159804957626,0.303101474653713,0.411696139562672,0.467380163660663,0.306325112800207,0.212427662045823,0.669612903908439,0.677104279711371,0.157568016326313,0.0985770085283672,0.638515349593138,0.217104193359104,0.32901288067251,0.244983982677037,0.368825752742308,0.256736450415137,0.441218673931989,0.618619668895367,0.264129276925775,0.218493614977678,0.329381638606517,0.558607400767908,0.448890198770968,0.401473709667265,0.466155851702232,0.472897470552013,0.296396958640746,0.263081630453734,0.350786084163796,0.345665774800869,0.320959405321864,0.40065753270212,0.307483741482598,0.467314504722992,0.558774212716451,0.528740967614293,0.423376323664297,0.310208793115696,0.43795301041218,0.193175446473818,0.214961916163122,0.346084868388076,0.057419978255721,0.0523850926389769,0.159285716363626,0.454715384675172,0.482852009072183,0.609148133444901,0.424575802169838,0.417626417983179,0.483652428373888,0.380059387656567,0.300680166658347,0.404193721998255,0.387327580645247,0.254948603683486,0.284322422056222,0.577082082759762,0.767514188959579,0.18963387491119,0.452095314033393,0.737927907089964,0.386350754619949,0.275996731500252,0.235612444967049,0.457254357159434,0.349187824159711,0.23888532347833,0.31334516138104,0.456276588691298,0.564459690484411,0.0274857936603927,0.271376458338632,0.733109303650886,0.567820154176674,0.456548270211922,0.554482642034849,0.58772793476376,0.333298180342511,0.304198575851133,0.299738043540709,0.319235406698545,0.637179407827275,0.494725181394562,0.614226320325818,0.354301516222591,0.412003152012843,0.405748526368818,0.381122239757883,0.378841250925074,0.438596177497302,0.381420868875467,0.426523893586721,0.404055772908531,0.504962603101072,0.531253082479252,0.0848611813825092,0.0807650736485103,0.058658676682086,0.404177306719637,0.432995399062115,0.340934765788033,0.250945085905853,0.22724162731737,0.368673990042562,0.351142183240098,0.294621237187523,0.414413693027053,0.469926344422034,0.339955059885912,0.455173725831408,0.143009361277452,0.294789484462813,0.179894416093383,0.132994342704189,0.185091615171268,0.385080227926685,0.178093281797032,0.359910024367208,0.462025017278967,0.607995564653556,0.204715622351884,0.443197533656569,0.122373461987394,0.324732811191202,0.322213523348994,0.368160150815657,0.295198226908147,0.502964931439173,0.716263714118191,0.553908387016106,0.471374061149095,0.486245790712591,0.640198907107037,0.53277623222471,0.120655287137457,0.235023051718682,0.215877582180102,0.153459170307385,0.245553886649384,0.238833914174478,0.339562345836779,0.352985543106539,0.394913914468071,0.365475546581789,0.544620211581735,0.581695011997871,0.56140157310422,0.525003059771129,0.31925173007073,0.42403633156616,0.385193710269446,0.6488849150546,0.148878075217885,0.165716662997078,0.595021956870128,0.576517533901973,0.538200502470849,0.429569223281658,0.367612658782466,0.36792674343319,0.456406117711531],["10LB","10LB","10LB","10LB","10LC","10LC","10LC","10LC","10LD","10LD","10LD","10LD","10NA","10NA","10NA","10ND","10ND","10ND","10RBL","10RBL","10RBL","10RBL","10RBU","10RBU","10RBU","10RBU","10RC","10RC","10RC","10RC","11LB","11LB","11LB","11LB","11ND","11ND","11ND","11ND","11RC","11RC","11RC","11RC","11RD","11RD","11RD","11RD","12LC","12LC","12LC","12LC","12LD","12LD","12LD","12LD","13NA","13NA","13NA","14NB","14NB","14NB","14NB","14NC","14NC","14NC","14NC","14RD","14RD","14RD","14RD","15LB","15LB","15LB","15LB","15NC-D","15NC-D","15NC-D","15ND","15ND","15ND","15ND","15RD","15RD","16LA","16LA","16LA","16LC","16LC","16LC","16LD","16LD","16LD","16ND","16ND","16ND","16ND","16RD","16RD","16RD","17NA","17NA","17NA","17ND","17ND","17ND","17ND","17RB","17RB","17RB","17RB","2N","2N","2N","2N","2RA","2RA","2RA","2RA","2RD","2RD","2RD","2RD","3LA","3LA","3LA","3LA","3NB","3NB","3NB","3RB","3RB","3RB","3RC","3RC","3RC","3RC","4LB","4LB","4LB","4LB","4NC","4NC","4NC","4ND","4ND","4ND","4RB","4RB","4RB","4RB","5LA","5LA","5LA","5LB","5LB","5LC","5LC","5LC","5LD","5LD","5LD","5LD","5RB","5RB","5RB","6LDU","6LDU","6LDU","6ND","6ND","6ND","6ND","6RB","6RB","6RB","6RC","6RC","6RC","6RC","7NB","7NB","7NB","7NC","7NC","7NC","7RA","7RA","7RA","7RA","7RB","7RB","7RB","7RB","7RD","7RD","7RD","8LD","8LD","8LD","8LD","8RCL","8RCL","8RCL","8RCU","8RCU","8RCU"],["Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating",null,null,null,null,"Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted",null,null,null,null,"Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted","restricted",null,null,null,null,"Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","restricted","restricted"],["PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","Vehicle","Vehicle","Vehicle","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY"],["growing","growing","growing","growing","growing","growing","growing","growing","stable","stable","stable","stable",null,null,null,"stable","stable","stable","growing","growing","growing","growing",null,null,null,null,null,null,null,null,"growing","growing","growing","growing","stable","stable","stable","stable","growing","growing","growing","growing","growing","growing","growing","growing",null,null,null,null,"stable","stable","stable","stable","growing","growing","growing","growing","growing","growing","growing","stable","stable","stable","stable","stable","stable","stable","stable","growing","growing","growing","growing","growing","growing","growing","stable","stable","stable","stable","growing","growing",null,null,null,"stable","stable","stable","stable","stable","stable","stable","stable","stable","stable","stable","stable","stable","growing","growing","growing","stable","stable","stable","stable","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","stable","stable","stable","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","stable","stable","stable","growing","growing","growing","growing","growing","stable","stable","stable","stable","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","growing","stable","stable","stable","stable","growing","growing","growing","growing","stable","stable","stable","stable","stable","stable","stable","growing","growing","growing","growing","growing","growing"],[0.0476926119861338,0.0476926119861338,0.0476926119861338,0.0476926119861338,0.010787460286585,0.010787460286585,0.010787460286585,0.010787460286585,0.0479456512895615,0.0479456512895615,0.0479456512895615,0.0479456512895615,0.0319309795486363,0.0319309795486363,0.0319309795486363,0.0257829624400936,0.0257829624400936,0.0257829624400936,0.0104720537207619,0.0104720537207619,0.0104720537207619,0.0104720537207619,0.155480427254777,0.155480427254777,0.155480427254777,0.155480427254777,0.00813878305467377,0.00813878305467377,0.00813878305467377,0.00813878305467377,0.380067171051444,0.380067171051444,0.380067171051444,0.380067171051444,0.0453951787168959,0.0453951787168959,0.0453951787168959,0.0453951787168959,0.0417305711342566,0.0417305711342566,0.0417305711342566,0.0417305711342566,0.0321690077775606,0.0321690077775606,0.0321690077775606,0.0321690077775606,0.0103370617114103,0.0103370617114103,0.0103370617114103,0.0103370617114103,0.0129612204366809,0.0129612204366809,0.0129612204366809,0.0129612204366809,0.106152004735647,0.106152004735647,0.106152004735647,0.0742194780431157,0.0742194780431157,0.0742194780431157,0.0742194780431157,0.0227194879526846,0.0227194879526846,0.0227194879526846,0.0227194879526846,0.0100340714520434,0.0100340714520434,0.0100340714520434,0.0100340714520434,0.0206734110298608,0.0206734110298608,0.0206734110298608,0.0206734110298608,0.0169469113521434,0.0169469113521434,0.0169469113521434,0.00762451633757023,0.00762451633757023,0.00762451633757023,0.00762451633757023,0.0306485937592836,0.0306485937592836,0.0232139311385568,0.0232139311385568,0.0232139311385568,0.0280096449579857,0.0280096449579857,0.0280096449579857,0.0515054602700039,0.0515054602700039,0.0515054602700039,0.107059057466693,0.107059057466693,0.107059057466693,0.107059057466693,0.0266553579642389,0.0266553579642389,0.0266553579642389,0.0858191749091156,0.0858191749091156,0.0858191749091156,0.0244473882371464,0.0244473882371464,0.0244473882371464,0.0244473882371464,0.0670640985529038,0.0670640985529038,0.0670640985529038,0.0670640985529038,0.0815901125430434,0.0815901125430434,0.0815901125430434,0.0815901125430434,0.0301040967138085,0.0301040967138085,0.0301040967138085,0.0301040967138085,0.0348107762848735,0.0348107762848735,0.0348107762848735,0.0348107762848735,0.0596672294268477,0.0596672294268477,0.0596672294268477,0.0596672294268477,0.0753308198822148,0.0753308198822148,0.0753308198822148,0.046562711539908,0.046562711539908,0.046562711539908,0.0228977401821137,0.0228977401821137,0.0228977401821137,0.0228977401821137,0.0411073596330847,0.0411073596330847,0.0411073596330847,0.0411073596330847,0.0176690744267719,0.0176690744267719,0.0176690744267719,0.0171528413159012,0.0171528413159012,0.0171528413159012,0.050418603715108,0.050418603715108,0.050418603715108,0.050418603715108,0.0328312348073089,0.0328312348073089,0.0328312348073089,0.0223692560965648,0.0223692560965648,0.0681087685159526,0.0681087685159526,0.0681087685159526,0.0316167665758732,0.0316167665758732,0.0316167665758732,0.0316167665758732,0.276829917860447,0.276829917860447,0.276829917860447,0.0541297977067744,0.0541297977067744,0.0541297977067744,0.152177738773681,0.152177738773681,0.152177738773681,0.152177738773681,0.0556252700006171,0.0556252700006171,0.0556252700006171,0.111526720118085,0.111526720118085,0.111526720118085,0.111526720118085,0.0355810679060535,0.0355810679060535,0.0355810679060535,0.0788010213529223,0.0788010213529223,0.0788010213529223,0.0531246414587471,0.0531246414587471,0.0531246414587471,0.0531246414587471,0.0287668011746126,0.0287668011746126,0.0287668011746126,0.0287668011746126,0.0472687015058753,0.0472687015058753,0.0472687015058753,0.0224452418752018,0.0224452418752018,0.0224452418752018,0.0224452418752018,0.0202714813177359,0.0202714813177359,0.0202714813177359,0.0562336342953625,0.0562336342953625,0.0562336342953625]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th>Var1<\/th>\n      <th>Var2<\/th>\n      <th>MH.lower<\/th>\n      <th>MH.upper<\/th>\n      <th>gridsize<\/th>\n      <th>variable<\/th>\n      <th>value<\/th>\n      <th>L1<\/th>\n      <th>SpatialManual<\/th>\n      <th>Treatment<\/th>\n      <th>Growth<\/th>\n      <th>CD8frac<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["csv","excel"],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[2,3,4,6,11]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="spatial-statistics.html#cb103-1"></a></span>
<span id="cb103-2"><a href="spatial-statistics.html#cb103-2"></a><span class="co">#write.csv(A3, file=&quot;nature-tables/Fig4e-Ext4h.csv&quot;)</span></span></code></pre></div>
<p>Although the MH values for growing vs stable are not different, we can compare the mixing in epcam vs stroma in matched samples:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="spatial-statistics.html#cb104-1"></a><span class="co">#pdf(&quot;~/Desktop/4E-MH-summary-matched-samples-growing-stable.pdf&quot;, height=5, width=7)</span></span>
<span id="cb104-2"><a href="spatial-statistics.html#cb104-2"></a></span>
<span id="cb104-3"><a href="spatial-statistics.html#cb104-3"></a></span>
<span id="cb104-4"><a href="spatial-statistics.html#cb104-4"></a>A2t=A2[<span class="op">-</span><span class="kw">which</span>(A2<span class="op">$</span>L1<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;15RD&quot;</span>, <span class="st">&quot;5LB&quot;</span>)), ]</span>
<span id="cb104-5"><a href="spatial-statistics.html#cb104-5"></a></span>
<span id="cb104-6"><a href="spatial-statistics.html#cb104-6"></a> a1=<span class="kw">t.test</span>(A2t<span class="op">$</span>value[A2t<span class="op">$</span>Growth<span class="op">==</span><span class="st">&quot;stable&quot;</span> <span class="op">&amp;</span><span class="st"> </span>A2t<span class="op">$</span>Var1<span class="op">==</span><span class="st">&quot;EpCAM&quot;</span>], A2t<span class="op">$</span>value[A2t<span class="op">$</span>Growth<span class="op">==</span><span class="st">&quot;stable&quot;</span> <span class="op">&amp;</span><span class="st"> </span>A2t<span class="op">$</span>Var1<span class="op">==</span><span class="st">&quot;SMA&quot;</span>], <span class="dt">paired=</span>T)</span>
<span id="cb104-7"><a href="spatial-statistics.html#cb104-7"></a> a2=<span class="kw">t.test</span>(A2t<span class="op">$</span>value[A2t<span class="op">$</span>Growth<span class="op">==</span><span class="st">&quot;growing&quot;</span> <span class="op">&amp;</span><span class="st"> </span>A2t<span class="op">$</span>Var1<span class="op">==</span><span class="st">&quot;EpCAM&quot;</span>], A2t<span class="op">$</span>value[A2t<span class="op">$</span>Growth<span class="op">==</span><span class="st">&quot;growing&quot;</span> <span class="op">&amp;</span><span class="st"> </span>A2t<span class="op">$</span>Var1<span class="op">==</span><span class="st">&quot;SMA&quot;</span>], <span class="dt">paired=</span>T)</span>
<span id="cb104-8"><a href="spatial-statistics.html#cb104-8"></a><span class="co"># </span></span>
<span id="cb104-9"><a href="spatial-statistics.html#cb104-9"></a><span class="kw">ggplot</span>(A2, <span class="kw">aes</span>(<span class="dt">x=</span>Var1, <span class="dt">y=</span>value, <span class="dt">col=</span>Growth))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>Growth)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span>L1))<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;grid size&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="kw">sprintf</span>(<span class="st">&quot;Morisita Horn index @ %s&quot;</span>, MHgridsize))<span class="op">+</span><span class="kw">ggtitle</span>(<span class="kw">sprintf</span>(<span class="st">&quot;MH index with CD8: stable p=%s, growing p=%s&quot;</span>, <span class="kw">round</span>(a1<span class="op">$</span>p.value, <span class="dv">2</span>), <span class="kw">round</span>(a2<span class="op">$</span>p.value, <span class="dv">2</span>)))<span class="op">+</span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>MH.lower, <span class="dt">ymax=</span>MH.upper), <span class="dt">width=</span>.<span class="dv">2</span>)<span class="op">+</span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>In the growing cases, there is a difference in the MH index in epacam and stroma, but the stable cases do not support this.</p>
</div>
<div id="treatment-1" class="section level3">
<h3><span class="header-section-number">5.3.3</span> Treatment</h3>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="spatial-statistics.html#cb105-1"></a></span>
<span id="cb105-2"><a href="spatial-statistics.html#cb105-2"></a><span class="co">#pdf(&quot;~/Desktop/4E-MH-summary-treatment.pdf&quot;, height=5, width=7)</span></span>
<span id="cb105-3"><a href="spatial-statistics.html#cb105-3"></a></span>
<span id="cb105-4"><a href="spatial-statistics.html#cb105-4"></a></span>
<span id="cb105-5"><a href="spatial-statistics.html#cb105-5"></a>pval2=<span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb105-6"><a href="spatial-statistics.html#cb105-6"></a><span class="kw">colnames</span>(pval2)=<span class="kw">unique</span>(A3<span class="op">$</span>Var1)</span>
<span id="cb105-7"><a href="spatial-statistics.html#cb105-7"></a><span class="kw">rownames</span>(pval2)=TreatV[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb105-8"><a href="spatial-statistics.html#cb105-8"></a></span>
<span id="cb105-9"><a href="spatial-statistics.html#cb105-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){</span>
<span id="cb105-10"><a href="spatial-statistics.html#cb105-10"></a>pval2[i, ]=<span class="kw">sapply</span>(<span class="kw">unique</span>(A3<span class="op">$</span>Var1), <span class="cf">function</span>(x) <span class="kw">wilcox.test</span>(A3<span class="op">$</span>value[A3<span class="op">$</span>Var1<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>A3<span class="op">$</span>Treatment<span class="op">==</span>TreatV[i]], A3<span class="op">$</span>value[A3<span class="op">$</span>Var1<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>A3<span class="op">$</span>Treatment<span class="op">==</span><span class="st">&quot;Vehicle&quot;</span>])<span class="op">$</span>p.value)</span>
<span id="cb105-11"><a href="spatial-statistics.html#cb105-11"></a>}</span>
<span id="cb105-12"><a href="spatial-statistics.html#cb105-12"></a></span>
<span id="cb105-13"><a href="spatial-statistics.html#cb105-13"></a>pmelt=<span class="kw">melt</span>(pval2)</span>
<span id="cb105-14"><a href="spatial-statistics.html#cb105-14"></a><span class="kw">colnames</span>(pmelt)=<span class="kw">c</span>(<span class="st">&quot;Treatment&quot;</span>, <span class="st">&quot;Var1&quot;</span>, <span class="st">&quot;label&quot;</span>)</span>
<span id="cb105-15"><a href="spatial-statistics.html#cb105-15"></a>pmelt<span class="op">$</span>label=<span class="kw">round</span>(pmelt<span class="op">$</span>label, <span class="dv">2</span>)</span>
<span id="cb105-16"><a href="spatial-statistics.html#cb105-16"></a>pmelt<span class="op">$</span>value=<span class="fl">0.8</span></span>
<span id="cb105-17"><a href="spatial-statistics.html#cb105-17"></a></span>
<span id="cb105-18"><a href="spatial-statistics.html#cb105-18"></a>p&lt;-<span class="kw">ggplot</span>(A1, <span class="kw">aes</span>(<span class="dt">x=</span>gridsize, <span class="dt">y=</span>value, <span class="dt">col=</span>Treatment))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>Var1)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span>L1))<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;grid size&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Morisita Horn index&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;MH index with CD8: Treatment&quot;</span>)<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">position=</span><span class="kw">position_jitterdodge</span>(),<span class="dt">alpha=</span><span class="fl">0.3</span>)</span>
<span id="cb105-19"><a href="spatial-statistics.html#cb105-19"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="spatial-statistics.html#cb106-1"></a><span class="kw">ggplot</span>(A3, <span class="kw">aes</span>(<span class="dt">x=</span>Treatment, <span class="dt">y=</span>value, <span class="dt">col=</span>Treatment))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>Var1)<span class="op">+</span><span class="kw">geom_boxplot</span>()<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;grid size&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Morisita Horn index&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;MH index with CD8: Treatment&quot;</span>)<span class="op">+</span><span class="kw">geom_text</span>(<span class="dt">data=</span>pmelt, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>Treatment, <span class="dt">y=</span><span class="fl">0.8</span>, <span class="dt">label=</span>label))<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">position=</span><span class="kw">position_jitterdodge</span>(),<span class="dt">alpha=</span><span class="fl">0.3</span>)<span class="op">+</span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>ColMerge[ ,<span class="dv">1</span>])</span></code></pre></div>
<div class="figure"><span id="fig:Ext4h"></span>
<img src="RatDCIS-bookdown_files/figure-html/Ext4h-1.png" alt="MH values with Treatment" width="672" />
<p class="caption">
Figure 5.4: MH values with Treatment
</p>
</div>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="spatial-statistics.html#cb107-1"></a></span>
<span id="cb107-2"><a href="spatial-statistics.html#cb107-2"></a></span>
<span id="cb107-3"><a href="spatial-statistics.html#cb107-3"></a><span class="co">#dev.off()</span></span></code></pre></div>
<p>There is no difference between the different spatial metrics compared to the vehicle, however, we can compare for a given treatment if there is a difference between the epcam and the stromal interaction scores. It appears that there is a difference only in the control, where SMA mixing is higher than EPcam mixing:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="spatial-statistics.html#cb108-1"></a><span class="co">## pairwise comparison: Epcam vs stroma</span></span>
<span id="cb108-2"><a href="spatial-statistics.html#cb108-2"></a><span class="co">## calculate the pairwise p values here</span></span>
<span id="cb108-3"><a href="spatial-statistics.html#cb108-3"></a>A2t=A2[<span class="op">-</span><span class="kw">which</span>(A2<span class="op">$</span>L1<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;15RD&quot;</span>, <span class="st">&quot;5LB&quot;</span>)), ]</span>
<span id="cb108-4"><a href="spatial-statistics.html#cb108-4"></a></span>
<span id="cb108-5"><a href="spatial-statistics.html#cb108-5"></a>a1=<span class="kw">t.test</span>(A2t<span class="op">$</span>value[A2t<span class="op">$</span>Treatment<span class="op">==</span><span class="st">&quot;Vehicle&quot;</span> <span class="op">&amp;</span><span class="st"> </span>A2t<span class="op">$</span>Var1<span class="op">==</span><span class="st">&quot;EpCAM&quot;</span>], A2t<span class="op">$</span>value[A2t<span class="op">$</span>Treatment<span class="op">==</span><span class="st">&quot;Vehicle&quot;</span><span class="op">&amp;</span><span class="st"> </span>A2t<span class="op">$</span>Var1<span class="op">==</span><span class="st">&quot;SMA&quot;</span>], <span class="dt">paired=</span>T)</span>
<span id="cb108-6"><a href="spatial-statistics.html#cb108-6"></a>a2=<span class="kw">t.test</span>(A2t<span class="op">$</span>value[A2t<span class="op">$</span>Treatment<span class="op">==</span><span class="st">&quot;PDL1&quot;</span> <span class="op">&amp;</span><span class="st"> </span>A2t<span class="op">$</span>Var1<span class="op">==</span><span class="st">&quot;EpCAM&quot;</span>], A2t<span class="op">$</span>value[A2t<span class="op">$</span>Treatment<span class="op">==</span><span class="st">&quot;PDL1&quot;</span> <span class="op">&amp;</span><span class="st"> </span>A2t<span class="op">$</span>Var1<span class="op">==</span><span class="st">&quot;SMA&quot;</span>], <span class="dt">paired=</span>T)</span>
<span id="cb108-7"><a href="spatial-statistics.html#cb108-7"></a>a3=<span class="kw">t.test</span>(A2t<span class="op">$</span>value[A2t<span class="op">$</span>Treatment<span class="op">==</span><span class="st">&quot;PDL1+LY&quot;</span> <span class="op">&amp;</span><span class="st"> </span>A2t<span class="op">$</span>Var1<span class="op">==</span><span class="st">&quot;EpCAM&quot;</span>], A2t<span class="op">$</span>value[A2t<span class="op">$</span>Treatment<span class="op">==</span><span class="st">&quot;PDL1+LY&quot;</span> <span class="op">&amp;</span><span class="st"> </span>A2t<span class="op">$</span>Var1<span class="op">==</span><span class="st">&quot;SMA&quot;</span>], <span class="dt">paired=</span>T)</span>
<span id="cb108-8"><a href="spatial-statistics.html#cb108-8"></a>a4=<span class="kw">t.test</span>(A2t<span class="op">$</span>value[A2t<span class="op">$</span>Treatment<span class="op">==</span><span class="st">&quot;LY&quot;</span> <span class="op">&amp;</span><span class="st"> </span>A2t<span class="op">$</span>Var1<span class="op">==</span><span class="st">&quot;EpCAM&quot;</span>], A2t<span class="op">$</span>value[A2t<span class="op">$</span>Treatment<span class="op">==</span><span class="st">&quot;LY&quot;</span> <span class="op">&amp;</span><span class="st"> </span>A2t<span class="op">$</span>Var1<span class="op">==</span><span class="st">&quot;SMA&quot;</span>], <span class="dt">paired=</span>T)</span>
<span id="cb108-9"><a href="spatial-statistics.html#cb108-9"></a></span>
<span id="cb108-10"><a href="spatial-statistics.html#cb108-10"></a>p&lt;-<span class="kw">ggplot</span>(A2, <span class="kw">aes</span>(<span class="dt">x=</span>Var1, <span class="dt">y=</span>value, <span class="dt">col=</span>Treatment))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>Treatment)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span>L1))<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;grid size&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="kw">sprintf</span>(<span class="st">&quot;Morisita Horn index @ %s&quot;</span>, MHgridsize))<span class="op">+</span><span class="kw">ggtitle</span>(<span class="kw">sprintf</span>(<span class="st">&quot;MH index with CD8: Cntl p=%s, PDL1 p=%s LY p=%s P+L p=%s&quot;</span>, <span class="kw">round</span>(a1<span class="op">$</span>p.value, <span class="dv">2</span>), <span class="kw">round</span>(a2<span class="op">$</span>p.value, <span class="dv">2</span>), <span class="kw">round</span>(a3<span class="op">$</span>p.value,<span class="dv">2</span>), <span class="kw">round</span>(a4<span class="op">$</span>p.value, <span class="dv">2</span>)))<span class="op">+</span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>MH.lower, <span class="dt">ymax=</span>MH.upper), <span class="dt">width=</span>.<span class="dv">2</span>)<span class="op">+</span><span class="kw">geom_point</span>()</span>
<span id="cb108-11"><a href="spatial-statistics.html#cb108-11"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
</div>
<div id="comparison-between-metrics" class="section level2">
<h2><span class="header-section-number">5.4</span> Comparison between metrics</h2>
<p>After assessing optimal parameters for each metric, in this section we assess which metric could be the best for spatial analysis.</p>
<p>Below is a table of the different metrics and their values for each sample</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="spatial-statistics.html#cb109-1"></a><span class="co">#write.table(SummaryData, file=&quot;../metadata/WSI_compared_other_metrics.csv&quot;)</span></span>
<span id="cb109-2"><a href="spatial-statistics.html#cb109-2"></a></span>
<span id="cb109-3"><a href="spatial-statistics.html#cb109-3"></a><span class="co">##</span></span>
<span id="cb109-4"><a href="spatial-statistics.html#cb109-4"></a><span class="co"># Combine the data from above into one file</span></span>
<span id="cb109-5"><a href="spatial-statistics.html#cb109-5"></a><span class="co">#</span></span>
<span id="cb109-6"><a href="spatial-statistics.html#cb109-6"></a>df.temp=<span class="kw">cbind</span>(knnreshape[ , <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>], IFreshape[ ,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>], MHreshape[ , <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>] )</span>
<span id="cb109-7"><a href="spatial-statistics.html#cb109-7"></a><span class="kw">colnames</span>(df.temp)=<span class="kw">paste</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;knn&quot;</span>, <span class="st">&quot;IF&quot;</span>, <span class="st">&quot;MH&quot;</span>), <span class="dt">times=</span><span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">9</span>)), <span class="kw">colnames</span>(df.temp),<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)</span>
<span id="cb109-8"><a href="spatial-statistics.html#cb109-8"></a><span class="co">#colnames(df.Spatial)=paste()</span></span>
<span id="cb109-9"><a href="spatial-statistics.html#cb109-9"></a>df.Spatial=<span class="kw">cbind</span>(df.Spatial, df.temp)</span>
<span id="cb109-10"><a href="spatial-statistics.html#cb109-10"></a><span class="co">#df.Spatial=cbind(df.Spatial,IFreshape[ ,11:14])</span></span>
<span id="cb109-11"><a href="spatial-statistics.html#cb109-11"></a>df.Spatial<span class="op">$</span>GrowthRate=Cdata<span class="op">$</span>GrowthRate[<span class="kw">match</span>(<span class="kw">rownames</span>(df.Spatial), <span class="kw">gsub</span>(<span class="st">&quot;_&quot;</span>, <span class="st">&quot;&quot;</span>, Cdata<span class="op">$</span>TumorID))]</span>
<span id="cb109-12"><a href="spatial-statistics.html#cb109-12"></a>df.Spatial<span class="op">$</span>TumSize=Cdata<span class="op">$</span>Tumor.diameter.sac.mm[<span class="kw">match</span>(<span class="kw">rownames</span>(df.Spatial), <span class="kw">gsub</span>(<span class="st">&quot;_&quot;</span>, <span class="st">&quot;&quot;</span>, Cdata<span class="op">$</span>TumorID))]</span>
<span id="cb109-13"><a href="spatial-statistics.html#cb109-13"></a>df.Spatial<span class="op">$</span>knn.EpCAMcut=<span class="kw">cut</span>(df.Spatial<span class="op">$</span>knn.EpCAM, <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="kw">median</span>(df.Spatial<span class="op">$</span>knn.EpCAM, <span class="dt">na.rm =</span> T), <span class="fl">1.2</span>), <span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>))</span>
<span id="cb109-14"><a href="spatial-statistics.html#cb109-14"></a>df.Spatial<span class="op">$</span>MH.EpCAMcut=<span class="kw">cut</span>(df.Spatial<span class="op">$</span>MH.EpCAM, <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="kw">median</span>(df.Spatial<span class="op">$</span>MH.EpCAM, <span class="dt">na.rm =</span> T), <span class="fl">1.2</span>), <span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>))</span>
<span id="cb109-15"><a href="spatial-statistics.html#cb109-15"></a>df.Spatial<span class="op">$</span>IF.EpCAMcut=<span class="kw">cut</span>(df.Spatial<span class="op">$</span>IF.EpCAM, <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="kw">median</span>(df.Spatial<span class="op">$</span>IF.EpCAM, <span class="dt">na.rm =</span> T), <span class="fl">1.2</span>), <span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>))</span>
<span id="cb109-16"><a href="spatial-statistics.html#cb109-16"></a>df.Spatial<span class="op">$</span>CD8Fraccut=<span class="kw">cut</span>(df.Spatial<span class="op">$</span>CD8frac, <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="kw">median</span>(df.Spatial<span class="op">$</span>CD8frac, <span class="dt">na.rm =</span> T), <span class="fl">1.2</span>), <span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>))</span>
<span id="cb109-17"><a href="spatial-statistics.html#cb109-17"></a></span>
<span id="cb109-18"><a href="spatial-statistics.html#cb109-18"></a><span class="co">#t2=WSIvalFracs[, match(rownames(df.Spatial), colnames(WSIvalFracs))]</span></span>
<span id="cb109-19"><a href="spatial-statistics.html#cb109-19"></a><span class="co">#rownames(t2)=paste(rownames(t2), &quot;Frac.WSI&quot;, sep=&quot;&quot;)</span></span>
<span id="cb109-20"><a href="spatial-statistics.html#cb109-20"></a><span class="co">#t3=WSIvals[, match(rownames(df.Spatial), colnames(WSIvalFracs))]</span></span>
<span id="cb109-21"><a href="spatial-statistics.html#cb109-21"></a><span class="co">#rownames(t2)=paste(rownames(t2), &quot;.WSI&quot;, sep=&quot;&quot;)</span></span>
<span id="cb109-22"><a href="spatial-statistics.html#cb109-22"></a></span>
<span id="cb109-23"><a href="spatial-statistics.html#cb109-23"></a><span class="co">#df.Spatial=cbind(df.Spatial, t(t2), t(t3))</span></span>
<span id="cb109-24"><a href="spatial-statistics.html#cb109-24"></a></span>
<span id="cb109-25"><a href="spatial-statistics.html#cb109-25"></a><span class="kw">scroll_box</span>(<span class="kw">kable</span>(df.Spatial, <span class="dt">format=</span><span class="st">&quot;html&quot;</span>),</span>
<span id="cb109-26"><a href="spatial-statistics.html#cb109-26"></a>         <span class="dt">height=</span><span class="st">&quot;300px&quot;</span>, <span class="dt">width=</span><span class="st">&quot;100%&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
CD8
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
EpCAM
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
EpCAM:SMA
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
SMA
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Unclass
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
CD8frac
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
EpCAMfrac
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
EpCAM:SMAfrac
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
SMAfrac
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Unclassfrac
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
knn.EpCAM
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
knn.EpCAM..SMA
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
knn.SMA
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
knn.Unclass
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
knn.EpMIN
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
knn.EpStrRatio1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
knn.EpStrRatio2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
knn.EpStrRatio3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
knn.EpStrRatio4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
IF.CD8
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
IF.EpCAM
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
IF.EpCAM..SMA
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
IF.SMA
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
IF.Unclass
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
IF.EpMIN
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
IF.EpStrRatio1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
IF.EpStrRatio2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
IF.EpStrRatio3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
IF.EpStrRatio4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
MH.EpCAM
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
MH.EpCAM..SMA
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
MH.SMA
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
MH.Unclass
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
MH.EpMIN
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
MH.EpStrRatio1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
MH.EpStrRatio2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
MH.EpStrRatio3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
MH.EpStrRatio4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
GrowthRate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
TumSize
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
knn.EpCAMcut
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
MH.EpCAMcut
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
IF.EpCAMcut
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
CD8Fraccut
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
10LB
</td>
<td style="text-align:right;">
65507
</td>
<td style="text-align:right;">
761887
</td>
<td style="text-align:right;">
343389
</td>
<td style="text-align:right;">
1126173
</td>
<td style="text-align:right;">
563894
</td>
<td style="text-align:right;">
0.0228977
</td>
<td style="text-align:right;">
0.2663149
</td>
<td style="text-align:right;">
0.1200304
</td>
<td style="text-align:right;">
0.3936498
</td>
<td style="text-align:right;">
0.1971072
</td>
<td style="text-align:right;">
39.96193
</td>
<td style="text-align:right;">
52.72253
</td>
<td style="text-align:right;">
16.94935
</td>
<td style="text-align:right;">
28.07623
</td>
<td style="text-align:right;">
39.96193
</td>
<td style="text-align:right;">
0.5735732
</td>
<td style="text-align:right;">
2.3577258
</td>
<td style="text-align:right;">
1.3302993
</td>
<td style="text-align:right;">
5.4683183
</td>
<td style="text-align:right;">
0.2053826
</td>
<td style="text-align:right;">
0.2236555
</td>
<td style="text-align:right;">
0.0803884
</td>
<td style="text-align:right;">
0.5905018
</td>
<td style="text-align:right;">
0.3010823
</td>
<td style="text-align:right;">
0.0803884
</td>
<td style="text-align:right;">
3.333713e-01
</td>
<td style="text-align:right;">
3.787550e-01
</td>
<td style="text-align:right;">
4.531947e-01
</td>
<td style="text-align:right;">
5.148906e-01
</td>
<td style="text-align:right;">
0.3580143
</td>
<td style="text-align:right;">
0.3510808
</td>
<td style="text-align:right;">
0.4990200
</td>
<td style="text-align:right;">
0.4513703
</td>
<td style="text-align:right;">
0.3510808
</td>
<td style="text-align:right;">
0.4211433
</td>
<td style="text-align:right;">
0.7174347
</td>
<td style="text-align:right;">
0.8341306
</td>
<td style="text-align:right;">
1.4209752
</td>
<td style="text-align:right;">
6.2285714
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
10LC
</td>
<td style="text-align:right;">
3481
</td>
<td style="text-align:right;">
102702
</td>
<td style="text-align:right;">
58017
</td>
<td style="text-align:right;">
106919
</td>
<td style="text-align:right;">
75799
</td>
<td style="text-align:right;">
0.0100341
</td>
<td style="text-align:right;">
0.2960411
</td>
<td style="text-align:right;">
0.1672355
</td>
<td style="text-align:right;">
0.3081967
</td>
<td style="text-align:right;">
0.2184926
</td>
<td style="text-align:right;">
32.12258
</td>
<td style="text-align:right;">
34.57734
</td>
<td style="text-align:right;">
17.87345
</td>
<td style="text-align:right;">
24.28626
</td>
<td style="text-align:right;">
32.12258
</td>
<td style="text-align:right;">
0.6124326
</td>
<td style="text-align:right;">
1.7972227
</td>
<td style="text-align:right;">
1.2716665
</td>
<td style="text-align:right;">
3.7317865
</td>
<td style="text-align:right;">
0.0784257
</td>
<td style="text-align:right;">
0.3168630
</td>
<td style="text-align:right;">
0.2375754
</td>
<td style="text-align:right;">
0.4768745
</td>
<td style="text-align:right;">
0.3714450
</td>
<td style="text-align:right;">
0.2375754
</td>
<td style="text-align:right;">
4.435062e-01
</td>
<td style="text-align:right;">
6.644578e-01
</td>
<td style="text-align:right;">
7.760354e-01
</td>
<td style="text-align:right;">
1.162651e+00
</td>
<td style="text-align:right;">
0.3338239
</td>
<td style="text-align:right;">
0.3690715
</td>
<td style="text-align:right;">
0.3937566
</td>
<td style="text-align:right;">
0.4370583
</td>
<td style="text-align:right;">
0.3338239
</td>
<td style="text-align:right;">
0.4376135
</td>
<td style="text-align:right;">
0.8477925
</td>
<td style="text-align:right;">
0.9214336
</td>
<td style="text-align:right;">
1.7851014
</td>
<td style="text-align:right;">
5.3571429
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
10LD
</td>
<td style="text-align:right;">
67342
</td>
<td style="text-align:right;">
192699
</td>
<td style="text-align:right;">
204061
</td>
<td style="text-align:right;">
402092
</td>
<td style="text-align:right;">
122548
</td>
<td style="text-align:right;">
0.0681088
</td>
<td style="text-align:right;">
0.1948931
</td>
<td style="text-align:right;">
0.2063845
</td>
<td style="text-align:right;">
0.4066703
</td>
<td style="text-align:right;">
0.1239434
</td>
<td style="text-align:right;">
34.33110
</td>
<td style="text-align:right;">
30.18133
</td>
<td style="text-align:right;">
15.97086
</td>
<td style="text-align:right;">
35.99495
</td>
<td style="text-align:right;">
30.18133
</td>
<td style="text-align:right;">
0.7438671
</td>
<td style="text-align:right;">
2.1496080
</td>
<td style="text-align:right;">
1.3978193
</td>
<td style="text-align:right;">
4.0393825
</td>
<td style="text-align:right;">
0.2816222
</td>
<td style="text-align:right;">
0.2944373
</td>
<td style="text-align:right;">
0.2563779
</td>
<td style="text-align:right;">
0.5786730
</td>
<td style="text-align:right;">
0.1450209
</td>
<td style="text-align:right;">
0.2563779
</td>
<td style="text-align:right;">
3.525981e-01
</td>
<td style="text-align:right;">
5.088147e-01
</td>
<td style="text-align:right;">
6.596187e-01
</td>
<td style="text-align:right;">
9.518592e-01
</td>
<td style="text-align:right;">
0.6191886
</td>
<td style="text-align:right;">
0.5596224
</td>
<td style="text-align:right;">
0.6542665
</td>
<td style="text-align:right;">
0.5383814
</td>
<td style="text-align:right;">
0.5596224
</td>
<td style="text-align:right;">
0.5100867
</td>
<td style="text-align:right;">
0.9463859
</td>
<td style="text-align:right;">
0.9711029
</td>
<td style="text-align:right;">
1.8017290
</td>
<td style="text-align:right;">
1.9729730
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
10NA
</td>
<td style="text-align:right;">
27239
</td>
<td style="text-align:right;">
324933
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
167028
</td>
<td style="text-align:right;">
65796
</td>
<td style="text-align:right;">
0.0465627
</td>
<td style="text-align:right;">
0.5554448
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.2855199
</td>
<td style="text-align:right;">
0.1124726
</td>
<td style="text-align:right;">
23.80977
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
27.49276
</td>
<td style="text-align:right;">
48.19205
</td>
<td style="text-align:right;">
23.80977
</td>
<td style="text-align:right;">
0.8660376
</td>
<td style="text-align:right;">
0.8660376
</td>
<td style="text-align:right;">
0.8660376
</td>
<td style="text-align:right;">
0.8660376
</td>
<td style="text-align:right;">
0.3591542
</td>
<td style="text-align:right;">
0.4808547
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.3207166
</td>
<td style="text-align:right;">
0.1112743
</td>
<td style="text-align:right;">
0.4808547
</td>
<td style="text-align:right;">
1.499313e+00
</td>
<td style="text-align:right;">
1.499313e+00
</td>
<td style="text-align:right;">
1.499313e+00
</td>
<td style="text-align:right;">
1.499313e+00
</td>
<td style="text-align:right;">
0.3849200
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4254207
</td>
<td style="text-align:right;">
0.3382134
</td>
<td style="text-align:right;">
0.3849200
</td>
<td style="text-align:right;">
0.9047983
</td>
<td style="text-align:right;">
0.9047983
</td>
<td style="text-align:right;">
0.9047983
</td>
<td style="text-align:right;">
0.9047983
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
10ND
</td>
<td style="text-align:right;">
22618
</td>
<td style="text-align:right;">
463070
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
282453
</td>
<td style="text-align:right;">
227392
</td>
<td style="text-align:right;">
0.0227195
</td>
<td style="text-align:right;">
0.4651478
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.2837204
</td>
<td style="text-align:right;">
0.2284123
</td>
<td style="text-align:right;">
26.20801
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
30.06210
</td>
<td style="text-align:right;">
40.01762
</td>
<td style="text-align:right;">
26.20801
</td>
<td style="text-align:right;">
0.8717958
</td>
<td style="text-align:right;">
0.8717958
</td>
<td style="text-align:right;">
0.8717958
</td>
<td style="text-align:right;">
0.8717958
</td>
<td style="text-align:right;">
0.3008666
</td>
<td style="text-align:right;">
0.4408878
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.1738438
</td>
<td style="text-align:right;">
0.1426298
</td>
<td style="text-align:right;">
0.4408878
</td>
<td style="text-align:right;">
2.536114e+00
</td>
<td style="text-align:right;">
2.536114e+00
</td>
<td style="text-align:right;">
2.536114e+00
</td>
<td style="text-align:right;">
2.536114e+00
</td>
<td style="text-align:right;">
0.3107974
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.2528283
</td>
<td style="text-align:right;">
0.2367529
</td>
<td style="text-align:right;">
0.3107974
</td>
<td style="text-align:right;">
1.2292825
</td>
<td style="text-align:right;">
1.2292825
</td>
<td style="text-align:right;">
1.2292825
</td>
<td style="text-align:right;">
1.2292825
</td>
<td style="text-align:right;">
0.3930533
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
10RBL
</td>
<td style="text-align:right;">
3393
</td>
<td style="text-align:right;">
58223
</td>
<td style="text-align:right;">
25198
</td>
<td style="text-align:right;">
42642
</td>
<td style="text-align:right;">
37922
</td>
<td style="text-align:right;">
0.0202715
</td>
<td style="text-align:right;">
0.3478534
</td>
<td style="text-align:right;">
0.1505455
</td>
<td style="text-align:right;">
0.2547647
</td>
<td style="text-align:right;">
0.2265650
</td>
<td style="text-align:right;">
44.92703
</td>
<td style="text-align:right;">
67.36295
</td>
<td style="text-align:right;">
18.22774
</td>
<td style="text-align:right;">
26.07893
</td>
<td style="text-align:right;">
44.92703
</td>
<td style="text-align:right;">
0.5249056
</td>
<td style="text-align:right;">
2.4647619
</td>
<td style="text-align:right;">
1.3119416
</td>
<td style="text-align:right;">
6.1603904
</td>
<td style="text-align:right;">
0.1279104
</td>
<td style="text-align:right;">
0.2213380
</td>
<td style="text-align:right;">
0.2039493
</td>
<td style="text-align:right;">
0.5758915
</td>
<td style="text-align:right;">
0.4544651
</td>
<td style="text-align:right;">
0.2039493
</td>
<td style="text-align:right;">
2.838246e-01
</td>
<td style="text-align:right;">
3.843398e-01
</td>
<td style="text-align:right;">
5.453515e-01
</td>
<td style="text-align:right;">
7.384852e-01
</td>
<td style="text-align:right;">
0.4376521
</td>
<td style="text-align:right;">
0.4278403
</td>
<td style="text-align:right;">
0.5676946
</td>
<td style="text-align:right;">
0.5101371
</td>
<td style="text-align:right;">
0.4278403
</td>
<td style="text-align:right;">
0.4396151
</td>
<td style="text-align:right;">
0.7709288
</td>
<td style="text-align:right;">
0.8693742
</td>
<td style="text-align:right;">
1.5245739
</td>
<td style="text-align:right;">
4.9761905
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
10RBU
</td>
<td style="text-align:right;">
178767
</td>
<td style="text-align:right;">
437050
</td>
<td style="text-align:right;">
895393
</td>
<td style="text-align:right;">
763776
</td>
<td style="text-align:right;">
390628
</td>
<td style="text-align:right;">
0.0670641
</td>
<td style="text-align:right;">
0.1639585
</td>
<td style="text-align:right;">
0.3359050
</td>
<td style="text-align:right;">
0.2865291
</td>
<td style="text-align:right;">
0.1465433
</td>
<td style="text-align:right;">
87.12901
</td>
<td style="text-align:right;">
76.12121
</td>
<td style="text-align:right;">
20.78384
</td>
<td style="text-align:right;">
35.23226
</td>
<td style="text-align:right;">
76.12121
</td>
<td style="text-align:right;">
0.8991173
</td>
<td style="text-align:right;">
4.1921519
</td>
<td style="text-align:right;">
1.6846410
</td>
<td style="text-align:right;">
7.8546713
</td>
<td style="text-align:right;">
0.4317687
</td>
<td style="text-align:right;">
0.0816202
</td>
<td style="text-align:right;">
0.3119480
</td>
<td style="text-align:right;">
0.4723411
</td>
<td style="text-align:right;">
0.2877489
</td>
<td style="text-align:right;">
0.0816202
</td>
<td style="text-align:right;">
1.040690e-01
</td>
<td style="text-align:right;">
1.727993e-01
</td>
<td style="text-align:right;">
5.018152e-01
</td>
<td style="text-align:right;">
8.332287e-01
</td>
<td style="text-align:right;">
0.3034275
</td>
<td style="text-align:right;">
0.3661208
</td>
<td style="text-align:right;">
0.5282356
</td>
<td style="text-align:right;">
0.5051726
</td>
<td style="text-align:right;">
0.3034275
</td>
<td style="text-align:right;">
0.3392691
</td>
<td style="text-align:right;">
0.5744170
</td>
<td style="text-align:right;">
0.7486370
</td>
<td style="text-align:right;">
1.2675183
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
10RC
</td>
<td style="text-align:right;">
1823
</td>
<td style="text-align:right;">
15806
</td>
<td style="text-align:right;">
1209
</td>
<td style="text-align:right;">
5729
</td>
<td style="text-align:right;">
19118
</td>
<td style="text-align:right;">
0.0417306
</td>
<td style="text-align:right;">
0.3618176
</td>
<td style="text-align:right;">
0.0276754
</td>
<td style="text-align:right;">
0.1311434
</td>
<td style="text-align:right;">
0.4376331
</td>
<td style="text-align:right;">
25.68401
</td>
<td style="text-align:right;">
94.64722
</td>
<td style="text-align:right;">
31.71923
</td>
<td style="text-align:right;">
16.94124
</td>
<td style="text-align:right;">
25.68401
</td>
<td style="text-align:right;">
0.2032503
</td>
<td style="text-align:right;">
0.8097300
</td>
<td style="text-align:right;">
0.9522403
</td>
<td style="text-align:right;">
3.7936364
</td>
<td style="text-align:right;">
0.1695008
</td>
<td style="text-align:right;">
0.4119583
</td>
<td style="text-align:right;">
0.0142622
</td>
<td style="text-align:right;">
0.1579813
</td>
<td style="text-align:right;">
0.5798135
</td>
<td style="text-align:right;">
0.0142622
</td>
<td style="text-align:right;">
2.391720e+00
</td>
<td style="text-align:right;">
2.607639e+00
</td>
<td style="text-align:right;">
2.474522e+00
</td>
<td style="text-align:right;">
2.697917e+00
</td>
<td style="text-align:right;">
0.5653879
</td>
<td style="text-align:right;">
0.3556849
</td>
<td style="text-align:right;">
0.5385849
</td>
<td style="text-align:right;">
0.6096737
</td>
<td style="text-align:right;">
0.3556849
</td>
<td style="text-align:right;">
0.6322341
</td>
<td style="text-align:right;">
1.0497655
</td>
<td style="text-align:right;">
1.0299719
</td>
<td style="text-align:right;">
1.7101719
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
11LB
</td>
<td style="text-align:right;">
196293
</td>
<td style="text-align:right;">
587504
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
506036
</td>
<td style="text-align:right;">
0.1521777
</td>
<td style="text-align:right;">
0.4554672
</td>
<td style="text-align:right;">
0.0000101
</td>
<td style="text-align:right;">
0.0000364
</td>
<td style="text-align:right;">
0.3923085
</td>
<td style="text-align:right;">
69.10296
</td>
<td style="text-align:right;">
7919.73815
</td>
<td style="text-align:right;">
6967.17455
</td>
<td style="text-align:right;">
17.47761
</td>
<td style="text-align:right;">
69.10296
</td>
<td style="text-align:right;">
0.0046419
</td>
<td style="text-align:right;">
0.0099184
</td>
<td style="text-align:right;">
0.5366352
</td>
<td style="text-align:right;">
1.1466400
</td>
<td style="text-align:right;">
0.6929437
</td>
<td style="text-align:right;">
0.2080105
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000102
</td>
<td style="text-align:right;">
0.5774735
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
2.041550e+04
</td>
<td style="text-align:right;">
2.041550e+04
</td>
<td style="text-align:right;">
2.041550e+04
</td>
<td style="text-align:right;">
2.041550e+04
</td>
<td style="text-align:right;">
0.2377147
</td>
<td style="text-align:right;">
0.0002624
</td>
<td style="text-align:right;">
0.0002198
</td>
<td style="text-align:right;">
0.5655570
</td>
<td style="text-align:right;">
0.0002624
</td>
<td style="text-align:right;">
493.0221183
</td>
<td style="text-align:right;">
1081.6128754
</td>
<td style="text-align:right;">
493.5662971
</td>
<td style="text-align:right;">
1082.8067179
</td>
<td style="text-align:right;">
3.7857143
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
11ND
</td>
<td style="text-align:right;">
42097
</td>
<td style="text-align:right;">
46872
</td>
<td style="text-align:right;">
2054
</td>
<td style="text-align:right;">
1551
</td>
<td style="text-align:right;">
18188
</td>
<td style="text-align:right;">
0.3800672
</td>
<td style="text-align:right;">
0.4231776
</td>
<td style="text-align:right;">
0.0185443
</td>
<td style="text-align:right;">
0.0140030
</td>
<td style="text-align:right;">
0.1642079
</td>
<td style="text-align:right;">
26.89773
</td>
<td style="text-align:right;">
115.53783
</td>
<td style="text-align:right;">
92.98237
</td>
<td style="text-align:right;">
27.03077
</td>
<td style="text-align:right;">
26.89773
</td>
<td style="text-align:right;">
0.1289934
</td>
<td style="text-align:right;">
0.2892778
</td>
<td style="text-align:right;">
0.6830780
</td>
<td style="text-align:right;">
1.5318557
</td>
<td style="text-align:right;">
0.8951232
</td>
<td style="text-align:right;">
0.4326199
</td>
<td style="text-align:right;">
0.0146566
</td>
<td style="text-align:right;">
0.0079816
</td>
<td style="text-align:right;">
0.2765993
</td>
<td style="text-align:right;">
0.0146566
</td>
<td style="text-align:right;">
1.911018e+01
</td>
<td style="text-align:right;">
5.420238e+01
</td>
<td style="text-align:right;">
1.975761e+01
</td>
<td style="text-align:right;">
5.603869e+01
</td>
<td style="text-align:right;">
0.6777854
</td>
<td style="text-align:right;">
0.3947415
</td>
<td style="text-align:right;">
0.4434028
</td>
<td style="text-align:right;">
0.6868704
</td>
<td style="text-align:right;">
0.3947415
</td>
<td style="text-align:right;">
0.8086739
</td>
<td style="text-align:right;">
1.5285999
</td>
<td style="text-align:right;">
1.2796448
</td>
<td style="text-align:right;">
2.4188549
</td>
<td style="text-align:right;">
0.1065574
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
11RC
</td>
<td style="text-align:right;">
40084
</td>
<td style="text-align:right;">
247458
</td>
<td style="text-align:right;">
137553
</td>
<td style="text-align:right;">
165687
</td>
<td style="text-align:right;">
204242
</td>
<td style="text-align:right;">
0.0504186
</td>
<td style="text-align:right;">
0.3112585
</td>
<td style="text-align:right;">
0.1730174
</td>
<td style="text-align:right;">
0.2084050
</td>
<td style="text-align:right;">
0.2569004
</td>
<td style="text-align:right;">
153.33513
</td>
<td style="text-align:right;">
178.57028
</td>
<td style="text-align:right;">
70.26468
</td>
<td style="text-align:right;">
25.53931
</td>
<td style="text-align:right;">
153.33513
</td>
<td style="text-align:right;">
0.6162122
</td>
<td style="text-align:right;">
2.1822504
</td>
<td style="text-align:right;">
1.3338375
</td>
<td style="text-align:right;">
4.7236450
</td>
<td style="text-align:right;">
0.7894172
</td>
<td style="text-align:right;">
0.0386688
</td>
<td style="text-align:right;">
0.0222283
</td>
<td style="text-align:right;">
0.0532631
</td>
<td style="text-align:right;">
0.4286498
</td>
<td style="text-align:right;">
0.0222283
</td>
<td style="text-align:right;">
5.122274e-01
</td>
<td style="text-align:right;">
7.259953e-01
</td>
<td style="text-align:right;">
8.066755e-01
</td>
<td style="text-align:right;">
1.143325e+00
</td>
<td style="text-align:right;">
0.0261783
</td>
<td style="text-align:right;">
0.0269403
</td>
<td style="text-align:right;">
0.0417948
</td>
<td style="text-align:right;">
0.1950371
</td>
<td style="text-align:right;">
0.0261783
</td>
<td style="text-align:right;">
0.3808571
</td>
<td style="text-align:right;">
0.6263514
</td>
<td style="text-align:right;">
0.7728005
</td>
<td style="text-align:right;">
1.2709349
</td>
<td style="text-align:right;">
2.6785714
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
11RD
</td>
<td style="text-align:right;">
29817
</td>
<td style="text-align:right;">
352081
</td>
<td style="text-align:right;">
198409
</td>
<td style="text-align:right;">
375106
</td>
<td style="text-align:right;">
373020
</td>
<td style="text-align:right;">
0.0224452
</td>
<td style="text-align:right;">
0.2650348
</td>
<td style="text-align:right;">
0.1493557
</td>
<td style="text-align:right;">
0.2823673
</td>
<td style="text-align:right;">
0.2807970
</td>
<td style="text-align:right;">
73.82461
</td>
<td style="text-align:right;">
68.89859
</td>
<td style="text-align:right;">
24.26948
</td>
<td style="text-align:right;">
26.26985
</td>
<td style="text-align:right;">
68.89859
</td>
<td style="text-align:right;">
0.7923810
</td>
<td style="text-align:right;">
3.0418697
</td>
<td style="text-align:right;">
1.5318895
</td>
<td style="text-align:right;">
5.8807677
</td>
<td style="text-align:right;">
0.2660563
</td>
<td style="text-align:right;">
0.2323507
</td>
<td style="text-align:right;">
0.1251300
</td>
<td style="text-align:right;">
0.3447698
</td>
<td style="text-align:right;">
0.4433712
</td>
<td style="text-align:right;">
0.1251300
</td>
<td style="text-align:right;">
4.944686e-01
</td>
<td style="text-align:right;">
6.739300e-01
</td>
<td style="text-align:right;">
7.607594e-01
</td>
<td style="text-align:right;">
1.036868e+00
</td>
<td style="text-align:right;">
0.2646073
</td>
<td style="text-align:right;">
0.2511598
</td>
<td style="text-align:right;">
0.3031015
</td>
<td style="text-align:right;">
0.4116961
</td>
<td style="text-align:right;">
0.2511598
</td>
<td style="text-align:right;">
0.4774054
</td>
<td style="text-align:right;">
0.8729991
</td>
<td style="text-align:right;">
0.9305487
</td>
<td style="text-align:right;">
1.7016318
</td>
<td style="text-align:right;">
3.6428571
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
12LC
</td>
<td style="text-align:right;">
2692
</td>
<td style="text-align:right;">
14614
</td>
<td style="text-align:right;">
289
</td>
<td style="text-align:right;">
125
</td>
<td style="text-align:right;">
7425
</td>
<td style="text-align:right;">
0.1070591
</td>
<td style="text-align:right;">
0.5811891
</td>
<td style="text-align:right;">
0.0114933
</td>
<td style="text-align:right;">
0.0049712
</td>
<td style="text-align:right;">
0.2952873
</td>
<td style="text-align:right;">
23.96795
</td>
<td style="text-align:right;">
185.03912
</td>
<td style="text-align:right;">
202.99400
</td>
<td style="text-align:right;">
19.41965
</td>
<td style="text-align:right;">
23.96795
</td>
<td style="text-align:right;">
0.0617678
</td>
<td style="text-align:right;">
0.1180722
</td>
<td style="text-align:right;">
0.5386320
</td>
<td style="text-align:right;">
1.0296219
</td>
<td style="text-align:right;">
0.5118871
</td>
<td style="text-align:right;">
0.4342496
</td>
<td style="text-align:right;">
0.0115156
</td>
<td style="text-align:right;">
0.0018574
</td>
<td style="text-align:right;">
0.5401189
</td>
<td style="text-align:right;">
0.0115156
</td>
<td style="text-align:right;">
3.247222e+01
</td>
<td style="text-align:right;">
2.338000e+02
</td>
<td style="text-align:right;">
3.333333e+01
</td>
<td style="text-align:right;">
2.400000e+02
</td>
<td style="text-align:right;">
0.4673802
</td>
<td style="text-align:right;">
0.3063251
</td>
<td style="text-align:right;">
0.2124277
</td>
<td style="text-align:right;">
0.6696129
</td>
<td style="text-align:right;">
0.3063251
</td>
<td style="text-align:right;">
0.9009690
</td>
<td style="text-align:right;">
2.2001850
</td>
<td style="text-align:right;">
1.4914721
</td>
<td style="text-align:right;">
3.6422059
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
12LD
</td>
<td style="text-align:right;">
3560
</td>
<td style="text-align:right;">
117731
</td>
<td style="text-align:right;">
1764
</td>
<td style="text-align:right;">
316
</td>
<td style="text-align:right;">
35776
</td>
<td style="text-align:right;">
0.0223693
</td>
<td style="text-align:right;">
0.7397626
</td>
<td style="text-align:right;">
0.0110841
</td>
<td style="text-align:right;">
0.0019856
</td>
<td style="text-align:right;">
0.2247985
</td>
<td style="text-align:right;">
12.74758
</td>
<td style="text-align:right;">
285.85343
</td>
<td style="text-align:right;">
355.94915
</td>
<td style="text-align:right;">
26.97636
</td>
<td style="text-align:right;">
12.74758
</td>
<td style="text-align:right;">
0.0198622
</td>
<td style="text-align:right;">
0.0358129
</td>
<td style="text-align:right;">
0.4652537
</td>
<td style="text-align:right;">
0.8388867
</td>
<td style="text-align:right;">
0.1078652
</td>
<td style="text-align:right;">
0.8362360
</td>
<td style="text-align:right;">
0.0230337
</td>
<td style="text-align:right;">
0.0002809
</td>
<td style="text-align:right;">
0.3896067
</td>
<td style="text-align:right;">
0.0230337
</td>
<td style="text-align:right;">
3.586747e+01
</td>
<td style="text-align:right;">
2.977000e+03
</td>
<td style="text-align:right;">
3.685542e+01
</td>
<td style="text-align:right;">
3.059000e+03
</td>
<td style="text-align:right;">
0.6771043
</td>
<td style="text-align:right;">
0.1575680
</td>
<td style="text-align:right;">
0.0985770
</td>
<td style="text-align:right;">
0.6385153
</td>
<td style="text-align:right;">
0.1575680
</td>
<td style="text-align:right;">
2.6434411
</td>
<td style="text-align:right;">
6.8687850
</td>
<td style="text-align:right;">
3.2585927
</td>
<td style="text-align:right;">
8.4672106
</td>
<td style="text-align:right;">
0.7702703
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
13NA
</td>
<td style="text-align:right;">
121602
</td>
<td style="text-align:right;">
1156717
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1221416
</td>
<td style="text-align:right;">
917869
</td>
<td style="text-align:right;">
0.0355811
</td>
<td style="text-align:right;">
0.3384585
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.3573896
</td>
<td style="text-align:right;">
0.2685709
</td>
<td style="text-align:right;">
70.80101
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
22.21206
</td>
<td style="text-align:right;">
41.36664
</td>
<td style="text-align:right;">
70.80101
</td>
<td style="text-align:right;">
3.1875036
</td>
<td style="text-align:right;">
3.1875036
</td>
<td style="text-align:right;">
3.1875036
</td>
<td style="text-align:right;">
3.1875036
</td>
<td style="text-align:right;">
0.4678459
</td>
<td style="text-align:right;">
0.1279338
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4849838
</td>
<td style="text-align:right;">
0.2605385
</td>
<td style="text-align:right;">
0.1279338
</td>
<td style="text-align:right;">
2.637897e-01
</td>
<td style="text-align:right;">
2.637897e-01
</td>
<td style="text-align:right;">
2.637897e-01
</td>
<td style="text-align:right;">
2.637897e-01
</td>
<td style="text-align:right;">
0.2171042
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.3290129
</td>
<td style="text-align:right;">
0.2449840
</td>
<td style="text-align:right;">
0.2171042
</td>
<td style="text-align:right;">
0.6598653
</td>
<td style="text-align:right;">
0.6598653
</td>
<td style="text-align:right;">
0.6598653
</td>
<td style="text-align:right;">
0.6598653
</td>
<td style="text-align:right;">
6.2000000
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
14NB
</td>
<td style="text-align:right;">
97911
</td>
<td style="text-align:right;">
340247
</td>
<td style="text-align:right;">
59025
</td>
<td style="text-align:right;">
167505
</td>
<td style="text-align:right;">
257678
</td>
<td style="text-align:right;">
0.1061520
</td>
<td style="text-align:right;">
0.3688850
</td>
<td style="text-align:right;">
0.0639930
</td>
<td style="text-align:right;">
0.1816036
</td>
<td style="text-align:right;">
0.2793663
</td>
<td style="text-align:right;">
49.22243
</td>
<td style="text-align:right;">
100.58773
</td>
<td style="text-align:right;">
30.48163
</td>
<td style="text-align:right;">
18.51350
</td>
<td style="text-align:right;">
49.22243
</td>
<td style="text-align:right;">
0.3755449
</td>
<td style="text-align:right;">
1.6148228
</td>
<td style="text-align:right;">
1.1429838
</td>
<td style="text-align:right;">
4.9147687
</td>
<td style="text-align:right;">
0.5053671
</td>
<td style="text-align:right;">
0.2540062
</td>
<td style="text-align:right;">
0.0380039
</td>
<td style="text-align:right;">
0.2488995
</td>
<td style="text-align:right;">
0.5430442
</td>
<td style="text-align:right;">
0.0380039
</td>
<td style="text-align:right;">
8.853369e-01
</td>
<td style="text-align:right;">
1.020517e+00
</td>
<td style="text-align:right;">
1.017799e+00
</td>
<td style="text-align:right;">
1.173205e+00
</td>
<td style="text-align:right;">
0.3688258
</td>
<td style="text-align:right;">
0.2567365
</td>
<td style="text-align:right;">
0.4412187
</td>
<td style="text-align:right;">
0.6186197
</td>
<td style="text-align:right;">
0.2567365
</td>
<td style="text-align:right;">
0.5284376
</td>
<td style="text-align:right;">
0.8359251
</td>
<td style="text-align:right;">
0.8962785
</td>
<td style="text-align:right;">
1.4178054
</td>
<td style="text-align:right;">
3.3150685
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
14NC
</td>
<td style="text-align:right;">
11415
</td>
<td style="text-align:right;">
115152
</td>
<td style="text-align:right;">
26633
</td>
<td style="text-align:right;">
17181
</td>
<td style="text-align:right;">
40501
</td>
<td style="text-align:right;">
0.0541298
</td>
<td style="text-align:right;">
0.5460494
</td>
<td style="text-align:right;">
0.1262934
</td>
<td style="text-align:right;">
0.0814721
</td>
<td style="text-align:right;">
0.1920553
</td>
<td style="text-align:right;">
45.49485
</td>
<td style="text-align:right;">
76.76388
</td>
<td style="text-align:right;">
44.46686
</td>
<td style="text-align:right;">
19.26432
</td>
<td style="text-align:right;">
45.49485
</td>
<td style="text-align:right;">
0.3752749
</td>
<td style="text-align:right;">
1.0231182
</td>
<td style="text-align:right;">
1.0084796
</td>
<td style="text-align:right;">
2.7494347
</td>
<td style="text-align:right;">
0.4206746
</td>
<td style="text-align:right;">
0.3935173
</td>
<td style="text-align:right;">
0.1186159
</td>
<td style="text-align:right;">
0.1239597
</td>
<td style="text-align:right;">
0.4955760
</td>
<td style="text-align:right;">
0.1186159
</td>
<td style="text-align:right;">
1.622246e+00
</td>
<td style="text-align:right;">
3.174558e+00
</td>
<td style="text-align:right;">
2.111232e+00
</td>
<td style="text-align:right;">
4.131449e+00
</td>
<td style="text-align:right;">
0.2641293
</td>
<td style="text-align:right;">
0.2184936
</td>
<td style="text-align:right;">
0.3293816
</td>
<td style="text-align:right;">
0.5586074
</td>
<td style="text-align:right;">
0.2184936
</td>
<td style="text-align:right;">
0.4820975
</td>
<td style="text-align:right;">
0.8018944
</td>
<td style="text-align:right;">
0.8808992
</td>
<td style="text-align:right;">
1.4652392
</td>
<td style="text-align:right;">
0.5595238
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
14RD
</td>
<td style="text-align:right;">
2194
</td>
<td style="text-align:right;">
107760
</td>
<td style="text-align:right;">
28128
</td>
<td style="text-align:right;">
18909
</td>
<td style="text-align:right;">
55255
</td>
<td style="text-align:right;">
0.0103371
</td>
<td style="text-align:right;">
0.5077127
</td>
<td style="text-align:right;">
0.1325255
</td>
<td style="text-align:right;">
0.0890900
</td>
<td style="text-align:right;">
0.2603347
</td>
<td style="text-align:right;">
22.18326
</td>
<td style="text-align:right;">
43.27617
</td>
<td style="text-align:right;">
31.50346
</td>
<td style="text-align:right;">
22.40920
</td>
<td style="text-align:right;">
22.18326
</td>
<td style="text-align:right;">
0.2966485
</td>
<td style="text-align:right;">
0.7041532
</td>
<td style="text-align:right;">
0.8753645
</td>
<td style="text-align:right;">
2.0778489
</td>
<td style="text-align:right;">
0.1216955
</td>
<td style="text-align:right;">
0.5000000
</td>
<td style="text-align:right;">
0.1927985
</td>
<td style="text-align:right;">
0.1681860
</td>
<td style="text-align:right;">
0.4799453
</td>
<td style="text-align:right;">
0.1927985
</td>
<td style="text-align:right;">
1.385101e+00
</td>
<td style="text-align:right;">
2.972900e+00
</td>
<td style="text-align:right;">
1.919192e+00
</td>
<td style="text-align:right;">
4.119241e+00
</td>
<td style="text-align:right;">
0.4488902
</td>
<td style="text-align:right;">
0.4014737
</td>
<td style="text-align:right;">
0.4661559
</td>
<td style="text-align:right;">
0.4728975
</td>
<td style="text-align:right;">
0.4014737
</td>
<td style="text-align:right;">
0.5173754
</td>
<td style="text-align:right;">
0.9629616
</td>
<td style="text-align:right;">
0.9801002
</td>
<td style="text-align:right;">
1.8242052
</td>
<td style="text-align:right;">
-0.1666667
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
15LB
</td>
<td style="text-align:right;">
6350
</td>
<td style="text-align:right;">
105525
</td>
<td style="text-align:right;">
20305
</td>
<td style="text-align:right;">
130687
</td>
<td style="text-align:right;">
227056
</td>
<td style="text-align:right;">
0.0129612
</td>
<td style="text-align:right;">
0.2153910
</td>
<td style="text-align:right;">
0.0414453
</td>
<td style="text-align:right;">
0.2667501
</td>
<td style="text-align:right;">
0.4634524
</td>
<td style="text-align:right;">
32.69579
</td>
<td style="text-align:right;">
70.46882
</td>
<td style="text-align:right;">
20.89178
</td>
<td style="text-align:right;">
15.83206
</td>
<td style="text-align:right;">
32.69579
</td>
<td style="text-align:right;">
0.3578762
</td>
<td style="text-align:right;">
1.5650073
</td>
<td style="text-align:right;">
1.1292024
</td>
<td style="text-align:right;">
4.9380478
</td>
<td style="text-align:right;">
0.1064567
</td>
<td style="text-align:right;">
0.2226772
</td>
<td style="text-align:right;">
0.0332283
</td>
<td style="text-align:right;">
0.4615748
</td>
<td style="text-align:right;">
0.6502362
</td>
<td style="text-align:right;">
0.0332283
</td>
<td style="text-align:right;">
4.500318e-01
</td>
<td style="text-align:right;">
4.824292e-01
</td>
<td style="text-align:right;">
5.171865e-01
</td>
<td style="text-align:right;">
5.544183e-01
</td>
<td style="text-align:right;">
0.2963970
</td>
<td style="text-align:right;">
0.2630816
</td>
<td style="text-align:right;">
0.3507861
</td>
<td style="text-align:right;">
0.3456658
</td>
<td style="text-align:right;">
0.2630816
</td>
<td style="text-align:right;">
0.4828352
</td>
<td style="text-align:right;">
0.8449507
</td>
<td style="text-align:right;">
0.9113993
</td>
<td style="text-align:right;">
1.5949281
</td>
<td style="text-align:right;">
3.5000000
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
15NC-D
</td>
<td style="text-align:right;">
3993
</td>
<td style="text-align:right;">
83111
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
99191
</td>
<td style="text-align:right;">
183857
</td>
<td style="text-align:right;">
0.0107875
</td>
<td style="text-align:right;">
0.2245321
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.2679737
</td>
<td style="text-align:right;">
0.4967068
</td>
<td style="text-align:right;">
39.22818
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
23.06369
</td>
<td style="text-align:right;">
22.18943
</td>
<td style="text-align:right;">
39.22818
</td>
<td style="text-align:right;">
1.7008635
</td>
<td style="text-align:right;">
1.7008635
</td>
<td style="text-align:right;">
1.7008635
</td>
<td style="text-align:right;">
1.7008635
</td>
<td style="text-align:right;">
0.1344853
</td>
<td style="text-align:right;">
0.1299775
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.3683947
</td>
<td style="text-align:right;">
0.3005259
</td>
<td style="text-align:right;">
0.1299775
</td>
<td style="text-align:right;">
3.528212e-01
</td>
<td style="text-align:right;">
3.528212e-01
</td>
<td style="text-align:right;">
3.528212e-01
</td>
<td style="text-align:right;">
3.528212e-01
</td>
<td style="text-align:right;">
0.3209594
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4006575
</td>
<td style="text-align:right;">
0.3074837
</td>
<td style="text-align:right;">
0.3209594
</td>
<td style="text-align:right;">
0.8010817
</td>
<td style="text-align:right;">
0.8010817
</td>
<td style="text-align:right;">
0.8010817
</td>
<td style="text-align:right;">
0.8010817
</td>
<td style="text-align:right;">
2.6857143
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
15ND
</td>
<td style="text-align:right;">
1678
</td>
<td style="text-align:right;">
64379
</td>
<td style="text-align:right;">
8785
</td>
<td style="text-align:right;">
16699
</td>
<td style="text-align:right;">
68695
</td>
<td style="text-align:right;">
0.0104721
</td>
<td style="text-align:right;">
0.4017761
</td>
<td style="text-align:right;">
0.0548254
</td>
<td style="text-align:right;">
0.1042150
</td>
<td style="text-align:right;">
0.4287114
</td>
<td style="text-align:right;">
15.54429
</td>
<td style="text-align:right;">
53.43276
</td>
<td style="text-align:right;">
37.28968
</td>
<td style="text-align:right;">
17.33598
</td>
<td style="text-align:right;">
15.54429
</td>
<td style="text-align:right;">
0.1713390
</td>
<td style="text-align:right;">
0.4168524
</td>
<td style="text-align:right;">
0.7603086
</td>
<td style="text-align:right;">
1.8497622
</td>
<td style="text-align:right;">
0.0286055
</td>
<td style="text-align:right;">
0.6025030
</td>
<td style="text-align:right;">
0.0643623
</td>
<td style="text-align:right;">
0.1877235
</td>
<td style="text-align:right;">
0.4928486
</td>
<td style="text-align:right;">
0.0643623
</td>
<td style="text-align:right;">
2.390071e+00
</td>
<td style="text-align:right;">
3.209524e+00
</td>
<td style="text-align:right;">
2.645390e+00
</td>
<td style="text-align:right;">
3.552381e+00
</td>
<td style="text-align:right;">
0.4673145
</td>
<td style="text-align:right;">
0.5587742
</td>
<td style="text-align:right;">
0.5287410
</td>
<td style="text-align:right;">
0.4233763
</td>
<td style="text-align:right;">
0.4673145
</td>
<td style="text-align:right;">
0.4297085
</td>
<td style="text-align:right;">
0.8838250
</td>
<td style="text-align:right;">
0.9435167
</td>
<td style="text-align:right;">
1.9406265
</td>
<td style="text-align:right;">
-0.2285714
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
15RD
</td>
<td style="text-align:right;">
24041
</td>
<td style="text-align:right;">
109825
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
598394
</td>
<td style="text-align:right;">
0.0328312
</td>
<td style="text-align:right;">
0.1499809
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.8171879
</td>
<td style="text-align:right;">
91.07517
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
11.52589
</td>
<td style="text-align:right;">
91.07517
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.2216630
</td>
<td style="text-align:right;">
0.1578969
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.8819101
</td>
<td style="text-align:right;">
0.1578969
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.3102088
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4379530
</td>
<td style="text-align:right;">
0.3102088
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
3.5000000
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
16LA
</td>
<td style="text-align:right;">
12242
</td>
<td style="text-align:right;">
303229
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
267100
</td>
<td style="text-align:right;">
131130
</td>
<td style="text-align:right;">
0.0171528
</td>
<td style="text-align:right;">
0.4248684
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.3742464
</td>
<td style="text-align:right;">
0.1837324
</td>
<td style="text-align:right;">
31.26867
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
19.19006
</td>
<td style="text-align:right;">
27.79750
</td>
<td style="text-align:right;">
31.26867
</td>
<td style="text-align:right;">
1.6294199
</td>
<td style="text-align:right;">
1.6294199
</td>
<td style="text-align:right;">
1.6294199
</td>
<td style="text-align:right;">
1.6294199
</td>
<td style="text-align:right;">
0.3536187
</td>
<td style="text-align:right;">
0.2750368
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4480477
</td>
<td style="text-align:right;">
0.3018298
</td>
<td style="text-align:right;">
0.2750368
</td>
<td style="text-align:right;">
6.138560e-01
</td>
<td style="text-align:right;">
6.138560e-01
</td>
<td style="text-align:right;">
6.138560e-01
</td>
<td style="text-align:right;">
6.138560e-01
</td>
<td style="text-align:right;">
0.1931754
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.2149619
</td>
<td style="text-align:right;">
0.3460849
</td>
<td style="text-align:right;">
0.1931754
</td>
<td style="text-align:right;">
0.8986496
</td>
<td style="text-align:right;">
0.8986496
</td>
<td style="text-align:right;">
0.8986496
</td>
<td style="text-align:right;">
0.8986496
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
16LC
</td>
<td style="text-align:right;">
22907
</td>
<td style="text-align:right;">
229322
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
115205
</td>
<td style="text-align:right;">
112871
</td>
<td style="text-align:right;">
0.0476926
</td>
<td style="text-align:right;">
0.4774508
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.2398580
</td>
<td style="text-align:right;">
0.2349986
</td>
<td style="text-align:right;">
71.64542
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
65.51353
</td>
<td style="text-align:right;">
21.56242
</td>
<td style="text-align:right;">
71.64542
</td>
<td style="text-align:right;">
1.0935973
</td>
<td style="text-align:right;">
1.0935973
</td>
<td style="text-align:right;">
1.0935973
</td>
<td style="text-align:right;">
1.0935973
</td>
<td style="text-align:right;">
0.6542978
</td>
<td style="text-align:right;">
0.2411490
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.1293491
</td>
<td style="text-align:right;">
0.3635133
</td>
<td style="text-align:right;">
0.2411490
</td>
<td style="text-align:right;">
1.864327e+00
</td>
<td style="text-align:right;">
1.864327e+00
</td>
<td style="text-align:right;">
1.864327e+00
</td>
<td style="text-align:right;">
1.864327e+00
</td>
<td style="text-align:right;">
0.0574200
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.0523851
</td>
<td style="text-align:right;">
0.1592857
</td>
<td style="text-align:right;">
0.0574200
</td>
<td style="text-align:right;">
1.0961129
</td>
<td style="text-align:right;">
1.0961129
</td>
<td style="text-align:right;">
1.0961129
</td>
<td style="text-align:right;">
1.0961129
</td>
<td style="text-align:right;">
0.6475410
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
16LD
</td>
<td style="text-align:right;">
69599
</td>
<td style="text-align:right;">
779658
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
905754
</td>
<td style="text-align:right;">
446321
</td>
<td style="text-align:right;">
0.0316168
</td>
<td style="text-align:right;">
0.3541756
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.4114572
</td>
<td style="text-align:right;">
0.2027504
</td>
<td style="text-align:right;">
38.85862
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
19.42446
</td>
<td style="text-align:right;">
22.61613
</td>
<td style="text-align:right;">
38.85862
</td>
<td style="text-align:right;">
2.0004993
</td>
<td style="text-align:right;">
2.0004993
</td>
<td style="text-align:right;">
2.0004993
</td>
<td style="text-align:right;">
2.0004993
</td>
<td style="text-align:right;">
0.2420006
</td>
<td style="text-align:right;">
0.3001624
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4920473
</td>
<td style="text-align:right;">
0.3806520
</td>
<td style="text-align:right;">
0.3001624
</td>
<td style="text-align:right;">
6.100274e-01
</td>
<td style="text-align:right;">
6.100274e-01
</td>
<td style="text-align:right;">
6.100274e-01
</td>
<td style="text-align:right;">
6.100274e-01
</td>
<td style="text-align:right;">
0.4547154
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4828520
</td>
<td style="text-align:right;">
0.6091481
</td>
<td style="text-align:right;">
0.4547154
</td>
<td style="text-align:right;">
0.9417283
</td>
<td style="text-align:right;">
0.9417283
</td>
<td style="text-align:right;">
0.9417283
</td>
<td style="text-align:right;">
0.9417283
</td>
<td style="text-align:right;">
1.9151786
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
16ND
</td>
<td style="text-align:right;">
137787
</td>
<td style="text-align:right;">
687621
</td>
<td style="text-align:right;">
242704
</td>
<td style="text-align:right;">
572319
</td>
<td style="text-align:right;">
188661
</td>
<td style="text-align:right;">
0.0753308
</td>
<td style="text-align:right;">
0.3759357
</td>
<td style="text-align:right;">
0.1326910
</td>
<td style="text-align:right;">
0.3128979
</td>
<td style="text-align:right;">
0.1031446
</td>
<td style="text-align:right;">
29.84045
</td>
<td style="text-align:right;">
40.34701
</td>
<td style="text-align:right;">
26.33421
</td>
<td style="text-align:right;">
47.06903
</td>
<td style="text-align:right;">
29.84045
</td>
<td style="text-align:right;">
0.4475090
</td>
<td style="text-align:right;">
1.1331438
</td>
<td style="text-align:right;">
1.0525821
</td>
<td style="text-align:right;">
2.6652576
</td>
<td style="text-align:right;">
0.4492659
</td>
<td style="text-align:right;">
0.2842939
</td>
<td style="text-align:right;">
0.0509409
</td>
<td style="text-align:right;">
0.3098188
</td>
<td style="text-align:right;">
0.0600419
</td>
<td style="text-align:right;">
0.0509409
</td>
<td style="text-align:right;">
7.880422e-01
</td>
<td style="text-align:right;">
9.176134e-01
</td>
<td style="text-align:right;">
9.292468e-01
</td>
<td style="text-align:right;">
1.082035e+00
</td>
<td style="text-align:right;">
0.4245758
</td>
<td style="text-align:right;">
0.4176264
</td>
<td style="text-align:right;">
0.4836524
</td>
<td style="text-align:right;">
0.3800594
</td>
<td style="text-align:right;">
0.4176264
</td>
<td style="text-align:right;">
0.4710815
</td>
<td style="text-align:right;">
0.8778531
</td>
<td style="text-align:right;">
0.9344524
</td>
<td style="text-align:right;">
1.7413377
</td>
<td style="text-align:right;">
1.0745763
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
16RD
</td>
<td style="text-align:right;">
22697
</td>
<td style="text-align:right;">
179849
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
372829
</td>
<td style="text-align:right;">
165181
</td>
<td style="text-align:right;">
0.0306486
</td>
<td style="text-align:right;">
0.2428567
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.5034447
</td>
<td style="text-align:right;">
0.2230500
</td>
<td style="text-align:right;">
56.31604
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
16.51236
</td>
<td style="text-align:right;">
34.65626
</td>
<td style="text-align:right;">
56.31604
</td>
<td style="text-align:right;">
3.4105390
</td>
<td style="text-align:right;">
3.4105390
</td>
<td style="text-align:right;">
3.4105390
</td>
<td style="text-align:right;">
3.4105390
</td>
<td style="text-align:right;">
0.2959863
</td>
<td style="text-align:right;">
0.2354937
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.6114905
</td>
<td style="text-align:right;">
0.2825043
</td>
<td style="text-align:right;">
0.2354937
</td>
<td style="text-align:right;">
3.851142e-01
</td>
<td style="text-align:right;">
3.851142e-01
</td>
<td style="text-align:right;">
3.851142e-01
</td>
<td style="text-align:right;">
3.851142e-01
</td>
<td style="text-align:right;">
0.3006802
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4041937
</td>
<td style="text-align:right;">
0.3873276
</td>
<td style="text-align:right;">
0.3006802
</td>
<td style="text-align:right;">
0.7439011
</td>
<td style="text-align:right;">
0.7439011
</td>
<td style="text-align:right;">
0.7439011
</td>
<td style="text-align:right;">
0.7439011
</td>
<td style="text-align:right;">
-0.1027397
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
17NA
</td>
<td style="text-align:right;">
114939
</td>
<td style="text-align:right;">
444216
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1252644
</td>
<td style="text-align:right;">
619810
</td>
<td style="text-align:right;">
0.0472687
</td>
<td style="text-align:right;">
0.1826840
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.5151503
</td>
<td style="text-align:right;">
0.2548971
</td>
<td style="text-align:right;">
61.86642
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
22.48160
</td>
<td style="text-align:right;">
21.57101
</td>
<td style="text-align:right;">
61.86642
</td>
<td style="text-align:right;">
2.7518686
</td>
<td style="text-align:right;">
2.7518686
</td>
<td style="text-align:right;">
2.7518686
</td>
<td style="text-align:right;">
2.7518686
</td>
<td style="text-align:right;">
0.3757123
</td>
<td style="text-align:right;">
0.0907525
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.3861962
</td>
<td style="text-align:right;">
0.5524496
</td>
<td style="text-align:right;">
0.0907525
</td>
<td style="text-align:right;">
2.349907e-01
</td>
<td style="text-align:right;">
2.349907e-01
</td>
<td style="text-align:right;">
2.349907e-01
</td>
<td style="text-align:right;">
2.349907e-01
</td>
<td style="text-align:right;">
0.2549486
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.2843224
</td>
<td style="text-align:right;">
0.5770821
</td>
<td style="text-align:right;">
0.2549486
</td>
<td style="text-align:right;">
0.8966884
</td>
<td style="text-align:right;">
0.8966884
</td>
<td style="text-align:right;">
0.8966884
</td>
<td style="text-align:right;">
0.8966884
</td>
<td style="text-align:right;">
6.8000000
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
17ND
</td>
<td style="text-align:right;">
13298
</td>
<td style="text-align:right;">
62937
</td>
<td style="text-align:right;">
203
</td>
<td style="text-align:right;">
1332
</td>
<td style="text-align:right;">
41466
</td>
<td style="text-align:right;">
0.1115267
</td>
<td style="text-align:right;">
0.5278356
</td>
<td style="text-align:right;">
0.0017025
</td>
<td style="text-align:right;">
0.0111711
</td>
<td style="text-align:right;">
0.3477641
</td>
<td style="text-align:right;">
15.06388
</td>
<td style="text-align:right;">
232.02438
</td>
<td style="text-align:right;">
111.85371
</td>
<td style="text-align:right;">
18.01790
</td>
<td style="text-align:right;">
15.06388
</td>
<td style="text-align:right;">
0.0438059
</td>
<td style="text-align:right;">
0.1346748
</td>
<td style="text-align:right;">
0.7185345
</td>
<td style="text-align:right;">
2.2090306
</td>
<td style="text-align:right;">
0.3246353
</td>
<td style="text-align:right;">
0.6664160
</td>
<td style="text-align:right;">
0.0003008
</td>
<td style="text-align:right;">
0.0029328
</td>
<td style="text-align:right;">
0.4851857
</td>
<td style="text-align:right;">
0.0003008
</td>
<td style="text-align:right;">
2.060930e+02
</td>
<td style="text-align:right;">
2.272308e+02
</td>
<td style="text-align:right;">
2.061860e+02
</td>
<td style="text-align:right;">
2.273333e+02
</td>
<td style="text-align:right;">
0.7675142
</td>
<td style="text-align:right;">
0.1896339
</td>
<td style="text-align:right;">
0.4520953
</td>
<td style="text-align:right;">
0.7379279
</td>
<td style="text-align:right;">
0.1896339
</td>
<td style="text-align:right;">
1.1960095
</td>
<td style="text-align:right;">
1.6976822
</td>
<td style="text-align:right;">
1.4915140
</td>
<td style="text-align:right;">
2.1171378
</td>
<td style="text-align:right;">
-0.3846154
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
17RB
</td>
<td style="text-align:right;">
85774
</td>
<td style="text-align:right;">
1378423
</td>
<td style="text-align:right;">
250877
</td>
<td style="text-align:right;">
112621
</td>
<td style="text-align:right;">
258890
</td>
<td style="text-align:right;">
0.0411074
</td>
<td style="text-align:right;">
0.6606120
</td>
<td style="text-align:right;">
0.1202333
</td>
<td style="text-align:right;">
0.0539738
</td>
<td style="text-align:right;">
0.1240735
</td>
<td style="text-align:right;">
16.70828
</td>
<td style="text-align:right;">
88.48121
</td>
<td style="text-align:right;">
95.13230
</td>
<td style="text-align:right;">
35.71473
</td>
<td style="text-align:right;">
16.70828
</td>
<td style="text-align:right;">
0.0909970
</td>
<td style="text-align:right;">
0.1756320
</td>
<td style="text-align:right;">
0.5728853
</td>
<td style="text-align:right;">
1.1057178
</td>
<td style="text-align:right;">
0.3890573
</td>
<td style="text-align:right;">
0.6275561
</td>
<td style="text-align:right;">
0.0788001
</td>
<td style="text-align:right;">
0.0414694
</td>
<td style="text-align:right;">
0.2133747
</td>
<td style="text-align:right;">
0.0788001
</td>
<td style="text-align:right;">
5.217914e+00
</td>
<td style="text-align:right;">
1.513298e+01
</td>
<td style="text-align:right;">
5.873110e+00
</td>
<td style="text-align:right;">
1.703317e+01
</td>
<td style="text-align:right;">
0.3863508
</td>
<td style="text-align:right;">
0.2759967
</td>
<td style="text-align:right;">
0.2356124
</td>
<td style="text-align:right;">
0.4572544
</td>
<td style="text-align:right;">
0.2759967
</td>
<td style="text-align:right;">
0.7551678
</td>
<td style="text-align:right;">
1.6397723
</td>
<td style="text-align:right;">
1.2946357
</td>
<td style="text-align:right;">
2.8111736
</td>
<td style="text-align:right;">
8.2142857
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
2N
</td>
<td style="text-align:right;">
109694
</td>
<td style="text-align:right;">
1143016
</td>
<td style="text-align:right;">
335772
</td>
<td style="text-align:right;">
714690
</td>
<td style="text-align:right;">
1340651
</td>
<td style="text-align:right;">
0.0301041
</td>
<td style="text-align:right;">
0.3136859
</td>
<td style="text-align:right;">
0.0921483
</td>
<td style="text-align:right;">
0.1961374
</td>
<td style="text-align:right;">
0.3679243
</td>
<td style="text-align:right;">
47.77260
</td>
<td style="text-align:right;">
87.60001
</td>
<td style="text-align:right;">
35.15413
</td>
<td style="text-align:right;">
19.20262
</td>
<td style="text-align:right;">
47.77260
</td>
<td style="text-align:right;">
0.3891730
</td>
<td style="text-align:right;">
1.3589470
</td>
<td style="text-align:right;">
1.1027947
</td>
<td style="text-align:right;">
3.8508309
</td>
<td style="text-align:right;">
0.3846518
</td>
<td style="text-align:right;">
0.2826408
</td>
<td style="text-align:right;">
0.0808522
</td>
<td style="text-align:right;">
0.2448721
</td>
<td style="text-align:right;">
0.5902966
</td>
<td style="text-align:right;">
0.0808522
</td>
<td style="text-align:right;">
8.677302e-01
</td>
<td style="text-align:right;">
1.154238e+00
</td>
<td style="text-align:right;">
1.115953e+00
</td>
<td style="text-align:right;">
1.484420e+00
</td>
<td style="text-align:right;">
0.3491878
</td>
<td style="text-align:right;">
0.2388853
</td>
<td style="text-align:right;">
0.3133452
</td>
<td style="text-align:right;">
0.4562766
</td>
<td style="text-align:right;">
0.2388853
</td>
<td style="text-align:right;">
0.6323226
</td>
<td style="text-align:right;">
1.1143872
</td>
<td style="text-align:right;">
1.0649053
</td>
<td style="text-align:right;">
1.8767583
</td>
<td style="text-align:right;">
11.7000000
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
2RA
</td>
<td style="text-align:right;">
24008
</td>
<td style="text-align:right;">
120410
</td>
<td style="text-align:right;">
473
</td>
<td style="text-align:right;">
10966
</td>
<td style="text-align:right;">
123894
</td>
<td style="text-align:right;">
0.0858192
</td>
<td style="text-align:right;">
0.4304185
</td>
<td style="text-align:right;">
0.0016908
</td>
<td style="text-align:right;">
0.0391991
</td>
<td style="text-align:right;">
0.4428724
</td>
<td style="text-align:right;">
44.80857
</td>
<td style="text-align:right;">
534.05443
</td>
<td style="text-align:right;">
132.80795
</td>
<td style="text-align:right;">
15.31048
</td>
<td style="text-align:right;">
44.80857
</td>
<td style="text-align:right;">
0.0671931
</td>
<td style="text-align:right;">
0.3373938
</td>
<td style="text-align:right;">
0.8680397
</td>
<td style="text-align:right;">
4.3586471
</td>
<td style="text-align:right;">
0.3464678
</td>
<td style="text-align:right;">
0.4371043
</td>
<td style="text-align:right;">
0.0009580
</td>
<td style="text-align:right;">
0.0452766
</td>
<td style="text-align:right;">
0.6856881
</td>
<td style="text-align:right;">
0.0009580
</td>
<td style="text-align:right;">
9.454054e+00
</td>
<td style="text-align:right;">
9.654094e+00
</td>
<td style="text-align:right;">
9.474775e+00
</td>
<td style="text-align:right;">
9.675253e+00
</td>
<td style="text-align:right;">
0.5644597
</td>
<td style="text-align:right;">
0.0274858
</td>
<td style="text-align:right;">
0.2713765
</td>
<td style="text-align:right;">
0.7331093
</td>
<td style="text-align:right;">
0.0274858
</td>
<td style="text-align:right;">
1.8886952
</td>
<td style="text-align:right;">
2.0799877
</td>
<td style="text-align:right;">
1.9806633
</td>
<td style="text-align:right;">
2.1812706
</td>
<td style="text-align:right;">
3.5428571
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
2RD
</td>
<td style="text-align:right;">
31061
</td>
<td style="text-align:right;">
111306
</td>
<td style="text-align:right;">
51141
</td>
<td style="text-align:right;">
76195
</td>
<td style="text-align:right;">
148799
</td>
<td style="text-align:right;">
0.0742195
</td>
<td style="text-align:right;">
0.2659629
</td>
<td style="text-align:right;">
0.1222001
</td>
<td style="text-align:right;">
0.1820660
</td>
<td style="text-align:right;">
0.3555515
</td>
<td style="text-align:right;">
38.61221
</td>
<td style="text-align:right;">
73.15221
</td>
<td style="text-align:right;">
27.66634
</td>
<td style="text-align:right;">
21.62384
</td>
<td style="text-align:right;">
38.61221
</td>
<td style="text-align:right;">
0.3829872
</td>
<td style="text-align:right;">
1.3956389
</td>
<td style="text-align:right;">
1.1085701
</td>
<td style="text-align:right;">
4.0397263
</td>
<td style="text-align:right;">
0.3219793
</td>
<td style="text-align:right;">
0.1979009
</td>
<td style="text-align:right;">
0.1740124
</td>
<td style="text-align:right;">
0.2492193
</td>
<td style="text-align:right;">
0.5216188
</td>
<td style="text-align:right;">
0.1740124
</td>
<td style="text-align:right;">
4.675947e-01
</td>
<td style="text-align:right;">
7.940835e-01
</td>
<td style="text-align:right;">
8.787464e-01
</td>
<td style="text-align:right;">
1.492314e+00
</td>
<td style="text-align:right;">
0.5678202
</td>
<td style="text-align:right;">
0.4565483
</td>
<td style="text-align:right;">
0.5544826
</td>
<td style="text-align:right;">
0.5877279
</td>
<td style="text-align:right;">
0.4565483
</td>
<td style="text-align:right;">
0.5616249
</td>
<td style="text-align:right;">
1.0240540
</td>
<td style="text-align:right;">
1.0131920
</td>
<td style="text-align:right;">
1.8474310
</td>
<td style="text-align:right;">
20.0000000
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
3LA
</td>
<td style="text-align:right;">
83808
</td>
<td style="text-align:right;">
623759
</td>
<td style="text-align:right;">
232788
</td>
<td style="text-align:right;">
157121
</td>
<td style="text-align:right;">
480097
</td>
<td style="text-align:right;">
0.0531246
</td>
<td style="text-align:right;">
0.3953915
</td>
<td style="text-align:right;">
0.1475608
</td>
<td style="text-align:right;">
0.0995967
</td>
<td style="text-align:right;">
0.3043263
</td>
<td style="text-align:right;">
46.09601
</td>
<td style="text-align:right;">
104.05573
</td>
<td style="text-align:right;">
65.98973
</td>
<td style="text-align:right;">
41.88896
</td>
<td style="text-align:right;">
46.09601
</td>
<td style="text-align:right;">
0.2710805
</td>
<td style="text-align:right;">
0.6985331
</td>
<td style="text-align:right;">
0.8830094
</td>
<td style="text-align:right;">
2.2753805
</td>
<td style="text-align:right;">
0.4243628
</td>
<td style="text-align:right;">
0.2865240
</td>
<td style="text-align:right;">
0.0929863
</td>
<td style="text-align:right;">
0.0477520
</td>
<td style="text-align:right;">
0.2387958
</td>
<td style="text-align:right;">
0.0929863
</td>
<td style="text-align:right;">
2.035863e+00
</td>
<td style="text-align:right;">
6.000250e+00
</td>
<td style="text-align:right;">
2.696566e+00
</td>
<td style="text-align:right;">
7.947526e+00
</td>
<td style="text-align:right;">
0.3332982
</td>
<td style="text-align:right;">
0.3041986
</td>
<td style="text-align:right;">
0.2997380
</td>
<td style="text-align:right;">
0.3192354
</td>
<td style="text-align:right;">
0.3041986
</td>
<td style="text-align:right;">
0.5518761
</td>
<td style="text-align:right;">
1.1119649
</td>
<td style="text-align:right;">
1.0555690
</td>
<td style="text-align:right;">
2.1268463
</td>
<td style="text-align:right;">
3.0000000
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
3NB
</td>
<td style="text-align:right;">
98748
</td>
<td style="text-align:right;">
168767
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
15223
</td>
<td style="text-align:right;">
73972
</td>
<td style="text-align:right;">
0.2768299
</td>
<td style="text-align:right;">
0.4731210
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0426761
</td>
<td style="text-align:right;">
0.2073729
</td>
<td style="text-align:right;">
32.31159
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
62.64161
</td>
<td style="text-align:right;">
29.70786
</td>
<td style="text-align:right;">
32.31159
</td>
<td style="text-align:right;">
0.5158168
</td>
<td style="text-align:right;">
0.5158168
</td>
<td style="text-align:right;">
0.5158168
</td>
<td style="text-align:right;">
0.5158168
</td>
<td style="text-align:right;">
0.7233868
</td>
<td style="text-align:right;">
0.4377911
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.0275246
</td>
<td style="text-align:right;">
0.2218779
</td>
<td style="text-align:right;">
0.4377911
</td>
<td style="text-align:right;">
1.590545e+01
</td>
<td style="text-align:right;">
1.590545e+01
</td>
<td style="text-align:right;">
1.590545e+01
</td>
<td style="text-align:right;">
1.590545e+01
</td>
<td style="text-align:right;">
0.6371794
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4947252
</td>
<td style="text-align:right;">
0.6142263
</td>
<td style="text-align:right;">
0.6371794
</td>
<td style="text-align:right;">
1.2879462
</td>
<td style="text-align:right;">
1.2879462
</td>
<td style="text-align:right;">
1.2879462
</td>
<td style="text-align:right;">
1.2879462
</td>
<td style="text-align:right;">
0.0245902
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
3RB
</td>
<td style="text-align:right;">
43810
</td>
<td style="text-align:right;">
717597
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
625176
</td>
<td style="text-align:right;">
256989
</td>
<td style="text-align:right;">
0.0266554
</td>
<td style="text-align:right;">
0.4366082
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.3803764
</td>
<td style="text-align:right;">
0.1563600
</td>
<td style="text-align:right;">
42.63162
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
29.99254
</td>
<td style="text-align:right;">
46.16097
</td>
<td style="text-align:right;">
42.63162
</td>
<td style="text-align:right;">
1.4214077
</td>
<td style="text-align:right;">
1.4214077
</td>
<td style="text-align:right;">
1.4214077
</td>
<td style="text-align:right;">
1.4214077
</td>
<td style="text-align:right;">
0.1779959
</td>
<td style="text-align:right;">
0.2910751
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.3592331
</td>
<td style="text-align:right;">
0.2055695
</td>
<td style="text-align:right;">
0.2910751
</td>
<td style="text-align:right;">
8.102681e-01
</td>
<td style="text-align:right;">
8.102681e-01
</td>
<td style="text-align:right;">
8.102681e-01
</td>
<td style="text-align:right;">
8.102681e-01
</td>
<td style="text-align:right;">
0.3543015
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4120032
</td>
<td style="text-align:right;">
0.4057485
</td>
<td style="text-align:right;">
0.3543015
</td>
<td style="text-align:right;">
0.8599486
</td>
<td style="text-align:right;">
0.8599486
</td>
<td style="text-align:right;">
0.8599486
</td>
<td style="text-align:right;">
0.8599486
</td>
<td style="text-align:right;">
7.6857143
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
3RC
</td>
<td style="text-align:right;">
11691
</td>
<td style="text-align:right;">
195683
</td>
<td style="text-align:right;">
58422
</td>
<td style="text-align:right;">
76220
</td>
<td style="text-align:right;">
161604
</td>
<td style="text-align:right;">
0.0232139
</td>
<td style="text-align:right;">
0.3885529
</td>
<td style="text-align:right;">
0.1160041
</td>
<td style="text-align:right;">
0.1513443
</td>
<td style="text-align:right;">
0.3208848
</td>
<td style="text-align:right;">
32.11938
</td>
<td style="text-align:right;">
55.92834
</td>
<td style="text-align:right;">
37.32758
</td>
<td style="text-align:right;">
27.31100
</td>
<td style="text-align:right;">
32.11938
</td>
<td style="text-align:right;">
0.3444219
</td>
<td style="text-align:right;">
0.8604733
</td>
<td style="text-align:right;">
0.9441516
</td>
<td style="text-align:right;">
2.3587846
</td>
<td style="text-align:right;">
0.2039175
</td>
<td style="text-align:right;">
0.2962108
</td>
<td style="text-align:right;">
0.0879309
</td>
<td style="text-align:right;">
0.2004961
</td>
<td style="text-align:right;">
0.3165683
</td>
<td style="text-align:right;">
0.0879309
</td>
<td style="text-align:right;">
1.026987e+00
</td>
<td style="text-align:right;">
1.477389e+00
</td>
<td style="text-align:right;">
1.331851e+00
</td>
<td style="text-align:right;">
1.915956e+00
</td>
<td style="text-align:right;">
0.3811222
</td>
<td style="text-align:right;">
0.3788413
</td>
<td style="text-align:right;">
0.4385962
</td>
<td style="text-align:right;">
0.3814209
</td>
<td style="text-align:right;">
0.3788413
</td>
<td style="text-align:right;">
0.4662403
</td>
<td style="text-align:right;">
0.8689593
</td>
<td style="text-align:right;">
0.9296901
</td>
<td style="text-align:right;">
1.7327180
</td>
<td style="text-align:right;">
5.5428571
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
4LB
</td>
<td style="text-align:right;">
37888
</td>
<td style="text-align:right;">
542224
</td>
<td style="text-align:right;">
163326
</td>
<td style="text-align:right;">
231943
</td>
<td style="text-align:right;">
574396
</td>
<td style="text-align:right;">
0.0244474
</td>
<td style="text-align:right;">
0.3498723
</td>
<td style="text-align:right;">
0.1053868
</td>
<td style="text-align:right;">
0.1496622
</td>
<td style="text-align:right;">
0.3706314
</td>
<td style="text-align:right;">
30.99117
</td>
<td style="text-align:right;">
57.04930
</td>
<td style="text-align:right;">
28.06937
</td>
<td style="text-align:right;">
16.66993
</td>
<td style="text-align:right;">
30.99117
</td>
<td style="text-align:right;">
0.3640937
</td>
<td style="text-align:right;">
1.1040920
</td>
<td style="text-align:right;">
1.0343262
</td>
<td style="text-align:right;">
3.1365315
</td>
<td style="text-align:right;">
0.2172720
</td>
<td style="text-align:right;">
0.2903294
</td>
<td style="text-align:right;">
0.1223870
</td>
<td style="text-align:right;">
0.2381757
</td>
<td style="text-align:right;">
0.5714738
</td>
<td style="text-align:right;">
0.1223870
</td>
<td style="text-align:right;">
8.052119e-01
</td>
<td style="text-align:right;">
1.218972e+00
</td>
<td style="text-align:right;">
1.144645e+00
</td>
<td style="text-align:right;">
1.732824e+00
</td>
<td style="text-align:right;">
0.4265239
</td>
<td style="text-align:right;">
0.4040558
</td>
<td style="text-align:right;">
0.5049626
</td>
<td style="text-align:right;">
0.5312531
</td>
<td style="text-align:right;">
0.4040558
</td>
<td style="text-align:right;">
0.4692137
</td>
<td style="text-align:right;">
0.8446643
</td>
<td style="text-align:right;">
0.9137105
</td>
<td style="text-align:right;">
1.6448340
</td>
<td style="text-align:right;">
6.8783784
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
4NC
</td>
<td style="text-align:right;">
4456
</td>
<td style="text-align:right;">
396164
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
96651
</td>
<td style="text-align:right;">
50231
</td>
<td style="text-align:right;">
0.0081388
</td>
<td style="text-align:right;">
0.7235846
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.1765309
</td>
<td style="text-align:right;">
0.0917458
</td>
<td style="text-align:right;">
15.33106
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
30.68159
</td>
<td style="text-align:right;">
155.44956
</td>
<td style="text-align:right;">
15.33106
</td>
<td style="text-align:right;">
0.4996826
</td>
<td style="text-align:right;">
0.4996826
</td>
<td style="text-align:right;">
0.4996826
</td>
<td style="text-align:right;">
0.4996826
</td>
<td style="text-align:right;">
0.2675045
</td>
<td style="text-align:right;">
0.6851436
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.2188061
</td>
<td style="text-align:right;">
0.0832585
</td>
<td style="text-align:right;">
0.6851436
</td>
<td style="text-align:right;">
3.131282e+00
</td>
<td style="text-align:right;">
3.131282e+00
</td>
<td style="text-align:right;">
3.131282e+00
</td>
<td style="text-align:right;">
3.131282e+00
</td>
<td style="text-align:right;">
0.0848612
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.0807651
</td>
<td style="text-align:right;">
0.0586587
</td>
<td style="text-align:right;">
0.0848612
</td>
<td style="text-align:right;">
1.0507163
</td>
<td style="text-align:right;">
1.0507163
</td>
<td style="text-align:right;">
1.0507163
</td>
<td style="text-align:right;">
1.0507163
</td>
<td style="text-align:right;">
3.0000000
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
4ND
</td>
<td style="text-align:right;">
4010
</td>
<td style="text-align:right;">
198640
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
265301
</td>
<td style="text-align:right;">
57984
</td>
<td style="text-align:right;">
0.0076245
</td>
<td style="text-align:right;">
0.3776893
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.5044369
</td>
<td style="text-align:right;">
0.1102494
</td>
<td style="text-align:right;">
20.75556
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
14.30657
</td>
<td style="text-align:right;">
39.67271
</td>
<td style="text-align:right;">
20.75556
</td>
<td style="text-align:right;">
1.4507707
</td>
<td style="text-align:right;">
1.4507707
</td>
<td style="text-align:right;">
1.4507707
</td>
<td style="text-align:right;">
1.4507707
</td>
<td style="text-align:right;">
0.0356608
</td>
<td style="text-align:right;">
0.4768080
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.7169576
</td>
<td style="text-align:right;">
0.1271820
</td>
<td style="text-align:right;">
0.4768080
</td>
<td style="text-align:right;">
6.650435e-01
</td>
<td style="text-align:right;">
6.650435e-01
</td>
<td style="text-align:right;">
6.650435e-01
</td>
<td style="text-align:right;">
6.650435e-01
</td>
<td style="text-align:right;">
0.4041773
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4329954
</td>
<td style="text-align:right;">
0.3409348
</td>
<td style="text-align:right;">
0.4041773
</td>
<td style="text-align:right;">
0.9334448
</td>
<td style="text-align:right;">
0.9334448
</td>
<td style="text-align:right;">
0.9334448
</td>
<td style="text-align:right;">
0.9334448
</td>
<td style="text-align:right;">
4.3000000
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
4RB
</td>
<td style="text-align:right;">
69477
</td>
<td style="text-align:right;">
752029
</td>
<td style="text-align:right;">
407898
</td>
<td style="text-align:right;">
556391
</td>
<td style="text-align:right;">
694672
</td>
<td style="text-align:right;">
0.0280096
</td>
<td style="text-align:right;">
0.3031804
</td>
<td style="text-align:right;">
0.1644440
</td>
<td style="text-align:right;">
0.2243090
</td>
<td style="text-align:right;">
0.2800569
</td>
<td style="text-align:right;">
53.31478
</td>
<td style="text-align:right;">
62.79761
</td>
<td style="text-align:right;">
25.09420
</td>
<td style="text-align:right;">
28.66758
</td>
<td style="text-align:right;">
53.31478
</td>
<td style="text-align:right;">
0.6065954
</td>
<td style="text-align:right;">
2.1245853
</td>
<td style="text-align:right;">
1.3210831
</td>
<td style="text-align:right;">
4.6270602
</td>
<td style="text-align:right;">
0.3672294
</td>
<td style="text-align:right;">
0.1765476
</td>
<td style="text-align:right;">
0.1182837
</td>
<td style="text-align:right;">
0.3346431
</td>
<td style="text-align:right;">
0.3210703
</td>
<td style="text-align:right;">
0.1182837
</td>
<td style="text-align:right;">
3.897928e-01
</td>
<td style="text-align:right;">
5.275699e-01
</td>
<td style="text-align:right;">
6.509470e-01
</td>
<td style="text-align:right;">
8.810323e-01
</td>
<td style="text-align:right;">
0.2509451
</td>
<td style="text-align:right;">
0.2272416
</td>
<td style="text-align:right;">
0.3686740
</td>
<td style="text-align:right;">
0.3511422
</td>
<td style="text-align:right;">
0.2272416
</td>
<td style="text-align:right;">
0.4211084
</td>
<td style="text-align:right;">
0.6806694
</td>
<td style="text-align:right;">
0.8024403
</td>
<td style="text-align:right;">
1.2970449
</td>
<td style="text-align:right;">
7.8108108
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
5LA
</td>
<td style="text-align:right;">
30482
</td>
<td style="text-align:right;">
234195
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
320467
</td>
<td style="text-align:right;">
86337
</td>
<td style="text-align:right;">
0.0453952
</td>
<td style="text-align:right;">
0.3487738
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.4772540
</td>
<td style="text-align:right;">
0.1285770
</td>
<td style="text-align:right;">
41.12871
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
15.84267
</td>
<td style="text-align:right;">
35.17202
</td>
<td style="text-align:right;">
41.12871
</td>
<td style="text-align:right;">
2.5960728
</td>
<td style="text-align:right;">
2.5960728
</td>
<td style="text-align:right;">
2.5960728
</td>
<td style="text-align:right;">
2.5960728
</td>
<td style="text-align:right;">
0.3901975
</td>
<td style="text-align:right;">
0.2471295
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.5824421
</td>
<td style="text-align:right;">
0.1998228
</td>
<td style="text-align:right;">
0.2471295
</td>
<td style="text-align:right;">
4.242987e-01
</td>
<td style="text-align:right;">
4.242987e-01
</td>
<td style="text-align:right;">
4.242987e-01
</td>
<td style="text-align:right;">
4.242987e-01
</td>
<td style="text-align:right;">
0.2946212
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4144137
</td>
<td style="text-align:right;">
0.4699263
</td>
<td style="text-align:right;">
0.2946212
</td>
<td style="text-align:right;">
0.7109351
</td>
<td style="text-align:right;">
0.7109351
</td>
<td style="text-align:right;">
0.7109351
</td>
<td style="text-align:right;">
0.7109351
</td>
<td style="text-align:right;">
0.5000000
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
5LB
</td>
<td style="text-align:right;">
7634
</td>
<td style="text-align:right;">
139335
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
149118
</td>
<td style="text-align:right;">
0.0257830
</td>
<td style="text-align:right;">
0.4705880
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.5036290
</td>
<td style="text-align:right;">
41.91177
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
15.05867
</td>
<td style="text-align:right;">
41.91177
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.3379618
</td>
<td style="text-align:right;">
0.2807178
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.6502489
</td>
<td style="text-align:right;">
0.2807178
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.3399551
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4551737
</td>
<td style="text-align:right;">
0.3399551
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4.0000000
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
5LC
</td>
<td style="text-align:right;">
93441
</td>
<td style="text-align:right;">
516380
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
833223
</td>
<td style="text-align:right;">
371152
</td>
<td style="text-align:right;">
0.0515055
</td>
<td style="text-align:right;">
0.2846330
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.4592795
</td>
<td style="text-align:right;">
0.2045821
</td>
<td style="text-align:right;">
82.68448
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
23.56636
</td>
<td style="text-align:right;">
61.02936
</td>
<td style="text-align:right;">
82.68448
</td>
<td style="text-align:right;">
3.5085804
</td>
<td style="text-align:right;">
3.5085804
</td>
<td style="text-align:right;">
3.5085804
</td>
<td style="text-align:right;">
3.5085804
</td>
<td style="text-align:right;">
0.5297032
</td>
<td style="text-align:right;">
0.1168545
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4516540
</td>
<td style="text-align:right;">
0.1066662
</td>
<td style="text-align:right;">
0.1168545
</td>
<td style="text-align:right;">
2.587257e-01
</td>
<td style="text-align:right;">
2.587257e-01
</td>
<td style="text-align:right;">
2.587257e-01
</td>
<td style="text-align:right;">
2.587257e-01
</td>
<td style="text-align:right;">
0.1430094
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.2947895
</td>
<td style="text-align:right;">
0.1798944
</td>
<td style="text-align:right;">
0.1430094
</td>
<td style="text-align:right;">
0.4851237
</td>
<td style="text-align:right;">
0.4851237
</td>
<td style="text-align:right;">
0.4851237
</td>
<td style="text-align:right;">
0.4851237
</td>
<td style="text-align:right;">
3.5000000
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
5LD
</td>
<td style="text-align:right;">
25942
</td>
<td style="text-align:right;">
176986
</td>
<td style="text-align:right;">
7127
</td>
<td style="text-align:right;">
54197
</td>
<td style="text-align:right;">
480977
</td>
<td style="text-align:right;">
0.0348108
</td>
<td style="text-align:right;">
0.2374921
</td>
<td style="text-align:right;">
0.0095635
</td>
<td style="text-align:right;">
0.0727253
</td>
<td style="text-align:right;">
0.6454083
</td>
<td style="text-align:right;">
91.41539
</td>
<td style="text-align:right;">
174.12079
</td>
<td style="text-align:right;">
36.47074
</td>
<td style="text-align:right;">
28.68030
</td>
<td style="text-align:right;">
91.41539
</td>
<td style="text-align:right;">
0.4340886
</td>
<td style="text-align:right;">
2.5065407
</td>
<td style="text-align:right;">
1.2609063
</td>
<td style="text-align:right;">
7.2808006
</td>
<td style="text-align:right;">
0.4943721
</td>
<td style="text-align:right;">
0.0735101
</td>
<td style="text-align:right;">
0.0027369
</td>
<td style="text-align:right;">
0.1400046
</td>
<td style="text-align:right;">
0.2530645
</td>
<td style="text-align:right;">
0.0027369
</td>
<td style="text-align:right;">
5.149878e-01
</td>
<td style="text-align:right;">
5.250551e-01
</td>
<td style="text-align:right;">
5.341615e-01
</td>
<td style="text-align:right;">
5.446035e-01
</td>
<td style="text-align:right;">
0.1329943
</td>
<td style="text-align:right;">
0.1850916
</td>
<td style="text-align:right;">
0.3850802
</td>
<td style="text-align:right;">
0.1780933
</td>
<td style="text-align:right;">
0.1329943
</td>
<td style="text-align:right;">
0.2332531
</td>
<td style="text-align:right;">
0.3453679
</td>
<td style="text-align:right;">
0.5578774
</td>
<td style="text-align:right;">
0.8260252
</td>
<td style="text-align:right;">
0.9299769
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
5RB
</td>
<td style="text-align:right;">
187348
</td>
<td style="text-align:right;">
1078667
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1452387
</td>
<td style="text-align:right;">
421479
</td>
<td style="text-align:right;">
0.0596672
</td>
<td style="text-align:right;">
0.3435375
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.4625612
</td>
<td style="text-align:right;">
0.1342341
</td>
<td style="text-align:right;">
39.00602
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
20.88804
</td>
<td style="text-align:right;">
28.66510
</td>
<td style="text-align:right;">
39.00602
</td>
<td style="text-align:right;">
1.8673849
</td>
<td style="text-align:right;">
1.8673849
</td>
<td style="text-align:right;">
1.8673849
</td>
<td style="text-align:right;">
1.8673849
</td>
<td style="text-align:right;">
0.4820815
</td>
<td style="text-align:right;">
0.1934315
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.5213079
</td>
<td style="text-align:right;">
0.2945054
</td>
<td style="text-align:right;">
0.1934315
</td>
<td style="text-align:right;">
3.710503e-01
</td>
<td style="text-align:right;">
3.710503e-01
</td>
<td style="text-align:right;">
3.710503e-01
</td>
<td style="text-align:right;">
3.710503e-01
</td>
<td style="text-align:right;">
0.3599100
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4620250
</td>
<td style="text-align:right;">
0.6079956
</td>
<td style="text-align:right;">
0.3599100
</td>
<td style="text-align:right;">
0.7789838
</td>
<td style="text-align:right;">
0.7789838
</td>
<td style="text-align:right;">
0.7789838
</td>
<td style="text-align:right;">
0.7789838
</td>
<td style="text-align:right;">
10.3571429
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
6LDU
</td>
<td style="text-align:right;">
78416
</td>
<td style="text-align:right;">
377308
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
912277
</td>
<td style="text-align:right;">
41718
</td>
<td style="text-align:right;">
0.0556253
</td>
<td style="text-align:right;">
0.2676477
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.6471339
</td>
<td style="text-align:right;">
0.0295931
</td>
<td style="text-align:right;">
111.44785
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
21.09500
</td>
<td style="text-align:right;">
421.71225
</td>
<td style="text-align:right;">
111.44785
</td>
<td style="text-align:right;">
5.2831411
</td>
<td style="text-align:right;">
5.2831411
</td>
<td style="text-align:right;">
5.2831411
</td>
<td style="text-align:right;">
5.2831411
</td>
<td style="text-align:right;">
0.4110641
</td>
<td style="text-align:right;">
0.1092889
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.6222455
</td>
<td style="text-align:right;">
0.0145634
</td>
<td style="text-align:right;">
0.1092889
</td>
<td style="text-align:right;">
1.756363e-01
</td>
<td style="text-align:right;">
1.756363e-01
</td>
<td style="text-align:right;">
1.756363e-01
</td>
<td style="text-align:right;">
1.756363e-01
</td>
<td style="text-align:right;">
0.2047156
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4431975
</td>
<td style="text-align:right;">
0.1223735
</td>
<td style="text-align:right;">
0.2047156
</td>
<td style="text-align:right;">
0.4619061
</td>
<td style="text-align:right;">
0.4619061
</td>
<td style="text-align:right;">
0.4619061
</td>
<td style="text-align:right;">
0.4619061
</td>
<td style="text-align:right;">
2.1974522
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
6ND
</td>
<td style="text-align:right;">
170266
</td>
<td style="text-align:right;">
980499
</td>
<td style="text-align:right;">
223461
</td>
<td style="text-align:right;">
528928
</td>
<td style="text-align:right;">
183692
</td>
<td style="text-align:right;">
0.0815901
</td>
<td style="text-align:right;">
0.4698473
</td>
<td style="text-align:right;">
0.1070807
</td>
<td style="text-align:right;">
0.2534581
</td>
<td style="text-align:right;">
0.0880237
</td>
<td style="text-align:right;">
28.41556
</td>
<td style="text-align:right;">
47.86891
</td>
<td style="text-align:right;">
30.70313
</td>
<td style="text-align:right;">
51.92693
</td>
<td style="text-align:right;">
28.41556
</td>
<td style="text-align:right;">
0.3616497
</td>
<td style="text-align:right;">
0.9254938
</td>
<td style="text-align:right;">
0.9708856
</td>
<td style="text-align:right;">
2.4845825
</td>
<td style="text-align:right;">
0.5991449
</td>
<td style="text-align:right;">
0.2756628
</td>
<td style="text-align:right;">
0.0305404
</td>
<td style="text-align:right;">
0.2129080
</td>
<td style="text-align:right;">
0.0798398
</td>
<td style="text-align:right;">
0.0305404
</td>
<td style="text-align:right;">
1.132325e+00
</td>
<td style="text-align:right;">
1.294750e+00
</td>
<td style="text-align:right;">
1.257774e+00
</td>
<td style="text-align:right;">
1.438195e+00
</td>
<td style="text-align:right;">
0.3247328
</td>
<td style="text-align:right;">
0.3222135
</td>
<td style="text-align:right;">
0.3681602
</td>
<td style="text-align:right;">
0.2951982
</td>
<td style="text-align:right;">
0.3222135
</td>
<td style="text-align:right;">
0.4703725
</td>
<td style="text-align:right;">
0.8820423
</td>
<td style="text-align:right;">
0.9370959
</td>
<td style="text-align:right;">
1.7572416
</td>
<td style="text-align:right;">
30.0000000
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
6RB
</td>
<td style="text-align:right;">
79608
</td>
<td style="text-align:right;">
90700
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
247319
</td>
<td style="text-align:right;">
94386
</td>
<td style="text-align:right;">
0.1554804
</td>
<td style="text-align:right;">
0.1771439
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.4830327
</td>
<td style="text-align:right;">
0.1843430
</td>
<td style="text-align:right;">
76.37955
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
15.75336
</td>
<td style="text-align:right;">
43.30215
</td>
<td style="text-align:right;">
76.37955
</td>
<td style="text-align:right;">
4.8484602
</td>
<td style="text-align:right;">
4.8484602
</td>
<td style="text-align:right;">
4.8484602
</td>
<td style="text-align:right;">
4.8484602
</td>
<td style="text-align:right;">
0.5258014
</td>
<td style="text-align:right;">
0.1446840
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.6712516
</td>
<td style="text-align:right;">
0.2653502
</td>
<td style="text-align:right;">
0.1446840
</td>
<td style="text-align:right;">
2.155435e-01
</td>
<td style="text-align:right;">
2.155435e-01
</td>
<td style="text-align:right;">
2.155435e-01
</td>
<td style="text-align:right;">
2.155435e-01
</td>
<td style="text-align:right;">
0.5029649
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.7162637
</td>
<td style="text-align:right;">
0.5539084
</td>
<td style="text-align:right;">
0.5029649
</td>
<td style="text-align:right;">
0.7022064
</td>
<td style="text-align:right;">
0.7022064
</td>
<td style="text-align:right;">
0.7022064
</td>
<td style="text-align:right;">
0.7022064
</td>
<td style="text-align:right;">
2.8000000
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
6RC
</td>
<td style="text-align:right;">
157455
</td>
<td style="text-align:right;">
495313
</td>
<td style="text-align:right;">
238235
</td>
<td style="text-align:right;">
782142
</td>
<td style="text-align:right;">
324989
</td>
<td style="text-align:right;">
0.0788010
</td>
<td style="text-align:right;">
0.2478878
</td>
<td style="text-align:right;">
0.1192287
</td>
<td style="text-align:right;">
0.3914362
</td>
<td style="text-align:right;">
0.1626462
</td>
<td style="text-align:right;">
50.21453
</td>
<td style="text-align:right;">
66.49674
</td>
<td style="text-align:right;">
18.16188
</td>
<td style="text-align:right;">
34.81308
</td>
<td style="text-align:right;">
50.21453
</td>
<td style="text-align:right;">
0.5931413
</td>
<td style="text-align:right;">
2.7648305
</td>
<td style="text-align:right;">
1.3786105
</td>
<td style="text-align:right;">
6.4261656
</td>
<td style="text-align:right;">
0.3830618
</td>
<td style="text-align:right;">
0.1966022
</td>
<td style="text-align:right;">
0.0674351
</td>
<td style="text-align:right;">
0.5424852
</td>
<td style="text-align:right;">
0.2411991
</td>
<td style="text-align:right;">
0.0674351
</td>
<td style="text-align:right;">
3.223408e-01
</td>
<td style="text-align:right;">
3.624103e-01
</td>
<td style="text-align:right;">
4.329047e-01
</td>
<td style="text-align:right;">
4.867181e-01
</td>
<td style="text-align:right;">
0.4713741
</td>
<td style="text-align:right;">
0.4862458
</td>
<td style="text-align:right;">
0.6401989
</td>
<td style="text-align:right;">
0.5327762
</td>
<td style="text-align:right;">
0.4713741
</td>
<td style="text-align:right;">
0.4184618
</td>
<td style="text-align:right;">
0.7362931
</td>
<td style="text-align:right;">
0.8501259
</td>
<td style="text-align:right;">
1.4958161
</td>
<td style="text-align:right;">
8.2142857
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
7NB
</td>
<td style="text-align:right;">
32396
</td>
<td style="text-align:right;">
417604
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
543360
</td>
<td style="text-align:right;">
573677
</td>
<td style="text-align:right;">
0.0206734
</td>
<td style="text-align:right;">
0.2664928
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.3467436
</td>
<td style="text-align:right;">
0.3660903
</td>
<td style="text-align:right;">
80.17580
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
23.02340
</td>
<td style="text-align:right;">
30.71527
</td>
<td style="text-align:right;">
80.17580
</td>
<td style="text-align:right;">
3.4823613
</td>
<td style="text-align:right;">
3.4823613
</td>
<td style="text-align:right;">
3.4823613
</td>
<td style="text-align:right;">
3.4823613
</td>
<td style="text-align:right;">
0.3887826
</td>
<td style="text-align:right;">
0.0728176
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.3846771
</td>
<td style="text-align:right;">
0.3060872
</td>
<td style="text-align:right;">
0.0728176
</td>
<td style="text-align:right;">
1.892955e-01
</td>
<td style="text-align:right;">
1.892955e-01
</td>
<td style="text-align:right;">
1.892955e-01
</td>
<td style="text-align:right;">
1.892955e-01
</td>
<td style="text-align:right;">
0.1206553
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.2350231
</td>
<td style="text-align:right;">
0.2158776
</td>
<td style="text-align:right;">
0.1206553
</td>
<td style="text-align:right;">
0.5133764
</td>
<td style="text-align:right;">
0.5133764
</td>
<td style="text-align:right;">
0.5133764
</td>
<td style="text-align:right;">
0.5133764
</td>
<td style="text-align:right;">
2.8878505
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
7NC
</td>
<td style="text-align:right;">
106074
</td>
<td style="text-align:right;">
310952
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1628191
</td>
<td style="text-align:right;">
167163
</td>
<td style="text-align:right;">
0.0479457
</td>
<td style="text-align:right;">
0.1405509
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.7359455
</td>
<td style="text-align:right;">
0.0755580
</td>
<td style="text-align:right;">
89.34399
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
18.52427
</td>
<td style="text-align:right;">
73.48726
</td>
<td style="text-align:right;">
89.34399
</td>
<td style="text-align:right;">
4.8230787
</td>
<td style="text-align:right;">
4.8230787
</td>
<td style="text-align:right;">
4.8230787
</td>
<td style="text-align:right;">
4.8230787
</td>
<td style="text-align:right;">
0.5526142
</td>
<td style="text-align:right;">
0.0531233
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.5233799
</td>
<td style="text-align:right;">
0.0517752
</td>
<td style="text-align:right;">
0.0531233
</td>
<td style="text-align:right;">
1.015004e-01
</td>
<td style="text-align:right;">
1.015004e-01
</td>
<td style="text-align:right;">
1.015004e-01
</td>
<td style="text-align:right;">
1.015004e-01
</td>
<td style="text-align:right;">
0.1534592
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.2455539
</td>
<td style="text-align:right;">
0.2388339
</td>
<td style="text-align:right;">
0.1534592
</td>
<td style="text-align:right;">
0.6249511
</td>
<td style="text-align:right;">
0.6249511
</td>
<td style="text-align:right;">
0.6249511
</td>
<td style="text-align:right;">
0.6249511
</td>
<td style="text-align:right;">
3.4444444
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
7RA
</td>
<td style="text-align:right;">
72918
</td>
<td style="text-align:right;">
530505
</td>
<td style="text-align:right;">
441179
</td>
<td style="text-align:right;">
772709
</td>
<td style="text-align:right;">
466302
</td>
<td style="text-align:right;">
0.0319310
</td>
<td style="text-align:right;">
0.2323095
</td>
<td style="text-align:right;">
0.1931934
</td>
<td style="text-align:right;">
0.3383713
</td>
<td style="text-align:right;">
0.2041948
</td>
<td style="text-align:right;">
33.35958
</td>
<td style="text-align:right;">
39.17649
</td>
<td style="text-align:right;">
17.01392
</td>
<td style="text-align:right;">
25.12197
</td>
<td style="text-align:right;">
33.35958
</td>
<td style="text-align:right;">
0.5936880
</td>
<td style="text-align:right;">
1.9607221
</td>
<td style="text-align:right;">
1.2908975
</td>
<td style="text-align:right;">
4.2633357
</td>
<td style="text-align:right;">
0.2951535
</td>
<td style="text-align:right;">
0.2251296
</td>
<td style="text-align:right;">
0.1866754
</td>
<td style="text-align:right;">
0.4992183
</td>
<td style="text-align:right;">
0.1908445
</td>
<td style="text-align:right;">
0.1866754
</td>
<td style="text-align:right;">
3.282281e-01
</td>
<td style="text-align:right;">
4.509642e-01
</td>
<td style="text-align:right;">
6.003919e-01
</td>
<td style="text-align:right;">
8.248997e-01
</td>
<td style="text-align:right;">
0.3395623
</td>
<td style="text-align:right;">
0.3529855
</td>
<td style="text-align:right;">
0.3949139
</td>
<td style="text-align:right;">
0.3654755
</td>
<td style="text-align:right;">
0.3395623
</td>
<td style="text-align:right;">
0.4540214
</td>
<td style="text-align:right;">
0.8598389
</td>
<td style="text-align:right;">
0.9259906
</td>
<td style="text-align:right;">
1.7536680
</td>
<td style="text-align:right;">
1.1153846
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
7RB
</td>
<td style="text-align:right;">
23710
</td>
<td style="text-align:right;">
284804
</td>
<td style="text-align:right;">
735372
</td>
<td style="text-align:right;">
167172
</td>
<td style="text-align:right;">
188017
</td>
<td style="text-align:right;">
0.0169469
</td>
<td style="text-align:right;">
0.2035659
</td>
<td style="text-align:right;">
0.5256130
</td>
<td style="text-align:right;">
0.1194875
</td>
<td style="text-align:right;">
0.1343866
</td>
<td style="text-align:right;">
34.39737
</td>
<td style="text-align:right;">
14.99604
</td>
<td style="text-align:right;">
27.35225
</td>
<td style="text-align:right;">
37.09141
</td>
<td style="text-align:right;">
14.99604
</td>
<td style="text-align:right;">
0.8122495
</td>
<td style="text-align:right;">
1.2575703
</td>
<td style="text-align:right;">
1.1663616
</td>
<td style="text-align:right;">
1.8058266
</td>
<td style="text-align:right;">
0.0670603
</td>
<td style="text-align:right;">
0.1917334
</td>
<td style="text-align:right;">
0.6787431
</td>
<td style="text-align:right;">
0.1155631
</td>
<td style="text-align:right;">
0.1097005
</td>
<td style="text-align:right;">
0.1917334
</td>
<td style="text-align:right;">
2.413848e-01
</td>
<td style="text-align:right;">
1.659124e+00
</td>
<td style="text-align:right;">
1.095895e+00
</td>
<td style="text-align:right;">
7.532482e+00
</td>
<td style="text-align:right;">
0.5446202
</td>
<td style="text-align:right;">
0.5816950
</td>
<td style="text-align:right;">
0.5614016
</td>
<td style="text-align:right;">
0.5250031
</td>
<td style="text-align:right;">
0.5446202
</td>
<td style="text-align:right;">
0.4764429
</td>
<td style="text-align:right;">
0.9701081
</td>
<td style="text-align:right;">
0.9853194
</td>
<td style="text-align:right;">
2.0062559
</td>
<td style="text-align:right;">
3.9615385
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
7RD
</td>
<td style="text-align:right;">
50862
</td>
<td style="text-align:right;">
403704
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
886443
</td>
<td style="text-align:right;">
240078
</td>
<td style="text-align:right;">
0.0321690
</td>
<td style="text-align:right;">
0.2553332
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.5606542
</td>
<td style="text-align:right;">
0.1518436
</td>
<td style="text-align:right;">
44.13770
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
14.33429
</td>
<td style="text-align:right;">
38.10895
</td>
<td style="text-align:right;">
44.13770
</td>
<td style="text-align:right;">
3.0791694
</td>
<td style="text-align:right;">
3.0791694
</td>
<td style="text-align:right;">
3.0791694
</td>
<td style="text-align:right;">
3.0791694
</td>
<td style="text-align:right;">
0.3013841
</td>
<td style="text-align:right;">
0.2386457
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.6842436
</td>
<td style="text-align:right;">
0.1745901
</td>
<td style="text-align:right;">
0.2386457
</td>
<td style="text-align:right;">
3.487731e-01
</td>
<td style="text-align:right;">
3.487731e-01
</td>
<td style="text-align:right;">
3.487731e-01
</td>
<td style="text-align:right;">
3.487731e-01
</td>
<td style="text-align:right;">
0.3192517
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4240363
</td>
<td style="text-align:right;">
0.3851937
</td>
<td style="text-align:right;">
0.3192517
</td>
<td style="text-align:right;">
0.7528877
</td>
<td style="text-align:right;">
0.7528877
</td>
<td style="text-align:right;">
0.7528877
</td>
<td style="text-align:right;">
0.7528877
</td>
<td style="text-align:right;">
0.9966997
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
8LD
</td>
<td style="text-align:right;">
7860
</td>
<td style="text-align:right;">
82972
</td>
<td style="text-align:right;">
259
</td>
<td style="text-align:right;">
508
</td>
<td style="text-align:right;">
48175
</td>
<td style="text-align:right;">
0.0562336
</td>
<td style="text-align:right;">
0.5936154
</td>
<td style="text-align:right;">
0.0018530
</td>
<td style="text-align:right;">
0.0036344
</td>
<td style="text-align:right;">
0.3446635
</td>
<td style="text-align:right;">
16.36623
</td>
<td style="text-align:right;">
350.73208
</td>
<td style="text-align:right;">
292.95079
</td>
<td style="text-align:right;">
22.72937
</td>
<td style="text-align:right;">
16.36623
</td>
<td style="text-align:right;">
0.0254259
</td>
<td style="text-align:right;">
0.0558668
</td>
<td style="text-align:right;">
0.5703093
</td>
<td style="text-align:right;">
1.2531057
</td>
<td style="text-align:right;">
0.3456743
</td>
<td style="text-align:right;">
0.6508906
</td>
<td style="text-align:right;">
0.0008906
</td>
<td style="text-align:right;">
0.0035623
</td>
<td style="text-align:right;">
0.3871501
</td>
<td style="text-align:right;">
0.0008906
</td>
<td style="text-align:right;">
1.461714e+02
</td>
<td style="text-align:right;">
1.827143e+02
</td>
<td style="text-align:right;">
1.463714e+02
</td>
<td style="text-align:right;">
1.829643e+02
</td>
<td style="text-align:right;">
0.6488849
</td>
<td style="text-align:right;">
0.1488781
</td>
<td style="text-align:right;">
0.1657167
</td>
<td style="text-align:right;">
0.5950220
</td>
<td style="text-align:right;">
0.1488781
</td>
<td style="text-align:right;">
2.0626057
</td>
<td style="text-align:right;">
3.9156287
</td>
<td style="text-align:right;">
2.5358434
</td>
<td style="text-align:right;">
4.8140179
</td>
<td style="text-align:right;">
0.2418033
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
</tr>
<tr>
<td style="text-align:left;">
8RCL
</td>
<td style="text-align:right;">
4518
</td>
<td style="text-align:right;">
141557
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
63579
</td>
<td style="text-align:right;">
46047
</td>
<td style="text-align:right;">
0.0176691
</td>
<td style="text-align:right;">
0.5536036
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.2486459
</td>
<td style="text-align:right;">
0.1800814
</td>
<td style="text-align:right;">
15.12966
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
36.87314
</td>
<td style="text-align:right;">
33.12931
</td>
<td style="text-align:right;">
15.12966
</td>
<td style="text-align:right;">
0.4103167
</td>
<td style="text-align:right;">
0.4103167
</td>
<td style="text-align:right;">
0.4103167
</td>
<td style="text-align:right;">
0.4103167
</td>
<td style="text-align:right;">
0.1051350
</td>
<td style="text-align:right;">
0.6186366
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.3669765
</td>
<td style="text-align:right;">
0.2673749
</td>
<td style="text-align:right;">
0.6186366
</td>
<td style="text-align:right;">
1.685766e+00
</td>
<td style="text-align:right;">
1.685766e+00
</td>
<td style="text-align:right;">
1.685766e+00
</td>
<td style="text-align:right;">
1.685766e+00
</td>
<td style="text-align:right;">
0.5765175
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.5382005
</td>
<td style="text-align:right;">
0.4295692
</td>
<td style="text-align:right;">
0.5765175
</td>
<td style="text-align:right;">
1.0711947
</td>
<td style="text-align:right;">
1.0711947
</td>
<td style="text-align:right;">
1.0711947
</td>
<td style="text-align:right;">
1.0711947
</td>
<td style="text-align:right;">
12.0000000
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
</tr>
<tr>
<td style="text-align:left;">
8RCU
</td>
<td style="text-align:right;">
83679
</td>
<td style="text-align:right;">
750075
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1475968
</td>
<td style="text-align:right;">
599152
</td>
<td style="text-align:right;">
0.0287668
</td>
<td style="text-align:right;">
0.2578575
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.5074018
</td>
<td style="text-align:right;">
0.2059739
</td>
<td style="text-align:right;">
50.00101
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
24.56317
</td>
<td style="text-align:right;">
37.07321
</td>
<td style="text-align:right;">
50.00101
</td>
<td style="text-align:right;">
2.0356094
</td>
<td style="text-align:right;">
2.0356094
</td>
<td style="text-align:right;">
2.0356094
</td>
<td style="text-align:right;">
2.0356094
</td>
<td style="text-align:right;">
0.2746806
</td>
<td style="text-align:right;">
0.2347423
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4697355
</td>
<td style="text-align:right;">
0.2889853
</td>
<td style="text-align:right;">
0.2347423
</td>
<td style="text-align:right;">
4.997329e-01
</td>
<td style="text-align:right;">
4.997329e-01
</td>
<td style="text-align:right;">
4.997329e-01
</td>
<td style="text-align:right;">
4.997329e-01
</td>
<td style="text-align:right;">
0.3676127
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.3679267
</td>
<td style="text-align:right;">
0.4564061
</td>
<td style="text-align:right;">
0.3676127
</td>
<td style="text-align:right;">
0.9991463
</td>
<td style="text-align:right;">
0.9991463
</td>
<td style="text-align:right;">
0.9991463
</td>
<td style="text-align:right;">
0.9991463
</td>
<td style="text-align:right;">
5.5142857
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
low
</td>
</tr>
</tbody>
</table>
</div>
<p>Firstly, we can compare the different metrics to determine how similar or different they are: They generally associate very well, with knn and IF being the best (they are directly related metrics)</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="spatial-statistics.html#cb110-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb110-2"><a href="spatial-statistics.html#cb110-2"></a>a1=<span class="kw">cor.test</span>(df.Spatial<span class="op">$</span>knn.EpCAM, df.Spatial<span class="op">$</span>MH.EpCAM)</span>
<span id="cb110-3"><a href="spatial-statistics.html#cb110-3"></a><span class="kw">plot</span>(df.Spatial<span class="op">$</span>knn.EpCAM, df.Spatial<span class="op">$</span>MH.EpCAM, <span class="dt">xlab=</span><span class="st">&quot;knn&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;MH&quot;</span>,</span>
<span id="cb110-4"><a href="spatial-statistics.html#cb110-4"></a>     <span class="dt">main=</span><span class="kw">sprintf</span>(<span class="st">&quot;cor:%s, p:%s&quot;</span>, <span class="kw">round</span>(a1<span class="op">$</span>estimate,<span class="dv">2</span>), <span class="kw">round</span>(a1<span class="op">$</span>p.value, <span class="dv">2</span>)))</span>
<span id="cb110-5"><a href="spatial-statistics.html#cb110-5"></a>a1=<span class="kw">cor.test</span>(df.Spatial<span class="op">$</span>IF.EpCAM, df.Spatial<span class="op">$</span>MH.EpCAM)</span>
<span id="cb110-6"><a href="spatial-statistics.html#cb110-6"></a><span class="kw">plot</span>(df.Spatial<span class="op">$</span>MH.EpCAM, df.Spatial<span class="op">$</span>IF.EpCAM,  <span class="dt">xlab=</span><span class="st">&quot;MH&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;IF&quot;</span>,</span>
<span id="cb110-7"><a href="spatial-statistics.html#cb110-7"></a>      <span class="dt">main=</span><span class="kw">sprintf</span>(<span class="st">&quot;cor:%s, p:%s&quot;</span>, <span class="kw">round</span>(a1<span class="op">$</span>estimate,<span class="dv">2</span>), <span class="kw">round</span>(a1<span class="op">$</span>p.value, <span class="dv">2</span>)))</span>
<span id="cb110-8"><a href="spatial-statistics.html#cb110-8"></a>a1=<span class="kw">cor.test</span>(df.Spatial<span class="op">$</span>knn.EpCAM, df.Spatial<span class="op">$</span>MH.EpCAM)</span>
<span id="cb110-9"><a href="spatial-statistics.html#cb110-9"></a><span class="kw">plot</span>( df.Spatial<span class="op">$</span>IF.EpCAM,df.Spatial<span class="op">$</span>knn.EpCAM,  <span class="dt">xlab=</span><span class="st">&quot;IF&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;knn&quot;</span>,</span>
<span id="cb110-10"><a href="spatial-statistics.html#cb110-10"></a>       <span class="dt">main=</span><span class="kw">sprintf</span>(<span class="st">&quot;cor:%s, p:%s&quot;</span>, <span class="kw">round</span>(a1<span class="op">$</span>estimate,<span class="dv">2</span>), <span class="kw">round</span>(a1<span class="op">$</span>p.value, <span class="dv">2</span>)))</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<p>We can also make comparisons directly against growth rate and tumor size</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="spatial-statistics.html#cb111-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb111-2"><a href="spatial-statistics.html#cb111-2"></a></span>
<span id="cb111-3"><a href="spatial-statistics.html#cb111-3"></a>cNames=<span class="kw">c</span>(<span class="st">&quot;knn.EpCAM&quot;</span>, <span class="st">&quot;IF.EpCAM&quot;</span>, <span class="st">&quot;MH.EpCAM&quot;</span>)</span>
<span id="cb111-4"><a href="spatial-statistics.html#cb111-4"></a></span>
<span id="cb111-5"><a href="spatial-statistics.html#cb111-5"></a><span class="cf">for</span> (i <span class="cf">in</span> cNames){</span>
<span id="cb111-6"><a href="spatial-statistics.html#cb111-6"></a>t1=<span class="kw">cor.test</span>(df.Spatial[, i],df.Spatial<span class="op">$</span>GrowthRate, <span class="dt">use=</span><span class="st">&quot;complete&quot;</span>)</span>
<span id="cb111-7"><a href="spatial-statistics.html#cb111-7"></a><span class="kw">plot</span>(df.Spatial[, i]<span class="op">~</span>df.Spatial<span class="op">$</span>GrowthRate, <span class="dt">ylab=</span>i, <span class="dt">xlab=</span><span class="st">&quot;Growth Rate&quot;</span>, <span class="dt">main=</span><span class="kw">sprintf</span>(<span class="st">&quot;cor:%s p:%s&quot;</span>, <span class="kw">round</span>(t1<span class="op">$</span>estimate, <span class="dv">2</span>), <span class="kw">round</span>(t1<span class="op">$</span>p.value,<span class="dv">2</span>)))</span>
<span id="cb111-8"><a href="spatial-statistics.html#cb111-8"></a></span>
<span id="cb111-9"><a href="spatial-statistics.html#cb111-9"></a>t1=<span class="kw">cor.test</span>(df.Spatial[ ,i],df.Spatial<span class="op">$</span>TumSize, <span class="dt">use=</span><span class="st">&quot;complete&quot;</span>)</span>
<span id="cb111-10"><a href="spatial-statistics.html#cb111-10"></a><span class="kw">plot</span>(df.Spatial[, i]<span class="op">~</span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(df.Spatial<span class="op">$</span>TumSize)), <span class="dt">ylab=</span>i, <span class="dt">xlab=</span><span class="st">&quot;Tumor size&quot;</span>, <span class="dt">main=</span><span class="kw">sprintf</span>(<span class="st">&quot;cor:%s p:%s&quot;</span>, <span class="kw">round</span>(t1<span class="op">$</span>estimate, <span class="dv">2</span>), <span class="kw">round</span>(t1<span class="op">$</span>p.value, <span class="dv">2</span>)))</span>
<span id="cb111-11"><a href="spatial-statistics.html#cb111-11"></a>}</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
</div>
<div id="distances-to-unclassified-cells" class="section level2">
<h2><span class="header-section-number">5.5</span> Distances to “unclassified cells”</h2>
<p>We noted that the proportion of Unclassified cells seemed to be different between the treatments. Assess here whether the MH index for this cell type is associated with growth or treatment here:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="spatial-statistics.html#cb112-1"></a>varsearch=<span class="st">&quot;Unclass&quot;</span></span>
<span id="cb112-2"><a href="spatial-statistics.html#cb112-2"></a></span>
<span id="cb112-3"><a href="spatial-statistics.html#cb112-3"></a><span class="co">#MHmeltsumm=melt(WSIMHsetup, id.vars=c(&quot;gridsize&quot;, &quot;Ntiles&quot;))</span></span>
<span id="cb112-4"><a href="spatial-statistics.html#cb112-4"></a></span>
<span id="cb112-5"><a href="spatial-statistics.html#cb112-5"></a>MHmelt=<span class="kw">melt</span>(WSIMH, <span class="dt">measure.vars=</span><span class="st">&quot;MH.mean&quot;</span>)</span>
<span id="cb112-6"><a href="spatial-statistics.html#cb112-6"></a>MHmelt<span class="op">$</span>SpatialManual=Cdata<span class="op">$</span>Pathologist.CD8.Spatial[<span class="kw">match</span>(MHmelt<span class="op">$</span>L1, <span class="kw">gsub</span>(<span class="st">&quot;_&quot;</span>, <span class="st">&quot;&quot;</span>, Cdata<span class="op">$</span>TumorID))]</span>
<span id="cb112-7"><a href="spatial-statistics.html#cb112-7"></a><span class="co">#MHmeltsumm$SpatialManual=Cdata$Pathologist.CD8.Spatial[match(MHmeltsumm$L1, gsub(&quot;_&quot;, &quot;&quot;, Cdata$TumorID))]</span></span>
<span id="cb112-8"><a href="spatial-statistics.html#cb112-8"></a>MHmelt<span class="op">$</span>Treatment=Cdata<span class="op">$</span>Treatment[<span class="kw">match</span>(MHmelt<span class="op">$</span>L1, <span class="kw">gsub</span>(<span class="st">&quot;_&quot;</span>, <span class="st">&quot;&quot;</span>, Cdata<span class="op">$</span>TumorID))]</span>
<span id="cb112-9"><a href="spatial-statistics.html#cb112-9"></a>MHmelt<span class="op">$</span>Growth=Cdata<span class="op">$</span>Tumor.Growth[<span class="kw">match</span>(MHmelt<span class="op">$</span>L1, <span class="kw">gsub</span>(<span class="st">&quot;_&quot;</span>, <span class="st">&quot;&quot;</span>, Cdata<span class="op">$</span>TumorID))]</span>
<span id="cb112-10"><a href="spatial-statistics.html#cb112-10"></a><span class="co">#MHmelt$Growth=Cdata$Tumor.growth.status[match(MHmelt$L1, gsub(&quot;_&quot;, &quot;&quot;, Cdata$TumorID))]</span></span>
<span id="cb112-11"><a href="spatial-statistics.html#cb112-11"></a><span class="co">#MHmelt$Growth[grep(&quot;no data&quot;, MHmelt$Growth)]=&quot;no data&quot;</span></span>
<span id="cb112-12"><a href="spatial-statistics.html#cb112-12"></a></span>
<span id="cb112-13"><a href="spatial-statistics.html#cb112-13"></a>A1=MHmelt[MHmelt<span class="op">$</span>Var2<span class="op">==</span>varsearch<span class="op">|</span><span class="st"> </span>MHmelt<span class="op">$</span>Var1<span class="op">==</span>varsearch, ]</span>
<span id="cb112-14"><a href="spatial-statistics.html#cb112-14"></a>A1<span class="op">$</span>label=A1<span class="op">$</span>L1</span>
<span id="cb112-15"><a href="spatial-statistics.html#cb112-15"></a>A1<span class="op">$</span>label[<span class="kw">which</span>(A1<span class="op">$</span>gridsize<span class="op">!=</span><span class="dv">500</span>)]=<span class="ot">NA</span></span>
<span id="cb112-16"><a href="spatial-statistics.html#cb112-16"></a>A1<span class="op">$</span>Var1=<span class="kw">ifelse</span>(A1<span class="op">$</span>Var1<span class="op">==</span>varsearch, <span class="kw">as.character</span>(A1<span class="op">$</span>Var2), <span class="kw">as.character</span>(A1<span class="op">$</span>Var1))</span>
<span id="cb112-17"><a href="spatial-statistics.html#cb112-17"></a></span>
<span id="cb112-18"><a href="spatial-statistics.html#cb112-18"></a>A2=MHmelt[(MHmelt<span class="op">$</span>Var2<span class="op">==</span>varsearch<span class="op">|</span>MHmelt<span class="op">$</span>Var1<span class="op">==</span>varsearch) <span class="op">&amp;</span><span class="st"> </span>MHmelt<span class="op">$</span>gridsize<span class="op">==</span><span class="dv">250</span> <span class="op">&amp;</span><span class="st"> </span>MHmelt<span class="op">$</span>Var1<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;EpCAM&quot;</span>, <span class="st">&quot;SMA&quot;</span>), ]</span>
<span id="cb112-19"><a href="spatial-statistics.html#cb112-19"></a>A3=MHmelt[(MHmelt<span class="op">$</span>Var2<span class="op">==</span>varsearch<span class="op">|</span>MHmelt<span class="op">$</span>Var1<span class="op">==</span>varsearch) <span class="op">&amp;</span><span class="st"> </span>MHmelt<span class="op">$</span>gridsize<span class="op">==</span><span class="dv">250</span>, ]</span>
<span id="cb112-20"><a href="spatial-statistics.html#cb112-20"></a>A3<span class="op">$</span>CD8frac=WSIvalFracs[ <span class="dv">1</span>, <span class="kw">match</span>(A3<span class="op">$</span>L1, <span class="kw">colnames</span>(WSIvals))]</span>
<span id="cb112-21"><a href="spatial-statistics.html#cb112-21"></a></span>
<span id="cb112-22"><a href="spatial-statistics.html#cb112-22"></a>A3<span class="op">$</span>Var1=<span class="kw">ifelse</span>(A3<span class="op">$</span>Var1<span class="op">==</span>varsearch, <span class="kw">as.character</span>(A3<span class="op">$</span>Var2), <span class="kw">as.character</span>(A3<span class="op">$</span>Var1))</span>
<span id="cb112-23"><a href="spatial-statistics.html#cb112-23"></a></span>
<span id="cb112-24"><a href="spatial-statistics.html#cb112-24"></a>MHTempSumm=A3 <span class="co">#MHmelt[which(MHmelt$gridsize==300 &amp; MHmelt$Var2==varsearch), ]</span></span>
<span id="cb112-25"><a href="spatial-statistics.html#cb112-25"></a>MHreshape=<span class="kw">acast</span>(A3[ ,<span class="kw">c</span>(<span class="st">&quot;Var1&quot;</span>, <span class="st">&quot;value&quot;</span>, <span class="st">&quot;L1&quot;</span>)], L1<span class="op">~</span>Var1, <span class="dt">value.var=</span><span class="st">&quot;value&quot;</span> )</span>
<span id="cb112-26"><a href="spatial-statistics.html#cb112-26"></a>MHreshape=<span class="kw">data.frame</span>(MHreshape)</span>
<span id="cb112-27"><a href="spatial-statistics.html#cb112-27"></a></span>
<span id="cb112-28"><a href="spatial-statistics.html#cb112-28"></a>MHreshape<span class="op">$</span>Treatment=A3<span class="op">$</span>Treatment[<span class="kw">match</span>(<span class="kw">rownames</span>(MHreshape), A3<span class="op">$</span>L1)]</span>
<span id="cb112-29"><a href="spatial-statistics.html#cb112-29"></a>MHreshape<span class="op">$</span>Growth=A3<span class="op">$</span>Growth[<span class="kw">match</span>(<span class="kw">rownames</span>(MHreshape), A3<span class="op">$</span>L1)]</span>
<span id="cb112-30"><a href="spatial-statistics.html#cb112-30"></a>MHreshape<span class="op">$</span>Infil=A3<span class="op">$</span>SpatialManual[<span class="kw">match</span>(<span class="kw">rownames</span>(MHreshape), A3<span class="op">$</span>L1)]</span>
<span id="cb112-31"><a href="spatial-statistics.html#cb112-31"></a></span>
<span id="cb112-32"><a href="spatial-statistics.html#cb112-32"></a><span class="kw">colnames</span>(MHreshape)=<span class="kw">paste</span>(varsearch, <span class="kw">colnames</span>(MHreshape), <span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)</span>
<span id="cb112-33"><a href="spatial-statistics.html#cb112-33"></a>DT<span class="op">::</span><span class="kw">datatable</span>(MHreshape, <span class="dt">rownames=</span>F, <span class="dt">class=</span><span class="st">&#39;cell-border stripe&#39;</span>,</span>
<span id="cb112-34"><a href="spatial-statistics.html#cb112-34"></a>          <span class="dt">extensions=</span><span class="st">&quot;Buttons&quot;</span>, <span class="dt">options=</span><span class="kw">list</span>(<span class="dt">dom=</span><span class="st">&quot;Bfrtip&quot;</span>, <span class="dt">buttons=</span><span class="kw">c</span>(<span class="st">&#39;csv&#39;</span>, <span class="st">&#39;excel&#39;</span>), <span class="dt">scrollX=</span>T))</span></code></pre></div>
<div id="htmlwidget-4c6a6fc654da50f0a9ce" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-4c6a6fc654da50f0a9ce">{"x":{"filter":"none","extensions":["Buttons"],"data":[[0.554407461965743,0.571706500746745,0.616443478568439,0.403389337252738,0.320639407141568,0.591797817005499,0.569209083514097,0.73423338795938,0.615306256385877,0.760823927940326,0.234990097863977,0.548163685066951,0.751713124869326,0.756493327578111,0.298523931706878,0.665964863983904,0.634440752554161,0.616237375150883,0.54889862347386,0.469112503545889,0.559479135873044,0.500466103481249,0.501202617288951,0.175556268202293,0.722455134666891,0.461123659635355,0.500136097272639,0.645045518454209,0.829501552336648,0.525095910363072,0.529474330589773,0.795823479468692,0.647009188811405,0.382801887858857,0.695614729284186,0.505801351525514,0.489237750106348,0.645739428397967,0.0617269574485295,0.474780912295535,0.461234665470411,0.534745022844513,0.576877740668441,0.238726512729895,0.262171110724757,0.676888613955451,0.147798498629994,0.352226667884465,0.599240641694505,0.599989558742801,0.30859617855788,0.309327302706513,0.460543284820433,0.698388125565078,0.471617885817702,0.670401108787399,0.53479902598915,0.54197766559555],[0.541966914529955,0.565347218262969,0.661450233449333,0.637210181005627,0.699999405245068,0.327136466673407,0.430828054853804,0.686847271526345,0.638024076279043,0.591483404621749,0.472881081540703,0.670982685496341,0.601190582213496,0.752959910518844,0.466342540935303,0.69736164026783,0.668116114893356,0.662499578951943,0.685765345100487,0.78386589859735,0.816477224563357,0.443212636273637,0.663456625689404,0.598602234540211,0.544824181685303,0.691521602031211,0.350980995891652,0.467054042525129,0.763222466356374,0.578585202573978,0.507281514542977,0.604160572510732,0.52008073010337,0.498213972716051,0.603406998776568,0.526373718418174,0.731267443375609,0.730905076355118,0.698629383860997,0.452158056000263,0.712976832898206,0.574051811712815,0.572213720269094,0.605626301365651,0.541341116884509,0.458969679001159,0.116066965514807,0.413354340817665,0.446156875683663,0.477445940645722,0.59559796470764,0.582883484015059,0.741664495828784,0.880282478651327,0.648760027897502,0.764774493503624,0.659700000393215,0.439227085019723],[0.483527675094136,0.506925893758707,0.551870293915699,null,null,0.179567624606396,0.317564607436408,0.355892975877728,0.00203769611110544,0.29774071049419,0.380808758190991,0.483623074984279,0.280979483459146,0.0350722068655168,null,0.340098064563138,0.461024214178208,0.356781504525555,0.382316866428604,null,0.402537065077304,null,null,null,null,0.721961417047497,null,null,0.316760013821209,0.370293960497868,0.33033617217201,0.0459516459039714,0.160775728886664,0.276335732020638,null,null,0.424650181586161,0.392606546224574,null,null,0.366336728949172,null,null,null,0.311981336544148,null,null,0.343034501480875,null,0.359354878268505,null,null,0.74801379374255,0.865545399681869,null,0.160494578726192,null,null],[0.639857590196137,0.617962348727518,0.729667069548325,0.62843107767795,0.781130338052862,0.465167275526612,0.604724541469034,0.792586444067425,0.00347550611429827,0.705253957173179,0.527779023568653,0.572631472729276,0.400348214908099,0.199767258783656,0.527436190051516,0.602069930105403,0.585564839821863,0.625906430051862,0.794766305745752,0.69930381296093,0.451016489713622,null,0.565205618074221,0.541785408641017,0.524757160954419,0.734396472048844,0.526761137343141,0.493009737644387,0.69220879547474,0.371074516297324,0.626273263954461,0.396711018141298,0.636357745702916,0.415227060455917,0.693144578673802,0.607867720746984,0.644667284786248,0.658950332548708,0.746814062665711,0.465685188419852,0.63687412754186,0.544975973088918,null,0.447594195459972,0.622888163487371,0.555789652377546,0.203060470066058,0.450966336566723,0.419737263093096,0.532038623505348,0.602465699258607,0.552100473754475,0.811192104740618,0.822157564703389,0.631730993469433,0.200176588497078,0.273309430246077,0.357489665240284],["PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","PDL1","Vehicle","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1+LY","PDL1","PDL1","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","Vehicle","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY","LY"],["growing","growing","stable",null,"stable","growing",null,null,"growing","stable","growing","growing",null,"stable","growing","growing","stable","stable","growing","growing","stable","growing",null,"stable","stable","stable","stable","growing","stable","growing","growing","growing","growing","growing","stable","growing","growing","growing","growing","growing","growing","stable","growing","growing","stable","growing","growing","growing","growing","growing","growing","growing","stable","growing","stable","stable","growing","growing"],["Infiltrating","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","Infiltrating",null,"Infiltrating","restricted","restricted","Infiltrating","Infiltrating","restricted","restricted","restricted","Infiltrating","restricted","restricted","Infiltrating","restricted","Infiltrating","Infiltrating","Infiltrating","Infiltrating","Infiltrating","restricted","Infiltrating","Infiltrating","restricted","restricted","restricted","restricted","Infiltrating","restricted","Infiltrating","Infiltrating","restricted","Infiltrating","restricted","Infiltrating","restricted","restricted","restricted","restricted","restricted",null,"Infiltrating","restricted","restricted","restricted","restricted",null,"Infiltrating","Infiltrating","restricted","restricted"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th>Unclass.CD8<\/th>\n      <th>Unclass.EpCAM<\/th>\n      <th>Unclass.EpCAM..SMA<\/th>\n      <th>Unclass.SMA<\/th>\n      <th>Unclass.Treatment<\/th>\n      <th>Unclass.Growth<\/th>\n      <th>Unclass.Infil<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["csv","excel"],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[0,1,2,3]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="spatial-statistics.html#cb113-1"></a><span class="co">#write.csv(MHreshape, file=sprintf(&quot;outputs/%s_MH_comparisons_gridsize250.csv&quot;, varsearch))</span></span>
<span id="cb113-2"><a href="spatial-statistics.html#cb113-2"></a></span>
<span id="cb113-3"><a href="spatial-statistics.html#cb113-3"></a><span class="co"># pdf(sprintf(&quot;rslt/WSI-analysis/MHplots_spatial_growth_treatment_%s_celltype_%s.pdf&quot;, varsearch, Sys.Date()), height=7, width=12)</span></span>
<span id="cb113-4"><a href="spatial-statistics.html#cb113-4"></a><span class="co"># </span></span>
<span id="cb113-5"><a href="spatial-statistics.html#cb113-5"></a> p&lt;-<span class="kw">ggplot</span>(A1, <span class="kw">aes</span>(<span class="dt">x=</span>gridsize, <span class="dt">y=</span>value, <span class="dt">col=</span>Growth))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>Var1)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span>L1))<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;grid size&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Morisita Horn index&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="kw">sprintf</span>(<span class="st">&quot;MH index with %s: growth&quot;</span>, varsearch))</span>
<span id="cb113-6"><a href="spatial-statistics.html#cb113-6"></a> <span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-49-2.png" width="672" /></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="spatial-statistics.html#cb114-1"></a> </span>
<span id="cb114-2"><a href="spatial-statistics.html#cb114-2"></a>pvals=<span class="kw">sapply</span>(<span class="kw">unique</span>(A3<span class="op">$</span>Var1), <span class="cf">function</span>(x) <span class="kw">wilcox.test</span>(A3<span class="op">$</span>value[A3<span class="op">$</span>Var1<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>A3<span class="op">$</span>Growth<span class="op">==</span><span class="st">&quot;growing&quot;</span>],A3<span class="op">$</span>value[A3<span class="op">$</span>Var1<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>A3<span class="op">$</span>Growth<span class="op">==</span><span class="st">&quot;stable&quot;</span>])<span class="op">$</span>p.value)</span>
<span id="cb114-3"><a href="spatial-statistics.html#cb114-3"></a></span>
<span id="cb114-4"><a href="spatial-statistics.html#cb114-4"></a>ann_text=<span class="kw">data.frame</span>(<span class="dt">Growth=</span><span class="st">&quot;stable&quot;</span>, <span class="dt">y=</span><span class="fl">0.8</span>, <span class="dt">label=</span><span class="kw">round</span>(pvals,<span class="dv">2</span>), <span class="dt">Var1=</span><span class="kw">unique</span>(A3<span class="op">$</span>Var1))</span>
<span id="cb114-5"><a href="spatial-statistics.html#cb114-5"></a> </span>
<span id="cb114-6"><a href="spatial-statistics.html#cb114-6"></a><span class="kw">ggplot</span>(A3, <span class="kw">aes</span>(<span class="dt">x=</span>Growth, <span class="dt">y=</span>value, <span class="dt">col=</span>Growth))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>Var1)<span class="op">+</span><span class="kw">geom_boxplot</span>()<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;grid size&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Morisita Horn index&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="kw">sprintf</span>(<span class="st">&quot;MH index with %s: growth&quot;</span>, varsearch))<span class="op">+</span></span>
<span id="cb114-7"><a href="spatial-statistics.html#cb114-7"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data=</span>ann_text, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>Growth , <span class="dt">y=</span><span class="fl">0.75</span>, <span class="dt">label=</span>label))</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-49-3.png" width="672" /></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="spatial-statistics.html#cb115-1"></a> </span>
<span id="cb115-2"><a href="spatial-statistics.html#cb115-2"></a></span>
<span id="cb115-3"><a href="spatial-statistics.html#cb115-3"></a>pval2=<span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb115-4"><a href="spatial-statistics.html#cb115-4"></a><span class="kw">colnames</span>(pval2)=<span class="kw">unique</span>(A3<span class="op">$</span>Var1)</span>
<span id="cb115-5"><a href="spatial-statistics.html#cb115-5"></a><span class="kw">rownames</span>(pval2)=TreatV[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb115-6"><a href="spatial-statistics.html#cb115-6"></a></span>
<span id="cb115-7"><a href="spatial-statistics.html#cb115-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){</span>
<span id="cb115-8"><a href="spatial-statistics.html#cb115-8"></a>pval2[i, ]=<span class="kw">sapply</span>(<span class="kw">unique</span>(A3<span class="op">$</span>Var1), <span class="cf">function</span>(x) <span class="kw">wilcox.test</span>(A3<span class="op">$</span>value[A3<span class="op">$</span>Var1<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>A3<span class="op">$</span>Treatment<span class="op">==</span>TreatV[i]], A3<span class="op">$</span>value[A3<span class="op">$</span>Var1<span class="op">==</span>x <span class="op">&amp;</span><span class="st"> </span>A3<span class="op">$</span>Treatment<span class="op">==</span><span class="st">&quot;Vehicle&quot;</span>])<span class="op">$</span>p.value)</span>
<span id="cb115-9"><a href="spatial-statistics.html#cb115-9"></a>}</span>
<span id="cb115-10"><a href="spatial-statistics.html#cb115-10"></a></span>
<span id="cb115-11"><a href="spatial-statistics.html#cb115-11"></a>pmelt=<span class="kw">melt</span>(pval2)</span>
<span id="cb115-12"><a href="spatial-statistics.html#cb115-12"></a><span class="kw">colnames</span>(pmelt)=<span class="kw">c</span>(<span class="st">&quot;Treatment&quot;</span>, <span class="st">&quot;Var1&quot;</span>, <span class="st">&quot;label&quot;</span>)</span>
<span id="cb115-13"><a href="spatial-statistics.html#cb115-13"></a>pmelt<span class="op">$</span>label=<span class="kw">round</span>(pmelt<span class="op">$</span>label, <span class="dv">2</span>)</span>
<span id="cb115-14"><a href="spatial-statistics.html#cb115-14"></a>pmelt<span class="op">$</span>value=<span class="fl">0.8</span></span>
<span id="cb115-15"><a href="spatial-statistics.html#cb115-15"></a></span>
<span id="cb115-16"><a href="spatial-statistics.html#cb115-16"></a>p&lt;-<span class="kw">ggplot</span>(A1, <span class="kw">aes</span>(<span class="dt">x=</span>gridsize, <span class="dt">y=</span>value, <span class="dt">col=</span>Treatment))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>Var1)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span>L1))<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;grid size&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Morisita Horn index&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="kw">sprintf</span>(<span class="st">&quot;MH index with %s: growth&quot;</span>, varsearch))</span>
<span id="cb115-17"><a href="spatial-statistics.html#cb115-17"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-49-4.png" width="672" /></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="spatial-statistics.html#cb116-1"></a></span>
<span id="cb116-2"><a href="spatial-statistics.html#cb116-2"></a><span class="kw">ggplot</span>(A3, <span class="kw">aes</span>(<span class="dt">x=</span>Treatment, <span class="dt">y=</span>value, <span class="dt">col=</span>Treatment))<span class="op">+</span><span class="kw">facet_grid</span>(<span class="op">~</span>Var1)<span class="op">+</span><span class="kw">geom_boxplot</span>()<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;grid size&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Morisita Horn index&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="kw">sprintf</span>(<span class="st">&quot;MH index with %s: growth&quot;</span>, varsearch))<span class="op">+</span><span class="kw">geom_text</span>(<span class="dt">data=</span>pmelt, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>Treatment, <span class="dt">y=</span><span class="fl">0.8</span>, <span class="dt">label=</span>label))</span></code></pre></div>
<p><img src="RatDCIS-bookdown_files/figure-html/unnamed-chunk-49-5.png" width="672" /></p>
<p>We see here that epcam-unclass mixing could also be associated with tumor growth - this could be attributed to a hight number of other immune related cells in this fraction.</p>
<p>Note that we can change the entry cell type to obtain the same plots for other reference cells of interest.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="whole-slide-imaging.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="expression-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["RatDCIS-bookdown.pdf", "RatDCIS-bookdown.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
